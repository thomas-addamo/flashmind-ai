var nx=Object.defineProperty;var m0=n=>{throw TypeError(n)};var ix=(n,e,t)=>e in n?nx(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var J=(n,e,t)=>ix(n,typeof e!="symbol"?e+"":e,t),eg=(n,e,t)=>e.has(n)||m0("Cannot "+t);var c=(n,e,t)=>(eg(n,e,"read from private field"),t?t.call(n):e.get(n)),S=(n,e,t)=>e.has(n)?m0("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),_=(n,e,t,i)=>(eg(n,e,"write to private field"),i?i.call(n,t):e.set(n,t),t),C=(n,e,t)=>(eg(n,e,"access private method"),t);var Ht=(n,e,t,i)=>({set _(s){_(n,e,s,t)},get _(){return c(n,e,i)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const o of r.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=t(s);fetch(s.href,r)}})();function sx(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var yE={exports:{}},xp={},vE={exports:{}},oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rh=Symbol.for("react.element"),rx=Symbol.for("react.portal"),ox=Symbol.for("react.fragment"),ax=Symbol.for("react.strict_mode"),lx=Symbol.for("react.profiler"),ux=Symbol.for("react.provider"),cx=Symbol.for("react.context"),dx=Symbol.for("react.forward_ref"),hx=Symbol.for("react.suspense"),fx=Symbol.for("react.memo"),px=Symbol.for("react.lazy"),y0=Symbol.iterator;function gx(n){return n===null||typeof n!="object"?null:(n=y0&&n[y0]||n["@@iterator"],typeof n=="function"?n:null)}var _E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},AE=Object.assign,EE={};function yu(n,e,t){this.props=n,this.context=e,this.refs=EE,this.updater=t||_E}yu.prototype.isReactComponent={};yu.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};yu.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function SE(){}SE.prototype=yu.prototype;function Qy(n,e,t){this.props=n,this.context=e,this.refs=EE,this.updater=t||_E}var Zy=Qy.prototype=new SE;Zy.constructor=Qy;AE(Zy,yu.prototype);Zy.isPureReactComponent=!0;var v0=Array.isArray,wE=Object.prototype.hasOwnProperty,jy={current:null},CE={key:!0,ref:!0,__self:!0,__source:!0};function TE(n,e,t){var i,s={},r=null,o=null;if(e!=null)for(i in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(r=""+e.key),e)wE.call(e,i)&&!CE.hasOwnProperty(i)&&(s[i]=e[i]);var a=arguments.length-2;if(a===1)s.children=t;else if(1<a){for(var l=Array(a),u=0;u<a;u++)l[u]=arguments[u+2];s.children=l}if(n&&n.defaultProps)for(i in a=n.defaultProps,a)s[i]===void 0&&(s[i]=a[i]);return{$$typeof:rh,type:n,key:r,ref:o,props:s,_owner:jy.current}}function mx(n,e){return{$$typeof:rh,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function ev(n){return typeof n=="object"&&n!==null&&n.$$typeof===rh}function yx(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var _0=/\/+/g;function tg(n,e){return typeof n=="object"&&n!==null&&n.key!=null?yx(""+n.key):e.toString(36)}function Lh(n,e,t,i,s){var r=typeof n;(r==="undefined"||r==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(r){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case rh:case rx:o=!0}}if(o)return o=n,s=s(o),n=i===""?"."+tg(o,0):i,v0(s)?(t="",n!=null&&(t=n.replace(_0,"$&/")+"/"),Lh(s,e,t,"",function(u){return u})):s!=null&&(ev(s)&&(s=mx(s,t+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(_0,"$&/")+"/")+n)),e.push(s)),1;if(o=0,i=i===""?".":i+":",v0(n))for(var a=0;a<n.length;a++){r=n[a];var l=i+tg(r,a);o+=Lh(r,e,t,l,s)}else if(l=gx(n),typeof l=="function")for(n=l.call(n),a=0;!(r=n.next()).done;)r=r.value,l=i+tg(r,a++),o+=Lh(r,e,t,l,s);else if(r==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function fh(n,e,t){if(n==null)return n;var i=[],s=0;return Lh(n,i,"","",function(r){return e.call(t,r,s++)}),i}function vx(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Jt={current:null},Dh={transition:null},_x={ReactCurrentDispatcher:Jt,ReactCurrentBatchConfig:Dh,ReactCurrentOwner:jy};function xE(){throw Error("act(...) is not supported in production builds of React.")}oe.Children={map:fh,forEach:function(n,e,t){fh(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return fh(n,function(){e++}),e},toArray:function(n){return fh(n,function(e){return e})||[]},only:function(n){if(!ev(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};oe.Component=yu;oe.Fragment=ox;oe.Profiler=lx;oe.PureComponent=Qy;oe.StrictMode=ax;oe.Suspense=hx;oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=_x;oe.act=xE;oe.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var i=AE({},n.props),s=n.key,r=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(r=e.ref,o=jy.current),e.key!==void 0&&(s=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)wE.call(e,l)&&!CE.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=t;else if(1<l){a=Array(l);for(var u=0;u<l;u++)a[u]=arguments[u+2];i.children=a}return{$$typeof:rh,type:n.type,key:s,ref:r,props:i,_owner:o}};oe.createContext=function(n){return n={$$typeof:cx,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:ux,_context:n},n.Consumer=n};oe.createElement=TE;oe.createFactory=function(n){var e=TE.bind(null,n);return e.type=n,e};oe.createRef=function(){return{current:null}};oe.forwardRef=function(n){return{$$typeof:dx,render:n}};oe.isValidElement=ev;oe.lazy=function(n){return{$$typeof:px,_payload:{_status:-1,_result:n},_init:vx}};oe.memo=function(n,e){return{$$typeof:fx,type:n,compare:e===void 0?null:e}};oe.startTransition=function(n){var e=Dh.transition;Dh.transition={};try{n()}finally{Dh.transition=e}};oe.unstable_act=xE;oe.useCallback=function(n,e){return Jt.current.useCallback(n,e)};oe.useContext=function(n){return Jt.current.useContext(n)};oe.useDebugValue=function(){};oe.useDeferredValue=function(n){return Jt.current.useDeferredValue(n)};oe.useEffect=function(n,e){return Jt.current.useEffect(n,e)};oe.useId=function(){return Jt.current.useId()};oe.useImperativeHandle=function(n,e,t){return Jt.current.useImperativeHandle(n,e,t)};oe.useInsertionEffect=function(n,e){return Jt.current.useInsertionEffect(n,e)};oe.useLayoutEffect=function(n,e){return Jt.current.useLayoutEffect(n,e)};oe.useMemo=function(n,e){return Jt.current.useMemo(n,e)};oe.useReducer=function(n,e,t){return Jt.current.useReducer(n,e,t)};oe.useRef=function(n){return Jt.current.useRef(n)};oe.useState=function(n){return Jt.current.useState(n)};oe.useSyncExternalStore=function(n,e,t){return Jt.current.useSyncExternalStore(n,e,t)};oe.useTransition=function(){return Jt.current.useTransition()};oe.version="18.3.1";vE.exports=oe;var Je=vE.exports;const Ax=sx(Je);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ex=Je,Sx=Symbol.for("react.element"),wx=Symbol.for("react.fragment"),Cx=Object.prototype.hasOwnProperty,Tx=Ex.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,xx={key:!0,ref:!0,__self:!0,__source:!0};function IE(n,e,t){var i,s={},r=null,o=null;t!==void 0&&(r=""+t),e.key!==void 0&&(r=""+e.key),e.ref!==void 0&&(o=e.ref);for(i in e)Cx.call(e,i)&&!xx.hasOwnProperty(i)&&(s[i]=e[i]);if(n&&n.defaultProps)for(i in e=n.defaultProps,e)s[i]===void 0&&(s[i]=e[i]);return{$$typeof:Sx,type:n,key:r,ref:o,props:s,_owner:Tx.current}}xp.Fragment=wx;xp.jsx=IE;xp.jsxs=IE;yE.exports=xp;var M=yE.exports,Lg={},PE={exports:{}},bn={},RE={exports:{}},ME={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(U,K){var Q=U.length;U.push(K);e:for(;0<Q;){var ce=Q-1>>>1,le=U[ce];if(0<s(le,K))U[ce]=K,U[Q]=le,Q=ce;else break e}}function t(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var K=U[0],Q=U.pop();if(Q!==K){U[0]=Q;e:for(var ce=0,le=U.length,Re=le>>>1;ce<Re;){var Qt=2*(ce+1)-1,Ji=U[Qt],Ge=Qt+1,me=U[Ge];if(0>s(Ji,Q))Ge<le&&0>s(me,Ji)?(U[ce]=me,U[Ge]=Q,ce=Ge):(U[ce]=Ji,U[Qt]=Q,ce=Qt);else if(Ge<le&&0>s(me,Q))U[ce]=me,U[Ge]=Q,ce=Ge;else break e}}return K}function s(U,K){var Q=U.sortIndex-K.sortIndex;return Q!==0?Q:U.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var r=performance;n.unstable_now=function(){return r.now()}}else{var o=Date,a=o.now();n.unstable_now=function(){return o.now()-a}}var l=[],u=[],h=1,p=null,g=3,m=!1,y=!1,A=!1,T=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,E=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(U){for(var K=t(u);K!==null;){if(K.callback===null)i(u);else if(K.startTime<=U)i(u),K.sortIndex=K.expirationTime,e(l,K);else break;K=t(u)}}function x(U){if(A=!1,w(U),!y)if(t(l)!==null)y=!0,F(I);else{var K=t(u);K!==null&&$(x,K.startTime-U)}}function I(U,K){y=!1,A&&(A=!1,v(k),k=-1),m=!0;var Q=g;try{for(w(K),p=t(l);p!==null&&(!(p.expirationTime>K)||U&&!D());){var ce=p.callback;if(typeof ce=="function"){p.callback=null,g=p.priorityLevel;var le=ce(p.expirationTime<=K);K=n.unstable_now(),typeof le=="function"?p.callback=le:p===t(l)&&i(l),w(K)}else i(l);p=t(l)}if(p!==null)var Re=!0;else{var Qt=t(u);Qt!==null&&$(x,Qt.startTime-K),Re=!1}return Re}finally{p=null,g=Q,m=!1}}var P=!1,R=null,k=-1,b=5,N=-1;function D(){return!(n.unstable_now()-N<b)}function Y(){if(R!==null){var U=n.unstable_now();N=U;var K=!0;try{K=R(!0,U)}finally{K?ie():(P=!1,R=null)}}else P=!1}var ie;if(typeof E=="function")ie=function(){E(Y)};else if(typeof MessageChannel<"u"){var ae=new MessageChannel,Ye=ae.port2;ae.port1.onmessage=Y,ie=function(){Ye.postMessage(null)}}else ie=function(){T(Y,0)};function F(U){R=U,P||(P=!0,ie())}function $(U,K){k=T(function(){U(n.unstable_now())},K)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(U){U.callback=null},n.unstable_continueExecution=function(){y||m||(y=!0,F(I))},n.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):b=0<U?Math.floor(1e3/U):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(U){switch(g){case 1:case 2:case 3:var K=3;break;default:K=g}var Q=g;g=K;try{return U()}finally{g=Q}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(U,K){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var Q=g;g=U;try{return K()}finally{g=Q}},n.unstable_scheduleCallback=function(U,K,Q){var ce=n.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?ce+Q:ce):Q=ce,U){case 1:var le=-1;break;case 2:le=250;break;case 5:le=1073741823;break;case 4:le=1e4;break;default:le=5e3}return le=Q+le,U={id:h++,callback:K,priorityLevel:U,startTime:Q,expirationTime:le,sortIndex:-1},Q>ce?(U.sortIndex=Q,e(u,U),t(l)===null&&U===t(u)&&(A?(v(k),k=-1):A=!0,$(x,Q-ce))):(U.sortIndex=le,e(l,U),y||m||(y=!0,F(I))),U},n.unstable_shouldYield=D,n.unstable_wrapCallback=function(U){var K=g;return function(){var Q=g;g=K;try{return U.apply(this,arguments)}finally{g=Q}}}})(ME);RE.exports=ME;var Ix=RE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Px=Je,kn=Ix;function L(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var kE=new Set,pc={};function Aa(n,e){cu(n,e),cu(n+"Capture",e)}function cu(n,e){for(pc[n]=e,n=0;n<e.length;n++)kE.add(e[n])}var Ls=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dg=Object.prototype.hasOwnProperty,Rx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,A0={},E0={};function Mx(n){return Dg.call(E0,n)?!0:Dg.call(A0,n)?!1:Rx.test(n)?E0[n]=!0:(A0[n]=!0,!1)}function kx(n,e,t,i){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function bx(n,e,t,i){if(e===null||typeof e>"u"||kx(n,e,t,i))return!0;if(i)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Xt(n,e,t,i,s,r,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=s,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=r,this.removeEmptyString=o}var wt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){wt[n]=new Xt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];wt[e]=new Xt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){wt[n]=new Xt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){wt[n]=new Xt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){wt[n]=new Xt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){wt[n]=new Xt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){wt[n]=new Xt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){wt[n]=new Xt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){wt[n]=new Xt(n,5,!1,n.toLowerCase(),null,!1,!1)});var tv=/[\-:]([a-z])/g;function nv(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(tv,nv);wt[e]=new Xt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(tv,nv);wt[e]=new Xt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(tv,nv);wt[e]=new Xt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){wt[n]=new Xt(n,1,!1,n.toLowerCase(),null,!1,!1)});wt.xlinkHref=new Xt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){wt[n]=new Xt(n,1,!1,n.toLowerCase(),null,!0,!0)});function iv(n,e,t,i){var s=wt.hasOwnProperty(e)?wt[e]:null;(s!==null?s.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(bx(e,t,s,i)&&(t=null),i||s===null?Mx(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):s.mustUseProperty?n[s.propertyName]=t===null?s.type===3?!1:"":t:(e=s.attributeName,i=s.attributeNamespace,t===null?n.removeAttribute(e):(s=s.type,t=s===3||s===4&&t===!0?"":""+t,i?n.setAttributeNS(i,e,t):n.setAttribute(e,t))))}var Os=Px.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ph=Symbol.for("react.element"),Na=Symbol.for("react.portal"),La=Symbol.for("react.fragment"),sv=Symbol.for("react.strict_mode"),Fg=Symbol.for("react.profiler"),bE=Symbol.for("react.provider"),NE=Symbol.for("react.context"),rv=Symbol.for("react.forward_ref"),Ug=Symbol.for("react.suspense"),Hg=Symbol.for("react.suspense_list"),ov=Symbol.for("react.memo"),Ws=Symbol.for("react.lazy"),LE=Symbol.for("react.offscreen"),S0=Symbol.iterator;function wu(n){return n===null||typeof n!="object"?null:(n=S0&&n[S0]||n["@@iterator"],typeof n=="function"?n:null)}var Ve=Object.assign,ng;function Fu(n){if(ng===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);ng=e&&e[1]||""}return`
`+ng+n}var ig=!1;function sg(n,e){if(!n||ig)return"";ig=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var i=u}Reflect.construct(n,[],e)}else{try{e.call()}catch(u){i=u}n.call(e.prototype)}else{try{throw Error()}catch(u){i=u}n()}}catch(u){if(u&&i&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),r=i.stack.split(`
`),o=s.length-1,a=r.length-1;1<=o&&0<=a&&s[o]!==r[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==r[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==r[a]){var l=`
`+s[o].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=o&&0<=a);break}}}finally{ig=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Fu(n):""}function Nx(n){switch(n.tag){case 5:return Fu(n.type);case 16:return Fu("Lazy");case 13:return Fu("Suspense");case 19:return Fu("SuspenseList");case 0:case 2:case 15:return n=sg(n.type,!1),n;case 11:return n=sg(n.type.render,!1),n;case 1:return n=sg(n.type,!0),n;default:return""}}function Vg(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case La:return"Fragment";case Na:return"Portal";case Fg:return"Profiler";case sv:return"StrictMode";case Ug:return"Suspense";case Hg:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case NE:return(n.displayName||"Context")+".Consumer";case bE:return(n._context.displayName||"Context")+".Provider";case rv:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case ov:return e=n.displayName||null,e!==null?e:Vg(n.type)||"Memo";case Ws:e=n._payload,n=n._init;try{return Vg(n(e))}catch{}}return null}function Lx(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Vg(e);case 8:return e===sv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Hr(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function DE(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Dx(n){var e=DE(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),i=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var s=t.get,r=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){i=""+o,r.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return i},setValue:function(o){i=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function gh(n){n._valueTracker||(n._valueTracker=Dx(n))}function FE(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),i="";return n&&(i=DE(n)?n.checked?"true":"false":n.value),n=i,n!==t?(e.setValue(n),!0):!1}function Tf(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Gg(n,e){var t=e.checked;return Ve({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function w0(n,e){var t=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;t=Hr(e.value!=null?e.value:t),n._wrapperState={initialChecked:i,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function UE(n,e){e=e.checked,e!=null&&iv(n,"checked",e,!1)}function Og(n,e){UE(n,e);var t=Hr(e.value),i=e.type;if(t!=null)i==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(i==="submit"||i==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Bg(n,e.type,t):e.hasOwnProperty("defaultValue")&&Bg(n,e.type,Hr(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function C0(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Bg(n,e,t){(e!=="number"||Tf(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Uu=Array.isArray;function Ka(n,e,t,i){if(n=n.options,e){e={};for(var s=0;s<t.length;s++)e["$"+t[s]]=!0;for(t=0;t<n.length;t++)s=e.hasOwnProperty("$"+n[t].value),n[t].selected!==s&&(n[t].selected=s),s&&i&&(n[t].defaultSelected=!0)}else{for(t=""+Hr(t),e=null,s=0;s<n.length;s++){if(n[s].value===t){n[s].selected=!0,i&&(n[s].defaultSelected=!0);return}e!==null||n[s].disabled||(e=n[s])}e!==null&&(e.selected=!0)}}function zg(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(L(91));return Ve({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function T0(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(L(92));if(Uu(t)){if(1<t.length)throw Error(L(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Hr(t)}}function HE(n,e){var t=Hr(e.value),i=Hr(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),i!=null&&(n.defaultValue=""+i)}function x0(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function VE(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function qg(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?VE(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var mh,GE=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,i,s){MSApp.execUnsafeLocalFunction(function(){return n(e,t,i,s)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(mh=mh||document.createElement("div"),mh.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=mh.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function gc(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var nc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Fx=["Webkit","ms","Moz","O"];Object.keys(nc).forEach(function(n){Fx.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),nc[e]=nc[n]})});function OE(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||nc.hasOwnProperty(n)&&nc[n]?(""+e).trim():e+"px"}function BE(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var i=t.indexOf("--")===0,s=OE(t,e[t],i);t==="float"&&(t="cssFloat"),i?n.setProperty(t,s):n[t]=s}}var Ux=Ve({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function $g(n,e){if(e){if(Ux[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(L(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(L(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(L(61))}if(e.style!=null&&typeof e.style!="object")throw Error(L(62))}}function Wg(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yg=null;function av(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Kg=null,Ja=null,Xa=null;function I0(n){if(n=lh(n)){if(typeof Kg!="function")throw Error(L(280));var e=n.stateNode;e&&(e=kp(e),Kg(n.stateNode,n.type,e))}}function zE(n){Ja?Xa?Xa.push(n):Xa=[n]:Ja=n}function qE(){if(Ja){var n=Ja,e=Xa;if(Xa=Ja=null,I0(n),e)for(n=0;n<e.length;n++)I0(e[n])}}function $E(n,e){return n(e)}function WE(){}var rg=!1;function YE(n,e,t){if(rg)return n(e,t);rg=!0;try{return $E(n,e,t)}finally{rg=!1,(Ja!==null||Xa!==null)&&(WE(),qE())}}function mc(n,e){var t=n.stateNode;if(t===null)return null;var i=kp(t);if(i===null)return null;t=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(n=n.type,i=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!i;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(L(231,e,typeof t));return t}var Jg=!1;if(Ls)try{var Cu={};Object.defineProperty(Cu,"passive",{get:function(){Jg=!0}}),window.addEventListener("test",Cu,Cu),window.removeEventListener("test",Cu,Cu)}catch{Jg=!1}function Hx(n,e,t,i,s,r,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{e.apply(t,u)}catch(h){this.onError(h)}}var ic=!1,xf=null,If=!1,Xg=null,Vx={onError:function(n){ic=!0,xf=n}};function Gx(n,e,t,i,s,r,o,a,l){ic=!1,xf=null,Hx.apply(Vx,arguments)}function Ox(n,e,t,i,s,r,o,a,l){if(Gx.apply(this,arguments),ic){if(ic){var u=xf;ic=!1,xf=null}else throw Error(L(198));If||(If=!0,Xg=u)}}function Ea(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function KE(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function P0(n){if(Ea(n)!==n)throw Error(L(188))}function Bx(n){var e=n.alternate;if(!e){if(e=Ea(n),e===null)throw Error(L(188));return e!==n?null:n}for(var t=n,i=e;;){var s=t.return;if(s===null)break;var r=s.alternate;if(r===null){if(i=s.return,i!==null){t=i;continue}break}if(s.child===r.child){for(r=s.child;r;){if(r===t)return P0(s),n;if(r===i)return P0(s),e;r=r.sibling}throw Error(L(188))}if(t.return!==i.return)t=s,i=r;else{for(var o=!1,a=s.child;a;){if(a===t){o=!0,t=s,i=r;break}if(a===i){o=!0,i=s,t=r;break}a=a.sibling}if(!o){for(a=r.child;a;){if(a===t){o=!0,t=r,i=s;break}if(a===i){o=!0,i=r,t=s;break}a=a.sibling}if(!o)throw Error(L(189))}}if(t.alternate!==i)throw Error(L(190))}if(t.tag!==3)throw Error(L(188));return t.stateNode.current===t?n:e}function JE(n){return n=Bx(n),n!==null?XE(n):null}function XE(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=XE(n);if(e!==null)return e;n=n.sibling}return null}var QE=kn.unstable_scheduleCallback,R0=kn.unstable_cancelCallback,zx=kn.unstable_shouldYield,qx=kn.unstable_requestPaint,$e=kn.unstable_now,$x=kn.unstable_getCurrentPriorityLevel,lv=kn.unstable_ImmediatePriority,ZE=kn.unstable_UserBlockingPriority,Pf=kn.unstable_NormalPriority,Wx=kn.unstable_LowPriority,jE=kn.unstable_IdlePriority,Ip=null,Wi=null;function Yx(n){if(Wi&&typeof Wi.onCommitFiberRoot=="function")try{Wi.onCommitFiberRoot(Ip,n,void 0,(n.current.flags&128)===128)}catch{}}var yi=Math.clz32?Math.clz32:Xx,Kx=Math.log,Jx=Math.LN2;function Xx(n){return n>>>=0,n===0?32:31-(Kx(n)/Jx|0)|0}var yh=64,vh=4194304;function Hu(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Rf(n,e){var t=n.pendingLanes;if(t===0)return 0;var i=0,s=n.suspendedLanes,r=n.pingedLanes,o=t&268435455;if(o!==0){var a=o&~s;a!==0?i=Hu(a):(r&=o,r!==0&&(i=Hu(r)))}else o=t&~s,o!==0?i=Hu(o):r!==0&&(i=Hu(r));if(i===0)return 0;if(e!==0&&e!==i&&!(e&s)&&(s=i&-i,r=e&-e,s>=r||s===16&&(r&4194240)!==0))return e;if(i&4&&(i|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=i;0<e;)t=31-yi(e),s=1<<t,i|=n[t],e&=~s;return i}function Qx(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Zx(n,e){for(var t=n.suspendedLanes,i=n.pingedLanes,s=n.expirationTimes,r=n.pendingLanes;0<r;){var o=31-yi(r),a=1<<o,l=s[o];l===-1?(!(a&t)||a&i)&&(s[o]=Qx(a,e)):l<=e&&(n.expiredLanes|=a),r&=~a}}function Qg(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function eS(){var n=yh;return yh<<=1,!(yh&4194240)&&(yh=64),n}function og(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function oh(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-yi(e),n[e]=t}function jx(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var i=n.eventTimes;for(n=n.expirationTimes;0<t;){var s=31-yi(t),r=1<<s;e[s]=0,i[s]=-1,n[s]=-1,t&=~r}}function uv(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var i=31-yi(t),s=1<<i;s&e|n[i]&e&&(n[i]|=e),t&=~s}}var _e=0;function tS(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var nS,cv,iS,sS,rS,Zg=!1,_h=[],Rr=null,Mr=null,kr=null,yc=new Map,vc=new Map,Ks=[],eI="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function M0(n,e){switch(n){case"focusin":case"focusout":Rr=null;break;case"dragenter":case"dragleave":Mr=null;break;case"mouseover":case"mouseout":kr=null;break;case"pointerover":case"pointerout":yc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":vc.delete(e.pointerId)}}function Tu(n,e,t,i,s,r){return n===null||n.nativeEvent!==r?(n={blockedOn:e,domEventName:t,eventSystemFlags:i,nativeEvent:r,targetContainers:[s]},e!==null&&(e=lh(e),e!==null&&cv(e)),n):(n.eventSystemFlags|=i,e=n.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),n)}function tI(n,e,t,i,s){switch(e){case"focusin":return Rr=Tu(Rr,n,e,t,i,s),!0;case"dragenter":return Mr=Tu(Mr,n,e,t,i,s),!0;case"mouseover":return kr=Tu(kr,n,e,t,i,s),!0;case"pointerover":var r=s.pointerId;return yc.set(r,Tu(yc.get(r)||null,n,e,t,i,s)),!0;case"gotpointercapture":return r=s.pointerId,vc.set(r,Tu(vc.get(r)||null,n,e,t,i,s)),!0}return!1}function oS(n){var e=to(n.target);if(e!==null){var t=Ea(e);if(t!==null){if(e=t.tag,e===13){if(e=KE(t),e!==null){n.blockedOn=e,rS(n.priority,function(){iS(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Fh(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=jg(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var i=new t.constructor(t.type,t);Yg=i,t.target.dispatchEvent(i),Yg=null}else return e=lh(t),e!==null&&cv(e),n.blockedOn=t,!1;e.shift()}return!0}function k0(n,e,t){Fh(n)&&t.delete(e)}function nI(){Zg=!1,Rr!==null&&Fh(Rr)&&(Rr=null),Mr!==null&&Fh(Mr)&&(Mr=null),kr!==null&&Fh(kr)&&(kr=null),yc.forEach(k0),vc.forEach(k0)}function xu(n,e){n.blockedOn===e&&(n.blockedOn=null,Zg||(Zg=!0,kn.unstable_scheduleCallback(kn.unstable_NormalPriority,nI)))}function _c(n){function e(s){return xu(s,n)}if(0<_h.length){xu(_h[0],n);for(var t=1;t<_h.length;t++){var i=_h[t];i.blockedOn===n&&(i.blockedOn=null)}}for(Rr!==null&&xu(Rr,n),Mr!==null&&xu(Mr,n),kr!==null&&xu(kr,n),yc.forEach(e),vc.forEach(e),t=0;t<Ks.length;t++)i=Ks[t],i.blockedOn===n&&(i.blockedOn=null);for(;0<Ks.length&&(t=Ks[0],t.blockedOn===null);)oS(t),t.blockedOn===null&&Ks.shift()}var Qa=Os.ReactCurrentBatchConfig,Mf=!0;function iI(n,e,t,i){var s=_e,r=Qa.transition;Qa.transition=null;try{_e=1,dv(n,e,t,i)}finally{_e=s,Qa.transition=r}}function sI(n,e,t,i){var s=_e,r=Qa.transition;Qa.transition=null;try{_e=4,dv(n,e,t,i)}finally{_e=s,Qa.transition=r}}function dv(n,e,t,i){if(Mf){var s=jg(n,e,t,i);if(s===null)mg(n,e,i,kf,t),M0(n,i);else if(tI(s,n,e,t,i))i.stopPropagation();else if(M0(n,i),e&4&&-1<eI.indexOf(n)){for(;s!==null;){var r=lh(s);if(r!==null&&nS(r),r=jg(n,e,t,i),r===null&&mg(n,e,i,kf,t),r===s)break;s=r}s!==null&&i.stopPropagation()}else mg(n,e,i,null,t)}}var kf=null;function jg(n,e,t,i){if(kf=null,n=av(i),n=to(n),n!==null)if(e=Ea(n),e===null)n=null;else if(t=e.tag,t===13){if(n=KE(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return kf=n,null}function aS(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch($x()){case lv:return 1;case ZE:return 4;case Pf:case Wx:return 16;case jE:return 536870912;default:return 16}default:return 16}}var Ir=null,hv=null,Uh=null;function lS(){if(Uh)return Uh;var n,e=hv,t=e.length,i,s="value"in Ir?Ir.value:Ir.textContent,r=s.length;for(n=0;n<t&&e[n]===s[n];n++);var o=t-n;for(i=1;i<=o&&e[t-i]===s[r-i];i++);return Uh=s.slice(n,1<i?1-i:void 0)}function Hh(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Ah(){return!0}function b0(){return!1}function Nn(n){function e(t,i,s,r,o){this._reactName=t,this._targetInst=s,this.type=i,this.nativeEvent=r,this.target=o,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(r):r[a]);return this.isDefaultPrevented=(r.defaultPrevented!=null?r.defaultPrevented:r.returnValue===!1)?Ah:b0,this.isPropagationStopped=b0,this}return Ve(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Ah)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Ah)},persist:function(){},isPersistent:Ah}),e}var vu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},fv=Nn(vu),ah=Ve({},vu,{view:0,detail:0}),rI=Nn(ah),ag,lg,Iu,Pp=Ve({},ah,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pv,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Iu&&(Iu&&n.type==="mousemove"?(ag=n.screenX-Iu.screenX,lg=n.screenY-Iu.screenY):lg=ag=0,Iu=n),ag)},movementY:function(n){return"movementY"in n?n.movementY:lg}}),N0=Nn(Pp),oI=Ve({},Pp,{dataTransfer:0}),aI=Nn(oI),lI=Ve({},ah,{relatedTarget:0}),ug=Nn(lI),uI=Ve({},vu,{animationName:0,elapsedTime:0,pseudoElement:0}),cI=Nn(uI),dI=Ve({},vu,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),hI=Nn(dI),fI=Ve({},vu,{data:0}),L0=Nn(fI),pI={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gI={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mI={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yI(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=mI[n])?!!e[n]:!1}function pv(){return yI}var vI=Ve({},ah,{key:function(n){if(n.key){var e=pI[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Hh(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?gI[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pv,charCode:function(n){return n.type==="keypress"?Hh(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Hh(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),_I=Nn(vI),AI=Ve({},Pp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),D0=Nn(AI),EI=Ve({},ah,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pv}),SI=Nn(EI),wI=Ve({},vu,{propertyName:0,elapsedTime:0,pseudoElement:0}),CI=Nn(wI),TI=Ve({},Pp,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),xI=Nn(TI),II=[9,13,27,32],gv=Ls&&"CompositionEvent"in window,sc=null;Ls&&"documentMode"in document&&(sc=document.documentMode);var PI=Ls&&"TextEvent"in window&&!sc,uS=Ls&&(!gv||sc&&8<sc&&11>=sc),F0=" ",U0=!1;function cS(n,e){switch(n){case"keyup":return II.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function dS(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Da=!1;function RI(n,e){switch(n){case"compositionend":return dS(e);case"keypress":return e.which!==32?null:(U0=!0,F0);case"textInput":return n=e.data,n===F0&&U0?null:n;default:return null}}function MI(n,e){if(Da)return n==="compositionend"||!gv&&cS(n,e)?(n=lS(),Uh=hv=Ir=null,Da=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return uS&&e.locale!=="ko"?null:e.data;default:return null}}var kI={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function H0(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!kI[n.type]:e==="textarea"}function hS(n,e,t,i){zE(i),e=bf(e,"onChange"),0<e.length&&(t=new fv("onChange","change",null,t,i),n.push({event:t,listeners:e}))}var rc=null,Ac=null;function bI(n){wS(n,0)}function Rp(n){var e=Ha(n);if(FE(e))return n}function NI(n,e){if(n==="change")return e}var fS=!1;if(Ls){var cg;if(Ls){var dg="oninput"in document;if(!dg){var V0=document.createElement("div");V0.setAttribute("oninput","return;"),dg=typeof V0.oninput=="function"}cg=dg}else cg=!1;fS=cg&&(!document.documentMode||9<document.documentMode)}function G0(){rc&&(rc.detachEvent("onpropertychange",pS),Ac=rc=null)}function pS(n){if(n.propertyName==="value"&&Rp(Ac)){var e=[];hS(e,Ac,n,av(n)),YE(bI,e)}}function LI(n,e,t){n==="focusin"?(G0(),rc=e,Ac=t,rc.attachEvent("onpropertychange",pS)):n==="focusout"&&G0()}function DI(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Rp(Ac)}function FI(n,e){if(n==="click")return Rp(e)}function UI(n,e){if(n==="input"||n==="change")return Rp(e)}function HI(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var _i=typeof Object.is=="function"?Object.is:HI;function Ec(n,e){if(_i(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),i=Object.keys(e);if(t.length!==i.length)return!1;for(i=0;i<t.length;i++){var s=t[i];if(!Dg.call(e,s)||!_i(n[s],e[s]))return!1}return!0}function O0(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function B0(n,e){var t=O0(n);n=0;for(var i;t;){if(t.nodeType===3){if(i=n+t.textContent.length,n<=e&&i>=e)return{node:t,offset:e-n};n=i}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=O0(t)}}function gS(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?gS(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function mS(){for(var n=window,e=Tf();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Tf(n.document)}return e}function mv(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function VI(n){var e=mS(),t=n.focusedElem,i=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&gS(t.ownerDocument.documentElement,t)){if(i!==null&&mv(t)){if(e=i.start,n=i.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var s=t.textContent.length,r=Math.min(i.start,s);i=i.end===void 0?r:Math.min(i.end,s),!n.extend&&r>i&&(s=i,i=r,r=s),s=B0(t,r);var o=B0(t,i);s&&o&&(n.rangeCount!==1||n.anchorNode!==s.node||n.anchorOffset!==s.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),n.removeAllRanges(),r>i?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var GI=Ls&&"documentMode"in document&&11>=document.documentMode,Fa=null,em=null,oc=null,tm=!1;function z0(n,e,t){var i=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;tm||Fa==null||Fa!==Tf(i)||(i=Fa,"selectionStart"in i&&mv(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),oc&&Ec(oc,i)||(oc=i,i=bf(em,"onSelect"),0<i.length&&(e=new fv("onSelect","select",null,e,t),n.push({event:e,listeners:i}),e.target=Fa)))}function Eh(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Ua={animationend:Eh("Animation","AnimationEnd"),animationiteration:Eh("Animation","AnimationIteration"),animationstart:Eh("Animation","AnimationStart"),transitionend:Eh("Transition","TransitionEnd")},hg={},yS={};Ls&&(yS=document.createElement("div").style,"AnimationEvent"in window||(delete Ua.animationend.animation,delete Ua.animationiteration.animation,delete Ua.animationstart.animation),"TransitionEvent"in window||delete Ua.transitionend.transition);function Mp(n){if(hg[n])return hg[n];if(!Ua[n])return n;var e=Ua[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in yS)return hg[n]=e[t];return n}var vS=Mp("animationend"),_S=Mp("animationiteration"),AS=Mp("animationstart"),ES=Mp("transitionend"),SS=new Map,q0="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function zr(n,e){SS.set(n,e),Aa(e,[n])}for(var fg=0;fg<q0.length;fg++){var pg=q0[fg],OI=pg.toLowerCase(),BI=pg[0].toUpperCase()+pg.slice(1);zr(OI,"on"+BI)}zr(vS,"onAnimationEnd");zr(_S,"onAnimationIteration");zr(AS,"onAnimationStart");zr("dblclick","onDoubleClick");zr("focusin","onFocus");zr("focusout","onBlur");zr(ES,"onTransitionEnd");cu("onMouseEnter",["mouseout","mouseover"]);cu("onMouseLeave",["mouseout","mouseover"]);cu("onPointerEnter",["pointerout","pointerover"]);cu("onPointerLeave",["pointerout","pointerover"]);Aa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Aa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Aa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Aa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Aa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Aa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Vu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zI=new Set("cancel close invalid load scroll toggle".split(" ").concat(Vu));function $0(n,e,t){var i=n.type||"unknown-event";n.currentTarget=t,Ox(i,e,void 0,n),n.currentTarget=null}function wS(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var i=n[t],s=i.event;i=i.listeners;e:{var r=void 0;if(e)for(var o=i.length-1;0<=o;o--){var a=i[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==r&&s.isPropagationStopped())break e;$0(s,a,u),r=l}else for(o=0;o<i.length;o++){if(a=i[o],l=a.instance,u=a.currentTarget,a=a.listener,l!==r&&s.isPropagationStopped())break e;$0(s,a,u),r=l}}}if(If)throw n=Xg,If=!1,Xg=null,n}function Te(n,e){var t=e[om];t===void 0&&(t=e[om]=new Set);var i=n+"__bubble";t.has(i)||(CS(e,n,2,!1),t.add(i))}function gg(n,e,t){var i=0;e&&(i|=4),CS(t,n,i,e)}var Sh="_reactListening"+Math.random().toString(36).slice(2);function Sc(n){if(!n[Sh]){n[Sh]=!0,kE.forEach(function(t){t!=="selectionchange"&&(zI.has(t)||gg(t,!1,n),gg(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Sh]||(e[Sh]=!0,gg("selectionchange",!1,e))}}function CS(n,e,t,i){switch(aS(e)){case 1:var s=iI;break;case 4:s=sI;break;default:s=dv}t=s.bind(null,e,t,n),s=void 0,!Jg||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),i?s!==void 0?n.addEventListener(e,t,{capture:!0,passive:s}):n.addEventListener(e,t,!0):s!==void 0?n.addEventListener(e,t,{passive:s}):n.addEventListener(e,t,!1)}function mg(n,e,t,i,s){var r=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var o=i.tag;if(o===3||o===4){var a=i.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=i.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=to(a),o===null)return;if(l=o.tag,l===5||l===6){i=r=o;continue e}a=a.parentNode}}i=i.return}YE(function(){var u=r,h=av(t),p=[];e:{var g=SS.get(n);if(g!==void 0){var m=fv,y=n;switch(n){case"keypress":if(Hh(t)===0)break e;case"keydown":case"keyup":m=_I;break;case"focusin":y="focus",m=ug;break;case"focusout":y="blur",m=ug;break;case"beforeblur":case"afterblur":m=ug;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=N0;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=aI;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=SI;break;case vS:case _S:case AS:m=cI;break;case ES:m=CI;break;case"scroll":m=rI;break;case"wheel":m=xI;break;case"copy":case"cut":case"paste":m=hI;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=D0}var A=(e&4)!==0,T=!A&&n==="scroll",v=A?g!==null?g+"Capture":null:g;A=[];for(var E=u,w;E!==null;){w=E;var x=w.stateNode;if(w.tag===5&&x!==null&&(w=x,v!==null&&(x=mc(E,v),x!=null&&A.push(wc(E,x,w)))),T)break;E=E.return}0<A.length&&(g=new m(g,y,null,t,h),p.push({event:g,listeners:A}))}}if(!(e&7)){e:{if(g=n==="mouseover"||n==="pointerover",m=n==="mouseout"||n==="pointerout",g&&t!==Yg&&(y=t.relatedTarget||t.fromElement)&&(to(y)||y[Ds]))break e;if((m||g)&&(g=h.window===h?h:(g=h.ownerDocument)?g.defaultView||g.parentWindow:window,m?(y=t.relatedTarget||t.toElement,m=u,y=y?to(y):null,y!==null&&(T=Ea(y),y!==T||y.tag!==5&&y.tag!==6)&&(y=null)):(m=null,y=u),m!==y)){if(A=N0,x="onMouseLeave",v="onMouseEnter",E="mouse",(n==="pointerout"||n==="pointerover")&&(A=D0,x="onPointerLeave",v="onPointerEnter",E="pointer"),T=m==null?g:Ha(m),w=y==null?g:Ha(y),g=new A(x,E+"leave",m,t,h),g.target=T,g.relatedTarget=w,x=null,to(h)===u&&(A=new A(v,E+"enter",y,t,h),A.target=w,A.relatedTarget=T,x=A),T=x,m&&y)t:{for(A=m,v=y,E=0,w=A;w;w=Ta(w))E++;for(w=0,x=v;x;x=Ta(x))w++;for(;0<E-w;)A=Ta(A),E--;for(;0<w-E;)v=Ta(v),w--;for(;E--;){if(A===v||v!==null&&A===v.alternate)break t;A=Ta(A),v=Ta(v)}A=null}else A=null;m!==null&&W0(p,g,m,A,!1),y!==null&&T!==null&&W0(p,T,y,A,!0)}}e:{if(g=u?Ha(u):window,m=g.nodeName&&g.nodeName.toLowerCase(),m==="select"||m==="input"&&g.type==="file")var I=NI;else if(H0(g))if(fS)I=UI;else{I=DI;var P=LI}else(m=g.nodeName)&&m.toLowerCase()==="input"&&(g.type==="checkbox"||g.type==="radio")&&(I=FI);if(I&&(I=I(n,u))){hS(p,I,t,h);break e}P&&P(n,g,u),n==="focusout"&&(P=g._wrapperState)&&P.controlled&&g.type==="number"&&Bg(g,"number",g.value)}switch(P=u?Ha(u):window,n){case"focusin":(H0(P)||P.contentEditable==="true")&&(Fa=P,em=u,oc=null);break;case"focusout":oc=em=Fa=null;break;case"mousedown":tm=!0;break;case"contextmenu":case"mouseup":case"dragend":tm=!1,z0(p,t,h);break;case"selectionchange":if(GI)break;case"keydown":case"keyup":z0(p,t,h)}var R;if(gv)e:{switch(n){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Da?cS(n,t)&&(k="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(k="onCompositionStart");k&&(uS&&t.locale!=="ko"&&(Da||k!=="onCompositionStart"?k==="onCompositionEnd"&&Da&&(R=lS()):(Ir=h,hv="value"in Ir?Ir.value:Ir.textContent,Da=!0)),P=bf(u,k),0<P.length&&(k=new L0(k,n,null,t,h),p.push({event:k,listeners:P}),R?k.data=R:(R=dS(t),R!==null&&(k.data=R)))),(R=PI?RI(n,t):MI(n,t))&&(u=bf(u,"onBeforeInput"),0<u.length&&(h=new L0("onBeforeInput","beforeinput",null,t,h),p.push({event:h,listeners:u}),h.data=R))}wS(p,e)})}function wc(n,e,t){return{instance:n,listener:e,currentTarget:t}}function bf(n,e){for(var t=e+"Capture",i=[];n!==null;){var s=n,r=s.stateNode;s.tag===5&&r!==null&&(s=r,r=mc(n,t),r!=null&&i.unshift(wc(n,r,s)),r=mc(n,e),r!=null&&i.push(wc(n,r,s))),n=n.return}return i}function Ta(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function W0(n,e,t,i,s){for(var r=e._reactName,o=[];t!==null&&t!==i;){var a=t,l=a.alternate,u=a.stateNode;if(l!==null&&l===i)break;a.tag===5&&u!==null&&(a=u,s?(l=mc(t,r),l!=null&&o.unshift(wc(t,l,a))):s||(l=mc(t,r),l!=null&&o.push(wc(t,l,a)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var qI=/\r\n?/g,$I=/\u0000|\uFFFD/g;function Y0(n){return(typeof n=="string"?n:""+n).replace(qI,`
`).replace($I,"")}function wh(n,e,t){if(e=Y0(e),Y0(n)!==e&&t)throw Error(L(425))}function Nf(){}var nm=null,im=null;function sm(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var rm=typeof setTimeout=="function"?setTimeout:void 0,WI=typeof clearTimeout=="function"?clearTimeout:void 0,K0=typeof Promise=="function"?Promise:void 0,YI=typeof queueMicrotask=="function"?queueMicrotask:typeof K0<"u"?function(n){return K0.resolve(null).then(n).catch(KI)}:rm;function KI(n){setTimeout(function(){throw n})}function yg(n,e){var t=e,i=0;do{var s=t.nextSibling;if(n.removeChild(t),s&&s.nodeType===8)if(t=s.data,t==="/$"){if(i===0){n.removeChild(s),_c(e);return}i--}else t!=="$"&&t!=="$?"&&t!=="$!"||i++;t=s}while(t);_c(e)}function br(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function J0(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var _u=Math.random().toString(36).slice(2),$i="__reactFiber$"+_u,Cc="__reactProps$"+_u,Ds="__reactContainer$"+_u,om="__reactEvents$"+_u,JI="__reactListeners$"+_u,XI="__reactHandles$"+_u;function to(n){var e=n[$i];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Ds]||t[$i]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=J0(n);n!==null;){if(t=n[$i])return t;n=J0(n)}return e}n=t,t=n.parentNode}return null}function lh(n){return n=n[$i]||n[Ds],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Ha(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(L(33))}function kp(n){return n[Cc]||null}var am=[],Va=-1;function qr(n){return{current:n}}function Pe(n){0>Va||(n.current=am[Va],am[Va]=null,Va--)}function Ce(n,e){Va++,am[Va]=n.current,n.current=e}var Vr={},Ut=qr(Vr),ln=qr(!1),da=Vr;function du(n,e){var t=n.type.contextTypes;if(!t)return Vr;var i=n.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var s={},r;for(r in t)s[r]=e[r];return i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=s),s}function un(n){return n=n.childContextTypes,n!=null}function Lf(){Pe(ln),Pe(Ut)}function X0(n,e,t){if(Ut.current!==Vr)throw Error(L(168));Ce(Ut,e),Ce(ln,t)}function TS(n,e,t){var i=n.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return t;i=i.getChildContext();for(var s in i)if(!(s in e))throw Error(L(108,Lx(n)||"Unknown",s));return Ve({},t,i)}function Df(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Vr,da=Ut.current,Ce(Ut,n),Ce(ln,ln.current),!0}function Q0(n,e,t){var i=n.stateNode;if(!i)throw Error(L(169));t?(n=TS(n,e,da),i.__reactInternalMemoizedMergedChildContext=n,Pe(ln),Pe(Ut),Ce(Ut,n)):Pe(ln),Ce(ln,t)}var ns=null,bp=!1,vg=!1;function xS(n){ns===null?ns=[n]:ns.push(n)}function QI(n){bp=!0,xS(n)}function $r(){if(!vg&&ns!==null){vg=!0;var n=0,e=_e;try{var t=ns;for(_e=1;n<t.length;n++){var i=t[n];do i=i(!0);while(i!==null)}ns=null,bp=!1}catch(s){throw ns!==null&&(ns=ns.slice(n+1)),QE(lv,$r),s}finally{_e=e,vg=!1}}return null}var Ga=[],Oa=0,Ff=null,Uf=0,Bn=[],zn=0,ha=null,Rs=1,Ms="";function Kr(n,e){Ga[Oa++]=Uf,Ga[Oa++]=Ff,Ff=n,Uf=e}function IS(n,e,t){Bn[zn++]=Rs,Bn[zn++]=Ms,Bn[zn++]=ha,ha=n;var i=Rs;n=Ms;var s=32-yi(i)-1;i&=~(1<<s),t+=1;var r=32-yi(e)+s;if(30<r){var o=s-s%5;r=(i&(1<<o)-1).toString(32),i>>=o,s-=o,Rs=1<<32-yi(e)+s|t<<s|i,Ms=r+n}else Rs=1<<r|t<<s|i,Ms=n}function yv(n){n.return!==null&&(Kr(n,1),IS(n,1,0))}function vv(n){for(;n===Ff;)Ff=Ga[--Oa],Ga[Oa]=null,Uf=Ga[--Oa],Ga[Oa]=null;for(;n===ha;)ha=Bn[--zn],Bn[zn]=null,Ms=Bn[--zn],Bn[zn]=null,Rs=Bn[--zn],Bn[zn]=null}var Rn=null,Pn=null,Ne=!1,gi=null;function PS(n,e){var t=Wn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function Z0(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,Rn=n,Pn=br(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,Rn=n,Pn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=ha!==null?{id:Rs,overflow:Ms}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Wn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,Rn=n,Pn=null,!0):!1;default:return!1}}function lm(n){return(n.mode&1)!==0&&(n.flags&128)===0}function um(n){if(Ne){var e=Pn;if(e){var t=e;if(!Z0(n,e)){if(lm(n))throw Error(L(418));e=br(t.nextSibling);var i=Rn;e&&Z0(n,e)?PS(i,t):(n.flags=n.flags&-4097|2,Ne=!1,Rn=n)}}else{if(lm(n))throw Error(L(418));n.flags=n.flags&-4097|2,Ne=!1,Rn=n}}}function j0(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;Rn=n}function Ch(n){if(n!==Rn)return!1;if(!Ne)return j0(n),Ne=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!sm(n.type,n.memoizedProps)),e&&(e=Pn)){if(lm(n))throw RS(),Error(L(418));for(;e;)PS(n,e),e=br(e.nextSibling)}if(j0(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(L(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){Pn=br(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}Pn=null}}else Pn=Rn?br(n.stateNode.nextSibling):null;return!0}function RS(){for(var n=Pn;n;)n=br(n.nextSibling)}function hu(){Pn=Rn=null,Ne=!1}function _v(n){gi===null?gi=[n]:gi.push(n)}var ZI=Os.ReactCurrentBatchConfig;function Pu(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(L(309));var i=t.stateNode}if(!i)throw Error(L(147,n));var s=i,r=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===r?e.ref:(e=function(o){var a=s.refs;o===null?delete a[r]:a[r]=o},e._stringRef=r,e)}if(typeof n!="string")throw Error(L(284));if(!t._owner)throw Error(L(290,n))}return n}function Th(n,e){throw n=Object.prototype.toString.call(e),Error(L(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function e_(n){var e=n._init;return e(n._payload)}function MS(n){function e(v,E){if(n){var w=v.deletions;w===null?(v.deletions=[E],v.flags|=16):w.push(E)}}function t(v,E){if(!n)return null;for(;E!==null;)e(v,E),E=E.sibling;return null}function i(v,E){for(v=new Map;E!==null;)E.key!==null?v.set(E.key,E):v.set(E.index,E),E=E.sibling;return v}function s(v,E){return v=Fr(v,E),v.index=0,v.sibling=null,v}function r(v,E,w){return v.index=w,n?(w=v.alternate,w!==null?(w=w.index,w<E?(v.flags|=2,E):w):(v.flags|=2,E)):(v.flags|=1048576,E)}function o(v){return n&&v.alternate===null&&(v.flags|=2),v}function a(v,E,w,x){return E===null||E.tag!==6?(E=Tg(w,v.mode,x),E.return=v,E):(E=s(E,w),E.return=v,E)}function l(v,E,w,x){var I=w.type;return I===La?h(v,E,w.props.children,x,w.key):E!==null&&(E.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Ws&&e_(I)===E.type)?(x=s(E,w.props),x.ref=Pu(v,E,w),x.return=v,x):(x=$h(w.type,w.key,w.props,null,v.mode,x),x.ref=Pu(v,E,w),x.return=v,x)}function u(v,E,w,x){return E===null||E.tag!==4||E.stateNode.containerInfo!==w.containerInfo||E.stateNode.implementation!==w.implementation?(E=xg(w,v.mode,x),E.return=v,E):(E=s(E,w.children||[]),E.return=v,E)}function h(v,E,w,x,I){return E===null||E.tag!==7?(E=ca(w,v.mode,x,I),E.return=v,E):(E=s(E,w),E.return=v,E)}function p(v,E,w){if(typeof E=="string"&&E!==""||typeof E=="number")return E=Tg(""+E,v.mode,w),E.return=v,E;if(typeof E=="object"&&E!==null){switch(E.$$typeof){case ph:return w=$h(E.type,E.key,E.props,null,v.mode,w),w.ref=Pu(v,null,E),w.return=v,w;case Na:return E=xg(E,v.mode,w),E.return=v,E;case Ws:var x=E._init;return p(v,x(E._payload),w)}if(Uu(E)||wu(E))return E=ca(E,v.mode,w,null),E.return=v,E;Th(v,E)}return null}function g(v,E,w,x){var I=E!==null?E.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return I!==null?null:a(v,E,""+w,x);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ph:return w.key===I?l(v,E,w,x):null;case Na:return w.key===I?u(v,E,w,x):null;case Ws:return I=w._init,g(v,E,I(w._payload),x)}if(Uu(w)||wu(w))return I!==null?null:h(v,E,w,x,null);Th(v,w)}return null}function m(v,E,w,x,I){if(typeof x=="string"&&x!==""||typeof x=="number")return v=v.get(w)||null,a(E,v,""+x,I);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case ph:return v=v.get(x.key===null?w:x.key)||null,l(E,v,x,I);case Na:return v=v.get(x.key===null?w:x.key)||null,u(E,v,x,I);case Ws:var P=x._init;return m(v,E,w,P(x._payload),I)}if(Uu(x)||wu(x))return v=v.get(w)||null,h(E,v,x,I,null);Th(E,x)}return null}function y(v,E,w,x){for(var I=null,P=null,R=E,k=E=0,b=null;R!==null&&k<w.length;k++){R.index>k?(b=R,R=null):b=R.sibling;var N=g(v,R,w[k],x);if(N===null){R===null&&(R=b);break}n&&R&&N.alternate===null&&e(v,R),E=r(N,E,k),P===null?I=N:P.sibling=N,P=N,R=b}if(k===w.length)return t(v,R),Ne&&Kr(v,k),I;if(R===null){for(;k<w.length;k++)R=p(v,w[k],x),R!==null&&(E=r(R,E,k),P===null?I=R:P.sibling=R,P=R);return Ne&&Kr(v,k),I}for(R=i(v,R);k<w.length;k++)b=m(R,v,k,w[k],x),b!==null&&(n&&b.alternate!==null&&R.delete(b.key===null?k:b.key),E=r(b,E,k),P===null?I=b:P.sibling=b,P=b);return n&&R.forEach(function(D){return e(v,D)}),Ne&&Kr(v,k),I}function A(v,E,w,x){var I=wu(w);if(typeof I!="function")throw Error(L(150));if(w=I.call(w),w==null)throw Error(L(151));for(var P=I=null,R=E,k=E=0,b=null,N=w.next();R!==null&&!N.done;k++,N=w.next()){R.index>k?(b=R,R=null):b=R.sibling;var D=g(v,R,N.value,x);if(D===null){R===null&&(R=b);break}n&&R&&D.alternate===null&&e(v,R),E=r(D,E,k),P===null?I=D:P.sibling=D,P=D,R=b}if(N.done)return t(v,R),Ne&&Kr(v,k),I;if(R===null){for(;!N.done;k++,N=w.next())N=p(v,N.value,x),N!==null&&(E=r(N,E,k),P===null?I=N:P.sibling=N,P=N);return Ne&&Kr(v,k),I}for(R=i(v,R);!N.done;k++,N=w.next())N=m(R,v,k,N.value,x),N!==null&&(n&&N.alternate!==null&&R.delete(N.key===null?k:N.key),E=r(N,E,k),P===null?I=N:P.sibling=N,P=N);return n&&R.forEach(function(Y){return e(v,Y)}),Ne&&Kr(v,k),I}function T(v,E,w,x){if(typeof w=="object"&&w!==null&&w.type===La&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case ph:e:{for(var I=w.key,P=E;P!==null;){if(P.key===I){if(I=w.type,I===La){if(P.tag===7){t(v,P.sibling),E=s(P,w.props.children),E.return=v,v=E;break e}}else if(P.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Ws&&e_(I)===P.type){t(v,P.sibling),E=s(P,w.props),E.ref=Pu(v,P,w),E.return=v,v=E;break e}t(v,P);break}else e(v,P);P=P.sibling}w.type===La?(E=ca(w.props.children,v.mode,x,w.key),E.return=v,v=E):(x=$h(w.type,w.key,w.props,null,v.mode,x),x.ref=Pu(v,E,w),x.return=v,v=x)}return o(v);case Na:e:{for(P=w.key;E!==null;){if(E.key===P)if(E.tag===4&&E.stateNode.containerInfo===w.containerInfo&&E.stateNode.implementation===w.implementation){t(v,E.sibling),E=s(E,w.children||[]),E.return=v,v=E;break e}else{t(v,E);break}else e(v,E);E=E.sibling}E=xg(w,v.mode,x),E.return=v,v=E}return o(v);case Ws:return P=w._init,T(v,E,P(w._payload),x)}if(Uu(w))return y(v,E,w,x);if(wu(w))return A(v,E,w,x);Th(v,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,E!==null&&E.tag===6?(t(v,E.sibling),E=s(E,w),E.return=v,v=E):(t(v,E),E=Tg(w,v.mode,x),E.return=v,v=E),o(v)):t(v,E)}return T}var fu=MS(!0),kS=MS(!1),Hf=qr(null),Vf=null,Ba=null,Av=null;function Ev(){Av=Ba=Vf=null}function Sv(n){var e=Hf.current;Pe(Hf),n._currentValue=e}function cm(n,e,t){for(;n!==null;){var i=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),n===t)break;n=n.return}}function Za(n,e){Vf=n,Av=Ba=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(an=!0),n.firstContext=null)}function Xn(n){var e=n._currentValue;if(Av!==n)if(n={context:n,memoizedValue:e,next:null},Ba===null){if(Vf===null)throw Error(L(308));Ba=n,Vf.dependencies={lanes:0,firstContext:n}}else Ba=Ba.next=n;return e}var no=null;function wv(n){no===null?no=[n]:no.push(n)}function bS(n,e,t,i){var s=e.interleaved;return s===null?(t.next=t,wv(e)):(t.next=s.next,s.next=t),e.interleaved=t,Fs(n,i)}function Fs(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Ys=!1;function Cv(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function NS(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function ks(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Nr(n,e,t){var i=n.updateQueue;if(i===null)return null;if(i=i.shared,de&2){var s=i.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),i.pending=e,Fs(n,t)}return s=i.interleaved,s===null?(e.next=e,wv(i)):(e.next=s.next,s.next=e),i.interleaved=e,Fs(n,t)}function Vh(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,uv(n,t)}}function t_(n,e){var t=n.updateQueue,i=n.alternate;if(i!==null&&(i=i.updateQueue,t===i)){var s=null,r=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};r===null?s=r=o:r=r.next=o,t=t.next}while(t!==null);r===null?s=r=e:r=r.next=e}else s=r=e;t={baseState:i.baseState,firstBaseUpdate:s,lastBaseUpdate:r,shared:i.shared,effects:i.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Gf(n,e,t,i){var s=n.updateQueue;Ys=!1;var r=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,u=l.next;l.next=null,o===null?r=u:o.next=u,o=l;var h=n.alternate;h!==null&&(h=h.updateQueue,a=h.lastBaseUpdate,a!==o&&(a===null?h.firstBaseUpdate=u:a.next=u,h.lastBaseUpdate=l))}if(r!==null){var p=s.baseState;o=0,h=u=l=null,a=r;do{var g=a.lane,m=a.eventTime;if((i&g)===g){h!==null&&(h=h.next={eventTime:m,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var y=n,A=a;switch(g=e,m=t,A.tag){case 1:if(y=A.payload,typeof y=="function"){p=y.call(m,p,g);break e}p=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=A.payload,g=typeof y=="function"?y.call(m,p,g):y,g==null)break e;p=Ve({},p,g);break e;case 2:Ys=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,g=s.effects,g===null?s.effects=[a]:g.push(a))}else m={eventTime:m,lane:g,tag:a.tag,payload:a.payload,callback:a.callback,next:null},h===null?(u=h=m,l=p):h=h.next=m,o|=g;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;g=a,a=g.next,g.next=null,s.lastBaseUpdate=g,s.shared.pending=null}}while(!0);if(h===null&&(l=p),s.baseState=l,s.firstBaseUpdate=u,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else r===null&&(s.shared.lanes=0);pa|=o,n.lanes=o,n.memoizedState=p}}function n_(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var i=n[e],s=i.callback;if(s!==null){if(i.callback=null,i=t,typeof s!="function")throw Error(L(191,s));s.call(i)}}}var uh={},Yi=qr(uh),Tc=qr(uh),xc=qr(uh);function io(n){if(n===uh)throw Error(L(174));return n}function Tv(n,e){switch(Ce(xc,e),Ce(Tc,n),Ce(Yi,uh),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:qg(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=qg(e,n)}Pe(Yi),Ce(Yi,e)}function pu(){Pe(Yi),Pe(Tc),Pe(xc)}function LS(n){io(xc.current);var e=io(Yi.current),t=qg(e,n.type);e!==t&&(Ce(Tc,n),Ce(Yi,t))}function xv(n){Tc.current===n&&(Pe(Yi),Pe(Tc))}var Fe=qr(0);function Of(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var _g=[];function Iv(){for(var n=0;n<_g.length;n++)_g[n]._workInProgressVersionPrimary=null;_g.length=0}var Gh=Os.ReactCurrentDispatcher,Ag=Os.ReactCurrentBatchConfig,fa=0,He=null,it=null,ht=null,Bf=!1,ac=!1,Ic=0,jI=0;function Ct(){throw Error(L(321))}function Pv(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!_i(n[t],e[t]))return!1;return!0}function Rv(n,e,t,i,s,r){if(fa=r,He=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Gh.current=n===null||n.memoizedState===null?iP:sP,n=t(i,s),ac){r=0;do{if(ac=!1,Ic=0,25<=r)throw Error(L(301));r+=1,ht=it=null,e.updateQueue=null,Gh.current=rP,n=t(i,s)}while(ac)}if(Gh.current=zf,e=it!==null&&it.next!==null,fa=0,ht=it=He=null,Bf=!1,e)throw Error(L(300));return n}function Mv(){var n=Ic!==0;return Ic=0,n}function Ii(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ht===null?He.memoizedState=ht=n:ht=ht.next=n,ht}function Qn(){if(it===null){var n=He.alternate;n=n!==null?n.memoizedState:null}else n=it.next;var e=ht===null?He.memoizedState:ht.next;if(e!==null)ht=e,it=n;else{if(n===null)throw Error(L(310));it=n,n={memoizedState:it.memoizedState,baseState:it.baseState,baseQueue:it.baseQueue,queue:it.queue,next:null},ht===null?He.memoizedState=ht=n:ht=ht.next=n}return ht}function Pc(n,e){return typeof e=="function"?e(n):e}function Eg(n){var e=Qn(),t=e.queue;if(t===null)throw Error(L(311));t.lastRenderedReducer=n;var i=it,s=i.baseQueue,r=t.pending;if(r!==null){if(s!==null){var o=s.next;s.next=r.next,r.next=o}i.baseQueue=s=r,t.pending=null}if(s!==null){r=s.next,i=i.baseState;var a=o=null,l=null,u=r;do{var h=u.lane;if((fa&h)===h)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),i=u.hasEagerState?u.eagerState:n(i,u.action);else{var p={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(a=l=p,o=i):l=l.next=p,He.lanes|=h,pa|=h}u=u.next}while(u!==null&&u!==r);l===null?o=i:l.next=a,_i(i,e.memoizedState)||(an=!0),e.memoizedState=i,e.baseState=o,e.baseQueue=l,t.lastRenderedState=i}if(n=t.interleaved,n!==null){s=n;do r=s.lane,He.lanes|=r,pa|=r,s=s.next;while(s!==n)}else s===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Sg(n){var e=Qn(),t=e.queue;if(t===null)throw Error(L(311));t.lastRenderedReducer=n;var i=t.dispatch,s=t.pending,r=e.memoizedState;if(s!==null){t.pending=null;var o=s=s.next;do r=n(r,o.action),o=o.next;while(o!==s);_i(r,e.memoizedState)||(an=!0),e.memoizedState=r,e.baseQueue===null&&(e.baseState=r),t.lastRenderedState=r}return[r,i]}function DS(){}function FS(n,e){var t=He,i=Qn(),s=e(),r=!_i(i.memoizedState,s);if(r&&(i.memoizedState=s,an=!0),i=i.queue,kv(VS.bind(null,t,i,n),[n]),i.getSnapshot!==e||r||ht!==null&&ht.memoizedState.tag&1){if(t.flags|=2048,Rc(9,HS.bind(null,t,i,s,e),void 0,null),ft===null)throw Error(L(349));fa&30||US(t,e,s)}return s}function US(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=He.updateQueue,e===null?(e={lastEffect:null,stores:null},He.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function HS(n,e,t,i){e.value=t,e.getSnapshot=i,GS(e)&&OS(n)}function VS(n,e,t){return t(function(){GS(e)&&OS(n)})}function GS(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!_i(n,t)}catch{return!0}}function OS(n){var e=Fs(n,1);e!==null&&vi(e,n,1,-1)}function i_(n){var e=Ii();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pc,lastRenderedState:n},e.queue=n,n=n.dispatch=nP.bind(null,He,n),[e.memoizedState,n]}function Rc(n,e,t,i){return n={tag:n,create:e,destroy:t,deps:i,next:null},e=He.updateQueue,e===null?(e={lastEffect:null,stores:null},He.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(i=t.next,t.next=n,n.next=i,e.lastEffect=n)),n}function BS(){return Qn().memoizedState}function Oh(n,e,t,i){var s=Ii();He.flags|=n,s.memoizedState=Rc(1|e,t,void 0,i===void 0?null:i)}function Np(n,e,t,i){var s=Qn();i=i===void 0?null:i;var r=void 0;if(it!==null){var o=it.memoizedState;if(r=o.destroy,i!==null&&Pv(i,o.deps)){s.memoizedState=Rc(e,t,r,i);return}}He.flags|=n,s.memoizedState=Rc(1|e,t,r,i)}function s_(n,e){return Oh(8390656,8,n,e)}function kv(n,e){return Np(2048,8,n,e)}function zS(n,e){return Np(4,2,n,e)}function qS(n,e){return Np(4,4,n,e)}function $S(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function WS(n,e,t){return t=t!=null?t.concat([n]):null,Np(4,4,$S.bind(null,e,n),t)}function bv(){}function YS(n,e){var t=Qn();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Pv(e,i[1])?i[0]:(t.memoizedState=[n,e],n)}function KS(n,e){var t=Qn();e=e===void 0?null:e;var i=t.memoizedState;return i!==null&&e!==null&&Pv(e,i[1])?i[0]:(n=n(),t.memoizedState=[n,e],n)}function JS(n,e,t){return fa&21?(_i(t,e)||(t=eS(),He.lanes|=t,pa|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,an=!0),n.memoizedState=t)}function eP(n,e){var t=_e;_e=t!==0&&4>t?t:4,n(!0);var i=Ag.transition;Ag.transition={};try{n(!1),e()}finally{_e=t,Ag.transition=i}}function XS(){return Qn().memoizedState}function tP(n,e,t){var i=Dr(n);if(t={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null},QS(n))ZS(e,t);else if(t=bS(n,e,t,i),t!==null){var s=$t();vi(t,n,i,s),jS(t,e,i)}}function nP(n,e,t){var i=Dr(n),s={lane:i,action:t,hasEagerState:!1,eagerState:null,next:null};if(QS(n))ZS(e,s);else{var r=n.alternate;if(n.lanes===0&&(r===null||r.lanes===0)&&(r=e.lastRenderedReducer,r!==null))try{var o=e.lastRenderedState,a=r(o,t);if(s.hasEagerState=!0,s.eagerState=a,_i(a,o)){var l=e.interleaved;l===null?(s.next=s,wv(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}t=bS(n,e,s,i),t!==null&&(s=$t(),vi(t,n,i,s),jS(t,e,i))}}function QS(n){var e=n.alternate;return n===He||e!==null&&e===He}function ZS(n,e){ac=Bf=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function jS(n,e,t){if(t&4194240){var i=e.lanes;i&=n.pendingLanes,t|=i,e.lanes=t,uv(n,t)}}var zf={readContext:Xn,useCallback:Ct,useContext:Ct,useEffect:Ct,useImperativeHandle:Ct,useInsertionEffect:Ct,useLayoutEffect:Ct,useMemo:Ct,useReducer:Ct,useRef:Ct,useState:Ct,useDebugValue:Ct,useDeferredValue:Ct,useTransition:Ct,useMutableSource:Ct,useSyncExternalStore:Ct,useId:Ct,unstable_isNewReconciler:!1},iP={readContext:Xn,useCallback:function(n,e){return Ii().memoizedState=[n,e===void 0?null:e],n},useContext:Xn,useEffect:s_,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,Oh(4194308,4,$S.bind(null,e,n),t)},useLayoutEffect:function(n,e){return Oh(4194308,4,n,e)},useInsertionEffect:function(n,e){return Oh(4,2,n,e)},useMemo:function(n,e){var t=Ii();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var i=Ii();return e=t!==void 0?t(e):e,i.memoizedState=i.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},i.queue=n,n=n.dispatch=tP.bind(null,He,n),[i.memoizedState,n]},useRef:function(n){var e=Ii();return n={current:n},e.memoizedState=n},useState:i_,useDebugValue:bv,useDeferredValue:function(n){return Ii().memoizedState=n},useTransition:function(){var n=i_(!1),e=n[0];return n=eP.bind(null,n[1]),Ii().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var i=He,s=Ii();if(Ne){if(t===void 0)throw Error(L(407));t=t()}else{if(t=e(),ft===null)throw Error(L(349));fa&30||US(i,e,t)}s.memoizedState=t;var r={value:t,getSnapshot:e};return s.queue=r,s_(VS.bind(null,i,r,n),[n]),i.flags|=2048,Rc(9,HS.bind(null,i,r,t,e),void 0,null),t},useId:function(){var n=Ii(),e=ft.identifierPrefix;if(Ne){var t=Ms,i=Rs;t=(i&~(1<<32-yi(i)-1)).toString(32)+t,e=":"+e+"R"+t,t=Ic++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=jI++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},sP={readContext:Xn,useCallback:YS,useContext:Xn,useEffect:kv,useImperativeHandle:WS,useInsertionEffect:zS,useLayoutEffect:qS,useMemo:KS,useReducer:Eg,useRef:BS,useState:function(){return Eg(Pc)},useDebugValue:bv,useDeferredValue:function(n){var e=Qn();return JS(e,it.memoizedState,n)},useTransition:function(){var n=Eg(Pc)[0],e=Qn().memoizedState;return[n,e]},useMutableSource:DS,useSyncExternalStore:FS,useId:XS,unstable_isNewReconciler:!1},rP={readContext:Xn,useCallback:YS,useContext:Xn,useEffect:kv,useImperativeHandle:WS,useInsertionEffect:zS,useLayoutEffect:qS,useMemo:KS,useReducer:Sg,useRef:BS,useState:function(){return Sg(Pc)},useDebugValue:bv,useDeferredValue:function(n){var e=Qn();return it===null?e.memoizedState=n:JS(e,it.memoizedState,n)},useTransition:function(){var n=Sg(Pc)[0],e=Qn().memoizedState;return[n,e]},useMutableSource:DS,useSyncExternalStore:FS,useId:XS,unstable_isNewReconciler:!1};function ei(n,e){if(n&&n.defaultProps){e=Ve({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function dm(n,e,t,i){e=n.memoizedState,t=t(i,e),t=t==null?e:Ve({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Lp={isMounted:function(n){return(n=n._reactInternals)?Ea(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var i=$t(),s=Dr(n),r=ks(i,s);r.payload=e,t!=null&&(r.callback=t),e=Nr(n,r,s),e!==null&&(vi(e,n,s,i),Vh(e,n,s))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var i=$t(),s=Dr(n),r=ks(i,s);r.tag=1,r.payload=e,t!=null&&(r.callback=t),e=Nr(n,r,s),e!==null&&(vi(e,n,s,i),Vh(e,n,s))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=$t(),i=Dr(n),s=ks(t,i);s.tag=2,e!=null&&(s.callback=e),e=Nr(n,s,i),e!==null&&(vi(e,n,i,t),Vh(e,n,i))}};function r_(n,e,t,i,s,r,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(i,r,o):e.prototype&&e.prototype.isPureReactComponent?!Ec(t,i)||!Ec(s,r):!0}function ew(n,e,t){var i=!1,s=Vr,r=e.contextType;return typeof r=="object"&&r!==null?r=Xn(r):(s=un(e)?da:Ut.current,i=e.contextTypes,r=(i=i!=null)?du(n,s):Vr),e=new e(t,r),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Lp,n.stateNode=e,e._reactInternals=n,i&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=s,n.__reactInternalMemoizedMaskedChildContext=r),e}function o_(n,e,t,i){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,i),e.state!==n&&Lp.enqueueReplaceState(e,e.state,null)}function hm(n,e,t,i){var s=n.stateNode;s.props=t,s.state=n.memoizedState,s.refs={},Cv(n);var r=e.contextType;typeof r=="object"&&r!==null?s.context=Xn(r):(r=un(e)?da:Ut.current,s.context=du(n,r)),s.state=n.memoizedState,r=e.getDerivedStateFromProps,typeof r=="function"&&(dm(n,e,r,t),s.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Lp.enqueueReplaceState(s,s.state,null),Gf(n,t,s,i),s.state=n.memoizedState),typeof s.componentDidMount=="function"&&(n.flags|=4194308)}function gu(n,e){try{var t="",i=e;do t+=Nx(i),i=i.return;while(i);var s=t}catch(r){s=`
Error generating stack: `+r.message+`
`+r.stack}return{value:n,source:e,stack:s,digest:null}}function wg(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function fm(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var oP=typeof WeakMap=="function"?WeakMap:Map;function tw(n,e,t){t=ks(-1,t),t.tag=3,t.payload={element:null};var i=e.value;return t.callback=function(){$f||($f=!0,wm=i),fm(n,e)},t}function nw(n,e,t){t=ks(-1,t),t.tag=3;var i=n.type.getDerivedStateFromError;if(typeof i=="function"){var s=e.value;t.payload=function(){return i(s)},t.callback=function(){fm(n,e)}}var r=n.stateNode;return r!==null&&typeof r.componentDidCatch=="function"&&(t.callback=function(){fm(n,e),typeof i!="function"&&(Lr===null?Lr=new Set([this]):Lr.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function a_(n,e,t){var i=n.pingCache;if(i===null){i=n.pingCache=new oP;var s=new Set;i.set(e,s)}else s=i.get(e),s===void 0&&(s=new Set,i.set(e,s));s.has(t)||(s.add(t),n=AP.bind(null,n,e,t),e.then(n,n))}function l_(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function u_(n,e,t,i,s){return n.mode&1?(n.flags|=65536,n.lanes=s,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=ks(-1,1),e.tag=2,Nr(t,e,1))),t.lanes|=1),n)}var aP=Os.ReactCurrentOwner,an=!1;function qt(n,e,t,i){e.child=n===null?kS(e,null,t,i):fu(e,n.child,t,i)}function c_(n,e,t,i,s){t=t.render;var r=e.ref;return Za(e,s),i=Rv(n,e,t,i,r,s),t=Mv(),n!==null&&!an?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Us(n,e,s)):(Ne&&t&&yv(e),e.flags|=1,qt(n,e,i,s),e.child)}function d_(n,e,t,i,s){if(n===null){var r=t.type;return typeof r=="function"&&!Gv(r)&&r.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=r,iw(n,e,r,i,s)):(n=$h(t.type,null,i,e,e.mode,s),n.ref=e.ref,n.return=e,e.child=n)}if(r=n.child,!(n.lanes&s)){var o=r.memoizedProps;if(t=t.compare,t=t!==null?t:Ec,t(o,i)&&n.ref===e.ref)return Us(n,e,s)}return e.flags|=1,n=Fr(r,i),n.ref=e.ref,n.return=e,e.child=n}function iw(n,e,t,i,s){if(n!==null){var r=n.memoizedProps;if(Ec(r,i)&&n.ref===e.ref)if(an=!1,e.pendingProps=i=r,(n.lanes&s)!==0)n.flags&131072&&(an=!0);else return e.lanes=n.lanes,Us(n,e,s)}return pm(n,e,t,i,s)}function sw(n,e,t){var i=e.pendingProps,s=i.children,r=n!==null?n.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ce(qa,Tn),Tn|=t;else{if(!(t&1073741824))return n=r!==null?r.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Ce(qa,Tn),Tn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=r!==null?r.baseLanes:t,Ce(qa,Tn),Tn|=i}else r!==null?(i=r.baseLanes|t,e.memoizedState=null):i=t,Ce(qa,Tn),Tn|=i;return qt(n,e,s,t),e.child}function rw(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function pm(n,e,t,i,s){var r=un(t)?da:Ut.current;return r=du(e,r),Za(e,s),t=Rv(n,e,t,i,r,s),i=Mv(),n!==null&&!an?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~s,Us(n,e,s)):(Ne&&i&&yv(e),e.flags|=1,qt(n,e,t,s),e.child)}function h_(n,e,t,i,s){if(un(t)){var r=!0;Df(e)}else r=!1;if(Za(e,s),e.stateNode===null)Bh(n,e),ew(e,t,i),hm(e,t,i,s),i=!0;else if(n===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,u=t.contextType;typeof u=="object"&&u!==null?u=Xn(u):(u=un(t)?da:Ut.current,u=du(e,u));var h=t.getDerivedStateFromProps,p=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==i||l!==u)&&o_(e,o,i,u),Ys=!1;var g=e.memoizedState;o.state=g,Gf(e,i,o,s),l=e.memoizedState,a!==i||g!==l||ln.current||Ys?(typeof h=="function"&&(dm(e,t,h,i),l=e.memoizedState),(a=Ys||r_(e,t,a,i,g,l,u))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),o.props=i,o.state=l,o.context=u,i=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{o=e.stateNode,NS(n,e),a=e.memoizedProps,u=e.type===e.elementType?a:ei(e.type,a),o.props=u,p=e.pendingProps,g=o.context,l=t.contextType,typeof l=="object"&&l!==null?l=Xn(l):(l=un(t)?da:Ut.current,l=du(e,l));var m=t.getDerivedStateFromProps;(h=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==p||g!==l)&&o_(e,o,i,l),Ys=!1,g=e.memoizedState,o.state=g,Gf(e,i,o,s);var y=e.memoizedState;a!==p||g!==y||ln.current||Ys?(typeof m=="function"&&(dm(e,t,m,i),y=e.memoizedState),(u=Ys||r_(e,t,u,i,g,y,l)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(i,y,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(i,y,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&g===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&g===n.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=y),o.props=i,o.state=y,o.context=l,i=u):(typeof o.componentDidUpdate!="function"||a===n.memoizedProps&&g===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&g===n.memoizedState||(e.flags|=1024),i=!1)}return gm(n,e,t,i,r,s)}function gm(n,e,t,i,s,r){rw(n,e);var o=(e.flags&128)!==0;if(!i&&!o)return s&&Q0(e,t,!1),Us(n,e,r);i=e.stateNode,aP.current=e;var a=o&&typeof t.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,n!==null&&o?(e.child=fu(e,n.child,null,r),e.child=fu(e,null,a,r)):qt(n,e,a,r),e.memoizedState=i.state,s&&Q0(e,t,!0),e.child}function ow(n){var e=n.stateNode;e.pendingContext?X0(n,e.pendingContext,e.pendingContext!==e.context):e.context&&X0(n,e.context,!1),Tv(n,e.containerInfo)}function f_(n,e,t,i,s){return hu(),_v(s),e.flags|=256,qt(n,e,t,i),e.child}var mm={dehydrated:null,treeContext:null,retryLane:0};function ym(n){return{baseLanes:n,cachePool:null,transitions:null}}function aw(n,e,t){var i=e.pendingProps,s=Fe.current,r=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=n!==null&&n.memoizedState===null?!1:(s&2)!==0),a?(r=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(s|=1),Ce(Fe,s&1),n===null)return um(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=i.children,n=i.fallback,r?(i=e.mode,r=e.child,o={mode:"hidden",children:o},!(i&1)&&r!==null?(r.childLanes=0,r.pendingProps=o):r=Up(o,i,0,null),n=ca(n,i,t,null),r.return=e,n.return=e,r.sibling=n,e.child=r,e.child.memoizedState=ym(t),e.memoizedState=mm,n):Nv(e,o));if(s=n.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return lP(n,e,o,i,a,s,t);if(r){r=i.fallback,o=e.mode,s=n.child,a=s.sibling;var l={mode:"hidden",children:i.children};return!(o&1)&&e.child!==s?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=Fr(s,l),i.subtreeFlags=s.subtreeFlags&14680064),a!==null?r=Fr(a,r):(r=ca(r,o,t,null),r.flags|=2),r.return=e,i.return=e,i.sibling=r,e.child=i,i=r,r=e.child,o=n.child.memoizedState,o=o===null?ym(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},r.memoizedState=o,r.childLanes=n.childLanes&~t,e.memoizedState=mm,i}return r=n.child,n=r.sibling,i=Fr(r,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=t),i.return=e,i.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=i,e.memoizedState=null,i}function Nv(n,e){return e=Up({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function xh(n,e,t,i){return i!==null&&_v(i),fu(e,n.child,null,t),n=Nv(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function lP(n,e,t,i,s,r,o){if(t)return e.flags&256?(e.flags&=-257,i=wg(Error(L(422))),xh(n,e,o,i)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(r=i.fallback,s=e.mode,i=Up({mode:"visible",children:i.children},s,0,null),r=ca(r,s,o,null),r.flags|=2,i.return=e,r.return=e,i.sibling=r,e.child=i,e.mode&1&&fu(e,n.child,null,o),e.child.memoizedState=ym(o),e.memoizedState=mm,r);if(!(e.mode&1))return xh(n,e,o,null);if(s.data==="$!"){if(i=s.nextSibling&&s.nextSibling.dataset,i)var a=i.dgst;return i=a,r=Error(L(419)),i=wg(r,i,void 0),xh(n,e,o,i)}if(a=(o&n.childLanes)!==0,an||a){if(i=ft,i!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(i.suspendedLanes|o)?0:s,s!==0&&s!==r.retryLane&&(r.retryLane=s,Fs(n,s),vi(i,n,s,-1))}return Vv(),i=wg(Error(L(421))),xh(n,e,o,i)}return s.data==="$?"?(e.flags|=128,e.child=n.child,e=EP.bind(null,n),s._reactRetry=e,null):(n=r.treeContext,Pn=br(s.nextSibling),Rn=e,Ne=!0,gi=null,n!==null&&(Bn[zn++]=Rs,Bn[zn++]=Ms,Bn[zn++]=ha,Rs=n.id,Ms=n.overflow,ha=e),e=Nv(e,i.children),e.flags|=4096,e)}function p_(n,e,t){n.lanes|=e;var i=n.alternate;i!==null&&(i.lanes|=e),cm(n.return,e,t)}function Cg(n,e,t,i,s){var r=n.memoizedState;r===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:t,tailMode:s}:(r.isBackwards=e,r.rendering=null,r.renderingStartTime=0,r.last=i,r.tail=t,r.tailMode=s)}function lw(n,e,t){var i=e.pendingProps,s=i.revealOrder,r=i.tail;if(qt(n,e,i.children,t),i=Fe.current,i&2)i=i&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&p_(n,t,e);else if(n.tag===19)p_(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}i&=1}if(Ce(Fe,i),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(t=e.child,s=null;t!==null;)n=t.alternate,n!==null&&Of(n)===null&&(s=t),t=t.sibling;t=s,t===null?(s=e.child,e.child=null):(s=t.sibling,t.sibling=null),Cg(e,!1,s,t,r);break;case"backwards":for(t=null,s=e.child,e.child=null;s!==null;){if(n=s.alternate,n!==null&&Of(n)===null){e.child=s;break}n=s.sibling,s.sibling=t,t=s,s=n}Cg(e,!0,t,null,r);break;case"together":Cg(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Bh(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function Us(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),pa|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(L(153));if(e.child!==null){for(n=e.child,t=Fr(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Fr(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function uP(n,e,t){switch(e.tag){case 3:ow(e),hu();break;case 5:LS(e);break;case 1:un(e.type)&&Df(e);break;case 4:Tv(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,s=e.memoizedProps.value;Ce(Hf,i._currentValue),i._currentValue=s;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Ce(Fe,Fe.current&1),e.flags|=128,null):t&e.child.childLanes?aw(n,e,t):(Ce(Fe,Fe.current&1),n=Us(n,e,t),n!==null?n.sibling:null);Ce(Fe,Fe.current&1);break;case 19:if(i=(t&e.childLanes)!==0,n.flags&128){if(i)return lw(n,e,t);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Ce(Fe,Fe.current),i)break;return null;case 22:case 23:return e.lanes=0,sw(n,e,t)}return Us(n,e,t)}var uw,vm,cw,dw;uw=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};vm=function(){};cw=function(n,e,t,i){var s=n.memoizedProps;if(s!==i){n=e.stateNode,io(Yi.current);var r=null;switch(t){case"input":s=Gg(n,s),i=Gg(n,i),r=[];break;case"select":s=Ve({},s,{value:void 0}),i=Ve({},i,{value:void 0}),r=[];break;case"textarea":s=zg(n,s),i=zg(n,i),r=[];break;default:typeof s.onClick!="function"&&typeof i.onClick=="function"&&(n.onclick=Nf)}$g(t,i);var o;t=null;for(u in s)if(!i.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var a=s[u];for(o in a)a.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(pc.hasOwnProperty(u)?r||(r=[]):(r=r||[]).push(u,null));for(u in i){var l=i[u];if(a=s!=null?s[u]:void 0,i.hasOwnProperty(u)&&l!==a&&(l!=null||a!=null))if(u==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(t||(t={}),t[o]=l[o])}else t||(r||(r=[]),r.push(u,t)),t=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(r=r||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(r=r||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(pc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Te("scroll",n),r||a===l||(r=[])):(r=r||[]).push(u,l))}t&&(r=r||[]).push("style",t);var u=r;(e.updateQueue=u)&&(e.flags|=4)}};dw=function(n,e,t,i){t!==i&&(e.flags|=4)};function Ru(n,e){if(!Ne)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var i=null;t!==null;)t.alternate!==null&&(i=t),t=t.sibling;i===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:i.sibling=null}}function Tt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,i=0;if(e)for(var s=n.child;s!==null;)t|=s.lanes|s.childLanes,i|=s.subtreeFlags&14680064,i|=s.flags&14680064,s.return=n,s=s.sibling;else for(s=n.child;s!==null;)t|=s.lanes|s.childLanes,i|=s.subtreeFlags,i|=s.flags,s.return=n,s=s.sibling;return n.subtreeFlags|=i,n.childLanes=t,e}function cP(n,e,t){var i=e.pendingProps;switch(vv(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(e),null;case 1:return un(e.type)&&Lf(),Tt(e),null;case 3:return i=e.stateNode,pu(),Pe(ln),Pe(Ut),Iv(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(n===null||n.child===null)&&(Ch(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,gi!==null&&(xm(gi),gi=null))),vm(n,e),Tt(e),null;case 5:xv(e);var s=io(xc.current);if(t=e.type,n!==null&&e.stateNode!=null)cw(n,e,t,i,s),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(L(166));return Tt(e),null}if(n=io(Yi.current),Ch(e)){i=e.stateNode,t=e.type;var r=e.memoizedProps;switch(i[$i]=e,i[Cc]=r,n=(e.mode&1)!==0,t){case"dialog":Te("cancel",i),Te("close",i);break;case"iframe":case"object":case"embed":Te("load",i);break;case"video":case"audio":for(s=0;s<Vu.length;s++)Te(Vu[s],i);break;case"source":Te("error",i);break;case"img":case"image":case"link":Te("error",i),Te("load",i);break;case"details":Te("toggle",i);break;case"input":w0(i,r),Te("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!r.multiple},Te("invalid",i);break;case"textarea":T0(i,r),Te("invalid",i)}$g(t,r),s=null;for(var o in r)if(r.hasOwnProperty(o)){var a=r[o];o==="children"?typeof a=="string"?i.textContent!==a&&(r.suppressHydrationWarning!==!0&&wh(i.textContent,a,n),s=["children",a]):typeof a=="number"&&i.textContent!==""+a&&(r.suppressHydrationWarning!==!0&&wh(i.textContent,a,n),s=["children",""+a]):pc.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Te("scroll",i)}switch(t){case"input":gh(i),C0(i,r,!0);break;case"textarea":gh(i),x0(i);break;case"select":case"option":break;default:typeof r.onClick=="function"&&(i.onclick=Nf)}i=s,e.updateQueue=i,i!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=VE(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof i.is=="string"?n=o.createElement(t,{is:i.is}):(n=o.createElement(t),t==="select"&&(o=n,i.multiple?o.multiple=!0:i.size&&(o.size=i.size))):n=o.createElementNS(n,t),n[$i]=e,n[Cc]=i,uw(n,e,!1,!1),e.stateNode=n;e:{switch(o=Wg(t,i),t){case"dialog":Te("cancel",n),Te("close",n),s=i;break;case"iframe":case"object":case"embed":Te("load",n),s=i;break;case"video":case"audio":for(s=0;s<Vu.length;s++)Te(Vu[s],n);s=i;break;case"source":Te("error",n),s=i;break;case"img":case"image":case"link":Te("error",n),Te("load",n),s=i;break;case"details":Te("toggle",n),s=i;break;case"input":w0(n,i),s=Gg(n,i),Te("invalid",n);break;case"option":s=i;break;case"select":n._wrapperState={wasMultiple:!!i.multiple},s=Ve({},i,{value:void 0}),Te("invalid",n);break;case"textarea":T0(n,i),s=zg(n,i),Te("invalid",n);break;default:s=i}$g(t,s),a=s;for(r in a)if(a.hasOwnProperty(r)){var l=a[r];r==="style"?BE(n,l):r==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&GE(n,l)):r==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&gc(n,l):typeof l=="number"&&gc(n,""+l):r!=="suppressContentEditableWarning"&&r!=="suppressHydrationWarning"&&r!=="autoFocus"&&(pc.hasOwnProperty(r)?l!=null&&r==="onScroll"&&Te("scroll",n):l!=null&&iv(n,r,l,o))}switch(t){case"input":gh(n),C0(n,i,!1);break;case"textarea":gh(n),x0(n);break;case"option":i.value!=null&&n.setAttribute("value",""+Hr(i.value));break;case"select":n.multiple=!!i.multiple,r=i.value,r!=null?Ka(n,!!i.multiple,r,!1):i.defaultValue!=null&&Ka(n,!!i.multiple,i.defaultValue,!0);break;default:typeof s.onClick=="function"&&(n.onclick=Nf)}switch(t){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Tt(e),null;case 6:if(n&&e.stateNode!=null)dw(n,e,n.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(L(166));if(t=io(xc.current),io(Yi.current),Ch(e)){if(i=e.stateNode,t=e.memoizedProps,i[$i]=e,(r=i.nodeValue!==t)&&(n=Rn,n!==null))switch(n.tag){case 3:wh(i.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&wh(i.nodeValue,t,(n.mode&1)!==0)}r&&(e.flags|=4)}else i=(t.nodeType===9?t:t.ownerDocument).createTextNode(i),i[$i]=e,e.stateNode=i}return Tt(e),null;case 13:if(Pe(Fe),i=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Ne&&Pn!==null&&e.mode&1&&!(e.flags&128))RS(),hu(),e.flags|=98560,r=!1;else if(r=Ch(e),i!==null&&i.dehydrated!==null){if(n===null){if(!r)throw Error(L(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(L(317));r[$i]=e}else hu(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Tt(e),r=!1}else gi!==null&&(xm(gi),gi=null),r=!0;if(!r)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(i=i!==null,i!==(n!==null&&n.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(n===null||Fe.current&1?st===0&&(st=3):Vv())),e.updateQueue!==null&&(e.flags|=4),Tt(e),null);case 4:return pu(),vm(n,e),n===null&&Sc(e.stateNode.containerInfo),Tt(e),null;case 10:return Sv(e.type._context),Tt(e),null;case 17:return un(e.type)&&Lf(),Tt(e),null;case 19:if(Pe(Fe),r=e.memoizedState,r===null)return Tt(e),null;if(i=(e.flags&128)!==0,o=r.rendering,o===null)if(i)Ru(r,!1);else{if(st!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=Of(n),o!==null){for(e.flags|=128,Ru(r,!1),i=o.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=t,t=e.child;t!==null;)r=t,n=i,r.flags&=14680066,o=r.alternate,o===null?(r.childLanes=0,r.lanes=n,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,n=o.dependencies,r.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Ce(Fe,Fe.current&1|2),e.child}n=n.sibling}r.tail!==null&&$e()>mu&&(e.flags|=128,i=!0,Ru(r,!1),e.lanes=4194304)}else{if(!i)if(n=Of(o),n!==null){if(e.flags|=128,i=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Ru(r,!0),r.tail===null&&r.tailMode==="hidden"&&!o.alternate&&!Ne)return Tt(e),null}else 2*$e()-r.renderingStartTime>mu&&t!==1073741824&&(e.flags|=128,i=!0,Ru(r,!1),e.lanes=4194304);r.isBackwards?(o.sibling=e.child,e.child=o):(t=r.last,t!==null?t.sibling=o:e.child=o,r.last=o)}return r.tail!==null?(e=r.tail,r.rendering=e,r.tail=e.sibling,r.renderingStartTime=$e(),e.sibling=null,t=Fe.current,Ce(Fe,i?t&1|2:t&1),e):(Tt(e),null);case 22:case 23:return Hv(),i=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Tn&1073741824&&(Tt(e),e.subtreeFlags&6&&(e.flags|=8192)):Tt(e),null;case 24:return null;case 25:return null}throw Error(L(156,e.tag))}function dP(n,e){switch(vv(e),e.tag){case 1:return un(e.type)&&Lf(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return pu(),Pe(ln),Pe(Ut),Iv(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return xv(e),null;case 13:if(Pe(Fe),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(L(340));hu()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Pe(Fe),null;case 4:return pu(),null;case 10:return Sv(e.type._context),null;case 22:case 23:return Hv(),null;case 24:return null;default:return null}}var Ih=!1,Lt=!1,hP=typeof WeakSet=="function"?WeakSet:Set,B=null;function za(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(i){Be(n,e,i)}else t.current=null}function _m(n,e,t){try{t()}catch(i){Be(n,e,i)}}var g_=!1;function fP(n,e){if(nm=Mf,n=mS(),mv(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var i=t.getSelection&&t.getSelection();if(i&&i.rangeCount!==0){t=i.anchorNode;var s=i.anchorOffset,r=i.focusNode;i=i.focusOffset;try{t.nodeType,r.nodeType}catch{t=null;break e}var o=0,a=-1,l=-1,u=0,h=0,p=n,g=null;t:for(;;){for(var m;p!==t||s!==0&&p.nodeType!==3||(a=o+s),p!==r||i!==0&&p.nodeType!==3||(l=o+i),p.nodeType===3&&(o+=p.nodeValue.length),(m=p.firstChild)!==null;)g=p,p=m;for(;;){if(p===n)break t;if(g===t&&++u===s&&(a=o),g===r&&++h===i&&(l=o),(m=p.nextSibling)!==null)break;p=g,g=p.parentNode}p=m}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(im={focusedElem:n,selectionRange:t},Mf=!1,B=e;B!==null;)if(e=B,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,B=n;else for(;B!==null;){e=B;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var A=y.memoizedProps,T=y.memoizedState,v=e.stateNode,E=v.getSnapshotBeforeUpdate(e.elementType===e.type?A:ei(e.type,A),T);v.__reactInternalSnapshotBeforeUpdate=E}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(L(163))}}catch(x){Be(e,e.return,x)}if(n=e.sibling,n!==null){n.return=e.return,B=n;break}B=e.return}return y=g_,g_=!1,y}function lc(n,e,t){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var s=i=i.next;do{if((s.tag&n)===n){var r=s.destroy;s.destroy=void 0,r!==void 0&&_m(e,t,r)}s=s.next}while(s!==i)}}function Dp(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var i=t.create;t.destroy=i()}t=t.next}while(t!==e)}}function Am(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function hw(n){var e=n.alternate;e!==null&&(n.alternate=null,hw(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[$i],delete e[Cc],delete e[om],delete e[JI],delete e[XI])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function fw(n){return n.tag===5||n.tag===3||n.tag===4}function m_(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||fw(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Em(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Nf));else if(i!==4&&(n=n.child,n!==null))for(Em(n,e,t),n=n.sibling;n!==null;)Em(n,e,t),n=n.sibling}function Sm(n,e,t){var i=n.tag;if(i===5||i===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(i!==4&&(n=n.child,n!==null))for(Sm(n,e,t),n=n.sibling;n!==null;)Sm(n,e,t),n=n.sibling}var _t=null,pi=!1;function qs(n,e,t){for(t=t.child;t!==null;)pw(n,e,t),t=t.sibling}function pw(n,e,t){if(Wi&&typeof Wi.onCommitFiberUnmount=="function")try{Wi.onCommitFiberUnmount(Ip,t)}catch{}switch(t.tag){case 5:Lt||za(t,e);case 6:var i=_t,s=pi;_t=null,qs(n,e,t),_t=i,pi=s,_t!==null&&(pi?(n=_t,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):_t.removeChild(t.stateNode));break;case 18:_t!==null&&(pi?(n=_t,t=t.stateNode,n.nodeType===8?yg(n.parentNode,t):n.nodeType===1&&yg(n,t),_c(n)):yg(_t,t.stateNode));break;case 4:i=_t,s=pi,_t=t.stateNode.containerInfo,pi=!0,qs(n,e,t),_t=i,pi=s;break;case 0:case 11:case 14:case 15:if(!Lt&&(i=t.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){s=i=i.next;do{var r=s,o=r.destroy;r=r.tag,o!==void 0&&(r&2||r&4)&&_m(t,e,o),s=s.next}while(s!==i)}qs(n,e,t);break;case 1:if(!Lt&&(za(t,e),i=t.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=t.memoizedProps,i.state=t.memoizedState,i.componentWillUnmount()}catch(a){Be(t,e,a)}qs(n,e,t);break;case 21:qs(n,e,t);break;case 22:t.mode&1?(Lt=(i=Lt)||t.memoizedState!==null,qs(n,e,t),Lt=i):qs(n,e,t);break;default:qs(n,e,t)}}function y_(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new hP),e.forEach(function(i){var s=SP.bind(null,n,i);t.has(i)||(t.add(i),i.then(s,s))})}}function Zn(n,e){var t=e.deletions;if(t!==null)for(var i=0;i<t.length;i++){var s=t[i];try{var r=n,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:_t=a.stateNode,pi=!1;break e;case 3:_t=a.stateNode.containerInfo,pi=!0;break e;case 4:_t=a.stateNode.containerInfo,pi=!0;break e}a=a.return}if(_t===null)throw Error(L(160));pw(r,o,s),_t=null,pi=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(u){Be(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)gw(e,n),e=e.sibling}function gw(n,e){var t=n.alternate,i=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Zn(e,n),wi(n),i&4){try{lc(3,n,n.return),Dp(3,n)}catch(A){Be(n,n.return,A)}try{lc(5,n,n.return)}catch(A){Be(n,n.return,A)}}break;case 1:Zn(e,n),wi(n),i&512&&t!==null&&za(t,t.return);break;case 5:if(Zn(e,n),wi(n),i&512&&t!==null&&za(t,t.return),n.flags&32){var s=n.stateNode;try{gc(s,"")}catch(A){Be(n,n.return,A)}}if(i&4&&(s=n.stateNode,s!=null)){var r=n.memoizedProps,o=t!==null?t.memoizedProps:r,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&r.type==="radio"&&r.name!=null&&UE(s,r),Wg(a,o);var u=Wg(a,r);for(o=0;o<l.length;o+=2){var h=l[o],p=l[o+1];h==="style"?BE(s,p):h==="dangerouslySetInnerHTML"?GE(s,p):h==="children"?gc(s,p):iv(s,h,p,u)}switch(a){case"input":Og(s,r);break;case"textarea":HE(s,r);break;case"select":var g=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!r.multiple;var m=r.value;m!=null?Ka(s,!!r.multiple,m,!1):g!==!!r.multiple&&(r.defaultValue!=null?Ka(s,!!r.multiple,r.defaultValue,!0):Ka(s,!!r.multiple,r.multiple?[]:"",!1))}s[Cc]=r}catch(A){Be(n,n.return,A)}}break;case 6:if(Zn(e,n),wi(n),i&4){if(n.stateNode===null)throw Error(L(162));s=n.stateNode,r=n.memoizedProps;try{s.nodeValue=r}catch(A){Be(n,n.return,A)}}break;case 3:if(Zn(e,n),wi(n),i&4&&t!==null&&t.memoizedState.isDehydrated)try{_c(e.containerInfo)}catch(A){Be(n,n.return,A)}break;case 4:Zn(e,n),wi(n);break;case 13:Zn(e,n),wi(n),s=n.child,s.flags&8192&&(r=s.memoizedState!==null,s.stateNode.isHidden=r,!r||s.alternate!==null&&s.alternate.memoizedState!==null||(Fv=$e())),i&4&&y_(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(Lt=(u=Lt)||h,Zn(e,n),Lt=u):Zn(e,n),wi(n),i&8192){if(u=n.memoizedState!==null,(n.stateNode.isHidden=u)&&!h&&n.mode&1)for(B=n,h=n.child;h!==null;){for(p=B=h;B!==null;){switch(g=B,m=g.child,g.tag){case 0:case 11:case 14:case 15:lc(4,g,g.return);break;case 1:za(g,g.return);var y=g.stateNode;if(typeof y.componentWillUnmount=="function"){i=g,t=g.return;try{e=i,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(A){Be(i,t,A)}}break;case 5:za(g,g.return);break;case 22:if(g.memoizedState!==null){__(p);continue}}m!==null?(m.return=g,B=m):__(p)}h=h.sibling}e:for(h=null,p=n;;){if(p.tag===5){if(h===null){h=p;try{s=p.stateNode,u?(r=s.style,typeof r.setProperty=="function"?r.setProperty("display","none","important"):r.display="none"):(a=p.stateNode,l=p.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=OE("display",o))}catch(A){Be(n,n.return,A)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=u?"":p.memoizedProps}catch(A){Be(n,n.return,A)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===n)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===n)break e;for(;p.sibling===null;){if(p.return===null||p.return===n)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Zn(e,n),wi(n),i&4&&y_(n);break;case 21:break;default:Zn(e,n),wi(n)}}function wi(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(fw(t)){var i=t;break e}t=t.return}throw Error(L(160))}switch(i.tag){case 5:var s=i.stateNode;i.flags&32&&(gc(s,""),i.flags&=-33);var r=m_(n);Sm(n,r,s);break;case 3:case 4:var o=i.stateNode.containerInfo,a=m_(n);Em(n,a,o);break;default:throw Error(L(161))}}catch(l){Be(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function pP(n,e,t){B=n,mw(n)}function mw(n,e,t){for(var i=(n.mode&1)!==0;B!==null;){var s=B,r=s.child;if(s.tag===22&&i){var o=s.memoizedState!==null||Ih;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||Lt;a=Ih;var u=Lt;if(Ih=o,(Lt=l)&&!u)for(B=s;B!==null;)o=B,l=o.child,o.tag===22&&o.memoizedState!==null?A_(s):l!==null?(l.return=o,B=l):A_(s);for(;r!==null;)B=r,mw(r),r=r.sibling;B=s,Ih=a,Lt=u}v_(n)}else s.subtreeFlags&8772&&r!==null?(r.return=s,B=r):v_(n)}}function v_(n){for(;B!==null;){var e=B;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Lt||Dp(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Lt)if(t===null)i.componentDidMount();else{var s=e.elementType===e.type?t.memoizedProps:ei(e.type,t.memoizedProps);i.componentDidUpdate(s,t.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var r=e.updateQueue;r!==null&&n_(e,r,i);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}n_(e,o,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&_c(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(L(163))}Lt||e.flags&512&&Am(e)}catch(g){Be(e,e.return,g)}}if(e===n){B=null;break}if(t=e.sibling,t!==null){t.return=e.return,B=t;break}B=e.return}}function __(n){for(;B!==null;){var e=B;if(e===n){B=null;break}var t=e.sibling;if(t!==null){t.return=e.return,B=t;break}B=e.return}}function A_(n){for(;B!==null;){var e=B;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Dp(4,e)}catch(l){Be(e,t,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var s=e.return;try{i.componentDidMount()}catch(l){Be(e,s,l)}}var r=e.return;try{Am(e)}catch(l){Be(e,r,l)}break;case 5:var o=e.return;try{Am(e)}catch(l){Be(e,o,l)}}}catch(l){Be(e,e.return,l)}if(e===n){B=null;break}var a=e.sibling;if(a!==null){a.return=e.return,B=a;break}B=e.return}}var gP=Math.ceil,qf=Os.ReactCurrentDispatcher,Lv=Os.ReactCurrentOwner,Yn=Os.ReactCurrentBatchConfig,de=0,ft=null,Xe=null,St=0,Tn=0,qa=qr(0),st=0,Mc=null,pa=0,Fp=0,Dv=0,uc=null,on=null,Fv=0,mu=1/0,ji=null,$f=!1,wm=null,Lr=null,Ph=!1,Pr=null,Wf=0,cc=0,Cm=null,zh=-1,qh=0;function $t(){return de&6?$e():zh!==-1?zh:zh=$e()}function Dr(n){return n.mode&1?de&2&&St!==0?St&-St:ZI.transition!==null?(qh===0&&(qh=eS()),qh):(n=_e,n!==0||(n=window.event,n=n===void 0?16:aS(n.type)),n):1}function vi(n,e,t,i){if(50<cc)throw cc=0,Cm=null,Error(L(185));oh(n,t,i),(!(de&2)||n!==ft)&&(n===ft&&(!(de&2)&&(Fp|=t),st===4&&Js(n,St)),cn(n,i),t===1&&de===0&&!(e.mode&1)&&(mu=$e()+500,bp&&$r()))}function cn(n,e){var t=n.callbackNode;Zx(n,e);var i=Rf(n,n===ft?St:0);if(i===0)t!==null&&R0(t),n.callbackNode=null,n.callbackPriority=0;else if(e=i&-i,n.callbackPriority!==e){if(t!=null&&R0(t),e===1)n.tag===0?QI(E_.bind(null,n)):xS(E_.bind(null,n)),YI(function(){!(de&6)&&$r()}),t=null;else{switch(tS(i)){case 1:t=lv;break;case 4:t=ZE;break;case 16:t=Pf;break;case 536870912:t=jE;break;default:t=Pf}t=Cw(t,yw.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function yw(n,e){if(zh=-1,qh=0,de&6)throw Error(L(327));var t=n.callbackNode;if(ja()&&n.callbackNode!==t)return null;var i=Rf(n,n===ft?St:0);if(i===0)return null;if(i&30||i&n.expiredLanes||e)e=Yf(n,i);else{e=i;var s=de;de|=2;var r=_w();(ft!==n||St!==e)&&(ji=null,mu=$e()+500,ua(n,e));do try{vP();break}catch(a){vw(n,a)}while(!0);Ev(),qf.current=r,de=s,Xe!==null?e=0:(ft=null,St=0,e=st)}if(e!==0){if(e===2&&(s=Qg(n),s!==0&&(i=s,e=Tm(n,s))),e===1)throw t=Mc,ua(n,0),Js(n,i),cn(n,$e()),t;if(e===6)Js(n,i);else{if(s=n.current.alternate,!(i&30)&&!mP(s)&&(e=Yf(n,i),e===2&&(r=Qg(n),r!==0&&(i=r,e=Tm(n,r))),e===1))throw t=Mc,ua(n,0),Js(n,i),cn(n,$e()),t;switch(n.finishedWork=s,n.finishedLanes=i,e){case 0:case 1:throw Error(L(345));case 2:Jr(n,on,ji);break;case 3:if(Js(n,i),(i&130023424)===i&&(e=Fv+500-$e(),10<e)){if(Rf(n,0)!==0)break;if(s=n.suspendedLanes,(s&i)!==i){$t(),n.pingedLanes|=n.suspendedLanes&s;break}n.timeoutHandle=rm(Jr.bind(null,n,on,ji),e);break}Jr(n,on,ji);break;case 4:if(Js(n,i),(i&4194240)===i)break;for(e=n.eventTimes,s=-1;0<i;){var o=31-yi(i);r=1<<o,o=e[o],o>s&&(s=o),i&=~r}if(i=s,i=$e()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*gP(i/1960))-i,10<i){n.timeoutHandle=rm(Jr.bind(null,n,on,ji),i);break}Jr(n,on,ji);break;case 5:Jr(n,on,ji);break;default:throw Error(L(329))}}}return cn(n,$e()),n.callbackNode===t?yw.bind(null,n):null}function Tm(n,e){var t=uc;return n.current.memoizedState.isDehydrated&&(ua(n,e).flags|=256),n=Yf(n,e),n!==2&&(e=on,on=t,e!==null&&xm(e)),n}function xm(n){on===null?on=n:on.push.apply(on,n)}function mP(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var i=0;i<t.length;i++){var s=t[i],r=s.getSnapshot;s=s.value;try{if(!_i(r(),s))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Js(n,e){for(e&=~Dv,e&=~Fp,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-yi(e),i=1<<t;n[t]=-1,e&=~i}}function E_(n){if(de&6)throw Error(L(327));ja();var e=Rf(n,0);if(!(e&1))return cn(n,$e()),null;var t=Yf(n,e);if(n.tag!==0&&t===2){var i=Qg(n);i!==0&&(e=i,t=Tm(n,i))}if(t===1)throw t=Mc,ua(n,0),Js(n,e),cn(n,$e()),t;if(t===6)throw Error(L(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Jr(n,on,ji),cn(n,$e()),null}function Uv(n,e){var t=de;de|=1;try{return n(e)}finally{de=t,de===0&&(mu=$e()+500,bp&&$r())}}function ga(n){Pr!==null&&Pr.tag===0&&!(de&6)&&ja();var e=de;de|=1;var t=Yn.transition,i=_e;try{if(Yn.transition=null,_e=1,n)return n()}finally{_e=i,Yn.transition=t,de=e,!(de&6)&&$r()}}function Hv(){Tn=qa.current,Pe(qa)}function ua(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,WI(t)),Xe!==null)for(t=Xe.return;t!==null;){var i=t;switch(vv(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&Lf();break;case 3:pu(),Pe(ln),Pe(Ut),Iv();break;case 5:xv(i);break;case 4:pu();break;case 13:Pe(Fe);break;case 19:Pe(Fe);break;case 10:Sv(i.type._context);break;case 22:case 23:Hv()}t=t.return}if(ft=n,Xe=n=Fr(n.current,null),St=Tn=e,st=0,Mc=null,Dv=Fp=pa=0,on=uc=null,no!==null){for(e=0;e<no.length;e++)if(t=no[e],i=t.interleaved,i!==null){t.interleaved=null;var s=i.next,r=t.pending;if(r!==null){var o=r.next;r.next=s,i.next=o}t.pending=i}no=null}return n}function vw(n,e){do{var t=Xe;try{if(Ev(),Gh.current=zf,Bf){for(var i=He.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Bf=!1}if(fa=0,ht=it=He=null,ac=!1,Ic=0,Lv.current=null,t===null||t.return===null){st=1,Mc=e,Xe=null;break}e:{var r=n,o=t.return,a=t,l=e;if(e=St,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,h=a,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var g=h.alternate;g?(h.updateQueue=g.updateQueue,h.memoizedState=g.memoizedState,h.lanes=g.lanes):(h.updateQueue=null,h.memoizedState=null)}var m=l_(o);if(m!==null){m.flags&=-257,u_(m,o,a,r,e),m.mode&1&&a_(r,u,e),e=m,l=u;var y=e.updateQueue;if(y===null){var A=new Set;A.add(l),e.updateQueue=A}else y.add(l);break e}else{if(!(e&1)){a_(r,u,e),Vv();break e}l=Error(L(426))}}else if(Ne&&a.mode&1){var T=l_(o);if(T!==null){!(T.flags&65536)&&(T.flags|=256),u_(T,o,a,r,e),_v(gu(l,a));break e}}r=l=gu(l,a),st!==4&&(st=2),uc===null?uc=[r]:uc.push(r),r=o;do{switch(r.tag){case 3:r.flags|=65536,e&=-e,r.lanes|=e;var v=tw(r,l,e);t_(r,v);break e;case 1:a=l;var E=r.type,w=r.stateNode;if(!(r.flags&128)&&(typeof E.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Lr===null||!Lr.has(w)))){r.flags|=65536,e&=-e,r.lanes|=e;var x=nw(r,a,e);t_(r,x);break e}}r=r.return}while(r!==null)}Ew(t)}catch(I){e=I,Xe===t&&t!==null&&(Xe=t=t.return);continue}break}while(!0)}function _w(){var n=qf.current;return qf.current=zf,n===null?zf:n}function Vv(){(st===0||st===3||st===2)&&(st=4),ft===null||!(pa&268435455)&&!(Fp&268435455)||Js(ft,St)}function Yf(n,e){var t=de;de|=2;var i=_w();(ft!==n||St!==e)&&(ji=null,ua(n,e));do try{yP();break}catch(s){vw(n,s)}while(!0);if(Ev(),de=t,qf.current=i,Xe!==null)throw Error(L(261));return ft=null,St=0,st}function yP(){for(;Xe!==null;)Aw(Xe)}function vP(){for(;Xe!==null&&!zx();)Aw(Xe)}function Aw(n){var e=ww(n.alternate,n,Tn);n.memoizedProps=n.pendingProps,e===null?Ew(n):Xe=e,Lv.current=null}function Ew(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=dP(t,e),t!==null){t.flags&=32767,Xe=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{st=6,Xe=null;return}}else if(t=cP(t,e,Tn),t!==null){Xe=t;return}if(e=e.sibling,e!==null){Xe=e;return}Xe=e=n}while(e!==null);st===0&&(st=5)}function Jr(n,e,t){var i=_e,s=Yn.transition;try{Yn.transition=null,_e=1,_P(n,e,t,i)}finally{Yn.transition=s,_e=i}return null}function _P(n,e,t,i){do ja();while(Pr!==null);if(de&6)throw Error(L(327));t=n.finishedWork;var s=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(L(177));n.callbackNode=null,n.callbackPriority=0;var r=t.lanes|t.childLanes;if(jx(n,r),n===ft&&(Xe=ft=null,St=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Ph||(Ph=!0,Cw(Pf,function(){return ja(),null})),r=(t.flags&15990)!==0,t.subtreeFlags&15990||r){r=Yn.transition,Yn.transition=null;var o=_e;_e=1;var a=de;de|=4,Lv.current=null,fP(n,t),gw(t,n),VI(im),Mf=!!nm,im=nm=null,n.current=t,pP(t),qx(),de=a,_e=o,Yn.transition=r}else n.current=t;if(Ph&&(Ph=!1,Pr=n,Wf=s),r=n.pendingLanes,r===0&&(Lr=null),Yx(t.stateNode),cn(n,$e()),e!==null)for(i=n.onRecoverableError,t=0;t<e.length;t++)s=e[t],i(s.value,{componentStack:s.stack,digest:s.digest});if($f)throw $f=!1,n=wm,wm=null,n;return Wf&1&&n.tag!==0&&ja(),r=n.pendingLanes,r&1?n===Cm?cc++:(cc=0,Cm=n):cc=0,$r(),null}function ja(){if(Pr!==null){var n=tS(Wf),e=Yn.transition,t=_e;try{if(Yn.transition=null,_e=16>n?16:n,Pr===null)var i=!1;else{if(n=Pr,Pr=null,Wf=0,de&6)throw Error(L(331));var s=de;for(de|=4,B=n.current;B!==null;){var r=B,o=r.child;if(B.flags&16){var a=r.deletions;if(a!==null){for(var l=0;l<a.length;l++){var u=a[l];for(B=u;B!==null;){var h=B;switch(h.tag){case 0:case 11:case 15:lc(8,h,r)}var p=h.child;if(p!==null)p.return=h,B=p;else for(;B!==null;){h=B;var g=h.sibling,m=h.return;if(hw(h),h===u){B=null;break}if(g!==null){g.return=m,B=g;break}B=m}}}var y=r.alternate;if(y!==null){var A=y.child;if(A!==null){y.child=null;do{var T=A.sibling;A.sibling=null,A=T}while(A!==null)}}B=r}}if(r.subtreeFlags&2064&&o!==null)o.return=r,B=o;else e:for(;B!==null;){if(r=B,r.flags&2048)switch(r.tag){case 0:case 11:case 15:lc(9,r,r.return)}var v=r.sibling;if(v!==null){v.return=r.return,B=v;break e}B=r.return}}var E=n.current;for(B=E;B!==null;){o=B;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,B=w;else e:for(o=E;B!==null;){if(a=B,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Dp(9,a)}}catch(I){Be(a,a.return,I)}if(a===o){B=null;break e}var x=a.sibling;if(x!==null){x.return=a.return,B=x;break e}B=a.return}}if(de=s,$r(),Wi&&typeof Wi.onPostCommitFiberRoot=="function")try{Wi.onPostCommitFiberRoot(Ip,n)}catch{}i=!0}return i}finally{_e=t,Yn.transition=e}}return!1}function S_(n,e,t){e=gu(t,e),e=tw(n,e,1),n=Nr(n,e,1),e=$t(),n!==null&&(oh(n,1,e),cn(n,e))}function Be(n,e,t){if(n.tag===3)S_(n,n,t);else for(;e!==null;){if(e.tag===3){S_(e,n,t);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(Lr===null||!Lr.has(i))){n=gu(t,n),n=nw(e,n,1),e=Nr(e,n,1),n=$t(),e!==null&&(oh(e,1,n),cn(e,n));break}}e=e.return}}function AP(n,e,t){var i=n.pingCache;i!==null&&i.delete(e),e=$t(),n.pingedLanes|=n.suspendedLanes&t,ft===n&&(St&t)===t&&(st===4||st===3&&(St&130023424)===St&&500>$e()-Fv?ua(n,0):Dv|=t),cn(n,e)}function Sw(n,e){e===0&&(n.mode&1?(e=vh,vh<<=1,!(vh&130023424)&&(vh=4194304)):e=1);var t=$t();n=Fs(n,e),n!==null&&(oh(n,e,t),cn(n,t))}function EP(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),Sw(n,t)}function SP(n,e){var t=0;switch(n.tag){case 13:var i=n.stateNode,s=n.memoizedState;s!==null&&(t=s.retryLane);break;case 19:i=n.stateNode;break;default:throw Error(L(314))}i!==null&&i.delete(e),Sw(n,t)}var ww;ww=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||ln.current)an=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return an=!1,uP(n,e,t);an=!!(n.flags&131072)}else an=!1,Ne&&e.flags&1048576&&IS(e,Uf,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Bh(n,e),n=e.pendingProps;var s=du(e,Ut.current);Za(e,t),s=Rv(null,e,i,n,s,t);var r=Mv();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,un(i)?(r=!0,Df(e)):r=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Cv(e),s.updater=Lp,e.stateNode=s,s._reactInternals=e,hm(e,i,n,t),e=gm(null,e,i,!0,r,t)):(e.tag=0,Ne&&r&&yv(e),qt(null,e,s,t),e=e.child),e;case 16:i=e.elementType;e:{switch(Bh(n,e),n=e.pendingProps,s=i._init,i=s(i._payload),e.type=i,s=e.tag=CP(i),n=ei(i,n),s){case 0:e=pm(null,e,i,n,t);break e;case 1:e=h_(null,e,i,n,t);break e;case 11:e=c_(null,e,i,n,t);break e;case 14:e=d_(null,e,i,ei(i.type,n),t);break e}throw Error(L(306,i,""))}return e;case 0:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:ei(i,s),pm(n,e,i,s,t);case 1:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:ei(i,s),h_(n,e,i,s,t);case 3:e:{if(ow(e),n===null)throw Error(L(387));i=e.pendingProps,r=e.memoizedState,s=r.element,NS(n,e),Gf(e,i,null,t);var o=e.memoizedState;if(i=o.element,r.isDehydrated)if(r={element:i,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=r,e.memoizedState=r,e.flags&256){s=gu(Error(L(423)),e),e=f_(n,e,i,t,s);break e}else if(i!==s){s=gu(Error(L(424)),e),e=f_(n,e,i,t,s);break e}else for(Pn=br(e.stateNode.containerInfo.firstChild),Rn=e,Ne=!0,gi=null,t=kS(e,null,i,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(hu(),i===s){e=Us(n,e,t);break e}qt(n,e,i,t)}e=e.child}return e;case 5:return LS(e),n===null&&um(e),i=e.type,s=e.pendingProps,r=n!==null?n.memoizedProps:null,o=s.children,sm(i,s)?o=null:r!==null&&sm(i,r)&&(e.flags|=32),rw(n,e),qt(n,e,o,t),e.child;case 6:return n===null&&um(e),null;case 13:return aw(n,e,t);case 4:return Tv(e,e.stateNode.containerInfo),i=e.pendingProps,n===null?e.child=fu(e,null,i,t):qt(n,e,i,t),e.child;case 11:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:ei(i,s),c_(n,e,i,s,t);case 7:return qt(n,e,e.pendingProps,t),e.child;case 8:return qt(n,e,e.pendingProps.children,t),e.child;case 12:return qt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(i=e.type._context,s=e.pendingProps,r=e.memoizedProps,o=s.value,Ce(Hf,i._currentValue),i._currentValue=o,r!==null)if(_i(r.value,o)){if(r.children===s.children&&!ln.current){e=Us(n,e,t);break e}}else for(r=e.child,r!==null&&(r.return=e);r!==null;){var a=r.dependencies;if(a!==null){o=r.child;for(var l=a.firstContext;l!==null;){if(l.context===i){if(r.tag===1){l=ks(-1,t&-t),l.tag=2;var u=r.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?l.next=l:(l.next=h.next,h.next=l),u.pending=l}}r.lanes|=t,l=r.alternate,l!==null&&(l.lanes|=t),cm(r.return,t,e),a.lanes|=t;break}l=l.next}}else if(r.tag===10)o=r.type===e.type?null:r.child;else if(r.tag===18){if(o=r.return,o===null)throw Error(L(341));o.lanes|=t,a=o.alternate,a!==null&&(a.lanes|=t),cm(o,t,e),o=r.sibling}else o=r.child;if(o!==null)o.return=r;else for(o=r;o!==null;){if(o===e){o=null;break}if(r=o.sibling,r!==null){r.return=o.return,o=r;break}o=o.return}r=o}qt(n,e,s.children,t),e=e.child}return e;case 9:return s=e.type,i=e.pendingProps.children,Za(e,t),s=Xn(s),i=i(s),e.flags|=1,qt(n,e,i,t),e.child;case 14:return i=e.type,s=ei(i,e.pendingProps),s=ei(i.type,s),d_(n,e,i,s,t);case 15:return iw(n,e,e.type,e.pendingProps,t);case 17:return i=e.type,s=e.pendingProps,s=e.elementType===i?s:ei(i,s),Bh(n,e),e.tag=1,un(i)?(n=!0,Df(e)):n=!1,Za(e,t),ew(e,i,s),hm(e,i,s,t),gm(null,e,i,!0,n,t);case 19:return lw(n,e,t);case 22:return sw(n,e,t)}throw Error(L(156,e.tag))};function Cw(n,e){return QE(n,e)}function wP(n,e,t,i){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Wn(n,e,t,i){return new wP(n,e,t,i)}function Gv(n){return n=n.prototype,!(!n||!n.isReactComponent)}function CP(n){if(typeof n=="function")return Gv(n)?1:0;if(n!=null){if(n=n.$$typeof,n===rv)return 11;if(n===ov)return 14}return 2}function Fr(n,e){var t=n.alternate;return t===null?(t=Wn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function $h(n,e,t,i,s,r){var o=2;if(i=n,typeof n=="function")Gv(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case La:return ca(t.children,s,r,e);case sv:o=8,s|=8;break;case Fg:return n=Wn(12,t,e,s|2),n.elementType=Fg,n.lanes=r,n;case Ug:return n=Wn(13,t,e,s),n.elementType=Ug,n.lanes=r,n;case Hg:return n=Wn(19,t,e,s),n.elementType=Hg,n.lanes=r,n;case LE:return Up(t,s,r,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case bE:o=10;break e;case NE:o=9;break e;case rv:o=11;break e;case ov:o=14;break e;case Ws:o=16,i=null;break e}throw Error(L(130,n==null?n:typeof n,""))}return e=Wn(o,t,e,s),e.elementType=n,e.type=i,e.lanes=r,e}function ca(n,e,t,i){return n=Wn(7,n,i,e),n.lanes=t,n}function Up(n,e,t,i){return n=Wn(22,n,i,e),n.elementType=LE,n.lanes=t,n.stateNode={isHidden:!1},n}function Tg(n,e,t){return n=Wn(6,n,null,e),n.lanes=t,n}function xg(n,e,t){return e=Wn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function TP(n,e,t,i,s){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=og(0),this.expirationTimes=og(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=og(0),this.identifierPrefix=i,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Ov(n,e,t,i,s,r,o,a,l){return n=new TP(n,e,t,a,l),e===1?(e=1,r===!0&&(e|=8)):e=0,r=Wn(3,null,null,e),n.current=r,r.stateNode=n,r.memoizedState={element:i,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Cv(r),n}function xP(n,e,t){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Na,key:i==null?null:""+i,children:n,containerInfo:e,implementation:t}}function Tw(n){if(!n)return Vr;n=n._reactInternals;e:{if(Ea(n)!==n||n.tag!==1)throw Error(L(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(un(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(L(171))}if(n.tag===1){var t=n.type;if(un(t))return TS(n,t,e)}return e}function xw(n,e,t,i,s,r,o,a,l){return n=Ov(t,i,!0,n,s,r,o,a,l),n.context=Tw(null),t=n.current,i=$t(),s=Dr(t),r=ks(i,s),r.callback=e??null,Nr(t,r,s),n.current.lanes=s,oh(n,s,i),cn(n,i),n}function Hp(n,e,t,i){var s=e.current,r=$t(),o=Dr(s);return t=Tw(t),e.context===null?e.context=t:e.pendingContext=t,e=ks(r,o),e.payload={element:n},i=i===void 0?null:i,i!==null&&(e.callback=i),n=Nr(s,e,o),n!==null&&(vi(n,s,o,r),Vh(n,s,o)),o}function Kf(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function w_(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Bv(n,e){w_(n,e),(n=n.alternate)&&w_(n,e)}function IP(){return null}var Iw=typeof reportError=="function"?reportError:function(n){console.error(n)};function zv(n){this._internalRoot=n}Vp.prototype.render=zv.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(L(409));Hp(n,e,null,null)};Vp.prototype.unmount=zv.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;ga(function(){Hp(null,n,null,null)}),e[Ds]=null}};function Vp(n){this._internalRoot=n}Vp.prototype.unstable_scheduleHydration=function(n){if(n){var e=sS();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Ks.length&&e!==0&&e<Ks[t].priority;t++);Ks.splice(t,0,n),t===0&&oS(n)}};function qv(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function Gp(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function C_(){}function PP(n,e,t,i,s){if(s){if(typeof i=="function"){var r=i;i=function(){var u=Kf(o);r.call(u)}}var o=xw(e,i,n,0,null,!1,!1,"",C_);return n._reactRootContainer=o,n[Ds]=o.current,Sc(n.nodeType===8?n.parentNode:n),ga(),o}for(;s=n.lastChild;)n.removeChild(s);if(typeof i=="function"){var a=i;i=function(){var u=Kf(l);a.call(u)}}var l=Ov(n,0,!1,null,null,!1,!1,"",C_);return n._reactRootContainer=l,n[Ds]=l.current,Sc(n.nodeType===8?n.parentNode:n),ga(function(){Hp(e,l,t,i)}),l}function Op(n,e,t,i,s){var r=t._reactRootContainer;if(r){var o=r;if(typeof s=="function"){var a=s;s=function(){var l=Kf(o);a.call(l)}}Hp(e,o,n,s)}else o=PP(t,e,n,s,i);return Kf(o)}nS=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Hu(e.pendingLanes);t!==0&&(uv(e,t|1),cn(e,$e()),!(de&6)&&(mu=$e()+500,$r()))}break;case 13:ga(function(){var i=Fs(n,1);if(i!==null){var s=$t();vi(i,n,1,s)}}),Bv(n,1)}};cv=function(n){if(n.tag===13){var e=Fs(n,134217728);if(e!==null){var t=$t();vi(e,n,134217728,t)}Bv(n,134217728)}};iS=function(n){if(n.tag===13){var e=Dr(n),t=Fs(n,e);if(t!==null){var i=$t();vi(t,n,e,i)}Bv(n,e)}};sS=function(){return _e};rS=function(n,e){var t=_e;try{return _e=n,e()}finally{_e=t}};Kg=function(n,e,t){switch(e){case"input":if(Og(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var i=t[e];if(i!==n&&i.form===n.form){var s=kp(i);if(!s)throw Error(L(90));FE(i),Og(i,s)}}}break;case"textarea":HE(n,t);break;case"select":e=t.value,e!=null&&Ka(n,!!t.multiple,e,!1)}};$E=Uv;WE=ga;var RP={usingClientEntryPoint:!1,Events:[lh,Ha,kp,zE,qE,Uv]},Mu={findFiberByHostInstance:to,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},MP={bundleType:Mu.bundleType,version:Mu.version,rendererPackageName:Mu.rendererPackageName,rendererConfig:Mu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Os.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=JE(n),n===null?null:n.stateNode},findFiberByHostInstance:Mu.findFiberByHostInstance||IP,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rh.isDisabled&&Rh.supportsFiber)try{Ip=Rh.inject(MP),Wi=Rh}catch{}}bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=RP;bn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!qv(e))throw Error(L(200));return xP(n,e,null,t)};bn.createRoot=function(n,e){if(!qv(n))throw Error(L(299));var t=!1,i="",s=Iw;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Ov(n,1,!1,null,null,t,!1,i,s),n[Ds]=e.current,Sc(n.nodeType===8?n.parentNode:n),new zv(e)};bn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(L(188)):(n=Object.keys(n).join(","),Error(L(268,n)));return n=JE(e),n=n===null?null:n.stateNode,n};bn.flushSync=function(n){return ga(n)};bn.hydrate=function(n,e,t){if(!Gp(e))throw Error(L(200));return Op(null,n,e,!0,t)};bn.hydrateRoot=function(n,e,t){if(!qv(n))throw Error(L(405));var i=t!=null&&t.hydratedSources||null,s=!1,r="",o=Iw;if(t!=null&&(t.unstable_strictMode===!0&&(s=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=xw(e,null,n,1,t??null,s,!1,r,o),n[Ds]=e.current,Sc(n),i)for(n=0;n<i.length;n++)t=i[n],s=t._getVersion,s=s(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,s]:e.mutableSourceEagerHydrationData.push(t,s);return new Vp(e)};bn.render=function(n,e,t){if(!Gp(e))throw Error(L(200));return Op(null,n,e,!1,t)};bn.unmountComponentAtNode=function(n){if(!Gp(n))throw Error(L(40));return n._reactRootContainer?(ga(function(){Op(null,null,n,!1,function(){n._reactRootContainer=null,n[Ds]=null})}),!0):!1};bn.unstable_batchedUpdates=Uv;bn.unstable_renderSubtreeIntoContainer=function(n,e,t,i){if(!Gp(t))throw Error(L(200));if(n==null||n._reactInternals===void 0)throw Error(L(38));return Op(n,e,t,!1,i)};bn.version="18.3.1-next-f1338f8080-20240426";function Pw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Pw)}catch(n){console.error(n)}}Pw(),PE.exports=bn;var kP=PE.exports,T_=kP;Lg.createRoot=T_.createRoot,Lg.hydrateRoot=T_.hydrateRoot;var Im=(n=>(n.Basic="Base",n.Intermediate="Intermedio",n.Advanced="Avanzato",n))(Im||{}),wn=(n=>(n.TrueFalse="true_false",n.MultipleChoice="multiple_choice",n.Basic="basic",n))(wn||{}),dc={};dc.d=(n,e)=>{for(var t in e)dc.o(e,t)&&!dc.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:e[t]})};dc.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e);var Z=globalThis.pdfjsLib={};dc.d(Z,{AbortException:()=>Gr,AnnotationEditorLayer:()=>Fy,AnnotationEditorParamsType:()=>ue,AnnotationEditorType:()=>ee,AnnotationEditorUIManager:()=>ya,AnnotationLayer:()=>xM,AnnotationMode:()=>Xs,ColorPicker:()=>ep,DOMSVGFactory:()=>jv,DrawLayer:()=>Vy,FeatureTest:()=>Wt,GlobalWorkerOptions:()=>Ps,ImageKind:()=>Wh,InvalidPDFException:()=>Rm,MissingPDFException:()=>kc,OPS:()=>ti,OutputScale:()=>km,PDFDataRangeTransport:()=>MC,PDFDateString:()=>Jv,PDFWorker:()=>tl,PasswordResponses:()=>DP,PermissionFlag:()=>LP,PixelsPerInch:()=>Or,RenderingCancelledException:()=>Yv,TextLayer:()=>bc,TouchManager:()=>Zf,UnexpectedResponseException:()=>Jf,Util:()=>W,VerbosityLevel:()=>Bp,XfaLayer:()=>bC,build:()=>oM,createValidAbsoluteUrl:()=>VP,fetchData:()=>Wp,getDocument:()=>QR,getFilenameFromUrl:()=>KP,getPdfFilenameFromUrl:()=>JP,getXfaPageViewport:()=>XP,isDataScheme:()=>Yp,isPdfFile:()=>Kv,noContextMenu:()=>Ai,normalizeUnicode:()=>$P,setLayerDimensions:()=>ma,shadow:()=>re,stopEvent:()=>In,version:()=>rM});const Dt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Rw=[1,0,0,1,0,0],Pm=[.001,0,0,.001,0,0],bP=1e7,Ig=1.35,Cn={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Xs={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},NP="pdfjs_internal_editor_",ee={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15},ue={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_DEFAULT_COLOR:32,HIGHLIGHT_THICKNESS:33,HIGHLIGHT_FREE:34,HIGHLIGHT_SHOW_ALL:35,DRAW_STEP:41},LP={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},xt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Wh={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},je={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,WIDGET:20},ku={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Bp={ERRORS:0,WARNINGS:1,INFOS:5},ti={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93},DP={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let zp=Bp.WARNINGS;function FP(n){Number.isInteger(n)&&(zp=n)}function UP(){return zp}function qp(n){zp>=Bp.INFOS&&console.log(`Info: ${n}`)}function te(n){zp>=Bp.WARNINGS&&console.log(`Warning: ${n}`)}function Se(n){throw new Error(n)}function Qe(n,e){n||Se(e)}function HP(n){switch(n==null?void 0:n.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function VP(n,e=null,t=null){if(!n)return null;try{if(t&&typeof n=="string"){if(t.addDefaultProtocol&&n.startsWith("www.")){const s=n.match(/\./g);(s==null?void 0:s.length)>=2&&(n=`http://${n}`)}if(t.tryConvertEncoding)try{n=qP(n)}catch{}}const i=e?new URL(n,e):new URL(n);if(HP(i))return i}catch{}return null}function re(n,e,t,i=!1){return Object.defineProperty(n,e,{value:t,enumerable:!i,configurable:!0,writable:!1}),t}const Wr=function(){function e(t,i){this.message=t,this.name=i}return e.prototype=new Error,e.constructor=e,e}();class x_ extends Wr{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Pg extends Wr{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class Rm extends Wr{constructor(e){super(e,"InvalidPDFException")}}class kc extends Wr{constructor(e){super(e,"MissingPDFException")}}class Jf extends Wr{constructor(e,t){super(e,"UnexpectedResponseException"),this.status=t}}class GP extends Wr{constructor(e){super(e,"FormatError")}}class Gr extends Wr{constructor(e){super(e,"AbortException")}}function Mw(n){(typeof n!="object"||(n==null?void 0:n.length)===void 0)&&Se("Invalid argument for bytesToString");const e=n.length,t=8192;if(e<t)return String.fromCharCode.apply(null,n);const i=[];for(let s=0;s<e;s+=t){const r=Math.min(s+t,e),o=n.subarray(s,r);i.push(String.fromCharCode.apply(null,o))}return i.join("")}function $p(n){typeof n!="string"&&Se("Invalid argument for stringToBytes");const e=n.length,t=new Uint8Array(e);for(let i=0;i<e;++i)t[i]=n.charCodeAt(i)&255;return t}function OP(n){return String.fromCharCode(n>>24&255,n>>16&255,n>>8&255,n&255)}function $v(n){const e=Object.create(null);for(const[t,i]of n)e[t]=i;return e}function BP(){const n=new Uint8Array(4);return n[0]=1,new Uint32Array(n.buffer,0,1)[0]===1}function zP(){try{return new Function(""),!0}catch{return!1}}class Wt{static get isLittleEndian(){return re(this,"isLittleEndian",BP())}static get isEvalSupported(){return re(this,"isEvalSupported",zP())}static get isOffscreenCanvasSupported(){return re(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return re(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){return typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.platform)=="string"?re(this,"platform",{isMac:navigator.platform.includes("Mac"),isWindows:navigator.platform.includes("Win"),isFirefox:typeof(navigator==null?void 0:navigator.userAgent)=="string"&&navigator.userAgent.includes("Firefox")}):re(this,"platform",{isMac:!1,isWindows:!1,isFirefox:!1})}static get isCSSRoundSupported(){var e,t;return re(this,"isCSSRoundSupported",(t=(e=globalThis.CSS)==null?void 0:e.supports)==null?void 0:t.call(e,"width: round(1.5px, 1px)"))}}const Rg=Array.from(Array(256).keys(),n=>n.toString(16).padStart(2,"0"));var bs,Yh,Mm;class W{static makeHexColor(e,t,i){return`#${Rg[e]}${Rg[t]}${Rg[i]}`}static scaleMinMax(e,t){let i;e[0]?(e[0]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[3],t[3]*=e[3]):(i=t[0],t[0]=t[1],t[1]=i,i=t[2],t[2]=t[3],t[3]=i,e[1]<0&&(i=t[1],t[1]=t[3],t[3]=i),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(i=t[0],t[0]=t[2],t[2]=i),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static applyTransform(e,t){const i=e[0]*t[0]+e[1]*t[2]+t[4],s=e[0]*t[1]+e[1]*t[3]+t[5];return[i,s]}static applyInverseTransform(e,t){const i=t[0]*t[3]-t[1]*t[2],s=(e[0]*t[3]-e[1]*t[2]+t[2]*t[5]-t[4]*t[3])/i,r=(-e[0]*t[1]+e[1]*t[0]+t[4]*t[1]-t[5]*t[0])/i;return[s,r]}static getAxialAlignedBoundingBox(e,t){const i=this.applyTransform(e,t),s=this.applyTransform(e.slice(2,4),t),r=this.applyTransform([e[0],e[3]],t),o=this.applyTransform([e[2],e[1]],t);return[Math.min(i[0],s[0],r[0],o[0]),Math.min(i[1],s[1],r[1],o[1]),Math.max(i[0],s[0],r[0],o[0]),Math.max(i[1],s[1],r[1],o[1])]}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e){const t=[e[0],e[2],e[1],e[3]],i=e[0]*t[0]+e[1]*t[2],s=e[0]*t[1]+e[1]*t[3],r=e[2]*t[0]+e[3]*t[2],o=e[2]*t[1]+e[3]*t[3],a=(i+o)/2,l=Math.sqrt((i+o)**2-4*(i*o-r*s))/2,u=a+l||1,h=a-l||1;return[Math.sqrt(u),Math.sqrt(h)]}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const i=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(i>s)return null;const r=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),o=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return r>o?null:[i,r,s,o]}static bezierBoundingBox(e,t,i,s,r,o,a,l,u){return u?(u[0]=Math.min(u[0],e,a),u[1]=Math.min(u[1],t,l),u[2]=Math.max(u[2],e,a),u[3]=Math.max(u[3],t,l)):u=[Math.min(e,a),Math.min(t,l),Math.max(e,a),Math.max(t,l)],C(this,bs,Mm).call(this,e,i,r,a,t,s,o,l,3*(-e+3*(i-r)+a),6*(e-2*i+r),3*(i-e),u),C(this,bs,Mm).call(this,e,i,r,a,t,s,o,l,3*(-t+3*(s-o)+l),6*(t-2*s+o),3*(s-t),u),u}}bs=new WeakSet,Yh=function(e,t,i,s,r,o,a,l,u,h){if(u<=0||u>=1)return;const p=1-u,g=u*u,m=g*u,y=p*(p*(p*e+3*u*t)+3*g*i)+m*s,A=p*(p*(p*r+3*u*o)+3*g*a)+m*l;h[0]=Math.min(h[0],y),h[1]=Math.min(h[1],A),h[2]=Math.max(h[2],y),h[3]=Math.max(h[3],A)},Mm=function(e,t,i,s,r,o,a,l,u,h,p,g){if(Math.abs(u)<1e-12){Math.abs(h)>=1e-12&&C(this,bs,Yh).call(this,e,t,i,s,r,o,a,l,-p/h,g);return}const m=h**2-4*p*u;if(m<0)return;const y=Math.sqrt(m),A=2*u;C(this,bs,Yh).call(this,e,t,i,s,r,o,a,l,(-h+y)/A,g),C(this,bs,Yh).call(this,e,t,i,s,r,o,a,l,(-h-y)/A,g)},S(W,bs);function qP(n){return decodeURIComponent(escape(n))}let Mg=null,I_=null;function $P(n){return Mg||(Mg=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,I_=new Map([["","t"]])),n.replaceAll(Mg,(e,t,i)=>t?t.normalize("NFKC"):I_.get(i))}function WP(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const n=new Uint8Array(32);return crypto.getRandomValues(n),Mw(n)}const Wv="pdfjs_internal_id_";function YP(n){return Uint8Array.prototype.toBase64?n.toBase64():btoa(Mw(n))}typeof Promise.try!="function"&&(Promise.try=function(n,...e){return new Promise(t=>{t(n(...e))})});const Xi="http://www.w3.org/2000/svg",jr=class jr{};J(jr,"CSS",96),J(jr,"PDF",72),J(jr,"PDF_TO_CSS_UNITS",jr.CSS/jr.PDF);let Or=jr;async function Wp(n,e="text"){if(Gu(n,document.baseURI)){const t=await fetch(n);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,i)=>{const s=new XMLHttpRequest;s.open("GET",n,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}i(new Error(s.statusText))}},s.send(null)})}class ch{constructor({viewBox:e,userUnit:t,scale:i,rotation:s,offsetX:r=0,offsetY:o=0,dontFlip:a=!1}){this.viewBox=e,this.userUnit=t,this.scale=i,this.rotation=s,this.offsetX=r,this.offsetY=o,i*=t;const l=(e[2]+e[0])/2,u=(e[3]+e[1])/2;let h,p,g,m;switch(s%=360,s<0&&(s+=360),s){case 180:h=-1,p=0,g=0,m=1;break;case 90:h=0,p=1,g=1,m=0;break;case 270:h=0,p=-1,g=-1,m=0;break;case 0:h=1,p=0,g=0,m=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}a&&(g=-g,m=-m);let y,A,T,v;h===0?(y=Math.abs(u-e[1])*i+r,A=Math.abs(l-e[0])*i+o,T=(e[3]-e[1])*i,v=(e[2]-e[0])*i):(y=Math.abs(l-e[0])*i+r,A=Math.abs(u-e[1])*i+o,T=(e[2]-e[0])*i,v=(e[3]-e[1])*i),this.transform=[h*i,p*i,g*i,m*i,y-h*i*l-g*i*u,A-p*i*l-m*i*u],this.width=T,this.height=v}get rawDims(){const{userUnit:e,viewBox:t}=this,i=t.map(s=>s*e);return re(this,"rawDims",{pageWidth:i[2]-i[0],pageHeight:i[3]-i[1],pageX:i[0],pageY:i[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:i=this.offsetX,offsetY:s=this.offsetY,dontFlip:r=!1}={}){return new ch({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}convertToViewportPoint(e,t){return W.applyTransform([e,t],this.transform)}convertToViewportRectangle(e){const t=W.applyTransform([e[0],e[1]],this.transform),i=W.applyTransform([e[2],e[3]],this.transform);return[t[0],t[1],i[0],i[1]]}convertToPdfPoint(e,t){return W.applyInverseTransform([e,t],this.transform)}}class Yv extends Wr{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Yp(n){const e=n.length;let t=0;for(;t<e&&n[t].trim()==="";)t++;return n.substring(t,t+5).toLowerCase()==="data:"}function Kv(n){return typeof n=="string"&&/\.pdf$/i.test(n)}function KP(n){return[n]=n.split(/[#?]/,1),n.substring(n.lastIndexOf("/")+1)}function JP(n,e="document.pdf"){if(typeof n!="string")return e;if(Yp(n))return te('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const t=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,i=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,s=t.exec(n);let r=i.exec(s[1])||i.exec(s[2])||i.exec(s[3]);if(r&&(r=r[0],r.includes("%")))try{r=i.exec(decodeURIComponent(r))[0]}catch{}return r||e}class P_{constructor(){J(this,"started",Object.create(null));J(this,"times",[])}time(e){e in this.started&&te(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||te(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:i}of this.times)t=Math.max(i.length,t);for(const{name:i,start:s,end:r}of this.times)e.push(`${i.padEnd(t)} ${r-s}ms
`);return e.join("")}}function Gu(n,e){try{const{protocol:t}=e?new URL(n,e):new URL(n);return t==="http:"||t==="https:"}catch{return!1}}function Ai(n){n.preventDefault()}function In(n){n.preventDefault(),n.stopPropagation()}var Lc;class Jv{static toDateObject(e){if(!e||typeof e!="string")return null;c(this,Lc)||_(this,Lc,new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?"));const t=c(this,Lc).exec(e);if(!t)return null;const i=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let r=parseInt(t[3],10);r=r>=1&&r<=31?r:1;let o=parseInt(t[4],10);o=o>=0&&o<=23?o:0;let a=parseInt(t[5],10);a=a>=0&&a<=59?a:0;let l=parseInt(t[6],10);l=l>=0&&l<=59?l:0;const u=t[7]||"Z";let h=parseInt(t[8],10);h=h>=0&&h<=23?h:0;let p=parseInt(t[9],10)||0;return p=p>=0&&p<=59?p:0,u==="-"?(o+=h,a+=p):u==="+"&&(o-=h,a-=p),new Date(Date.UTC(i,s,r,o,a,l))}}Lc=new WeakMap,S(Jv,Lc);function XP(n,{scale:e=1,rotation:t=0}){const{width:i,height:s}=n.attributes.style,r=[0,0,parseInt(i),parseInt(s)];return new ch({viewBox:r,userUnit:1,scale:e,rotation:t})}function Xv(n){if(n.startsWith("#")){const e=parseInt(n.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return n.startsWith("rgb(")?n.slice(4,-1).split(",").map(e=>parseInt(e)):n.startsWith("rgba(")?n.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(te(`Not a valid color format: "${n}"`),[0,0,0])}function QP(n){const e=document.createElement("span");e.style.visibility="hidden",document.body.append(e);for(const t of n.keys()){e.style.color=t;const i=window.getComputedStyle(e).color;n.set(t,Xv(i))}e.remove()}function ke(n){const{a:e,b:t,c:i,d:s,e:r,f:o}=n.getTransform();return[e,t,i,s,r,o]}function Ci(n){const{a:e,b:t,c:i,d:s,e:r,f:o}=n.getTransform().invertSelf();return[e,t,i,s,r,o]}function ma(n,e,t=!1,i=!0){if(e instanceof ch){const{pageWidth:s,pageHeight:r}=e.rawDims,{style:o}=n,a=Wt.isCSSRoundSupported,l=`var(--scale-factor) * ${s}px`,u=`var(--scale-factor) * ${r}px`,h=a?`round(down, ${l}, var(--scale-round-x, 1px))`:`calc(${l})`,p=a?`round(down, ${u}, var(--scale-round-y, 1px))`:`calc(${u})`;!t||e.rotation%180===0?(o.width=h,o.height=p):(o.width=p,o.height=h)}i&&n.setAttribute("data-main-rotation",e.rotation)}class km{constructor(){const e=window.devicePixelRatio||1;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}}var Qs,so,ni,ro,Dc,Fc,ap,kw,Yt,bw,Nw,Kh,Lw,Nm;const es=class es{constructor(e){S(this,Yt);S(this,Qs,null);S(this,so,null);S(this,ni);S(this,ro,null);S(this,Dc,null);_(this,ni,e),c(es,Fc)||_(es,Fc,Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button"}))}render(){const e=_(this,Qs,document.createElement("div"));e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=c(this,ni)._uiManager._signal;e.addEventListener("contextmenu",Ai,{signal:t}),e.addEventListener("pointerdown",C(es,ap,kw),{signal:t});const i=_(this,ro,document.createElement("div"));i.className="buttons",e.append(i);const s=c(this,ni).toolbarPosition;if(s){const{style:r}=e,o=c(this,ni)._uiManager.direction==="ltr"?1-s[0]:s[0];r.insetInlineEnd=`${100*o}%`,r.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return C(this,Yt,Lw).call(this),e}get div(){return c(this,Qs)}hide(){var e;c(this,Qs).classList.add("hidden"),(e=c(this,so))==null||e.hideDropdown()}show(){var e;c(this,Qs).classList.remove("hidden"),(e=c(this,Dc))==null||e.shown()}async addAltText(e){const t=await e.render();C(this,Yt,Kh).call(this,t),c(this,ro).prepend(t,c(this,Yt,Nm)),_(this,Dc,e)}addColorPicker(e){_(this,so,e);const t=e.renderButton();C(this,Yt,Kh).call(this,t),c(this,ro).prepend(t,c(this,Yt,Nm))}remove(){var e;c(this,Qs).remove(),(e=c(this,so))==null||e.destroy(),_(this,so,null)}};Qs=new WeakMap,so=new WeakMap,ni=new WeakMap,ro=new WeakMap,Dc=new WeakMap,Fc=new WeakMap,ap=new WeakSet,kw=function(e){e.stopPropagation()},Yt=new WeakSet,bw=function(e){c(this,ni)._focusEventsAllowed=!1,In(e)},Nw=function(e){c(this,ni)._focusEventsAllowed=!0,In(e)},Kh=function(e){const t=c(this,ni)._uiManager._signal;e.addEventListener("focusin",C(this,Yt,bw).bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",C(this,Yt,Nw).bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",Ai,{signal:t})},Lw=function(){const{editorType:e,_uiManager:t}=c(this,ni),i=document.createElement("button");i.className="delete",i.tabIndex=0,i.setAttribute("data-l10n-id",c(es,Fc)[e]),C(this,Yt,Kh).call(this,i),i.addEventListener("click",s=>{t.delete()},{signal:t._signal}),c(this,ro).append(i)},Nm=function(){const e=document.createElement("div");return e.className="divider",e},S(es,ap),S(es,Fc,null);let bm=es;var Uc,oo,ao,Br,Dw,Fw,Uw;class ZP{constructor(e){S(this,Br);S(this,Uc,null);S(this,oo,null);S(this,ao);_(this,ao,e)}show(e,t,i){const[s,r]=C(this,Br,Fw).call(this,t,i),{style:o}=c(this,oo)||_(this,oo,C(this,Br,Dw).call(this));e.append(c(this,oo)),o.insetInlineEnd=`${100*s}%`,o.top=`calc(${100*r}% + var(--editor-toolbar-vert-offset))`}hide(){c(this,oo).remove()}}Uc=new WeakMap,oo=new WeakMap,ao=new WeakMap,Br=new WeakSet,Dw=function(){const e=_(this,oo,document.createElement("div"));e.className="editToolbar",e.setAttribute("role","toolbar"),e.addEventListener("contextmenu",Ai,{signal:c(this,ao)._signal});const t=_(this,Uc,document.createElement("div"));return t.className="buttons",e.append(t),C(this,Br,Uw).call(this),e},Fw=function(e,t){let i=0,s=0;for(const r of e){const o=r.y+r.height;if(o<i)continue;const a=r.x+(t?r.width:0);if(o>i){s=a,i=o;continue}t?a>s&&(s=a):a<s&&(s=a)}return[t?1-s:s,i]},Uw=function(){const e=document.createElement("button");e.className="highlightButton",e.tabIndex=0,e.setAttribute("data-l10n-id","pdfjs-highlight-floating-button1");const t=document.createElement("span");e.append(t),t.className="visuallyHidden",t.setAttribute("data-l10n-id","pdfjs-highlight-floating-button-label");const i=c(this,ao)._signal;e.addEventListener("contextmenu",Ai,{signal:i}),e.addEventListener("click",()=>{c(this,ao).highlightSelection("floating_button")},{signal:i}),c(this,Uc).append(e)};function Xf(n,e,t){for(const i of t)e.addEventListener(i,n[i].bind(n))}var lp;class jP{constructor(){S(this,lp,0)}get id(){return`${NP}${Ht(this,lp)._++}`}}lp=new WeakMap;var rl,Hc,Rt,ol,Jh;const u0=class u0{constructor(){S(this,ol);S(this,rl,WP());S(this,Hc,0);S(this,Rt,null)}static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const r=s.decode().then(()=>(i.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return re(this,"_isSVGFittingCanvas",r)}async getFromFile(e){const{lastModified:t,name:i,size:s,type:r}=e;return C(this,ol,Jh).call(this,`${t}_${i}_${s}_${r}`,e)}async getFromUrl(e){return C(this,ol,Jh).call(this,e,e)}async getFromBlob(e,t){const i=await t;return C(this,ol,Jh).call(this,e,i)}async getFromId(e){c(this,Rt)||_(this,Rt,new Map);const t=c(this,Rt).get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:i}=t;return delete t.blobPromise,this.getFromBlob(t.id,i)}return this.getFromUrl(t.url)}getFromCanvas(e,t){c(this,Rt)||_(this,Rt,new Map);let i=c(this,Rt).get(e);if(i!=null&&i.bitmap)return i.refCounter+=1,i;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),i={bitmap:s.transferToImageBitmap(),id:`image_${c(this,rl)}_${Ht(this,Hc)._++}`,refCounter:1,isSvg:!1},c(this,Rt).set(e,i),c(this,Rt).set(i.id,i),i}getSvgUrl(e){const t=c(this,Rt).get(e);return t!=null&&t.isSvg?t.svgUrl:null}deleteId(e){var s;c(this,Rt)||_(this,Rt,new Map);const t=c(this,Rt).get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:i}=t;if(!t.url&&!t.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),t.blobPromise=r.convertToBlob()}(s=i.close)==null||s.call(i),t.bitmap=null}isValidId(e){return e.startsWith(`image_${c(this,rl)}_`)}};rl=new WeakMap,Hc=new WeakMap,Rt=new WeakMap,ol=new WeakSet,Jh=async function(e,t){c(this,Rt)||_(this,Rt,new Map);let i=c(this,Rt).get(e);if(i===null)return null;if(i!=null&&i.bitmap)return i.refCounter+=1,i;try{i||(i={bitmap:null,id:`image_${c(this,rl)}_${Ht(this,Hc)._++}`,refCounter:0,isSvg:!1});let s;if(typeof t=="string"?(i.url=t,s=await Wp(t,"blob")):t instanceof File?s=i.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const r=u0._isSVGFittingCanvas,o=new FileReader,a=new Image,l=new Promise((u,h)=>{a.onload=()=>{i.bitmap=a,i.isSvg=!0,u()},o.onload=async()=>{const p=i.svgUrl=o.result;a.src=await r?`${p}#svgView(preserveAspectRatio(none))`:p},a.onerror=o.onerror=h});o.readAsDataURL(s),await l}else i.bitmap=await createImageBitmap(s);i.refCounter=1}catch(s){te(s),i=null}return c(this,Rt).set(e,i),i&&c(this,Rt).set(i.id,i),i};let Lm=u0;var ze,Zs,Vc,Le;class eR{constructor(e=128){S(this,ze,[]);S(this,Zs,!1);S(this,Vc);S(this,Le,-1);_(this,Vc,e)}add({cmd:e,undo:t,post:i,mustExec:s,type:r=NaN,overwriteIfSameType:o=!1,keepUndo:a=!1}){if(s&&e(),c(this,Zs))return;const l={cmd:e,undo:t,post:i,type:r};if(c(this,Le)===-1){c(this,ze).length>0&&(c(this,ze).length=0),_(this,Le,0),c(this,ze).push(l);return}if(o&&c(this,ze)[c(this,Le)].type===r){a&&(l.undo=c(this,ze)[c(this,Le)].undo),c(this,ze)[c(this,Le)]=l;return}const u=c(this,Le)+1;u===c(this,Vc)?c(this,ze).splice(0,1):(_(this,Le,u),u<c(this,ze).length&&c(this,ze).splice(u)),c(this,ze).push(l)}undo(){if(c(this,Le)===-1)return;_(this,Zs,!0);const{undo:e,post:t}=c(this,ze)[c(this,Le)];e(),t==null||t(),_(this,Zs,!1),_(this,Le,c(this,Le)-1)}redo(){if(c(this,Le)<c(this,ze).length-1){_(this,Le,c(this,Le)+1),_(this,Zs,!0);const{cmd:e,post:t}=c(this,ze)[c(this,Le)];e(),t==null||t(),_(this,Zs,!1)}}hasSomethingToUndo(){return c(this,Le)!==-1}hasSomethingToRedo(){return c(this,Le)<c(this,ze).length-1}cleanType(e){if(c(this,Le)!==-1){for(let t=c(this,Le);t>=0;t--)if(c(this,ze)[t].type!==e){c(this,ze).splice(t+1,c(this,Le)-t),_(this,Le,t);return}c(this,ze).length=0,_(this,Le,-1)}}destroy(){_(this,ze,null)}}ze=new WeakMap,Zs=new WeakMap,Vc=new WeakMap,Le=new WeakMap;var up,Hw;class dh{constructor(e){S(this,up);this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=Wt.platform;for(const[i,s,r={}]of e)for(const o of i){const a=o.startsWith("mac+");t&&a?(this.callbacks.set(o.slice(4),{callback:s,options:r}),this.allKeys.add(o.split("+").at(-1))):!t&&!a&&(this.callbacks.set(o,{callback:s,options:r}),this.allKeys.add(o.split("+").at(-1)))}}exec(e,t){if(!this.allKeys.has(t.key))return;const i=this.callbacks.get(C(this,up,Hw).call(this,t));if(!i)return;const{callback:s,options:{bubbles:r=!1,args:o=[],checker:a=null}}=i;a&&!a(e,t)||(s.bind(e,...o,t)(),r||In(t))}}up=new WeakSet,Hw=function(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t};const cp=class cp{get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return QP(e),re(this,"_colors",e)}convert(e){const t=Xv(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[i,s]of this._colors)if(s.every((r,o)=>r===t[o]))return cp._colorsMapping.get(i);return t}getHexCode(e){const t=this._colors.get(e);return t?W.makeHexColor(...t):e}};J(cp,"_colorsMapping",new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]));let Dm=cp;var al,dn,tt,pt,ll,is,ul,Dn,js,lo,cl,uo,Pi,ii,co,Gc,Oc,dl,Bc,Ri,er,hl,tr,Mi,dp,nr,zc,ir,ho,qc,$c,ot,ye,ss,fo,Wc,Yc,sr,ki,rs,Kc,Fn,H,Xh,Fm,Vw,Gw,Qh,Ow,Bw,zw,Um,qw,Hm,Vm,$w,Vt,Qi,Ww,Yw,Gm,Kw,Ou,Om;const Wa=class Wa{constructor(e,t,i,s,r,o,a,l,u,h,p,g,m){S(this,H);S(this,al,new AbortController);S(this,dn,null);S(this,tt,new Map);S(this,pt,new Map);S(this,ll,null);S(this,is,null);S(this,ul,null);S(this,Dn,new eR);S(this,js,null);S(this,lo,null);S(this,cl,0);S(this,uo,new Set);S(this,Pi,null);S(this,ii,null);S(this,co,new Set);J(this,"_editorUndoBar",null);S(this,Gc,!1);S(this,Oc,!1);S(this,dl,!1);S(this,Bc,null);S(this,Ri,null);S(this,er,null);S(this,hl,null);S(this,tr,!1);S(this,Mi,null);S(this,dp,new jP);S(this,nr,!1);S(this,zc,!1);S(this,ir,null);S(this,ho,null);S(this,qc,null);S(this,$c,null);S(this,ot,ee.NONE);S(this,ye,new Set);S(this,ss,null);S(this,fo,null);S(this,Wc,null);S(this,Yc,{isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1});S(this,sr,[0,0]);S(this,ki,null);S(this,rs,null);S(this,Kc,null);S(this,Fn,null);const y=this._signal=c(this,al).signal;_(this,rs,e),_(this,Kc,t),_(this,ll,i),this._eventBus=s,s._on("editingaction",this.onEditingAction.bind(this),{signal:y}),s._on("pagechanging",this.onPageChanging.bind(this),{signal:y}),s._on("scalechanging",this.onScaleChanging.bind(this),{signal:y}),s._on("rotationchanging",this.onRotationChanging.bind(this),{signal:y}),s._on("setpreference",this.onSetPreference.bind(this),{signal:y}),s._on("switchannotationeditorparams",A=>this.updateParams(A.type,A.value),{signal:y}),C(this,H,Ow).call(this),C(this,H,$w).call(this),C(this,H,Um).call(this),_(this,is,r.annotationStorage),_(this,Bc,r.filterFactory),_(this,fo,o),_(this,hl,a||null),_(this,Gc,l),_(this,Oc,u),_(this,dl,h),_(this,$c,p||null),this.viewParameters={realScale:Or.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=g||null,this._supportsPinchToZoom=m!==!1}static get _keyboardManager(){const e=Wa.prototype,t=o=>c(o,rs).contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&o.hasSomethingToControl(),i=(o,{target:a})=>{if(a instanceof HTMLInputElement){const{type:l}=a;return l!=="text"&&l!=="number"}return!0},s=this.TRANSLATE_SMALL,r=this.TRANSLATE_BIG;return re(this,"_keyboardManager",new dh([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],e.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:i}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&c(o,rs).contains(a)&&!o.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(o,{target:a})=>!(a instanceof HTMLButtonElement)&&c(o,rs).contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-r,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[r,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-r],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,r],checker:t}]]))}destroy(){var e,t,i,s,r;(e=c(this,Fn))==null||e.resolve(),_(this,Fn,null),(t=c(this,al))==null||t.abort(),_(this,al,null),this._signal=null;for(const o of c(this,pt).values())o.destroy();c(this,pt).clear(),c(this,tt).clear(),c(this,co).clear(),_(this,dn,null),c(this,ye).clear(),c(this,Dn).destroy(),(i=c(this,ll))==null||i.destroy(),(s=c(this,Mi))==null||s.hide(),_(this,Mi,null),c(this,Ri)&&(clearTimeout(c(this,Ri)),_(this,Ri,null)),c(this,ki)&&(clearTimeout(c(this,ki)),_(this,ki,null)),(r=this._editorUndoBar)==null||r.destroy()}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return c(this,$c)}get useNewAltTextFlow(){return c(this,Oc)}get useNewAltTextWhenAddingImage(){return c(this,dl)}get hcmFilter(){return re(this,"hcmFilter",c(this,fo)?c(this,Bc).addHCMFilter(c(this,fo).foreground,c(this,fo).background):"none")}get direction(){return re(this,"direction",getComputedStyle(c(this,rs)).direction)}get highlightColors(){return re(this,"highlightColors",c(this,hl)?new Map(c(this,hl).split(",").map(e=>e.split("=").map(t=>t.trim()))):null)}get highlightColorNames(){return re(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),_(this,lo,e)}setMainHighlightColorPicker(e){_(this,qc,e)}editAltText(e,t=!1){var i;(i=c(this,ll))==null||i.editAltText(this,e,t)}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":_(this,dl,t);break}}onPageChanging({pageNumber:e}){_(this,cl,e-1)}focusMainContainer(){c(this,rs).focus()}findParent(e,t){for(const i of c(this,pt).values()){const{x:s,y:r,width:o,height:a}=i.div.getBoundingClientRect();if(e>=s&&e<=s+o&&t>=r&&t<=r+a)return i}return null}disableUserSelect(e=!1){c(this,Kc).classList.toggle("noUserSelect",e)}addShouldRescale(e){c(this,co).add(e)}removeShouldRescale(e){c(this,co).delete(e)}onScaleChanging({scale:e}){var t;this.commitOrRemove(),this.viewParameters.realScale=e*Or.PDF_TO_CSS_UNITS;for(const i of c(this,co))i.onScaleChanging();(t=c(this,lo))==null||t.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}highlightSelection(e=""){const t=document.getSelection();if(!t||t.isCollapsed)return;const{anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:o}=t,a=t.toString(),u=C(this,H,Xh).call(this,t).closest(".textLayer"),h=this.getSelectionBoxes(u);if(!h)return;t.empty();const p=C(this,H,Fm).call(this,u),g=c(this,ot)===ee.NONE,m=()=>{p==null||p.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:h,anchorNode:i,anchorOffset:s,focusNode:r,focusOffset:o,text:a}),g&&this.showAllEditors("highlight",!0,!0)};if(g){this.switchToMode(ee.HIGHLIGHT,m);return}m()}addToAnnotationStorage(e){!e.isEmpty()&&c(this,is)&&!c(this,is).has(e.id)&&c(this,is).setValue(e.id,e)}blur(){if(this.isShiftKeyDown=!1,c(this,tr)&&(_(this,tr,!1),C(this,H,Qh).call(this,"main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of c(this,ye))if(t.div.contains(e)){_(this,ho,[t,e]),t._focusEventsAllowed=!1;break}}focus(){if(!c(this,ho))return;const[e,t]=c(this,ho);_(this,ho,null),t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}addEditListeners(){C(this,H,Um).call(this),C(this,H,Hm).call(this)}removeEditListeners(){C(this,H,qw).call(this),C(this,H,Vm).call(this)}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const i of c(this,ii))if(i.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const i of c(this,ii))if(i.isHandlingMimeForPasting(t.type)){i.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){var i;if(e.preventDefault(),(i=c(this,dn))==null||i.commitOrRemove(),!this.hasSelection)return;const t=[];for(const s of c(this,ye)){const r=s.serialize(!0);r&&t.push(r)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const r of t.items)for(const o of c(this,ii))if(o.isHandlingMimeForPasting(r.type)){o.paste(r,this.currentLayer);return}let i=t.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(r){te(`paste: "${r.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const s=this.currentLayer;try{const r=[];for(const l of i){const u=await s.deserialize(l);if(!u)return;r.push(u)}const o=()=>{for(const l of r)C(this,H,Gm).call(this,l);C(this,H,Om).call(this,r)},a=()=>{for(const l of r)l.remove()};this.addCommands({cmd:o,undo:a,mustExec:!0})}catch(r){te(`paste: "${r.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),c(this,ot)!==ee.NONE&&!this.isEditorHandlingKeyboard&&Wa._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,c(this,tr)&&(_(this,tr,!1),C(this,H,Qh).call(this,"main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break}}setEditingState(e){e?(C(this,H,Bw).call(this),C(this,H,Hm).call(this),C(this,H,Vt).call(this,{isEditing:c(this,ot)!==ee.NONE,isEmpty:C(this,H,Ou).call(this),hasSomethingToUndo:c(this,Dn).hasSomethingToUndo(),hasSomethingToRedo:c(this,Dn).hasSomethingToRedo(),hasSelectedEditor:!1})):(C(this,H,zw).call(this),C(this,H,Vm).call(this),C(this,H,Vt).call(this,{isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!c(this,ii)){_(this,ii,e);for(const t of c(this,ii))C(this,H,Qi).call(this,t.defaultPropertiesToUpdate)}}getId(){return c(this,dp).id}get currentLayer(){return c(this,pt).get(c(this,cl))}getLayer(e){return c(this,pt).get(e)}get currentPageIndex(){return c(this,cl)}addLayer(e){c(this,pt).set(e.pageIndex,e),c(this,nr)?e.enable():e.disable()}removeLayer(e){c(this,pt).delete(e.pageIndex)}async updateMode(e,t=null,i=!1){var s;if(c(this,ot)!==e&&!(c(this,Fn)&&(await c(this,Fn).promise,!c(this,Fn)))){if(_(this,Fn,Promise.withResolvers()),_(this,ot,e),e===ee.NONE){this.setEditingState(!1),C(this,H,Yw).call(this),(s=this._editorUndoBar)==null||s.hide(),c(this,Fn).resolve();return}this.setEditingState(!0),await C(this,H,Ww).call(this),this.unselectAll();for(const r of c(this,pt).values())r.updateMode(e);if(!t){i&&this.addNewEditorFromKeyboard(),c(this,Fn).resolve();return}for(const r of c(this,tt).values())r.annotationElementId===t?(this.setSelected(r),r.enterInEditMode()):r.unselect();c(this,Fn).resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e!==c(this,ot)&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:e})}updateParams(e,t){var i;if(c(this,ii)){switch(e){case ue.CREATE:this.currentLayer.addNewEditor();return;case ue.HIGHLIGHT_DEFAULT_COLOR:(i=c(this,qc))==null||i.updateColor(t);break;case ue.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(c(this,Wc)||_(this,Wc,new Map)).set(e,t),this.showAllEditors("highlight",t);break}for(const s of c(this,ye))s.updateParams(e,t);for(const s of c(this,ii))s.updateDefaultParams(e,t)}}showAllEditors(e,t,i=!1){var r;for(const o of c(this,tt).values())o.editorType===e&&o.show(t);(((r=c(this,Wc))==null?void 0:r.get(ue.HIGHLIGHT_SHOW_ALL))??!0)!==t&&C(this,H,Qi).call(this,[[ue.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(c(this,zc)!==e){_(this,zc,e);for(const t of c(this,pt).values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}getEditors(e){const t=[];for(const i of c(this,tt).values())i.pageIndex===e&&t.push(i);return t}getEditor(e){return c(this,tt).get(e)}addEditor(e){c(this,tt).set(e.id,e)}removeEditor(e){var t;e.div.contains(document.activeElement)&&(c(this,Ri)&&clearTimeout(c(this,Ri)),_(this,Ri,setTimeout(()=>{this.focusMainContainer(),_(this,Ri,null)},0))),c(this,tt).delete(e.id),this.unselect(e),(!e.annotationElementId||!c(this,uo).has(e.annotationElementId))&&((t=c(this,is))==null||t.remove(e.id))}addDeletedAnnotationElement(e){c(this,uo).add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return c(this,uo).has(e)}removeDeletedAnnotationElement(e){c(this,uo).delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}setActiveEditor(e){c(this,dn)!==e&&(_(this,dn,e),e&&C(this,H,Qi).call(this,e.propertiesToUpdate))}updateUI(e){c(this,H,Kw)===e&&C(this,H,Qi).call(this,e.propertiesToUpdate)}updateUIForDefaultProperties(e){C(this,H,Qi).call(this,e.defaultPropertiesToUpdate)}toggleSelected(e){if(c(this,ye).has(e)){c(this,ye).delete(e),e.unselect(),C(this,H,Vt).call(this,{hasSelectedEditor:this.hasSelection});return}c(this,ye).add(e),e.select(),C(this,H,Qi).call(this,e.propertiesToUpdate),C(this,H,Vt).call(this,{hasSelectedEditor:!0})}setSelected(e){var t;(t=c(this,lo))==null||t.commitOrRemove();for(const i of c(this,ye))i!==e&&i.unselect();c(this,ye).clear(),c(this,ye).add(e),e.select(),C(this,H,Qi).call(this,e.propertiesToUpdate),C(this,H,Vt).call(this,{hasSelectedEditor:!0})}isSelected(e){return c(this,ye).has(e)}get firstSelectedEditor(){return c(this,ye).values().next().value}unselect(e){e.unselect(),c(this,ye).delete(e),C(this,H,Vt).call(this,{hasSelectedEditor:this.hasSelection})}get hasSelection(){return c(this,ye).size!==0}get isEnterHandled(){return c(this,ye).size===1&&this.firstSelectedEditor.isEnterHandled}undo(){var e;c(this,Dn).undo(),C(this,H,Vt).call(this,{hasSomethingToUndo:c(this,Dn).hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:C(this,H,Ou).call(this)}),(e=this._editorUndoBar)==null||e.hide()}redo(){c(this,Dn).redo(),C(this,H,Vt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:c(this,Dn).hasSomethingToRedo(),isEmpty:C(this,H,Ou).call(this)})}addCommands(e){c(this,Dn).add(e),C(this,H,Vt).call(this,{hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:C(this,H,Ou).call(this)})}cleanUndoStack(e){c(this,Dn).cleanType(e)}delete(){var r;this.commitOrRemove();const e=(r=this.currentLayer)==null?void 0:r.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...c(this,ye)],i=()=>{var o;(o=this._editorUndoBar)==null||o.show(s,t.length===1?t[0].editorType:t.length);for(const a of t)a.remove()},s=()=>{for(const o of t)C(this,H,Gm).call(this,o)};this.addCommands({cmd:i,undo:s,mustExec:!0})}commitOrRemove(){var e;(e=c(this,dn))==null||e.commitOrRemove()}hasSomethingToControl(){return c(this,dn)||this.hasSelection}selectAll(){for(const e of c(this,ye))e.commit();C(this,H,Om).call(this,c(this,tt).values())}unselectAll(){var e;if(!(c(this,dn)&&(c(this,dn).commitOrRemove(),c(this,ot)!==ee.NONE))&&!((e=c(this,lo))!=null&&e.commitOrRemove())&&this.hasSelection){for(const t of c(this,ye))t.unselect();c(this,ye).clear(),C(this,H,Vt).call(this,{hasSelectedEditor:!1})}}translateSelectedEditors(e,t,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;c(this,sr)[0]+=e,c(this,sr)[1]+=t;const[s,r]=c(this,sr),o=[...c(this,ye)],a=1e3;c(this,ki)&&clearTimeout(c(this,ki)),_(this,ki,setTimeout(()=>{_(this,ki,null),c(this,sr)[0]=c(this,sr)[1]=0,this.addCommands({cmd:()=>{for(const l of o)c(this,tt).has(l.id)&&l.translateInPage(s,r)},undo:()=>{for(const l of o)c(this,tt).has(l.id)&&l.translateInPage(-s,-r)},mustExec:!1})},a));for(const l of o)l.translateInPage(e,t)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),_(this,Pi,new Map);for(const e of c(this,ye))c(this,Pi).set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!c(this,Pi))return!1;this.disableUserSelect(!1);const e=c(this,Pi);_(this,Pi,null);let t=!1;for(const[{x:s,y:r,pageIndex:o},a]of e)a.newX=s,a.newY=r,a.newPageIndex=o,t||(t=s!==a.savedX||r!==a.savedY||o!==a.savedPageIndex);if(!t)return!1;const i=(s,r,o,a)=>{if(c(this,tt).has(s.id)){const l=c(this,pt).get(a);l?s._setParentAndPosition(l,r,o):(s.pageIndex=a,s.x=r,s.y=o)}};return this.addCommands({cmd:()=>{for(const[s,{newX:r,newY:o,newPageIndex:a}]of e)i(s,r,o,a)},undo:()=>{for(const[s,{savedX:r,savedY:o,savedPageIndex:a}]of e)i(s,r,o,a)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(c(this,Pi))for(const i of c(this,Pi).keys())i.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){var e;return((e=this.getActive())==null?void 0:e.shouldGetKeyboardEvents())||c(this,ye).size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return c(this,dn)===e}getActive(){return c(this,dn)}getMode(){return c(this,ot)}get imageManager(){return re(this,"imageManager",new Lm)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let u=0,h=t.rangeCount;u<h;u++)if(!e.contains(t.getRangeAt(u).commonAncestorContainer))return null;const{x:i,y:s,width:r,height:o}=e.getBoundingClientRect();let a;switch(e.getAttribute("data-main-rotation")){case"90":a=(u,h,p,g)=>({x:(h-s)/o,y:1-(u+p-i)/r,width:g/o,height:p/r});break;case"180":a=(u,h,p,g)=>({x:1-(u+p-i)/r,y:1-(h+g-s)/o,width:p/r,height:g/o});break;case"270":a=(u,h,p,g)=>({x:1-(h+g-s)/o,y:(u-i)/r,width:g/o,height:p/r});break;default:a=(u,h,p,g)=>({x:(u-i)/r,y:(h-s)/o,width:p/r,height:g/o});break}const l=[];for(let u=0,h=t.rangeCount;u<h;u++){const p=t.getRangeAt(u);if(!p.collapsed)for(const{x:g,y:m,width:y,height:A}of p.getClientRects())y===0||A===0||l.push(a(g,m,y,A))}return l.length===0?null:l}addChangedExistingAnnotation({annotationElementId:e,id:t}){(c(this,ul)||_(this,ul,new Map)).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){var t;(t=c(this,ul))==null||t.delete(e)}renderAnnotationElement(e){var s;const t=(s=c(this,ul))==null?void 0:s.get(e.data.id);if(!t)return;const i=c(this,is).getRawValue(t);i&&(c(this,ot)===ee.NONE&&!i.hasBeenModified||i.renderAnnotationElement(e))}};al=new WeakMap,dn=new WeakMap,tt=new WeakMap,pt=new WeakMap,ll=new WeakMap,is=new WeakMap,ul=new WeakMap,Dn=new WeakMap,js=new WeakMap,lo=new WeakMap,cl=new WeakMap,uo=new WeakMap,Pi=new WeakMap,ii=new WeakMap,co=new WeakMap,Gc=new WeakMap,Oc=new WeakMap,dl=new WeakMap,Bc=new WeakMap,Ri=new WeakMap,er=new WeakMap,hl=new WeakMap,tr=new WeakMap,Mi=new WeakMap,dp=new WeakMap,nr=new WeakMap,zc=new WeakMap,ir=new WeakMap,ho=new WeakMap,qc=new WeakMap,$c=new WeakMap,ot=new WeakMap,ye=new WeakMap,ss=new WeakMap,fo=new WeakMap,Wc=new WeakMap,Yc=new WeakMap,sr=new WeakMap,ki=new WeakMap,rs=new WeakMap,Kc=new WeakMap,Fn=new WeakMap,H=new WeakSet,Xh=function({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e},Fm=function(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const i of c(this,pt).values())if(i.hasTextLayer(e))return i;return null},Vw=function(){const e=document.getSelection();if(!e||e.isCollapsed)return;const i=C(this,H,Xh).call(this,e).closest(".textLayer"),s=this.getSelectionBoxes(i);s&&(c(this,Mi)||_(this,Mi,new ZP(this)),c(this,Mi).show(i,s,this.direction==="ltr"))},Gw=function(){var r,o,a;const e=document.getSelection();if(!e||e.isCollapsed){c(this,ss)&&((r=c(this,Mi))==null||r.hide(),_(this,ss,null),C(this,H,Vt).call(this,{hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===c(this,ss))return;const s=C(this,H,Xh).call(this,e).closest(".textLayer");if(!s){c(this,ss)&&((o=c(this,Mi))==null||o.hide(),_(this,ss,null),C(this,H,Vt).call(this,{hasSelectedText:!1}));return}if((a=c(this,Mi))==null||a.hide(),_(this,ss,t),C(this,H,Vt).call(this,{hasSelectedText:!0}),!(c(this,ot)!==ee.HIGHLIGHT&&c(this,ot)!==ee.NONE)&&(c(this,ot)===ee.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),_(this,tr,this.isShiftKeyDown),!this.isShiftKeyDown)){const l=c(this,ot)===ee.HIGHLIGHT?C(this,H,Fm).call(this,s):null;l==null||l.toggleDrawing();const u=new AbortController,h=this.combinedSignal(u),p=g=>{g.type==="pointerup"&&g.button!==0||(u.abort(),l==null||l.toggleDrawing(!0),g.type==="pointerup"&&C(this,H,Qh).call(this,"main_toolbar"))};window.addEventListener("pointerup",p,{signal:h}),window.addEventListener("blur",p,{signal:h})}},Qh=function(e=""){c(this,ot)===ee.HIGHLIGHT?this.highlightSelection(e):c(this,Gc)&&C(this,H,Vw).call(this)},Ow=function(){document.addEventListener("selectionchange",C(this,H,Gw).bind(this),{signal:this._signal})},Bw=function(){if(c(this,er))return;_(this,er,new AbortController);const e=this.combinedSignal(c(this,er));window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})},zw=function(){var e;(e=c(this,er))==null||e.abort(),_(this,er,null)},Um=function(){if(c(this,ir))return;_(this,ir,new AbortController);const e=this.combinedSignal(c(this,ir));window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})},qw=function(){var e;(e=c(this,ir))==null||e.abort(),_(this,ir,null)},Hm=function(){if(c(this,js))return;_(this,js,new AbortController);const e=this.combinedSignal(c(this,js));document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})},Vm=function(){var e;(e=c(this,js))==null||e.abort(),_(this,js,null)},$w=function(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})},Vt=function(e){Object.entries(e).some(([i,s])=>c(this,Yc)[i]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(c(this,Yc),e)}),c(this,ot)===ee.HIGHLIGHT&&e.hasSelectedEditor===!1&&C(this,H,Qi).call(this,[[ue.HIGHLIGHT_FREE,!0]]))},Qi=function(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})},Ww=async function(){if(!c(this,nr)){_(this,nr,!0);const e=[];for(const t of c(this,pt).values())e.push(t.enable());await Promise.all(e);for(const t of c(this,tt).values())t.enable()}},Yw=function(){if(this.unselectAll(),c(this,nr)){_(this,nr,!1);for(const e of c(this,pt).values())e.disable();for(const e of c(this,tt).values())e.disable()}},Gm=function(e){const t=c(this,pt).get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))},Kw=function(){let e=null;for(e of c(this,ye));return e},Ou=function(){if(c(this,tt).size===0)return!0;if(c(this,tt).size===1)for(const e of c(this,tt).values())return e.isEmpty();return!1},Om=function(e){for(const t of c(this,ye))t.unselect();c(this,ye).clear();for(const t of e)t.isEmpty()||(c(this,ye).add(t),t.select());C(this,H,Vt).call(this,{hasSelectedEditor:this.hasSelection})},J(Wa,"TRANSLATE_SMALL",1),J(Wa,"TRANSLATE_BIG",10);let ya=Wa;var at,bi,si,fl,Ni,hn,pl,Li,tn,os,po,Di,rr,mi,Bu,Zh;const Gt=class Gt{constructor(e){S(this,mi);S(this,at,null);S(this,bi,!1);S(this,si,null);S(this,fl,null);S(this,Ni,null);S(this,hn,null);S(this,pl,!1);S(this,Li,null);S(this,tn,null);S(this,os,null);S(this,po,null);S(this,Di,!1);_(this,tn,e),_(this,Di,e._uiManager.useNewAltTextFlow),c(Gt,rr)||_(Gt,rr,Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"}))}static initialize(e){Gt._l10n??(Gt._l10n=e)}async render(){const e=_(this,si,document.createElement("button"));e.className="altText",e.tabIndex="0";const t=_(this,fl,document.createElement("span"));e.append(t),c(this,Di)?(e.classList.add("new"),e.setAttribute("data-l10n-id",c(Gt,rr).missing),t.setAttribute("data-l10n-id",c(Gt,rr)["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=c(this,tn)._uiManager._signal;e.addEventListener("contextmenu",Ai,{signal:i}),e.addEventListener("pointerdown",r=>r.stopPropagation(),{signal:i});const s=r=>{r.preventDefault(),c(this,tn)._uiManager.editAltText(c(this,tn)),c(this,Di)&&c(this,tn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:c(this,mi,Bu)}})};return e.addEventListener("click",s,{capture:!0,signal:i}),e.addEventListener("keydown",r=>{r.target===e&&r.key==="Enter"&&(_(this,pl,!0),s(r))},{signal:i}),await C(this,mi,Zh).call(this),e}finish(){c(this,si)&&(c(this,si).focus({focusVisible:c(this,pl)}),_(this,pl,!1))}isEmpty(){return c(this,Di)?c(this,at)===null:!c(this,at)&&!c(this,bi)}hasData(){return c(this,Di)?c(this,at)!==null||!!c(this,os):this.isEmpty()}get guessedText(){return c(this,os)}async setGuessedText(e){c(this,at)===null&&(_(this,os,e),_(this,po,await Gt._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e})),C(this,mi,Zh).call(this))}toggleAltTextBadge(e=!1){var t;if(!c(this,Di)||c(this,at)){(t=c(this,Li))==null||t.remove(),_(this,Li,null);return}if(!c(this,Li)){const i=_(this,Li,document.createElement("div"));i.className="noAltTextBadge",c(this,tn).div.append(i)}c(this,Li).classList.toggle("hidden",!e)}serialize(e){let t=c(this,at);return!e&&c(this,os)===t&&(t=c(this,po)),{altText:t,decorative:c(this,bi),guessedText:c(this,os),textWithDisclaimer:c(this,po)}}get data(){return{altText:c(this,at),decorative:c(this,bi)}}set data({altText:e,decorative:t,guessedText:i,textWithDisclaimer:s,cancel:r=!1}){i&&(_(this,os,i),_(this,po,s)),!(c(this,at)===e&&c(this,bi)===t)&&(r||(_(this,at,e),_(this,bi,t)),C(this,mi,Zh).call(this))}toggle(e=!1){c(this,si)&&(!e&&c(this,hn)&&(clearTimeout(c(this,hn)),_(this,hn,null)),c(this,si).disabled=!e)}shown(){c(this,tn)._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:c(this,mi,Bu)}})}destroy(){var e,t;(e=c(this,si))==null||e.remove(),_(this,si,null),_(this,fl,null),_(this,Ni,null),(t=c(this,Li))==null||t.remove(),_(this,Li,null)}};at=new WeakMap,bi=new WeakMap,si=new WeakMap,fl=new WeakMap,Ni=new WeakMap,hn=new WeakMap,pl=new WeakMap,Li=new WeakMap,tn=new WeakMap,os=new WeakMap,po=new WeakMap,Di=new WeakMap,rr=new WeakMap,mi=new WeakSet,Bu=function(){return c(this,at)&&"added"||c(this,at)===null&&this.guessedText&&"review"||"missing"},Zh=async function(){var s,r,o;const e=c(this,si);if(!e)return;if(c(this,Di)){if(e.classList.toggle("done",!!c(this,at)),e.setAttribute("data-l10n-id",c(Gt,rr)[c(this,mi,Bu)]),(s=c(this,fl))==null||s.setAttribute("data-l10n-id",c(Gt,rr)[`${c(this,mi,Bu)}-label`]),!c(this,at)){(r=c(this,Ni))==null||r.remove();return}}else{if(!c(this,at)&&!c(this,bi)){e.classList.remove("done"),(o=c(this,Ni))==null||o.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=c(this,Ni);if(!t){_(this,Ni,t=document.createElement("span")),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${c(this,tn).id}`;const a=100,l=c(this,tn)._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(c(this,hn)),_(this,hn,null)},{once:!0}),e.addEventListener("mouseenter",()=>{_(this,hn,setTimeout(()=>{_(this,hn,null),c(this,Ni).classList.add("show"),c(this,tn)._reportTelemetry({action:"alt_text_tooltip"})},a))},{signal:l}),e.addEventListener("mouseleave",()=>{var u;c(this,hn)&&(clearTimeout(c(this,hn)),_(this,hn,null)),(u=c(this,Ni))==null||u.classList.remove("show")},{signal:l})}c(this,bi)?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=c(this,at)),t.parentNode||e.append(t);const i=c(this,tn).getImageForAltText();i==null||i.setAttribute("aria-describedby",t.id)},S(Gt,rr,null),J(Gt,"_l10n",null);let Qf=Gt;var Jc,go,Xc,Qc,Zc,jc,ed,gl,as,mo,or,Vs,Jw,Xw,Bm;const c0=class c0{constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:i=null,onPinchStart:s=null,onPinching:r=null,onPinchEnd:o=null,signal:a}){S(this,Vs);S(this,Jc);S(this,go,!1);S(this,Xc,null);S(this,Qc);S(this,Zc);S(this,jc);S(this,ed);S(this,gl);S(this,as,null);S(this,mo);S(this,or,null);_(this,Jc,e),_(this,Xc,i),_(this,Qc,t),_(this,Zc,s),_(this,jc,r),_(this,ed,o),_(this,mo,new AbortController),_(this,gl,AbortSignal.any([a,c(this,mo).signal])),e.addEventListener("touchstart",C(this,Vs,Jw).bind(this),{passive:!1,signal:c(this,gl)})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return re(this,"MIN_TOUCH_DISTANCE_TO_PINCH",35/(window.devicePixelRatio||1))}destroy(){var e;(e=c(this,mo))==null||e.abort(),_(this,mo,null)}};Jc=new WeakMap,go=new WeakMap,Xc=new WeakMap,Qc=new WeakMap,Zc=new WeakMap,jc=new WeakMap,ed=new WeakMap,gl=new WeakMap,as=new WeakMap,mo=new WeakMap,or=new WeakMap,Vs=new WeakSet,Jw=function(e){var s,r,o;if((s=c(this,Qc))!=null&&s.call(this)||e.touches.length<2)return;if(!c(this,or)){_(this,or,new AbortController);const a=AbortSignal.any([c(this,gl),c(this,or).signal]),l=c(this,Jc),u={signal:a,passive:!1};l.addEventListener("touchmove",C(this,Vs,Xw).bind(this),u),l.addEventListener("touchend",C(this,Vs,Bm).bind(this),u),l.addEventListener("touchcancel",C(this,Vs,Bm).bind(this),u),(r=c(this,Zc))==null||r.call(this)}if(In(e),e.touches.length!==2||(o=c(this,Xc))!=null&&o.call(this)){_(this,as,null);return}let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]),_(this,as,{touch0X:t.screenX,touch0Y:t.screenY,touch1X:i.screenX,touch1Y:i.screenY})},Xw=function(e){var x;if(!c(this,as)||e.touches.length!==2)return;let[t,i]=e.touches;t.identifier>i.identifier&&([t,i]=[i,t]);const{screenX:s,screenY:r}=t,{screenX:o,screenY:a}=i,l=c(this,as),{touch0X:u,touch0Y:h,touch1X:p,touch1Y:g}=l,m=p-u,y=g-h,A=o-s,T=a-r,v=Math.hypot(A,T)||1,E=Math.hypot(m,y)||1;if(!c(this,go)&&Math.abs(E-v)<=c0.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(l.touch0X=s,l.touch0Y=r,l.touch1X=o,l.touch1Y=a,e.preventDefault(),!c(this,go)){_(this,go,!0);return}const w=[(s+o)/2,(r+a)/2];(x=c(this,jc))==null||x.call(this,w,E,v)},Bm=function(e){var t;c(this,or).abort(),_(this,or,null),(t=c(this,ed))==null||t.call(this),c(this,as)&&(e.preventDefault(),_(this,as,null),_(this,go,!1))};let Zf=c0;var yo,ri,xe,ml,ar,td,vo,gt,_o,ls,lr,nd,Ao,fn,id,Eo,us,Fi,yl,vl,Un,So,sd,hp,X,zm,rd,qm,jh,Qw,Zw,$m,ef,Wm,jw,eC,tC,Ym,nC,Km,iC,sC,rC,Jm,zu;const ne=class ne{constructor(e){S(this,X);S(this,yo,null);S(this,ri,null);S(this,xe,null);S(this,ml,!1);S(this,ar,null);S(this,td,"");S(this,vo,!1);S(this,gt,null);S(this,_o,null);S(this,ls,null);S(this,lr,null);S(this,nd,"");S(this,Ao,!1);S(this,fn,null);S(this,id,!1);S(this,Eo,!1);S(this,us,!1);S(this,Fi,null);S(this,yl,0);S(this,vl,0);S(this,Un,null);S(this,So,null);J(this,"_editToolbar",null);J(this,"_initialOptions",Object.create(null));J(this,"_initialData",null);J(this,"_isVisible",!0);J(this,"_uiManager",null);J(this,"_focusEventsAllowed",!0);S(this,sd,!1);S(this,hp,ne._zIndex++);this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null;const{rotation:t,rawDims:{pageWidth:i,pageHeight:s,pageX:r,pageY:o}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,s],this.pageTranslation=[r,o];const[a,l]=this.parentDimensions;this.x=e.x/a,this.y=e.y/l,this.isAttachedToDOM=!1,this.deleted=!1}static get _resizerKeyboardManager(){const e=ne.prototype._resizeWithKeyboard,t=ya.TRANSLATE_SMALL,i=ya.TRANSLATE_BIG;return re(this,"_resizerKeyboardManager",new dh([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,i]}],[["Escape","mac+Escape"],ne.prototype._stopResizingWithKeyboard]]))}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get isDrawer(){return!1}static get _defaultLineColor(){return re(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new tR({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(ne._l10n??(ne._l10n=e),ne._l10nResizer||(ne._l10nResizer=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"})),ne._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);ne._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Se("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return c(this,sd)}set _isDraggable(e){var t;_(this,sd,e),(t=this.div)==null||t.classList.toggle("draggable",e)}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=c(this,hp)}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):C(this,X,zu).call(this),this.parent=e}focusin(e){this._focusEventsAllowed&&(c(this,Ao)?_(this,Ao,!1):this.parent.setSelected(this))}focusout(e){var i;if(!this._focusEventsAllowed||!this.isAttachedToDOM)return;const t=e.relatedTarget;t!=null&&t.closest(`#${this.id}`)||(e.preventDefault(),(i=this.parent)!=null&&i.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,i,s){const[r,o]=this.parentDimensions;[i,s]=this.screenToPageTranslation(i,s),this.x=(e+i)/r,this.y=(t+s)/o,this.fixAndSetPosition()}translate(e,t){C(this,X,zm).call(this,this.parentDimensions,e,t)}translateInPage(e,t){c(this,fn)||_(this,fn,[this.x,this.y,this.width,this.height]),C(this,X,zm).call(this,this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}drag(e,t){c(this,fn)||_(this,fn,[this.x,this.y,this.width,this.height]);const{div:i,parentDimensions:[s,r]}=this;if(this.x+=e/s,this.y+=t/r,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:p,y:g}=this.div.getBoundingClientRect();this.parent.findNewParent(this,p,g)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:o,y:a}=this;const[l,u]=this.getBaseTranslation();o+=l,a+=u;const{style:h}=i;h.left=`${(100*o).toFixed(2)}%`,h.top=`${(100*a).toFixed(2)}%`,this._onTranslating(o,a),i.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!c(this,fn)&&(c(this,fn)[0]!==this.x||c(this,fn)[1]!==this.y)}get _hasBeenResized(){return!!c(this,fn)&&(c(this,fn)[2]!==this.width||c(this,fn)[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:i}=ne,s=i/e,r=i/t;switch(this.rotation){case 90:return[-s,r];case 180:return[s,r];case 270:return[s,-r];default:return[-s,-r]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[i,s]}=this;let{x:r,y:o,width:a,height:l}=this;if(a*=i,l*=s,r*=i,o*=s,this._mustFixPosition)switch(e){case 0:r=Math.max(0,Math.min(i-a,r)),o=Math.max(0,Math.min(s-l,o));break;case 90:r=Math.max(0,Math.min(i-l,r)),o=Math.min(s,Math.max(a,o));break;case 180:r=Math.min(i,Math.max(a,r)),o=Math.min(s,Math.max(l,o));break;case 270:r=Math.min(i,Math.max(l,r)),o=Math.max(0,Math.min(s-a,o));break}this.x=r/=i,this.y=o/=s;const[u,h]=this.getBaseTranslation();r+=u,o+=h,t.left=`${(100*r).toFixed(2)}%`,t.top=`${(100*o).toFixed(2)}%`,this.moveInDOM()}screenToPageTranslation(e,t){var i;return C(i=ne,rd,qm).call(i,e,t,this.parentRotation)}pageTranslationToScreen(e,t){var i;return C(i=ne,rd,qm).call(i,e,t,360-this.parentRotation)}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,i]}=this;return[t*e,i*e]}setDims(e,t){const[i,s]=this.parentDimensions,{style:r}=this.div;r.width=`${(100*e/i).toFixed(2)}%`,c(this,vo)||(r.height=`${(100*t/s).toFixed(2)}%`)}fixDims(){const{style:e}=this.div,{height:t,width:i}=e,s=i.endsWith("%"),r=!c(this,vo)&&t.endsWith("%");if(s&&r)return;const[o,a]=this.parentDimensions;s||(e.width=`${(100*parseFloat(i)/o).toFixed(2)}%`),!c(this,vo)&&!r&&(e.height=`${(100*parseFloat(t)/a).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}_onResized(){}static _round(e){return Math.round(e*1e4)/1e4}_onResizing(){}altTextFinish(){var e;(e=c(this,xe))==null||e.finish()}async addEditToolbar(){return this._editToolbar||c(this,Eo)?this._editToolbar:(this._editToolbar=new bm(this),this.div.append(this._editToolbar.render()),c(this,xe)&&await this._editToolbar.addAltText(c(this,xe)),this._editToolbar)}removeEditToolbar(){var e;this._editToolbar&&(this._editToolbar.remove(),this._editToolbar=null,(e=c(this,xe))==null||e.destroy())}addContainer(e){var i;const t=(i=this._editToolbar)==null?void 0:i.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}async addAltTextButton(){c(this,xe)||(Qf.initialize(ne._l10n),_(this,xe,new Qf(this)),c(this,yo)&&(c(this,xe).data=c(this,yo),_(this,yo,null)),await this.addEditToolbar())}get altTextData(){var e;return(e=c(this,xe))==null?void 0:e.data}set altTextData(e){c(this,xe)&&(c(this,xe).data=e)}get guessedAltText(){var e;return(e=c(this,xe))==null?void 0:e.guessedText}async setGuessedAltText(e){var t;await((t=c(this,xe))==null?void 0:t.setGuessedText(e))}serializeAltText(e){var t;return(t=c(this,xe))==null?void 0:t.serialize(e)}hasAltText(){return!!c(this,xe)&&!c(this,xe).isEmpty()}hasAltTextData(){var e;return((e=c(this,xe))==null?void 0:e.hasData())??!1}render(){var r;this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.tabIndex=c(this,ml)?-1:0,this._isVisible||this.div.classList.add("hidden"),this.setInForeground(),C(this,X,Km).call(this);const[e,t]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*t/e).toFixed(2)}%`,this.div.style.maxHeight=`${(100*e/t).toFixed(2)}%`);const[i,s]=this.getInitialTranslation();return this.translate(i,s),Xf(this,this.div,["pointerdown"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(c(this,So)||_(this,So,new Zf({container:this.div,isPinchingDisabled:()=>!this.isSelected,onPinchStart:C(this,X,jw).bind(this),onPinching:C(this,X,eC).bind(this),onPinchEnd:C(this,X,tC).bind(this),signal:this._uiManager._signal}))),(r=this._uiManager._editorUndoBar)==null||r.hide(),this.div}pointerdown(e){const{isMac:t}=Wt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(_(this,Ao,!0),this._isDraggable){C(this,X,nC).call(this,e);return}C(this,X,Ym).call(this,e)}get isSelected(){return this._uiManager.isSelected(this)}_onStartDragging(){}_onStopDragging(){}moveInDOM(){c(this,Fi)&&clearTimeout(c(this,Fi)),_(this,Fi,setTimeout(()=>{var e;_(this,Fi,null),(e=this.parent)==null||e.moveEditorInDOM(this)},0))}_setParentAndPosition(e,t,i){e.changeParent(this),this.x=t,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,i=this.rotation){const s=this.parentScale,[r,o]=this.pageDimensions,[a,l]=this.pageTranslation,u=e/s,h=t/s,p=this.x*r,g=this.y*o,m=this.width*r,y=this.height*o;switch(i){case 0:return[p+u+a,o-g-h-y+l,p+u+m+a,o-g-h+l];case 90:return[p+h+a,o-g+u+l,p+h+y+a,o-g+u+m+l];case 180:return[p-u-m+a,o-g+h+l,p-u+a,o-g+h+y+l];case 270:return[p-h-y+a,o-g-u-m+l,p-h+a,o-g-u+l];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[i,s,r,o]=e,a=r-i,l=o-s;switch(this.rotation){case 0:return[i,t-o,a,l];case 90:return[i,t-s,l,a];case 180:return[r,t-s,a,l];case 270:return[r,t-o,l,a];default:throw new Error("Invalid rotation")}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){_(this,Eo,!0)}disableEditMode(){_(this,Eo,!1)}isInEditMode(){return c(this,Eo)}shouldGetKeyboardEvents(){return c(this,us)}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:i,right:s}=this.getClientDimensions(),{innerHeight:r,innerWidth:o}=window;return t<o&&s>0&&e<r&&i>0}rebuild(){C(this,X,Km).call(this)}rotate(e){}resize(){}serializeDeleted(){var e;return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:((e=this._initialData)==null?void 0:e.popupRef)||""}}serialize(e=!1,t=null){Se("An editor must be serializable")}static async deserialize(e,t,i){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:i});s.rotation=e.rotation,_(s,yo,e.accessibilityData);const[r,o]=s.pageDimensions,[a,l,u,h]=s.getRectInCurrentCoords(e.rect,o);return s.x=a/r,s.y=l/o,s.width=u/r,s.height=h/o,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){var e,t;if((e=c(this,lr))==null||e.abort(),_(this,lr,null),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),c(this,Fi)&&(clearTimeout(c(this,Fi)),_(this,Fi,null)),C(this,X,zu).call(this),this.removeEditToolbar(),c(this,Un)){for(const i of c(this,Un).values())clearTimeout(i);_(this,Un,null)}this.parent=null,(t=c(this,So))==null||t.destroy(),_(this,So,null)}get isResizable(){return!1}makeResizable(){this.isResizable&&(C(this,X,Qw).call(this),c(this,gt).classList.remove("hidden"),Xf(this,this.div,["keydown"]))}get toolbarPosition(){return null}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),_(this,ls,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const t=c(this,gt).children;if(!c(this,ri)){_(this,ri,Array.from(t));const o=C(this,X,iC).bind(this),a=C(this,X,sC).bind(this),l=this._uiManager._signal;for(const u of c(this,ri)){const h=u.getAttribute("data-resizer-name");u.setAttribute("role","spinbutton"),u.addEventListener("keydown",o,{signal:l}),u.addEventListener("blur",a,{signal:l}),u.addEventListener("focus",C(this,X,rC).bind(this,h),{signal:l}),u.setAttribute("data-l10n-id",ne._l10nResizer[h])}}const i=c(this,ri)[0];let s=0;for(const o of t){if(o===i)break;s++}const r=(360-this.rotation+this.parentRotation)%360/90*(c(this,ri).length/4);if(r!==s){if(r<s)for(let a=0;a<s-r;a++)c(this,gt).append(c(this,gt).firstChild);else if(r>s)for(let a=0;a<r-s;a++)c(this,gt).firstChild.before(c(this,gt).lastChild);let o=0;for(const a of t){const u=c(this,ri)[o++].getAttribute("data-resizer-name");a.setAttribute("data-l10n-id",ne._l10nResizer[u])}}C(this,X,Jm).call(this,0),_(this,us,!0),c(this,gt).firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}_resizeWithKeyboard(e,t){c(this,us)&&C(this,X,Wm).call(this,c(this,nd),{deltaX:e,deltaY:t,fromKeyboard:!0})}_stopResizingWithKeyboard(){C(this,X,zu).call(this),this.div.focus()}select(){var e,t,i;if(this.makeResizable(),(e=this.div)==null||e.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{var s,r;(s=this.div)!=null&&s.classList.contains("selectedEditor")&&((r=this._editToolbar)==null||r.show())});return}(t=this._editToolbar)==null||t.show(),(i=c(this,xe))==null||i.toggleAltTextBadge(!1)}unselect(){var e,t,i,s,r;(e=c(this,gt))==null||e.classList.add("hidden"),(t=this.div)==null||t.classList.remove("selectedEditor"),(i=this.div)!=null&&i.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),(s=this._editToolbar)==null||s.hide(),(r=c(this,xe))==null||r.toggleAltTextBadge(!0)}updateParams(e,t){}disableEditing(){}enableEditing(){}enterInEditMode(){}getImageForAltText(){return null}get contentDiv(){return this.div}get isEditing(){return c(this,id)}set isEditing(e){_(this,id,e),this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(e,t){_(this,vo,!0);const i=e/t,{style:s}=this.div;s.aspectRatio=i,s.height="auto"}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){c(this,Un)||_(this,Un,new Map);const{action:i}=e;let s=c(this,Un).get(i);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),c(this,Un).delete(i),c(this,Un).size===0&&_(this,Un,null)},ne._telemetryTimeout),c(this,Un).set(i,s);return}e.type||(e.type=this.editorType),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),_(this,ml,!1)}disable(){this.div&&(this.div.tabIndex=-1),_(this,ml,!0)}renderAnnotationElement(e){let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const i=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),i.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;(t==null?void 0:t.nodeName)==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}};yo=new WeakMap,ri=new WeakMap,xe=new WeakMap,ml=new WeakMap,ar=new WeakMap,td=new WeakMap,vo=new WeakMap,gt=new WeakMap,_o=new WeakMap,ls=new WeakMap,lr=new WeakMap,nd=new WeakMap,Ao=new WeakMap,fn=new WeakMap,id=new WeakMap,Eo=new WeakMap,us=new WeakMap,Fi=new WeakMap,yl=new WeakMap,vl=new WeakMap,Un=new WeakMap,So=new WeakMap,sd=new WeakMap,hp=new WeakMap,X=new WeakSet,zm=function([e,t],i,s){[i,s]=this.screenToPageTranslation(i,s),this.x+=i/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()},rd=new WeakSet,qm=function(e,t,i){switch(i){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}},jh=function(e){switch(e){case 90:{const[t,i]=this.pageDimensions;return[0,-t/i,i/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,i]=this.pageDimensions;return[0,t/i,-i/t,0]}default:return[1,0,0,1]}},Qw=function(){if(c(this,gt))return;_(this,gt,document.createElement("div")),c(this,gt).classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const i of e){const s=document.createElement("div");c(this,gt).append(s),s.classList.add("resizer",i),s.setAttribute("data-resizer-name",i),s.addEventListener("pointerdown",C(this,X,Zw).bind(this,i),{signal:t}),s.addEventListener("contextmenu",Ai,{signal:t}),s.tabIndex=-1}this.div.prepend(c(this,gt))},Zw=function(e,t){var h;t.preventDefault();const{isMac:i}=Wt.platform;if(t.button!==0||t.ctrlKey&&i)return;(h=c(this,xe))==null||h.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,_(this,_o,[t.screenX,t.screenY]);const r=new AbortController,o=this._uiManager.combinedSignal(r);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",C(this,X,Wm).bind(this,e),{passive:!0,capture:!0,signal:o}),window.addEventListener("touchmove",In,{passive:!1,signal:o}),window.addEventListener("contextmenu",Ai,{signal:o}),_(this,ls,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height});const a=this.parent.div.style.cursor,l=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const u=()=>{var p;r.abort(),this.parent.togglePointerEvents(!0),(p=c(this,xe))==null||p.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=a,this.div.style.cursor=l,C(this,X,ef).call(this)};window.addEventListener("pointerup",u,{signal:o}),window.addEventListener("blur",u,{signal:o})},$m=function(e,t,i,s){this.width=i,this.height=s,this.x=e,this.y=t;const[r,o]=this.parentDimensions;this.setDims(r*i,o*s),this.fixAndSetPosition(),this._onResized()},ef=function(){if(!c(this,ls))return;const{savedX:e,savedY:t,savedWidth:i,savedHeight:s}=c(this,ls);_(this,ls,null);const r=this.x,o=this.y,a=this.width,l=this.height;r===e&&o===t&&a===i&&l===s||this.addCommands({cmd:C(this,X,$m).bind(this,r,o,a,l),undo:C(this,X,$m).bind(this,e,t,i,s),mustExec:!0})},Wm=function(e,t){const[i,s]=this.parentDimensions,r=this.x,o=this.y,a=this.width,l=this.height,u=ne.MIN_SIZE/i,h=ne.MIN_SIZE/s,p=C(this,X,jh).call(this,this.rotation),g=(F,$)=>[p[0]*F+p[2]*$,p[1]*F+p[3]*$],m=C(this,X,jh).call(this,360-this.rotation),y=(F,$)=>[m[0]*F+m[2]*$,m[1]*F+m[3]*$];let A,T,v=!1,E=!1;switch(e){case"topLeft":v=!0,A=(F,$)=>[0,0],T=(F,$)=>[F,$];break;case"topMiddle":A=(F,$)=>[F/2,0],T=(F,$)=>[F/2,$];break;case"topRight":v=!0,A=(F,$)=>[F,0],T=(F,$)=>[0,$];break;case"middleRight":E=!0,A=(F,$)=>[F,$/2],T=(F,$)=>[0,$/2];break;case"bottomRight":v=!0,A=(F,$)=>[F,$],T=(F,$)=>[0,0];break;case"bottomMiddle":A=(F,$)=>[F/2,$],T=(F,$)=>[F/2,0];break;case"bottomLeft":v=!0,A=(F,$)=>[0,$],T=(F,$)=>[F,0];break;case"middleLeft":E=!0,A=(F,$)=>[0,$/2],T=(F,$)=>[F,$/2];break}const w=A(a,l),x=T(a,l);let I=g(...x);const P=ne._round(r+I[0]),R=ne._round(o+I[1]);let k=1,b=1,N,D;if(t.fromKeyboard)({deltaX:N,deltaY:D}=t);else{const{screenX:F,screenY:$}=t,[U,K]=c(this,_o);[N,D]=this.screenToPageTranslation(F-U,$-K),c(this,_o)[0]=F,c(this,_o)[1]=$}if([N,D]=y(N/i,D/s),v){const F=Math.hypot(a,l);k=b=Math.max(Math.min(Math.hypot(x[0]-w[0]-N,x[1]-w[1]-D)/F,1/a,1/l),u/a,h/l)}else E?k=Math.max(u,Math.min(1,Math.abs(x[0]-w[0]-N)))/a:b=Math.max(h,Math.min(1,Math.abs(x[1]-w[1]-D)))/l;const Y=ne._round(a*k),ie=ne._round(l*b);I=g(...T(Y,ie));const ae=P-I[0],Ye=R-I[1];c(this,fn)||_(this,fn,[this.x,this.y,this.width,this.height]),this.width=Y,this.height=ie,this.x=ae,this.y=Ye,this.setDims(i*Y,s*ie),this.fixAndSetPosition(),this._onResizing()},jw=function(){var e;_(this,ls,{savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height}),(e=c(this,xe))==null||e.toggle(!1),this.parent.togglePointerEvents(!1)},eC=function(e,t,i){let r=.7*(i/t)+1-.7;if(r===1)return;const o=C(this,X,jh).call(this,this.rotation),a=(P,R)=>[o[0]*P+o[2]*R,o[1]*P+o[3]*R],[l,u]=this.parentDimensions,h=this.x,p=this.y,g=this.width,m=this.height,y=ne.MIN_SIZE/l,A=ne.MIN_SIZE/u;r=Math.max(Math.min(r,1/g,1/m),y/g,A/m);const T=ne._round(g*r),v=ne._round(m*r);if(T===g&&v===m)return;c(this,fn)||_(this,fn,[h,p,g,m]);const E=a(g/2,m/2),w=ne._round(h+E[0]),x=ne._round(p+E[1]),I=a(T/2,v/2);this.x=w-I[0],this.y=x-I[1],this.width=T,this.height=v,this.setDims(l*T,u*v),this.fixAndSetPosition(),this._onResizing()},tC=function(){var e;(e=c(this,xe))==null||e.toggle(!0),this.parent.togglePointerEvents(!0),C(this,X,ef).call(this)},Ym=function(e){const{isMac:t}=Wt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)},nC=function(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let i=!1;const s=new AbortController,r=this._uiManager.combinedSignal(s),o={capture:!0,passive:!1,signal:r},a=u=>{s.abort(),_(this,ar,null),_(this,Ao,!1),this._uiManager.endDragSession()||C(this,X,Ym).call(this,u),i&&this._onStopDragging()};t&&(_(this,yl,e.clientX),_(this,vl,e.clientY),_(this,ar,e.pointerId),_(this,td,e.pointerType),window.addEventListener("pointermove",u=>{i||(i=!0,this._onStartDragging());const{clientX:h,clientY:p,pointerId:g}=u;if(g!==c(this,ar)){In(u);return}const[m,y]=this.screenToPageTranslation(h-c(this,yl),p-c(this,vl));_(this,yl,h),_(this,vl,p),this._uiManager.dragSelectedEditors(m,y)},o),window.addEventListener("touchmove",In,o),window.addEventListener("pointerdown",u=>{u.pointerType===c(this,td)&&(c(this,So)||u.isPrimary)&&a(u),In(u)},o));const l=u=>{if(!c(this,ar)||c(this,ar)===u.pointerId){a(u);return}In(u)};window.addEventListener("pointerup",l,{signal:r}),window.addEventListener("blur",l,{signal:r})},Km=function(){if(c(this,lr)||!this.div)return;_(this,lr,new AbortController);const e=this._uiManager.combinedSignal(c(this,lr));this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})},iC=function(e){ne._resizerKeyboardManager.exec(this,e)},sC=function(e){var t;c(this,us)&&((t=e.relatedTarget)==null?void 0:t.parentNode)!==c(this,gt)&&C(this,X,zu).call(this)},rC=function(e){_(this,nd,c(this,us)?e:"")},Jm=function(e){if(c(this,ri))for(const t of c(this,ri))t.tabIndex=e},zu=function(){_(this,us,!1),C(this,X,Jm).call(this,-1),C(this,X,ef).call(this)},S(ne,rd),J(ne,"_l10n",null),J(ne,"_l10nResizer",null),J(ne,"_borderLineWidth",-1),J(ne,"_colorManager",new Dm),J(ne,"_zIndex",1),J(ne,"_telemetryTimeout",1e3);let Ue=ne;class tR extends Ue{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const R_=3285377520,Ln=4294901760,Ti=65535;class oC{constructor(e){this.h1=e?e&4294967295:R_,this.h2=e?e&4294967295:R_}update(e){let t,i;if(typeof e=="string"){t=new Uint8Array(e.length*2),i=0;for(let A=0,T=e.length;A<T;A++){const v=e.charCodeAt(A);v<=255?t[i++]=v:(t[i++]=v>>>8,t[i++]=v&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),i=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=i>>2,r=i-s*4,o=new Uint32Array(t.buffer,0,s);let a=0,l=0,u=this.h1,h=this.h2;const p=3432918353,g=461845907,m=p&Ti,y=g&Ti;for(let A=0;A<s;A++)A&1?(a=o[A],a=a*p&Ln|a*m&Ti,a=a<<15|a>>>17,a=a*g&Ln|a*y&Ti,u^=a,u=u<<13|u>>>19,u=u*5+3864292196):(l=o[A],l=l*p&Ln|l*m&Ti,l=l<<15|l>>>17,l=l*g&Ln|l*y&Ti,h^=l,h=h<<13|h>>>19,h=h*5+3864292196);switch(a=0,r){case 3:a^=t[s*4+2]<<16;case 2:a^=t[s*4+1]<<8;case 1:a^=t[s*4],a=a*p&Ln|a*m&Ti,a=a<<15|a>>>17,a=a*g&Ln|a*y&Ti,s&1?u^=a:h^=a}this.h1=u,this.h2=h}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&Ln|e*36045&Ti,t=t*4283543511&Ln|((t<<16|e>>>16)*2950163797&Ln)>>>16,e^=t>>>1,e=e*444984403&Ln|e*60499&Ti,t=t*3301882366&Ln|((t<<16|e>>>16)*3120437893&Ln)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const Xm=Object.freeze({map:null,hash:"",transfer:void 0});var wo,Co,lt,fp,aC;class Qv{constructor(){S(this,fp);S(this,wo,!1);S(this,Co,null);S(this,lt,new Map);this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const i=c(this,lt).get(e);return i===void 0?t:Object.assign(t,i)}getRawValue(e){return c(this,lt).get(e)}remove(e){if(c(this,lt).delete(e),c(this,lt).size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const t of c(this,lt).values())if(t instanceof Ue)return;this.onAnnotationEditor(null)}}setValue(e,t){const i=c(this,lt).get(e);let s=!1;if(i!==void 0)for(const[r,o]of Object.entries(t))i[r]!==o&&(s=!0,i[r]=o);else s=!0,c(this,lt).set(e,t);s&&C(this,fp,aC).call(this),t instanceof Ue&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type)}has(e){return c(this,lt).has(e)}getAll(){return c(this,lt).size>0?$v(c(this,lt)):null}setAll(e){for(const[t,i]of Object.entries(e))this.setValue(t,i)}get size(){return c(this,lt).size}resetModified(){c(this,wo)&&(_(this,wo,!1),typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new lC(this)}get serializable(){if(c(this,lt).size===0)return Xm;const e=new Map,t=new oC,i=[],s=Object.create(null);let r=!1;for(const[o,a]of c(this,lt)){const l=a instanceof Ue?a.serialize(!1,s):a;l&&(e.set(o,l),t.update(`${o}:${JSON.stringify(l)}`),r||(r=!!l.bitmap))}if(r)for(const o of e.values())o.bitmap&&i.push(o.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:i}:Xm}get editorStats(){let e=null;const t=new Map;for(const i of c(this,lt).values()){if(!(i instanceof Ue))continue;const s=i.telemetryFinalData;if(!s)continue;const{type:r}=s;t.has(r)||t.set(r,Object.getPrototypeOf(i).constructor),e||(e=Object.create(null));const o=e[r]||(e[r]=new Map);for(const[a,l]of Object.entries(s)){if(a==="type")continue;let u=o.get(a);u||(u=new Map,o.set(a,u));const h=u.get(l)??0;u.set(l,h+1)}}for(const[i,s]of t)e[i]=s.computeTelemetryFinalData(e[i]);return e}resetModifiedIds(){_(this,Co,null)}get modifiedIds(){if(c(this,Co))return c(this,Co);const e=[];for(const t of c(this,lt).values())!(t instanceof Ue)||!t.annotationElementId||!t.serialize()||e.push(t.annotationElementId);return _(this,Co,{ids:new Set(e),hash:e.join(",")})}}wo=new WeakMap,Co=new WeakMap,lt=new WeakMap,fp=new WeakSet,aC=function(){c(this,wo)||(_(this,wo,!0),typeof this.onSetModified=="function"&&this.onSetModified())};var od;class lC extends Qv{constructor(t){super();S(this,od);const{map:i,hash:s,transfer:r}=t.serializable,o=structuredClone(i,r?{transfer:r}:null);_(this,od,{map:o,hash:s,transfer:r})}get print(){Se("Should not call PrintAnnotationStorage.print")}get serializable(){return c(this,od)}get modifiedIds(){return re(this,"modifiedIds",{ids:new Set,hash:""})}}od=new WeakMap;var _l;class nR{constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){S(this,_l,new Set);this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),c(this,_l).clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,_inspectFont:t}){if(!(!e||c(this,_l).has(e.loadedName))){if(Qe(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:i,src:s,style:r}=e,o=new FontFace(i,s,r);this.addNativeFontFace(o);try{await o.load(),c(this,_l).add(i),t==null||t(e)}catch{te(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(o)}return}Se("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const i=e.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(s){throw te(`Failed to load font '${i.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const s=this._queueLoadingCallback(i);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){var t;const e=!!((t=this._document)!=null&&t.fonts);return re(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){let e=!1;return(Dt||typeof navigator<"u"&&typeof(navigator==null?void 0:navigator.userAgent)=="string"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(e=!0),re(this,"isSyncFontLoadingSupported",e)}_queueLoadingCallback(e){function t(){for(Qe(!s.done,"completeRequest() cannot be called twice."),s.done=!0;i.length>0&&i[0].done;){const r=i.shift();setTimeout(r.callback,0)}}const{loadingRequests:i}=this,s={done:!1,complete:t,callback:e};return i.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return re(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function i(x,I){return x.charCodeAt(I)<<24|x.charCodeAt(I+1)<<16|x.charCodeAt(I+2)<<8|x.charCodeAt(I+3)&255}function s(x,I,P,R){const k=x.substring(0,I),b=x.substring(I+P);return k+R+b}let r,o;const a=this._document.createElement("canvas");a.width=1,a.height=1;const l=a.getContext("2d");let u=0;function h(x,I){if(++u>30){te("Load test font never loaded."),I();return}if(l.font="30px "+x,l.fillText(".",0,20),l.getImageData(0,0,1,1).data[3]>0){I();return}setTimeout(h.bind(null,x,I))}const p=`lt${Date.now()}${this.loadTestFontId++}`;let g=this._loadTestFont;g=s(g,976,p.length,p);const y=16,A=1482184792;let T=i(g,y);for(r=0,o=p.length-3;r<o;r+=4)T=T-A+i(p,r)|0;r<p.length&&(T=T-A+i(p+"XXX",r)|0),g=s(g,y,4,OP(T));const v=`url(data:font/opentype;base64,${btoa(g)});`,E=`@font-face {font-family:"${p}";src:${v}}`;this.insertRule(E);const w=this._document.createElement("div");w.style.visibility="hidden",w.style.width=w.style.height="10px",w.style.position="absolute",w.style.top=w.style.left="0px";for(const x of[e.loadedName,p]){const I=this._document.createElement("span");I.textContent="Hi",I.style.fontFamily=x,w.append(I)}this._document.body.append(w),h(p,()=>{w.remove(),t.complete()})}}_l=new WeakMap;class iR{constructor(e,{disableFontFace:t=!1,fontExtraProperties:i=!1,inspectFont:s=null}){this.compiledGlyphs=Object.create(null);for(const r in e)this[r]=e[r];this.disableFontFace=t===!0,this.fontExtraProperties=i===!0,this._inspectFont=s}createNativeFontFace(){var t;if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const i={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(i.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,i)}return(t=this._inspectFont)==null||t.call(this,this),e}createFontFaceRule(){var i;if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${YP(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let s=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(s+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${s}src:${e}}`}return(i=this._inspectFont)==null||i.call(this,this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const i=this.loadedName+"_path_"+t;let s;try{s=e.get(i)}catch(o){te(`getPathGenerator - ignoring character: "${o}".`)}const r=new Path2D(s||"");return this.fontExtraProperties||e.delete(i),this.compiledGlyphs[t]=r}}const Mh={DATA:1,ERROR:2},Ke={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function M_(){}function jt(n){if(n instanceof Gr||n instanceof Rm||n instanceof kc||n instanceof x_||n instanceof Jf||n instanceof Pg)return n;switch(n instanceof Error||typeof n=="object"&&n!==null||Se('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),n.name){case"AbortException":return new Gr(n.message);case"InvalidPDFException":return new Rm(n.message);case"MissingPDFException":return new kc(n.message);case"PasswordException":return new x_(n.message,n.code);case"UnexpectedResponseException":return new Jf(n.message,n.status);case"UnknownErrorException":return new Pg(n.message,n.details)}return new Pg(n.message,n.toString())}var Al,Jn,uC,cC,dC,tf;class qu{constructor(e,t,i){S(this,Jn);S(this,Al,new AbortController);this.sourceName=e,this.targetName=t,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",C(this,Jn,uC).bind(this),{signal:c(this,Al).signal})}on(e,t){const i=this.actionHandler;if(i[e])throw new Error(`There is already an actionName called "${e}"`);i[e]=t}send(e,t,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},i)}sendWithPromise(e,t,i){const s=this.callbackId++,r=Promise.withResolvers();this.callbackCapabilities[s]=r;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},i)}catch(o){r.reject(o)}return r.promise}sendWithStream(e,t,i,s){const r=this.streamId++,o=this.sourceName,a=this.targetName,l=this.comObj;return new ReadableStream({start:u=>{const h=Promise.withResolvers();return this.streamControllers[r]={controller:u,startCall:h,pullCall:null,cancelCall:null,isClosed:!1},l.postMessage({sourceName:o,targetName:a,action:e,streamId:r,data:t,desiredSize:u.desiredSize},s),h.promise},pull:u=>{const h=Promise.withResolvers();return this.streamControllers[r].pullCall=h,l.postMessage({sourceName:o,targetName:a,stream:Ke.PULL,streamId:r,desiredSize:u.desiredSize}),h.promise},cancel:u=>{Qe(u instanceof Error,"cancel must have a valid reason");const h=Promise.withResolvers();return this.streamControllers[r].cancelCall=h,this.streamControllers[r].isClosed=!0,l.postMessage({sourceName:o,targetName:a,stream:Ke.CANCEL,streamId:r,reason:jt(u)}),h.promise}},i)}destroy(){var e;(e=c(this,Al))==null||e.abort(),_(this,Al,null)}}Al=new WeakMap,Jn=new WeakSet,uC=function({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){C(this,Jn,dC).call(this,e);return}if(e.callback){const i=e.callbackId,s=this.callbackCapabilities[i];if(!s)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],e.callback===Mh.DATA)s.resolve(e.data);else if(e.callback===Mh.ERROR)s.reject(jt(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const i=this.sourceName,s=e.sourceName,r=this.comObj;Promise.try(t,e.data).then(function(o){r.postMessage({sourceName:i,targetName:s,callback:Mh.DATA,callbackId:e.callbackId,data:o})},function(o){r.postMessage({sourceName:i,targetName:s,callback:Mh.ERROR,callbackId:e.callbackId,reason:jt(o)})});return}if(e.streamId){C(this,Jn,cC).call(this,e);return}t(e.data)},cC=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,o=this,a=this.actionHandler[e.action],l={enqueue(u,h=1,p){if(this.isCancelled)return;const g=this.desiredSize;this.desiredSize-=h,g>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),r.postMessage({sourceName:i,targetName:s,stream:Ke.ENQUEUE,streamId:t,chunk:u},p)},close(){this.isCancelled||(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Ke.CLOSE,streamId:t}),delete o.streamSinks[t])},error(u){Qe(u instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,r.postMessage({sourceName:i,targetName:s,stream:Ke.ERROR,streamId:t,reason:jt(u)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};l.sinkCapability.resolve(),l.ready=l.sinkCapability.promise,this.streamSinks[t]=l,Promise.try(a,e.data,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Ke.START_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:i,targetName:s,stream:Ke.START_COMPLETE,streamId:t,reason:jt(u)})})},dC=function(e){const t=e.streamId,i=this.sourceName,s=e.sourceName,r=this.comObj,o=this.streamControllers[t],a=this.streamSinks[t];switch(e.stream){case Ke.START_COMPLETE:e.success?o.startCall.resolve():o.startCall.reject(jt(e.reason));break;case Ke.PULL_COMPLETE:e.success?o.pullCall.resolve():o.pullCall.reject(jt(e.reason));break;case Ke.PULL:if(!a){r.postMessage({sourceName:i,targetName:s,stream:Ke.PULL_COMPLETE,streamId:t,success:!0});break}a.desiredSize<=0&&e.desiredSize>0&&a.sinkCapability.resolve(),a.desiredSize=e.desiredSize,Promise.try(a.onPull||M_).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Ke.PULL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:i,targetName:s,stream:Ke.PULL_COMPLETE,streamId:t,reason:jt(u)})});break;case Ke.ENQUEUE:if(Qe(o,"enqueue should have stream controller"),o.isClosed)break;o.controller.enqueue(e.chunk);break;case Ke.CLOSE:if(Qe(o,"close should have stream controller"),o.isClosed)break;o.isClosed=!0,o.controller.close(),C(this,Jn,tf).call(this,o,t);break;case Ke.ERROR:Qe(o,"error should have stream controller"),o.controller.error(jt(e.reason)),C(this,Jn,tf).call(this,o,t);break;case Ke.CANCEL_COMPLETE:e.success?o.cancelCall.resolve():o.cancelCall.reject(jt(e.reason)),C(this,Jn,tf).call(this,o,t);break;case Ke.CANCEL:if(!a)break;const l=jt(e.reason);Promise.try(a.onCancel||M_,l).then(function(){r.postMessage({sourceName:i,targetName:s,stream:Ke.CANCEL_COMPLETE,streamId:t,success:!0})},function(u){r.postMessage({sourceName:i,targetName:s,stream:Ke.CANCEL_COMPLETE,streamId:t,reason:jt(u)})}),a.sinkCapability.reject(l),a.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}},tf=async function(e,t){var i,s,r;await Promise.allSettled([(i=e.startCall)==null?void 0:i.promise,(s=e.pullCall)==null?void 0:s.promise,(r=e.cancelCall)==null?void 0:r.promise]),delete this.streamControllers[t]};var ad;class hC{constructor({enableHWA:e=!1}){S(this,ad,!1);_(this,ad,e)}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(e,t);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!c(this,ad)})}}reset(e,t,i){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||i<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=i}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Se("Abstract method `_createCanvas` called.")}}ad=new WeakMap;class sR extends hC{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const i=this._document.createElement("canvas");return i.width=e,i.height=t,i}}class fC{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Se("Abstract method `_fetch` called.")}}class pC extends fC{async _fetch(e){const t=await Wp(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):$p(t)}}class gC{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,i,s,r){return"none"}destroy(e=!1){}}var To,El,cs,ds,Mt,xo,Io,G,It,$u,xa,nf,Ia,mC,Qm,Pa,Wu,Yu,Zm,Ku;class rR extends gC{constructor({docId:t,ownerDocument:i=globalThis.document}){super();S(this,G);S(this,To);S(this,El);S(this,cs);S(this,ds);S(this,Mt);S(this,xo);S(this,Io,0);_(this,ds,t),_(this,Mt,i)}addFilter(t){if(!t)return"none";let i=c(this,G,It).get(t);if(i)return i;const[s,r,o]=C(this,G,nf).call(this,t),a=t.length===1?s:`${s}${r}${o}`;if(i=c(this,G,It).get(a),i)return c(this,G,It).set(t,i),i;const l=`g_${c(this,ds)}_transfer_map_${Ht(this,Io)._++}`,u=C(this,G,Ia).call(this,l);c(this,G,It).set(t,u),c(this,G,It).set(a,u);const h=C(this,G,Pa).call(this,l);return C(this,G,Yu).call(this,s,r,o,h),u}addHCMFilter(t,i){var y;const s=`${t}-${i}`,r="base";let o=c(this,G,$u).get(r);if((o==null?void 0:o.key)===s||(o?((y=o.filter)==null||y.remove(),o.key=s,o.url="none",o.filter=null):(o={key:s,url:"none",filter:null},c(this,G,$u).set(r,o)),!t||!i))return o.url;const a=C(this,G,Ku).call(this,t);t=W.makeHexColor(...a);const l=C(this,G,Ku).call(this,i);if(i=W.makeHexColor(...l),c(this,G,xa).style.color="",t==="#000000"&&i==="#ffffff"||t===i)return o.url;const u=new Array(256);for(let A=0;A<=255;A++){const T=A/255;u[A]=T<=.03928?T/12.92:((T+.055)/1.055)**2.4}const h=u.join(","),p=`g_${c(this,ds)}_hcm_filter`,g=o.filter=C(this,G,Pa).call(this,p);C(this,G,Yu).call(this,h,h,h,g),C(this,G,Qm).call(this,g);const m=(A,T)=>{const v=a[A]/255,E=l[A]/255,w=new Array(T+1);for(let x=0;x<=T;x++)w[x]=v+x/T*(E-v);return w.join(",")};return C(this,G,Yu).call(this,m(0,5),m(1,5),m(2,5),g),o.url=C(this,G,Ia).call(this,p),o.url}addAlphaFilter(t){let i=c(this,G,It).get(t);if(i)return i;const[s]=C(this,G,nf).call(this,[t]),r=`alpha_${s}`;if(i=c(this,G,It).get(r),i)return c(this,G,It).set(t,i),i;const o=`g_${c(this,ds)}_alpha_map_${Ht(this,Io)._++}`,a=C(this,G,Ia).call(this,o);c(this,G,It).set(t,a),c(this,G,It).set(r,a);const l=C(this,G,Pa).call(this,o);return C(this,G,Zm).call(this,s,l),a}addLuminosityFilter(t){let i=c(this,G,It).get(t||"luminosity");if(i)return i;let s,r;if(t?([s]=C(this,G,nf).call(this,[t]),r=`luminosity_${s}`):r="luminosity",i=c(this,G,It).get(r),i)return c(this,G,It).set(t,i),i;const o=`g_${c(this,ds)}_luminosity_map_${Ht(this,Io)._++}`,a=C(this,G,Ia).call(this,o);c(this,G,It).set(t,a),c(this,G,It).set(r,a);const l=C(this,G,Pa).call(this,o);return C(this,G,mC).call(this,l),t&&C(this,G,Zm).call(this,s,l),a}addHighlightHCMFilter(t,i,s,r,o){var E;const a=`${i}-${s}-${r}-${o}`;let l=c(this,G,$u).get(t);if((l==null?void 0:l.key)===a||(l?((E=l.filter)==null||E.remove(),l.key=a,l.url="none",l.filter=null):(l={key:a,url:"none",filter:null},c(this,G,$u).set(t,l)),!i||!s))return l.url;const[u,h]=[i,s].map(C(this,G,Ku).bind(this));let p=Math.round(.2126*u[0]+.7152*u[1]+.0722*u[2]),g=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),[m,y]=[r,o].map(C(this,G,Ku).bind(this));g<p&&([p,g,m,y]=[g,p,y,m]),c(this,G,xa).style.color="";const A=(w,x,I)=>{const P=new Array(256),R=(g-p)/I,k=w/255,b=(x-w)/(255*I);let N=0;for(let D=0;D<=I;D++){const Y=Math.round(p+D*R),ie=k+D*b;for(let ae=N;ae<=Y;ae++)P[ae]=ie;N=Y+1}for(let D=N;D<256;D++)P[D]=P[N-1];return P.join(",")},T=`g_${c(this,ds)}_hcm_${t}_filter`,v=l.filter=C(this,G,Pa).call(this,T);return C(this,G,Qm).call(this,v),C(this,G,Yu).call(this,A(m[0],y[0],5),A(m[1],y[1],5),A(m[2],y[2],5),v),l.url=C(this,G,Ia).call(this,T),l.url}destroy(t=!1){var i,s,r,o;t&&((i=c(this,xo))!=null&&i.size)||((s=c(this,cs))==null||s.parentNode.parentNode.remove(),_(this,cs,null),(r=c(this,El))==null||r.clear(),_(this,El,null),(o=c(this,xo))==null||o.clear(),_(this,xo,null),_(this,Io,0))}}To=new WeakMap,El=new WeakMap,cs=new WeakMap,ds=new WeakMap,Mt=new WeakMap,xo=new WeakMap,Io=new WeakMap,G=new WeakSet,It=function(){return c(this,El)||_(this,El,new Map)},$u=function(){return c(this,xo)||_(this,xo,new Map)},xa=function(){if(!c(this,cs)){const t=c(this,Mt).createElement("div"),{style:i}=t;i.visibility="hidden",i.contain="strict",i.width=i.height=0,i.position="absolute",i.top=i.left=0,i.zIndex=-1;const s=c(this,Mt).createElementNS(Xi,"svg");s.setAttribute("width",0),s.setAttribute("height",0),_(this,cs,c(this,Mt).createElementNS(Xi,"defs")),t.append(s),s.append(c(this,cs)),c(this,Mt).body.append(t)}return c(this,cs)},nf=function(t){if(t.length===1){const u=t[0],h=new Array(256);for(let g=0;g<256;g++)h[g]=u[g]/255;const p=h.join(",");return[p,p,p]}const[i,s,r]=t,o=new Array(256),a=new Array(256),l=new Array(256);for(let u=0;u<256;u++)o[u]=i[u]/255,a[u]=s[u]/255,l[u]=r[u]/255;return[o.join(","),a.join(","),l.join(",")]},Ia=function(t){if(c(this,To)===void 0){_(this,To,"");const i=c(this,Mt).URL;i!==c(this,Mt).baseURI&&(Yp(i)?te('#createUrl: ignore "data:"-URL for performance reasons.'):_(this,To,i.split("#",1)[0]))}return`url(${c(this,To)}#${t})`},mC=function(t){const i=c(this,Mt).createElementNS(Xi,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(i)},Qm=function(t){const i=c(this,Mt).createElementNS(Xi,"feColorMatrix");i.setAttribute("type","matrix"),i.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(i)},Pa=function(t){const i=c(this,Mt).createElementNS(Xi,"filter");return i.setAttribute("color-interpolation-filters","sRGB"),i.setAttribute("id",t),c(this,G,xa).append(i),i},Wu=function(t,i,s){const r=c(this,Mt).createElementNS(Xi,i);r.setAttribute("type","discrete"),r.setAttribute("tableValues",s),t.append(r)},Yu=function(t,i,s,r){const o=c(this,Mt).createElementNS(Xi,"feComponentTransfer");r.append(o),C(this,G,Wu).call(this,o,"feFuncR",t),C(this,G,Wu).call(this,o,"feFuncG",i),C(this,G,Wu).call(this,o,"feFuncB",s)},Zm=function(t,i){const s=c(this,Mt).createElementNS(Xi,"feComponentTransfer");i.append(s),C(this,G,Wu).call(this,s,"feFuncA",t)},Ku=function(t){return c(this,G,xa).style.color=t,Xv(getComputedStyle(c(this,G,xa)).getPropertyValue("color"))};class yC{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(i=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Se("Abstract method `_fetch` called.")}}class vC extends yC{async _fetch(e){const t=await Wp(e,"arraybuffer");return new Uint8Array(t)}}Dt&&te("Please use the `legacy` build in Node.js environments.");async function _C(n){const t=await process.getBuiltinModule("fs").promises.readFile(n);return new Uint8Array(t)}class oR extends gC{}class aR extends hC{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class lR extends fC{async _fetch(e){return _C(e)}}class uR extends yC{async _fetch(e){return _C(e)}}const Nt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function jm(n,e){if(!e)return;const t=e[2]-e[0],i=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,i),n.clip(s)}class Zv{getPattern(){Se("Abstract method `getPattern` called.")}}class cR extends Zv{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const i of this._colorStops)t.addColorStop(i[0],i[1]);return t}getPattern(e,t,i,s){let r;if(s===Nt.STROKE||s===Nt.FILL){const o=t.current.getClippedPathBoundingBox(s,ke(e))||[0,0,0,0],a=Math.ceil(o[2]-o[0])||1,l=Math.ceil(o[3]-o[1])||1,u=t.cachedCanvases.getCanvas("pattern",a,l),h=u.context;h.clearRect(0,0,h.canvas.width,h.canvas.height),h.beginPath(),h.rect(0,0,h.canvas.width,h.canvas.height),h.translate(-o[0],-o[1]),i=W.transform(i,[1,0,0,1,o[0],o[1]]),h.transform(...t.baseTransform),this.matrix&&h.transform(...this.matrix),jm(h,this._bbox),h.fillStyle=this._createGradient(h),h.fill(),r=e.createPattern(u.canvas,"no-repeat");const p=new DOMMatrix(i);r.setTransform(p)}else jm(e,this._bbox),r=this._createGradient(e);return r}}function kg(n,e,t,i,s,r,o,a){const l=e.coords,u=e.colors,h=n.data,p=n.width*4;let g;l[t+1]>l[i+1]&&(g=t,t=i,i=g,g=r,r=o,o=g),l[i+1]>l[s+1]&&(g=i,i=s,s=g,g=o,o=a,a=g),l[t+1]>l[i+1]&&(g=t,t=i,i=g,g=r,r=o,o=g);const m=(l[t]+e.offsetX)*e.scaleX,y=(l[t+1]+e.offsetY)*e.scaleY,A=(l[i]+e.offsetX)*e.scaleX,T=(l[i+1]+e.offsetY)*e.scaleY,v=(l[s]+e.offsetX)*e.scaleX,E=(l[s+1]+e.offsetY)*e.scaleY;if(y>=E)return;const w=u[r],x=u[r+1],I=u[r+2],P=u[o],R=u[o+1],k=u[o+2],b=u[a],N=u[a+1],D=u[a+2],Y=Math.round(y),ie=Math.round(E);let ae,Ye,F,$,U,K,Q,ce;for(let le=Y;le<=ie;le++){if(le<T){const me=le<y?0:(y-le)/(y-T);ae=m-(m-A)*me,Ye=w-(w-P)*me,F=x-(x-R)*me,$=I-(I-k)*me}else{let me;le>E?me=1:T===E?me=0:me=(T-le)/(T-E),ae=A-(A-v)*me,Ye=P-(P-b)*me,F=R-(R-N)*me,$=k-(k-D)*me}let Re;le<y?Re=0:le>E?Re=1:Re=(y-le)/(y-E),U=m-(m-v)*Re,K=w-(w-b)*Re,Q=x-(x-N)*Re,ce=I-(I-D)*Re;const Qt=Math.round(Math.min(ae,U)),Ji=Math.round(Math.max(ae,U));let Ge=p*le+Qt*4;for(let me=Qt;me<=Ji;me++)Re=(ae-me)/(ae-U),Re<0?Re=0:Re>1&&(Re=1),h[Ge++]=Ye-(Ye-K)*Re|0,h[Ge++]=F-(F-Q)*Re|0,h[Ge++]=$-($-ce)*Re|0,h[Ge++]=255}}function dR(n,e,t){const i=e.coords,s=e.colors;let r,o;switch(e.type){case"lattice":const a=e.verticesPerRow,l=Math.floor(i.length/a)-1,u=a-1;for(r=0;r<l;r++){let h=r*a;for(let p=0;p<u;p++,h++)kg(n,t,i[h],i[h+1],i[h+a],s[h],s[h+1],s[h+a]),kg(n,t,i[h+a+1],i[h+1],i[h+a],s[h+a+1],s[h+1],s[h+a])}break;case"triangles":for(r=0,o=i.length;r<o;r+=3)kg(n,t,i[r],i[r+1],i[r+2],s[r],s[r+1],s[r+2]);break;default:throw new Error("illegal figure")}}class hR extends Zv{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[7],this._background=e[8],this.matrix=null}_createMeshCanvas(e,t,i){const a=Math.floor(this._bounds[0]),l=Math.floor(this._bounds[1]),u=Math.ceil(this._bounds[2])-a,h=Math.ceil(this._bounds[3])-l,p=Math.min(Math.ceil(Math.abs(u*e[0]*1.1)),3e3),g=Math.min(Math.ceil(Math.abs(h*e[1]*1.1)),3e3),m=u/p,y=h/g,A={coords:this._coords,colors:this._colors,offsetX:-a,offsetY:-l,scaleX:1/m,scaleY:1/y},T=p+2*2,v=g+2*2,E=i.getCanvas("mesh",T,v),w=E.context,x=w.createImageData(p,g);if(t){const P=x.data;for(let R=0,k=P.length;R<k;R+=4)P[R]=t[0],P[R+1]=t[1],P[R+2]=t[2],P[R+3]=255}for(const P of this._figures)dR(x,P,A);return w.putImageData(x,2,2),{canvas:E.canvas,offsetX:a-2*m,offsetY:l-2*y,scaleX:m,scaleY:y}}getPattern(e,t,i,s){jm(e,this._bbox);let r;if(s===Nt.SHADING)r=W.singularValueDecompose2dScale(ke(e));else if(r=W.singularValueDecompose2dScale(t.baseTransform),this.matrix){const a=W.singularValueDecompose2dScale(this.matrix);r=[r[0]*a[0],r[1]*a[1]]}const o=this._createMeshCanvas(r,s===Nt.SHADING?null:this._background,t.cachedCanvases);return s!==Nt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(o.offsetX,o.offsetY),e.scale(o.scaleX,o.scaleY),e.createPattern(o.canvas,"no-repeat")}}class fR extends Zv{getPattern(){return"hotpink"}}function pR(n){switch(n[0]){case"RadialAxial":return new cR(n);case"Mesh":return new hR(n);case"Dummy":return new fR}throw new Error(`Unknown IR type: ${n[0]}`)}const k_={COLORED:1,UNCOLORED:2},pp=class pp{constructor(e,t,i,s,r){this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.color=t,this.ctx=i,this.canvasGraphicsFactory=s,this.baseTransform=r}createPatternCanvas(e){const{bbox:t,operatorList:i,paintType:s,tilingType:r,color:o,canvasGraphicsFactory:a}=this;let{xstep:l,ystep:u}=this;l=Math.abs(l),u=Math.abs(u),qp("TilingType: "+r);const h=t[0],p=t[1],g=t[2],m=t[3],y=g-h,A=m-p,T=W.singularValueDecompose2dScale(this.matrix),v=W.singularValueDecompose2dScale(this.baseTransform),E=T[0]*v[0],w=T[1]*v[1];let x=y,I=A,P=!1,R=!1;const k=Math.ceil(l*E),b=Math.ceil(u*w),N=Math.ceil(y*E),D=Math.ceil(A*w);k>=N?x=l:P=!0,b>=D?I=u:R=!0;const Y=this.getSizeAndScale(x,this.ctx.canvas.width,E),ie=this.getSizeAndScale(I,this.ctx.canvas.height,w),ae=e.cachedCanvases.getCanvas("pattern",Y.size,ie.size),Ye=ae.context,F=a.createCanvasGraphics(Ye);if(F.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext(F,s,o),Ye.translate(-Y.scale*h,-ie.scale*p),F.transform(Y.scale,0,0,ie.scale,0,0),Ye.save(),this.clipBbox(F,h,p,g,m),F.baseTransform=ke(F.ctx),F.executeOperatorList(i),F.endDrawing(),Ye.restore(),P||R){const $=ae.canvas;P&&(x=l),R&&(I=u);const U=this.getSizeAndScale(x,this.ctx.canvas.width,E),K=this.getSizeAndScale(I,this.ctx.canvas.height,w),Q=U.size,ce=K.size,le=e.cachedCanvases.getCanvas("pattern-workaround",Q,ce),Re=le.context,Qt=P?Math.floor(y/l):0,Ji=R?Math.floor(A/u):0;for(let Ge=0;Ge<=Qt;Ge++)for(let me=0;me<=Ji;me++)Re.drawImage($,Q*Ge,ce*me,Q,ce,0,0,Q,ce);return{canvas:le.canvas,scaleX:U.scale,scaleY:K.scale,offsetX:h,offsetY:p}}return{canvas:ae.canvas,scaleX:Y.scale,scaleY:ie.scale,offsetX:h,offsetY:p}}getSizeAndScale(e,t,i){const s=Math.max(pp.MAX_PATTERN_SIZE,t);let r=Math.ceil(e*i);return r>=s?r=s:i=r/e,{scale:i,size:r}}clipBbox(e,t,i,s,r){const o=s-t,a=r-i;e.ctx.rect(t,i,o,a),e.current.updateRectMinMax(ke(e.ctx),[t,i,s,r]),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,i){const s=e.ctx,r=e.current;switch(t){case k_.COLORED:const o=this.ctx;s.fillStyle=o.fillStyle,s.strokeStyle=o.strokeStyle,r.fillColor=o.fillStyle,r.strokeColor=o.strokeStyle;break;case k_.UNCOLORED:const a=W.makeHexColor(i[0],i[1],i[2]);s.fillStyle=a,s.strokeStyle=a,r.fillColor=a,r.strokeColor=a;break;default:throw new GP(`Unsupported paint type: ${t}`)}}getPattern(e,t,i,s){let r=i;s!==Nt.SHADING&&(r=W.transform(r,t.baseTransform),this.matrix&&(r=W.transform(r,this.matrix)));const o=this.createPatternCanvas(t);let a=new DOMMatrix(r);a=a.translate(o.offsetX,o.offsetY),a=a.scale(1/o.scaleX,1/o.scaleY);const l=e.createPattern(o.canvas,"repeat");return l.setTransform(a),l}};J(pp,"MAX_PATTERN_SIZE",3e3);let ey=pp;function gR({src:n,srcPos:e=0,dest:t,width:i,height:s,nonBlackColor:r=4294967295,inverseDecode:o=!1}){const a=Wt.isLittleEndian?4278190080:255,[l,u]=o?[r,a]:[a,r],h=i>>3,p=i&7,g=n.length;t=new Uint32Array(t.buffer);let m=0;for(let y=0;y<s;y++){for(const T=e+h;e<T;e++){const v=e<g?n[e]:255;t[m++]=v&128?u:l,t[m++]=v&64?u:l,t[m++]=v&32?u:l,t[m++]=v&16?u:l,t[m++]=v&8?u:l,t[m++]=v&4?u:l,t[m++]=v&2?u:l,t[m++]=v&1?u:l}if(p===0)continue;const A=e<g?n[e++]:255;for(let T=0;T<p;T++)t[m++]=A&1<<7-T?u:l}return{srcPos:e,destPos:m}}const b_=16,N_=100,mR=15,L_=10,D_=1e3,rn=16;function yR(n,e){if(n._removeMirroring)throw new Error("Context is already forwarding operations.");n.__originalSave=n.save,n.__originalRestore=n.restore,n.__originalRotate=n.rotate,n.__originalScale=n.scale,n.__originalTranslate=n.translate,n.__originalTransform=n.transform,n.__originalSetTransform=n.setTransform,n.__originalResetTransform=n.resetTransform,n.__originalClip=n.clip,n.__originalMoveTo=n.moveTo,n.__originalLineTo=n.lineTo,n.__originalBezierCurveTo=n.bezierCurveTo,n.__originalRect=n.rect,n.__originalClosePath=n.closePath,n.__originalBeginPath=n.beginPath,n._removeMirroring=()=>{n.save=n.__originalSave,n.restore=n.__originalRestore,n.rotate=n.__originalRotate,n.scale=n.__originalScale,n.translate=n.__originalTranslate,n.transform=n.__originalTransform,n.setTransform=n.__originalSetTransform,n.resetTransform=n.__originalResetTransform,n.clip=n.__originalClip,n.moveTo=n.__originalMoveTo,n.lineTo=n.__originalLineTo,n.bezierCurveTo=n.__originalBezierCurveTo,n.rect=n.__originalRect,n.closePath=n.__originalClosePath,n.beginPath=n.__originalBeginPath,delete n._removeMirroring},n.save=function(){e.save(),this.__originalSave()},n.restore=function(){e.restore(),this.__originalRestore()},n.translate=function(i,s){e.translate(i,s),this.__originalTranslate(i,s)},n.scale=function(i,s){e.scale(i,s),this.__originalScale(i,s)},n.transform=function(i,s,r,o,a,l){e.transform(i,s,r,o,a,l),this.__originalTransform(i,s,r,o,a,l)},n.setTransform=function(i,s,r,o,a,l){e.setTransform(i,s,r,o,a,l),this.__originalSetTransform(i,s,r,o,a,l)},n.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},n.rotate=function(i){e.rotate(i),this.__originalRotate(i)},n.clip=function(i){e.clip(i),this.__originalClip(i)},n.moveTo=function(t,i){e.moveTo(t,i),this.__originalMoveTo(t,i)},n.lineTo=function(t,i){e.lineTo(t,i),this.__originalLineTo(t,i)},n.bezierCurveTo=function(t,i,s,r,o,a){e.bezierCurveTo(t,i,s,r,o,a),this.__originalBezierCurveTo(t,i,s,r,o,a)},n.rect=function(t,i,s,r){e.rect(t,i,s,r),this.__originalRect(t,i,s,r)},n.closePath=function(){e.closePath(),this.__originalClosePath()},n.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class vR{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,i){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,i)):(s=this.canvasFactory.create(t,i),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function kh(n,e,t,i,s,r,o,a,l,u){const[h,p,g,m,y,A]=ke(n);if(p===0&&g===0){const E=o*h+y,w=Math.round(E),x=a*m+A,I=Math.round(x),P=(o+l)*h+y,R=Math.abs(Math.round(P)-w)||1,k=(a+u)*m+A,b=Math.abs(Math.round(k)-I)||1;return n.setTransform(Math.sign(h),0,0,Math.sign(m),w,I),n.drawImage(e,t,i,s,r,0,0,R,b),n.setTransform(h,p,g,m,y,A),[R,b]}if(h===0&&m===0){const E=a*g+y,w=Math.round(E),x=o*p+A,I=Math.round(x),P=(a+u)*g+y,R=Math.abs(Math.round(P)-w)||1,k=(o+l)*p+A,b=Math.abs(Math.round(k)-I)||1;return n.setTransform(0,Math.sign(p),Math.sign(g),0,w,I),n.drawImage(e,t,i,s,r,0,0,b,R),n.setTransform(h,p,g,m,y,A),[b,R]}n.drawImage(e,t,i,s,r,o,a,l,u);const T=Math.hypot(h,p),v=Math.hypot(g,m);return[T*l,v*u]}function _R(n){const{width:e,height:t}=n;if(e>D_||t>D_)return null;const i=1e3,s=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),r=e+1;let o=new Uint8Array(r*(t+1)),a,l,u;const h=e+7&-8;let p=new Uint8Array(h*t),g=0;for(const v of n.data){let E=128;for(;E>0;)p[g++]=v&E?0:255,E>>=1}let m=0;for(g=0,p[g]!==0&&(o[0]=1,++m),l=1;l<e;l++)p[g]!==p[g+1]&&(o[l]=p[g]?2:1,++m),g++;for(p[g]!==0&&(o[l]=2,++m),a=1;a<t;a++){g=a*h,u=a*r,p[g-h]!==p[g]&&(o[u]=p[g]?1:8,++m);let v=(p[g]?4:0)+(p[g-h]?8:0);for(l=1;l<e;l++)v=(v>>2)+(p[g+1]?4:0)+(p[g-h+1]?8:0),s[v]&&(o[u+l]=s[v],++m),g++;if(p[g-h]!==p[g]&&(o[u+l]=p[g]?2:4,++m),m>i)return null}for(g=h*(t-1),u=a*r,p[g]!==0&&(o[u]=8,++m),l=1;l<e;l++)p[g]!==p[g+1]&&(o[u+l]=p[g]?4:8,++m),g++;if(p[g]!==0&&(o[u+l]=4,++m),m>i)return null;const y=new Int32Array([0,r,-1,0,-r,0,0,0,1]),A=new Path2D;for(a=0;m&&a<=t;a++){let v=a*r;const E=v+e;for(;v<E&&!o[v];)v++;if(v===E)continue;A.moveTo(v%r,a);const w=v;let x=o[v];do{const I=y[x];do v+=I;while(!o[v]);const P=o[v];P!==5&&P!==10?(x=P,o[v]=0):(x=P&51*x>>4,o[v]&=x>>2|x<<2),A.lineTo(v%r,v/r|0),o[v]||--m}while(w!==v);--a}return p=null,o=null,function(v){v.save(),v.scale(1/e,-1/t),v.translate(0,-t),v.fill(A),v.beginPath(),v.restore()}}class F_{constructor(e,t){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=Rw,this.textMatrixScale=1,this.fontMatrix=Pm,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=xt.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.patternStroke=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,e,t])}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e}setCurrentPoint(e,t){this.x=e,this.y=t}updatePathMinMax(e,t,i){[t,i]=W.applyTransform([t,i],e),this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,i),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,i)}updateRectMinMax(e,t){const i=W.applyTransform(t,e),s=W.applyTransform(t.slice(2),e),r=W.applyTransform([t[0],t[3]],e),o=W.applyTransform([t[2],t[1]],e);this.minX=Math.min(this.minX,i[0],s[0],r[0],o[0]),this.minY=Math.min(this.minY,i[1],s[1],r[1],o[1]),this.maxX=Math.max(this.maxX,i[0],s[0],r[0],o[0]),this.maxY=Math.max(this.maxY,i[1],s[1],r[1],o[1])}updateScalingPathMinMax(e,t){W.scaleMinMax(e,t),this.minX=Math.min(this.minX,t[0]),this.minY=Math.min(this.minY,t[1]),this.maxX=Math.max(this.maxX,t[2]),this.maxY=Math.max(this.maxY,t[3])}updateCurvePathMinMax(e,t,i,s,r,o,a,l,u,h){const p=W.bezierBoundingBox(t,i,s,r,o,a,l,u,h);h||this.updateRectMinMax(e,p)}getPathBoundingBox(e=Nt.FILL,t=null){const i=[this.minX,this.minY,this.maxX,this.maxY];if(e===Nt.STROKE){t||Se("Stroke bounding box must include transform.");const s=W.singularValueDecompose2dScale(t),r=s[0]*this.lineWidth/2,o=s[1]*this.lineWidth/2;i[0]-=r,i[1]-=o,i[2]+=r,i[3]+=o}return i}updateClipFromPath(){const e=W.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(e){this.clipBox=e,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(e=Nt.FILL,t=null){return W.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function U_(n,e){if(e instanceof ImageData){n.putImageData(e,0,0);return}const t=e.height,i=e.width,s=t%rn,r=(t-s)/rn,o=s===0?r:r+1,a=n.createImageData(i,rn);let l=0,u;const h=e.data,p=a.data;let g,m,y,A;if(e.kind===Wh.GRAYSCALE_1BPP){const T=h.byteLength,v=new Uint32Array(p.buffer,0,p.byteLength>>2),E=v.length,w=i+7>>3,x=4294967295,I=Wt.isLittleEndian?4278190080:255;for(g=0;g<o;g++){for(y=g<r?rn:s,u=0,m=0;m<y;m++){const P=T-l;let R=0;const k=P>w?i:P*8-7,b=k&-8;let N=0,D=0;for(;R<b;R+=8)D=h[l++],v[u++]=D&128?x:I,v[u++]=D&64?x:I,v[u++]=D&32?x:I,v[u++]=D&16?x:I,v[u++]=D&8?x:I,v[u++]=D&4?x:I,v[u++]=D&2?x:I,v[u++]=D&1?x:I;for(;R<k;R++)N===0&&(D=h[l++],N=128),v[u++]=D&N?x:I,N>>=1}for(;u<E;)v[u++]=0;n.putImageData(a,0,g*rn)}}else if(e.kind===Wh.RGBA_32BPP){for(m=0,A=i*rn*4,g=0;g<r;g++)p.set(h.subarray(l,l+A)),l+=A,n.putImageData(a,0,m),m+=rn;g<o&&(A=i*s*4,p.set(h.subarray(l,l+A)),n.putImageData(a,0,m))}else if(e.kind===Wh.RGB_24BPP)for(y=rn,A=i*y,g=0;g<o;g++){for(g>=r&&(y=s,A=i*y),u=0,m=A;m--;)p[u++]=h[l++],p[u++]=h[l++],p[u++]=h[l++],p[u++]=255;n.putImageData(a,0,g*rn)}else throw new Error(`bad image kind: ${e.kind}`)}function H_(n,e){if(e.bitmap){n.drawImage(e.bitmap,0,0);return}const t=e.height,i=e.width,s=t%rn,r=(t-s)/rn,o=s===0?r:r+1,a=n.createImageData(i,rn);let l=0;const u=e.data,h=a.data;for(let p=0;p<o;p++){const g=p<r?rn:s;({srcPos:l}=gR({src:u,srcPos:l,dest:h,width:i,height:g,nonBlackColor:0})),n.putImageData(a,0,p*rn)}}function bu(n,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of t)n[i]!==void 0&&(e[i]=n[i]);n.setLineDash!==void 0&&(e.setLineDash(n.getLineDash()),e.lineDashOffset=n.lineDashOffset)}function bh(n){if(n.strokeStyle=n.fillStyle="#000000",n.fillRule="nonzero",n.globalAlpha=1,n.lineWidth=1,n.lineCap="butt",n.lineJoin="miter",n.miterLimit=10,n.globalCompositeOperation="source-over",n.font="10px sans-serif",n.setLineDash!==void 0&&(n.setLineDash([]),n.lineDashOffset=0),!Dt){const{filter:e}=n;e!=="none"&&e!==""&&(n.filter="none")}}function V_(n,e){if(e)return!0;const t=W.singularValueDecompose2dScale(n);t[0]=Math.fround(t[0]),t[1]=Math.fround(t[1]);const i=Math.fround((globalThis.devicePixelRatio||1)*Or.PDF_TO_CSS_UNITS);return t[0]<=i&&t[1]<=i}const AR=["butt","round","square"],ER=["miter","round","bevel"],SR={},G_={};var Ei,ty,ny,iy;const d0=class d0{constructor(e,t,i,s,r,{optionalContentConfig:o,markedContentStack:a=null},l,u){S(this,Ei);this.ctx=e,this.current=new F_(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=i,this.canvasFactory=s,this.filterFactory=r,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=a||[],this.optionalContentConfig=o,this.cachedCanvases=new vR(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=l,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=u,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(e,t=null){return typeof e=="string"?e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e):t}beginDrawing({transform:e,viewport:t,transparency:i=!1,background:s=null}){const r=this.ctx.canvas.width,o=this.ctx.canvas.height,a=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,r,o),this.ctx.fillStyle=a,i){const l=this.cachedCanvases.getCanvas("transparent",r,o);this.compositeCtx=this.ctx,this.transparentCanvas=l.canvas,this.ctx=l.context,this.ctx.save(),this.ctx.transform(...ke(this.compositeCtx))}this.ctx.save(),bh(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=ke(this.ctx)}executeOperatorList(e,t,i,s){const r=e.argsArray,o=e.fnArray;let a=t||0;const l=r.length;if(l===a)return a;const u=l-a>L_&&typeof i=="function",h=u?Date.now()+mR:0;let p=0;const g=this.commonObjs,m=this.objs;let y;for(;;){if(s!==void 0&&a===s.nextBreakPoint)return s.breakIt(a,i),a;if(y=o[a],y!==ti.dependency)this[y].apply(this,r[a]);else for(const A of r[a]){const T=A.startsWith("g_")?g:m;if(!T.has(A))return T.get(A,i),a}if(a++,a===l)return a;if(u&&++p>L_){if(Date.now()>h)return i(),a;p=0}}}endDrawing(){C(this,Ei,ty).call(this),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),C(this,Ei,ny).call(this)}_scaleImage(e,t){const i=e.width??e.displayWidth,s=e.height??e.displayHeight;let r=Math.max(Math.hypot(t[0],t[1]),1),o=Math.max(Math.hypot(t[2],t[3]),1),a=i,l=s,u="prescale1",h,p;for(;r>2&&a>1||o>2&&l>1;){let g=a,m=l;r>2&&a>1&&(g=a>=16384?Math.floor(a/2)-1||1:Math.ceil(a/2),r/=a/g),o>2&&l>1&&(m=l>=16384?Math.floor(l/2)-1||1:Math.ceil(l)/2,o/=l/m),h=this.cachedCanvases.getCanvas(u,g,m),p=h.context,p.clearRect(0,0,g,m),p.drawImage(e,0,0,a,l,0,0,g,m),e=h.canvas,a=g,l=m,u=u==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:a,paintHeight:l}}_createMaskCanvas(e){const t=this.ctx,{width:i,height:s}=e,r=this.current.fillColor,o=this.current.patternFill,a=ke(t);let l,u,h,p;if((e.bitmap||e.data)&&e.count>1){const k=e.bitmap||e.data.buffer;u=JSON.stringify(o?a:[a.slice(0,4),r]),l=this._cachedBitmapsMap.get(k),l||(l=new Map,this._cachedBitmapsMap.set(k,l));const b=l.get(u);if(b&&!o){const N=Math.round(Math.min(a[0],a[2])+a[4]),D=Math.round(Math.min(a[1],a[3])+a[5]);return{canvas:b,offsetX:N,offsetY:D}}h=b}h||(p=this.cachedCanvases.getCanvas("maskCanvas",i,s),H_(p.context,e));let g=W.transform(a,[1/i,0,0,-1/s,0,0]);g=W.transform(g,[1,0,0,1,0,-s]);const[m,y,A,T]=W.getAxialAlignedBoundingBox([0,0,i,s],g),v=Math.round(A-m)||1,E=Math.round(T-y)||1,w=this.cachedCanvases.getCanvas("fillCanvas",v,E),x=w.context,I=m,P=y;x.translate(-I,-P),x.transform(...g),h||(h=this._scaleImage(p.canvas,Ci(x)),h=h.img,l&&o&&l.set(u,h)),x.imageSmoothingEnabled=V_(ke(x),e.interpolate),kh(x,h,0,0,h.width,h.height,0,0,i,s),x.globalCompositeOperation="source-in";const R=W.transform(Ci(x),[1,0,0,1,-I,-P]);return x.fillStyle=o?r.getPattern(t,this,R,Nt.FILL):r,x.fillRect(0,0,i,s),l&&!o&&(this.cachedCanvases.delete("fillCanvas"),l.set(u,w.canvas)),{canvas:w.canvas,offsetX:Math.round(I),offsetY:Math.round(P)}}setLineWidth(e){e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(e){this.ctx.lineCap=AR[e]}setLineJoin(e){this.ctx.lineJoin=ER[e]}setMiterLimit(e){this.ctx.miterLimit=e}setDash(e,t){const i=this.ctx;i.setLineDash!==void 0&&(i.setLineDash(e),i.lineDashOffset=t)}setRenderingIntent(e){}setFlatness(e){}setGState(e){for(const[t,i]of e)switch(t){case"LW":this.setLineWidth(i);break;case"LC":this.setLineCap(i);break;case"LJ":this.setLineJoin(i);break;case"ML":this.setMiterLimit(i);break;case"D":this.setDash(i[0],i[1]);break;case"RI":this.setRenderingIntent(i);break;case"FL":this.setFlatness(i);break;case"Font":this.setFont(i[0],i[1]);break;case"CA":this.current.strokeAlpha=i;break;case"ca":this.current.fillAlpha=i,this.ctx.globalAlpha=i;break;case"BM":this.ctx.globalCompositeOperation=i;break;case"SMask":this.current.activeSMask=i?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(i);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,t=this.ctx.canvas.height,i="smaskGroupAt"+this.groupLevel,s=this.cachedCanvases.getCanvas(i,e,t);this.suspendedCtx=this.ctx,this.ctx=s.context;const r=this.ctx;r.setTransform(...ke(this.suspendedCtx)),bu(this.suspendedCtx,r),yR(r,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),bu(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,i,s){const r=s[0],o=s[1],a=s[2]-r,l=s[3]-o;a===0||l===0||(this.genericComposeSMask(t.context,i,a,l,t.subtype,t.backdrop,t.transferMap,r,o,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(i.canvas,0,0),e.restore())}genericComposeSMask(e,t,i,s,r,o,a,l,u,h,p){let g=e.canvas,m=l-h,y=u-p;if(o){const T=W.makeHexColor(...o);if(m<0||y<0||m+i>g.width||y+s>g.height){const v=this.cachedCanvases.getCanvas("maskExtension",i,s),E=v.context;E.drawImage(g,-m,-y),E.globalCompositeOperation="destination-atop",E.fillStyle=T,E.fillRect(0,0,i,s),E.globalCompositeOperation="source-over",g=v.canvas,m=y=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const v=new Path2D;v.rect(m,y,i,s),e.clip(v),e.globalCompositeOperation="destination-atop",e.fillStyle=T,e.fillRect(m,y,i,s),e.restore()}}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),r==="Alpha"&&a?t.filter=this.filterFactory.addAlphaFilter(a):r==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(a));const A=new Path2D;A.rect(l,u,i,s),t.clip(A),t.globalCompositeOperation="destination-in",t.drawImage(g,m,y,i,s,l,u,i,s),t.restore()}save(){this.inSMaskMode?(bu(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),bu(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(e,t,i,s,r,o){this.ctx.transform(e,t,i,s,r,o),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,i){const s=this.ctx,r=this.current;let o=r.x,a=r.y,l,u;const h=ke(s),p=h[0]===0&&h[3]===0||h[1]===0&&h[2]===0,g=p?i.slice(0):null;for(let m=0,y=0,A=e.length;m<A;m++)switch(e[m]|0){case ti.rectangle:o=t[y++],a=t[y++];const T=t[y++],v=t[y++],E=o+T,w=a+v;s.moveTo(o,a),T===0||v===0?s.lineTo(E,w):(s.lineTo(E,a),s.lineTo(E,w),s.lineTo(o,w)),p||r.updateRectMinMax(h,[o,a,E,w]),s.closePath();break;case ti.moveTo:o=t[y++],a=t[y++],s.moveTo(o,a),p||r.updatePathMinMax(h,o,a);break;case ti.lineTo:o=t[y++],a=t[y++],s.lineTo(o,a),p||r.updatePathMinMax(h,o,a);break;case ti.curveTo:l=o,u=a,o=t[y+4],a=t[y+5],s.bezierCurveTo(t[y],t[y+1],t[y+2],t[y+3],o,a),r.updateCurvePathMinMax(h,l,u,t[y],t[y+1],t[y+2],t[y+3],o,a,g),y+=6;break;case ti.curveTo2:l=o,u=a,s.bezierCurveTo(o,a,t[y],t[y+1],t[y+2],t[y+3]),r.updateCurvePathMinMax(h,l,u,o,a,t[y],t[y+1],t[y+2],t[y+3],g),o=t[y+2],a=t[y+3],y+=4;break;case ti.curveTo3:l=o,u=a,o=t[y+2],a=t[y+3],s.bezierCurveTo(t[y],t[y+1],o,a,o,a),r.updateCurvePathMinMax(h,l,u,t[y],t[y+1],o,a,o,a,g),y+=4;break;case ti.closePath:s.closePath();break}p&&r.updateScalingPathMinMax(h,g),r.setCurrentPoint(o,a)}closePath(){this.ctx.closePath()}stroke(e=!0){const t=this.ctx,i=this.current.strokeColor;t.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof i=="object"&&(i!=null&&i.getPattern)?(t.save(),t.strokeStyle=i.getPattern(t,this,Ci(t),Nt.STROKE),this.rescaleAndStroke(!1),t.restore()):this.rescaleAndStroke(!0)),e&&this.consumePath(this.current.getClippedPathBoundingBox()),t.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(e=!0){const t=this.ctx,i=this.current.fillColor,s=this.current.patternFill;let r=!1;s&&(t.save(),t.fillStyle=i.getPattern(t,this,Ci(t),Nt.FILL),r=!0);const o=this.current.getClippedPathBoundingBox();this.contentVisible&&o!==null&&(this.pendingEOFill?(t.fill("evenodd"),this.pendingEOFill=!1):t.fill()),r&&t.restore(),e&&this.consumePath(o)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=SR}eoClip(){this.pendingClip=G_}beginText(){this.current.textMatrix=Rw,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const e=this.pendingTextPaths,t=this.ctx;if(e===void 0){t.beginPath();return}const i=new Path2D,s=t.getTransform().invertSelf();for(const{transform:r,x:o,y:a,fontSize:l,path:u}of e)i.addPath(u,new DOMMatrix(r).preMultiplySelf(s).translate(o,a).scale(l,-l));t.clip(i),t.beginPath(),delete this.pendingTextPaths}setCharSpacing(e){this.current.charSpacing=e}setWordSpacing(e){this.current.wordSpacing=e}setHScale(e){this.current.textHScale=e/100}setLeading(e){this.current.leading=-e}setFont(e,t){var h;const i=this.commonObjs.get(e),s=this.current;if(!i)throw new Error(`Can't find font for ${e}`);if(s.fontMatrix=i.fontMatrix||Pm,(s.fontMatrix[0]===0||s.fontMatrix[3]===0)&&te("Invalid font matrix for font "+e),t<0?(t=-t,s.fontDirection=-1):s.fontDirection=1,this.current.font=i,this.current.fontSize=t,i.isType3Font)return;const r=i.loadedName||"sans-serif",o=((h=i.systemFontInfo)==null?void 0:h.css)||`"${r}", ${i.fallbackName}`;let a="normal";i.black?a="900":i.bold&&(a="bold");const l=i.italic?"italic":"normal";let u=t;t<b_?u=b_:t>N_&&(u=N_),this.current.fontSizeScale=t/u,this.ctx.font=`${l} ${a} ${u}px ${o}`}setTextRenderingMode(e){this.current.textRenderingMode=e}setTextRise(e){this.current.textRise=e}moveText(e,t){this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=t}setLeadingMoveText(e,t){this.setLeading(-t),this.moveText(e,t)}setTextMatrix(e,t,i,s,r,o){this.current.textMatrix=[e,t,i,s,r,o],this.current.textMatrixScale=Math.hypot(e,t),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(e,t,i,s,r){const o=this.ctx,a=this.current,l=a.font,u=a.textRenderingMode,h=a.fontSize/a.fontSizeScale,p=u&xt.FILL_STROKE_MASK,g=!!(u&xt.ADD_TO_PATH_FLAG),m=a.patternFill&&!l.missingFile,y=a.patternStroke&&!l.missingFile;let A;if((l.disableFontFace||g||m||y)&&(A=l.getPathGenerator(this.commonObjs,e)),l.disableFontFace||m||y){if(o.save(),o.translate(t,i),o.scale(h,-h),p===xt.FILL||p===xt.FILL_STROKE)if(s){const T=o.getTransform();o.setTransform(...s),o.fill(C(this,Ei,iy).call(this,A,T,s))}else o.fill(A);if(p===xt.STROKE||p===xt.FILL_STROKE)if(r){const T=o.getTransform();o.setTransform(...r),o.stroke(C(this,Ei,iy).call(this,A,T,r))}else o.lineWidth/=h,o.stroke(A);o.restore()}else(p===xt.FILL||p===xt.FILL_STROKE)&&o.fillText(e,t,i),(p===xt.STROKE||p===xt.FILL_STROKE)&&o.strokeText(e,t,i);g&&(this.pendingTextPaths||(this.pendingTextPaths=[])).push({transform:ke(o),x:t,y:i,fontSize:h,path:A})}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let i=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){i=!0;break}return re(this,"isFontSubpixelAAEnabled",i)}showText(e){const t=this.current,i=t.font;if(i.isType3Font)return this.showType3Text(e);const s=t.fontSize;if(s===0)return;const r=this.ctx,o=t.fontSizeScale,a=t.charSpacing,l=t.wordSpacing,u=t.fontDirection,h=t.textHScale*u,p=e.length,g=i.vertical,m=g?1:-1,y=i.defaultVMetrics,A=s*t.fontMatrix[0],T=t.textRenderingMode===xt.FILL&&!i.disableFontFace&&!t.patternFill;r.save(),r.transform(...t.textMatrix),r.translate(t.x,t.y+t.textRise),u>0?r.scale(h,-1):r.scale(h,1);let v,E;if(t.patternFill){r.save();const R=t.fillColor.getPattern(r,this,Ci(r),Nt.FILL);v=ke(r),r.restore(),r.fillStyle=R}if(t.patternStroke){r.save();const R=t.strokeColor.getPattern(r,this,Ci(r),Nt.STROKE);E=ke(r),r.restore(),r.strokeStyle=R}let w=t.lineWidth;const x=t.textMatrixScale;if(x===0||w===0){const R=t.textRenderingMode&xt.FILL_STROKE_MASK;(R===xt.STROKE||R===xt.FILL_STROKE)&&(w=this.getSinglePixelWidth())}else w/=x;if(o!==1&&(r.scale(o,o),w/=o),r.lineWidth=w,i.isInvalidPDFjsFont){const R=[];let k=0;for(const b of e)R.push(b.unicode),k+=b.width;r.fillText(R.join(""),0,0),t.x+=k*A*h,r.restore(),this.compose();return}let I=0,P;for(P=0;P<p;++P){const R=e[P];if(typeof R=="number"){I+=m*R*s/1e3;continue}let k=!1;const b=(R.isSpace?l:0)+a,N=R.fontChar,D=R.accent;let Y,ie,ae=R.width;if(g){const F=R.vmetric||y,$=-(R.vmetric?F[1]:ae*.5)*A,U=F[2]*A;ae=F?-F[0]:ae,Y=$/o,ie=(I+U)/o}else Y=I/o,ie=0;if(i.remeasure&&ae>0){const F=r.measureText(N).width*1e3/s*o;if(ae<F&&this.isFontSubpixelAAEnabled){const $=ae/F;k=!0,r.save(),r.scale($,1),Y/=$}else ae!==F&&(Y+=(ae-F)/2e3*s/o)}if(this.contentVisible&&(R.isInFont||i.missingFile)){if(T&&!D)r.fillText(N,Y,ie);else if(this.paintChar(N,Y,ie,v,E),D){const F=Y+s*D.offset.x/o,$=ie-s*D.offset.y/o;this.paintChar(D.fontChar,F,$,v,E)}}const Ye=g?ae*A-b*u:ae*A+b*u;I+=Ye,k&&r.restore()}g?t.y-=I:t.x+=I*h,r.restore(),this.compose()}showType3Text(e){const t=this.ctx,i=this.current,s=i.font,r=i.fontSize,o=i.fontDirection,a=s.vertical?1:-1,l=i.charSpacing,u=i.wordSpacing,h=i.textHScale*o,p=i.fontMatrix||Pm,g=e.length,m=i.textRenderingMode===xt.INVISIBLE;let y,A,T,v;if(!(m||r===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,t.save(),t.transform(...i.textMatrix),t.translate(i.x,i.y),t.scale(h,o),y=0;y<g;++y){if(A=e[y],typeof A=="number"){v=a*A*r/1e3,this.ctx.translate(v,0),i.x+=v*h;continue}const E=(A.isSpace?u:0)+l,w=s.charProcOperatorList[A.operatorListId];if(!w){te(`Type3 character "${A.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=A,this.save(),t.scale(r,r),t.transform(...p),this.executeOperatorList(w),this.restore()),T=W.applyTransform([A.width,0],p)[0]*r+E,t.translate(T,0),i.x+=T*h}t.restore(),this.processingType3=null}}setCharWidth(e,t){}setCharWidthAndBounds(e,t,i,s,r,o){this.ctx.rect(i,s,r-i,o-s),this.ctx.clip(),this.endPath()}getColorN_Pattern(e){let t;if(e[0]==="TilingPattern"){const i=e[1],s=this.baseTransform||ke(this.ctx),r={createCanvasGraphics:o=>new d0(o,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};t=new ey(e,i,this.ctx,r,s)}else t=this._getPattern(e[1],e[2]);return t}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments),this.current.patternStroke=!0}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(e,t,i){this.ctx.strokeStyle=this.current.strokeColor=W.makeHexColor(e,t,i),this.current.patternStroke=!1}setStrokeTransparent(){this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t,i){this.ctx.fillStyle=this.current.fillColor=W.makeHexColor(e,t,i),this.current.patternFill=!1}setFillTransparent(){this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t=null){let i;return this.cachedPatterns.has(e)?i=this.cachedPatterns.get(e):(i=pR(this.getObject(e)),this.cachedPatterns.set(e,i)),t&&(i.matrix=t),i}shadingFill(e){if(!this.contentVisible)return;const t=this.ctx;this.save();const i=this._getPattern(e);t.fillStyle=i.getPattern(t,this,Ci(t),Nt.SHADING);const s=Ci(t);if(s){const{width:r,height:o}=t.canvas,[a,l,u,h]=W.getAxialAlignedBoundingBox([0,0,r,o],s);this.ctx.fillRect(a,l,u-a,h-l)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){Se("Should not call beginInlineImage")}beginImageData(){Se("Should not call beginImageData")}paintFormXObjectBegin(e,t){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),e&&this.transform(...e),this.baseTransform=ke(this.ctx),t)){const i=t[2]-t[0],s=t[3]-t[1];this.ctx.rect(t[0],t[1],i,s),this.current.updateRectMinMax(ke(this.ctx),t),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const t=this.ctx;e.isolated||qp("TODO: Support non-isolated groups."),e.knockout&&te("Knockout groups not supported.");const i=ke(t);if(e.matrix&&t.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let s=W.getAxialAlignedBoundingBox(e.bbox,ke(t));const r=[0,0,t.canvas.width,t.canvas.height];s=W.intersect(s,r)||[0,0,0,0];const o=Math.floor(s[0]),a=Math.floor(s[1]),l=Math.max(Math.ceil(s[2])-o,1),u=Math.max(Math.ceil(s[3])-a,1);this.current.startNewPathAndClipBox([0,0,l,u]);let h="groupAt"+this.groupLevel;e.smask&&(h+="_smask_"+this.smaskCounter++%2);const p=this.cachedCanvases.getCanvas(h,l,u),g=p.context;g.translate(-o,-a),g.transform(...i),e.smask?this.smaskStack.push({canvas:p.canvas,context:g,offsetX:o,offsetY:a,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}):(t.setTransform(1,0,0,1,0,0),t.translate(o,a),t.save()),bu(t,g),this.ctx=g,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(t),this.groupLevel++}endGroup(e){if(!this.contentVisible)return;this.groupLevel--;const t=this.ctx,i=this.groupStack.pop();if(this.ctx=i,this.ctx.imageSmoothingEnabled=!1,e.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const s=ke(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...s);const r=W.getAxialAlignedBoundingBox([0,0,t.canvas.width,t.canvas.height],s);this.ctx.drawImage(t.canvas,0,0),this.ctx.restore(),this.compose(r)}}beginAnnotation(e,t,i,s,r){if(C(this,Ei,ty).call(this),bh(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),t){const o=t[2]-t[0],a=t[3]-t[1];if(r&&this.annotationCanvasMap){i=i.slice(),i[4]-=t[0],i[5]-=t[1],t=t.slice(),t[0]=t[1]=0,t[2]=o,t[3]=a;const[l,u]=W.singularValueDecompose2dScale(ke(this.ctx)),{viewportScale:h}=this,p=Math.ceil(o*this.outputScaleX*h),g=Math.ceil(a*this.outputScaleY*h);this.annotationCanvas=this.canvasFactory.create(p,g);const{canvas:m,context:y}=this.annotationCanvas;this.annotationCanvasMap.set(e,m),this.annotationCanvas.savedCtx=this.ctx,this.ctx=y,this.ctx.save(),this.ctx.setTransform(l,0,0,-u,0,a*u),bh(this.ctx)}else bh(this.ctx),this.endPath(),this.ctx.rect(t[0],t[1],o,a),this.ctx.clip(),this.ctx.beginPath()}this.current=new F_(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...i),this.transform(...s)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),C(this,Ei,ny).call(this),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e){if(!this.contentVisible)return;const t=e.count;e=this.getObject(e.data,e),e.count=t;const i=this.ctx,s=this.processingType3;if(s&&(s.compiled===void 0&&(s.compiled=_R(e)),s.compiled)){s.compiled(i);return}const r=this._createMaskCanvas(e),o=r.canvas;i.save(),i.setTransform(1,0,0,1,0,0),i.drawImage(o,r.offsetX,r.offsetY),i.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,i=0,s=0,r,o){if(!this.contentVisible)return;e=this.getObject(e.data,e);const a=this.ctx;a.save();const l=ke(a);a.transform(t,i,s,r,0,0);const u=this._createMaskCanvas(e);a.setTransform(1,0,0,1,u.offsetX-l[4],u.offsetY-l[5]);for(let h=0,p=o.length;h<p;h+=2){const g=W.transform(l,[t,i,s,r,o[h],o[h+1]]),[m,y]=W.applyTransform([0,0],g);a.drawImage(u.canvas,m,y)}a.restore(),this.compose()}paintImageMaskXObjectGroup(e){if(!this.contentVisible)return;const t=this.ctx,i=this.current.fillColor,s=this.current.patternFill;for(const r of e){const{data:o,width:a,height:l,transform:u}=r,h=this.cachedCanvases.getCanvas("maskCanvas",a,l),p=h.context;p.save();const g=this.getObject(o,r);H_(p,g),p.globalCompositeOperation="source-in",p.fillStyle=s?i.getPattern(p,this,Ci(t),Nt.FILL):i,p.fillRect(0,0,a,l),p.restore(),t.save(),t.transform(...u),t.scale(1,-1),kh(t,h.canvas,0,0,a,l,0,-1,1,1),t.restore()}this.compose()}paintImageXObject(e){if(!this.contentVisible)return;const t=this.getObject(e);if(!t){te("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t)}paintImageXObjectRepeat(e,t,i,s){if(!this.contentVisible)return;const r=this.getObject(e);if(!r){te("Dependent image isn't ready yet");return}const o=r.width,a=r.height,l=[];for(let u=0,h=s.length;u<h;u+=2)l.push({transform:[t,0,0,i,s[u],s[u+1]],x:0,y:0,w:o,h:a});this.paintInlineImageXObjectGroup(r,l)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:i,height:s}=e,r=this.cachedCanvases.getCanvas("inlineImage",i,s),o=r.context;return o.filter=this.current.transferMaps,o.drawImage(t,0,0),o.filter="none",r.canvas}paintInlineImageXObject(e){if(!this.contentVisible)return;const t=e.width,i=e.height,s=this.ctx;if(this.save(),!Dt){const{filter:a}=s;a!=="none"&&a!==""&&(s.filter="none")}s.scale(1/t,-1/i);let r;if(e.bitmap)r=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)r=e;else{const l=this.cachedCanvases.getCanvas("inlineImage",t,i).context;U_(l,e),r=this.applyTransferMapsToCanvas(l)}const o=this._scaleImage(r,Ci(s));s.imageSmoothingEnabled=V_(ke(s),e.interpolate),kh(s,o.img,0,0,o.paintWidth,o.paintHeight,0,-i,t,i),this.compose(),this.restore()}paintInlineImageXObjectGroup(e,t){if(!this.contentVisible)return;const i=this.ctx;let s;if(e.bitmap)s=e.bitmap;else{const r=e.width,o=e.height,l=this.cachedCanvases.getCanvas("inlineImage",r,o).context;U_(l,e),s=this.applyTransferMapsToCanvas(l)}for(const r of t)i.save(),i.transform(...r.transform),i.scale(1,-1),kh(i,s,r.x,r.y,r.w,r.h,0,-1,1,1),i.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e){}markPointProps(e,t){}beginMarkedContent(e){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t){e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(t)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(e){const t=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(e);const i=this.ctx;this.pendingClip&&(t||(this.pendingClip===G_?i.clip("evenodd"):i.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),i.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=ke(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),i=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(i,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:i,c:s,d:r}=this.ctx.getTransform();let o,a;if(i===0&&s===0){const l=Math.abs(t),u=Math.abs(r);if(l===u)if(e===0)o=a=1/l;else{const h=l*e;o=a=h<1?1/h:1}else if(e===0)o=1/l,a=1/u;else{const h=l*e,p=u*e;o=h<1?1/h:1,a=p<1?1/p:1}}else{const l=Math.abs(t*r-i*s),u=Math.hypot(t,i),h=Math.hypot(s,r);if(e===0)o=h/l,a=u/l;else{const p=e*l;o=h>p?h/p:1,a=u>p?u/p:1}}this._cachedScaleForStroking[0]=o,this._cachedScaleForStroking[1]=a}return this._cachedScaleForStroking}rescaleAndStroke(e){const{ctx:t}=this,{lineWidth:i}=this.current,[s,r]=this.getScaleForStroking();if(t.lineWidth=i||1,s===1&&r===1){t.stroke();return}const o=t.getLineDash();if(e&&t.save(),t.scale(s,r),o.length>0){const a=Math.max(s,r);t.setLineDash(o.map(l=>l/a)),t.lineDashOffset/=a}t.stroke(),e&&t.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}};Ei=new WeakSet,ty=function(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)},ny=function(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}},iy=function(e,t,i){const s=new Path2D;return s.addPath(e,new DOMMatrix(i).invertSelf().multiplySelf(t)),s};let el=d0;for(const n in ti)el.prototype[n]!==void 0&&(el.prototype[ti[n]]=el.prototype[n]);var ld,ud;class Ps{static get workerPort(){return c(this,ld)}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");_(this,ld,e)}static get workerSrc(){return c(this,ud)}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");_(this,ud,e)}}ld=new WeakMap,ud=new WeakMap,S(Ps,ld,null),S(Ps,ud,"");var Po,cd;class wR{constructor({parsedData:e,rawData:t}){S(this,Po);S(this,cd);_(this,Po,e),_(this,cd,t)}getRaw(){return c(this,cd)}get(e){return c(this,Po).get(e)??null}getAll(){return $v(c(this,Po))}has(e){return c(this,Po).has(e)}}Po=new WeakMap,cd=new WeakMap;const Ra=Symbol("INTERNAL");var dd,hd,fd,Sl;class CR{constructor(e,{name:t,intent:i,usage:s,rbGroups:r}){S(this,dd,!1);S(this,hd,!1);S(this,fd,!1);S(this,Sl,!0);_(this,dd,!!(e&Cn.DISPLAY)),_(this,hd,!!(e&Cn.PRINT)),this.name=t,this.intent=i,this.usage=s,this.rbGroups=r}get visible(){if(c(this,fd))return c(this,Sl);if(!c(this,Sl))return!1;const{print:e,view:t}=this.usage;return c(this,dd)?(t==null?void 0:t.viewState)!=="OFF":c(this,hd)?(e==null?void 0:e.printState)!=="OFF":!0}_setVisible(e,t,i=!1){e!==Ra&&Se("Internal method `_setVisible` called."),_(this,fd,i),_(this,Sl,t)}}dd=new WeakMap,hd=new WeakMap,fd=new WeakMap,Sl=new WeakMap;var ur,ve,wl,Cl,pd,sy;class TR{constructor(e,t=Cn.DISPLAY){S(this,pd);S(this,ur,null);S(this,ve,new Map);S(this,wl,null);S(this,Cl,null);if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,_(this,Cl,e.order);for(const i of e.groups)c(this,ve).set(i.id,new CR(t,i));if(e.baseState==="OFF")for(const i of c(this,ve).values())i._setVisible(Ra,!1);for(const i of e.on)c(this,ve).get(i)._setVisible(Ra,!0);for(const i of e.off)c(this,ve).get(i)._setVisible(Ra,!1);_(this,wl,this.getHash())}}isVisible(e){if(c(this,ve).size===0)return!0;if(!e)return qp("Optional content group not defined."),!0;if(e.type==="OCG")return c(this,ve).has(e.id)?c(this,ve).get(e.id).visible:(te(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return C(this,pd,sy).call(this,e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!c(this,ve).has(t))return te(`Optional content group not found: ${t}`),!0;if(c(this,ve).get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!c(this,ve).has(t))return te(`Optional content group not found: ${t}`),!0;if(!c(this,ve).get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!c(this,ve).has(t))return te(`Optional content group not found: ${t}`),!0;if(!c(this,ve).get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!c(this,ve).has(t))return te(`Optional content group not found: ${t}`),!0;if(c(this,ve).get(t).visible)return!1}return!0}return te(`Unknown optional content policy ${e.policy}.`),!0}return te(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,i=!0){var r;const s=c(this,ve).get(e);if(!s){te(`Optional content group not found: ${e}`);return}if(i&&t&&s.rbGroups.length)for(const o of s.rbGroups)for(const a of o)a!==e&&((r=c(this,ve).get(a))==null||r._setVisible(Ra,!1,!0));s._setVisible(Ra,!!t,!0),_(this,ur,null)}setOCGState({state:e,preserveRB:t}){let i;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":i=s;continue}const r=c(this,ve).get(s);if(r)switch(i){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!r.visible,t);break}}_(this,ur,null)}get hasInitialVisibility(){return c(this,wl)===null||this.getHash()===c(this,wl)}getOrder(){return c(this,ve).size?c(this,Cl)?c(this,Cl).slice():[...c(this,ve).keys()]:null}getGroups(){return c(this,ve).size>0?$v(c(this,ve)):null}getGroup(e){return c(this,ve).get(e)||null}getHash(){if(c(this,ur)!==null)return c(this,ur);const e=new oC;for(const[t,i]of c(this,ve))e.update(`${t}:${i.visible}`);return _(this,ur,e.hexdigest())}}ur=new WeakMap,ve=new WeakMap,wl=new WeakMap,Cl=new WeakMap,pd=new WeakSet,sy=function(e){const t=e.length;if(t<2)return!0;const i=e[0];for(let s=1;s<t;s++){const r=e[s];let o;if(Array.isArray(r))o=C(this,pd,sy).call(this,r);else if(c(this,ve).has(r))o=c(this,ve).get(r).visible;else return te(`Optional content group not found: ${r}`),!0;switch(i){case"And":if(!o)return!1;break;case"Or":if(o)return!0;break;case"Not":return!o;default:return!0}}return i==="And"};class xR{constructor(e,{disableRange:t=!1,disableStream:i=!1}){Qe(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:r,progressiveDone:o,contentDispositionFilename:a}=e;if(this._queuedChunks=[],this._progressiveDone=o,this._contentDispositionFilename=a,(r==null?void 0:r.length)>0){const l=r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer;this._queuedChunks.push(l)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!i,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((l,u)=>{this._onReceiveData({begin:l,chunk:u})}),e.addProgressListener((l,u)=>{this._onProgress({loaded:l,total:u})}),e.addProgressiveReadListener(l=>{this._onReceiveData({chunk:l})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const i=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(i):this._queuedChunks.push(i);else{const s=this._rangeReaders.some(function(r){return r._begin!==e?!1:(r._enqueue(i),!0)});Qe(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}_onProgress(e){var t,i,s,r;e.total===void 0?(i=(t=this._rangeReaders[0])==null?void 0:t.onProgress)==null||i.call(t,{loaded:e.loaded}):(r=(s=this._fullRequestReader)==null?void 0:s.onProgress)==null||r.call(s,{loaded:e.loaded,total:e.total})}_onProgressiveDone(){var e;(e=this._fullRequestReader)==null||e.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Qe(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new IR(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new PR(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeReaders.slice(0))i.cancel(e);this._pdfDataRangeTransport.abort()}}class IR{constructor(e,t,i=!1,s=null){this._stream=e,this._done=i||!1,this._filename=Kv(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const r of this._queuedChunks)this._loaded+=r.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class PR{constructor(e,t,i){this._stream=e,this._begin=t,this._end=i,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function RR(n){let e=!0,t=i("filename\\*","i").exec(n);if(t){t=t[1];let h=a(t);return h=unescape(h),h=l(h),h=u(h),r(h)}if(t=o(n),t){const h=u(t);return r(h)}if(t=i("filename","i").exec(n),t){t=t[1];let h=a(t);return h=u(h),r(h)}function i(h,p){return new RegExp("(?:^|;)\\s*"+h+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',p)}function s(h,p){if(h){if(!/^[\x00-\xFF]+$/.test(p))return p;try{const g=new TextDecoder(h,{fatal:!0}),m=$p(p);p=g.decode(m),e=!1}catch{}}return p}function r(h){return e&&/[\x80-\xff]/.test(h)&&(h=s("utf-8",h),e&&(h=s("iso-8859-1",h))),h}function o(h){const p=[];let g;const m=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(g=m.exec(h))!==null;){let[,A,T,v]=g;if(A=parseInt(A,10),A in p){if(A===0)break;continue}p[A]=[T,v]}const y=[];for(let A=0;A<p.length&&A in p;++A){let[T,v]=p[A];v=a(v),T&&(v=unescape(v),A===0&&(v=l(v))),y.push(v)}return y.join("")}function a(h){if(h.startsWith('"')){const p=h.slice(1).split('\\"');for(let g=0;g<p.length;++g){const m=p[g].indexOf('"');m!==-1&&(p[g]=p[g].slice(0,m),p.length=g+1),p[g]=p[g].replaceAll(/\\(.)/g,"$1")}h=p.join('"')}return h}function l(h){const p=h.indexOf("'");if(p===-1)return h;const g=h.slice(0,p),y=h.slice(p+1).replace(/^[^']*'/,"");return s(g,y)}function u(h){return!h.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(h)?h:h.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(p,g,m,y){if(m==="q"||m==="Q")return y=y.replaceAll("_"," "),y=y.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,T){return String.fromCharCode(parseInt(T,16))}),s(g,y);try{y=atob(y)}catch{}return s(g,y)})}return""}function AC(n,e){const t=new Headers;if(!n||!e||typeof e!="object")return t;for(const i in e){const s=e[i];s!==void 0&&t.append(i,s)}return t}function Kp(n){try{return new URL(n).origin}catch{}return null}function EC({responseHeaders:n,isHttp:e,rangeChunkSize:t,disableRange:i}){const s={allowRangeRequests:!1,suggestedLength:void 0},r=parseInt(n.get("Content-Length"),10);return!Number.isInteger(r)||(s.suggestedLength=r,r<=2*t)||i||!e||n.get("Accept-Ranges")!=="bytes"||(n.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function SC(n){const e=n.get("Content-Disposition");if(e){let t=RR(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Kv(t))return t}return null}function Jp(n,e){return n===404||n===0&&e.startsWith("file:")?new kc('Missing PDF "'+e+'".'):new Jf(`Unexpected server response (${n}) while retrieving PDF "${e}".`,n)}function wC(n){return n===200||n===206}function CC(n,e,t){return{method:"GET",headers:n,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function TC(n){return n instanceof Uint8Array?n.buffer:n instanceof ArrayBuffer?n:(te(`getArrayBuffer - unexpected data format: ${n}`),new Uint8Array(n).buffer)}class O_{constructor(e){J(this,"_responseOrigin",null);this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=AC(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Qe(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new MR(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new kR(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class MR{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const i=new Headers(e.headers),s=t.url;fetch(s,CC(i,this._withCredentials,this._abortController)).then(r=>{if(e._responseOrigin=Kp(r.url),!wC(r.status))throw Jp(r.status,s);this._reader=r.body.getReader(),this._headersCapability.resolve();const o=r.headers,{allowRangeRequests:a,suggestedLength:l}=EC({responseHeaders:o,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=a,this._contentLength=l||this._contentLength,this._filename=SC(o),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Gr("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:TC(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}class kR{constructor(e,t,i){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const r=new Headers(e.headers);r.append("Range",`bytes=${t}-${i-1}`);const o=s.url;fetch(o,CC(r,this._withCredentials,this._abortController)).then(a=>{const l=Kp(a.url);if(l!==e._responseOrigin)throw new Error(`Expected range response-origin "${l}" to match "${e._responseOrigin}".`);if(!wC(a.status))throw Jp(a.status,o);this._readCapability.resolve(),this._reader=a.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:TC(e),done:!1})}cancel(e){var t;(t=this._reader)==null||t.cancel(e),this._abortController.abort()}}const bg=200,Ng=206;function bR(n){const e=n.response;return typeof e!="string"?e:$p(e).buffer}class NR{constructor({url:e,httpHeaders:t,withCredentials:i}){J(this,"_responseOrigin",null);this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=AC(this.isHttp,t),this.withCredentials=i||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,i=this.currXhrId++,s=this.pendingRequests[i]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[r,o]of this.headers)t.setRequestHeader(r,o);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=Ng):s.expectedStatus=bg,t.responseType="arraybuffer",Qe(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,i),t.onprogress=this.onProgress.bind(this,i),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),i}onProgress(e,t){var s;const i=this.pendingRequests[e];i&&((s=i.onProgress)==null||s.call(i,t))}onStateChange(e,t){const i=this.pendingRequests[e];if(!i)return;const s=i.xhr;if(s.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){i.onError(s.status);return}const r=s.status||bg;if(!(r===bg&&i.expectedStatus===Ng)&&r!==i.expectedStatus){i.onError(s.status);return}const a=bR(s);if(r===Ng){const l=s.getResponseHeader("Content-Range"),u=/bytes (\d+)-(\d+)\/(\d+)/.exec(l);u?i.onDone({begin:parseInt(u[1],10),chunk:a}):(te('Missing or invalid "Content-Range" header.'),i.onError(0))}else a?i.onDone({begin:0,chunk:a}):i.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class LR{constructor(e){this._source=e,this._manager=new NR(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Qe(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new DR(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const i=new FR(this._manager,e,t);return i.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class DR{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=Kp(t.responseURL);const i=t.getAllResponseHeaders(),s=new Headers(i?i.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(a=>{const[l,...u]=a.split(": ");return[l,u.join(": ")]}):[]),{allowRangeRequests:r,suggestedLength:o}=EC({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});r&&(this._isRangeSupported=!0),this._contentLength=o||this._contentLength,this._filename=SC(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=Jp(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){var t;(t=this.onProgress)==null||t.call(this,{loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class FR{constructor(e,t,i){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:i,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){var t;const e=Kp((t=this._manager.getRequestXhr(this._requestId))==null?void 0:t.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){var e;(e=this.onClosed)==null||e.call(this,this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??(this._storedError=Jp(e,this._url));for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){var t;this.isStreamingSupported||(t=this.onProgress)==null||t.call(this,{loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const UR=/^[a-z][a-z0-9\-+.]+:/i;function HR(n){if(UR.test(n))return new URL(n);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(n))}class VR{constructor(e){this.source=e,this.url=HR(e.url),Qe(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){var e;return((e=this._fullRequestReader)==null?void 0:e._loaded)??0}getFullReader(){return Qe(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new GR(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const i=new OR(this,e,t);return this._rangeRequestReaders.push(i),i}cancelAllRequests(e){var t;(t=this._fullRequestReader)==null||t.cancel(e);for(const i of this._rangeRequestReaders.slice(0))i.cancel(e)}}class GR{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const i=process.getBuiltinModule("fs");i.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(i.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=new kc(`Missing PDF "${this._url}".`)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new Gr("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class OR{constructor(e,t,i){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const r=process.getBuiltinModule("fs");this._setReadableStream(r.createReadStream(this._url,{start:t,end:i-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){var i;if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,(i=this.onProgress)==null||i.call(this,{loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const BR=1e5,Zt=30,zR=.8;var mE,cr,nn,gd,md,Ro,hs,yd,vd,Mo,Tl,xl,dr,Il,_d,Pl,ko,Ad,Ed,bo,No,Sd,hr,Rl,Gs,xC,IC,ry,Mn,sf,oy,PC,RC;const et=class et{constructor({textContentSource:e,container:t,viewport:i}){S(this,Gs);S(this,cr,Promise.withResolvers());S(this,nn,null);S(this,gd,!1);S(this,md,!!((mE=globalThis.FontInspector)!=null&&mE.enabled));S(this,Ro,null);S(this,hs,null);S(this,yd,0);S(this,vd,0);S(this,Mo,null);S(this,Tl,null);S(this,xl,0);S(this,dr,0);S(this,Il,Object.create(null));S(this,_d,[]);S(this,Pl,null);S(this,ko,[]);S(this,Ad,new WeakMap);S(this,Ed,null);var l;if(e instanceof ReadableStream)_(this,Pl,e);else if(typeof e=="object")_(this,Pl,new ReadableStream({start(u){u.enqueue(e),u.close()}}));else throw new Error('No "textContentSource" parameter specified.');_(this,nn,_(this,Tl,t)),_(this,dr,i.scale*(globalThis.devicePixelRatio||1)),_(this,xl,i.rotation),_(this,hs,{div:null,properties:null,ctx:null});const{pageWidth:s,pageHeight:r,pageX:o,pageY:a}=i.rawDims;_(this,Ed,[1,0,0,-1,-o,a+r]),_(this,vd,s),_(this,yd,r),C(l=et,Mn,PC).call(l),ma(t,i),c(this,cr).promise.finally(()=>{c(et,Rl).delete(this),_(this,hs,null),_(this,Il,null)}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=Wt.platform;return re(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{c(this,Mo).read().then(({value:t,done:i})=>{if(i){c(this,cr).resolve();return}c(this,Ro)??_(this,Ro,t.lang),Object.assign(c(this,Il),t.styles),C(this,Gs,xC).call(this,t.items),e()},c(this,cr).reject)};return _(this,Mo,c(this,Pl).getReader()),c(et,Rl).add(this),e(),c(this,cr).promise}update({viewport:e,onBefore:t=null}){var r;const i=e.scale*(globalThis.devicePixelRatio||1),s=e.rotation;if(s!==c(this,xl)&&(t==null||t(),_(this,xl,s),ma(c(this,Tl),{rotation:s})),i!==c(this,dr)){t==null||t(),_(this,dr,i);const o={div:null,properties:null,ctx:C(r=et,Mn,sf).call(r,c(this,Ro))};for(const a of c(this,ko))o.properties=c(this,Ad).get(a),o.div=a,C(this,Gs,ry).call(this,o)}}cancel(){var t;const e=new Gr("TextLayer task cancelled.");(t=c(this,Mo))==null||t.cancel(e).catch(()=>{}),_(this,Mo,null),c(this,cr).reject(e)}get textDivs(){return c(this,ko)}get textContentItemsStr(){return c(this,_d)}static cleanup(){if(!(c(this,Rl).size>0)){c(this,bo).clear();for(const{canvas:e}of c(this,No).values())e.remove();c(this,No).clear()}}};cr=new WeakMap,nn=new WeakMap,gd=new WeakMap,md=new WeakMap,Ro=new WeakMap,hs=new WeakMap,yd=new WeakMap,vd=new WeakMap,Mo=new WeakMap,Tl=new WeakMap,xl=new WeakMap,dr=new WeakMap,Il=new WeakMap,_d=new WeakMap,Pl=new WeakMap,ko=new WeakMap,Ad=new WeakMap,Ed=new WeakMap,bo=new WeakMap,No=new WeakMap,Sd=new WeakMap,hr=new WeakMap,Rl=new WeakMap,Gs=new WeakSet,xC=function(e){var s,r;if(c(this,gd))return;(r=c(this,hs)).ctx??(r.ctx=C(s=et,Mn,sf).call(s,c(this,Ro)));const t=c(this,ko),i=c(this,_d);for(const o of e){if(t.length>BR){te("Ignoring additional textDivs for performance reasons."),_(this,gd,!0);return}if(o.str===void 0){if(o.type==="beginMarkedContentProps"||o.type==="beginMarkedContent"){const a=c(this,nn);_(this,nn,document.createElement("span")),c(this,nn).classList.add("markedContent"),o.id!==null&&c(this,nn).setAttribute("id",`${o.id}`),a.append(c(this,nn))}else o.type==="endMarkedContent"&&_(this,nn,c(this,nn).parentNode);continue}i.push(o.str),C(this,Gs,IC).call(this,o)}},IC=function(e){var A;const t=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};c(this,ko).push(t);const s=W.transform(c(this,Ed),e.transform);let r=Math.atan2(s[1],s[0]);const o=c(this,Il)[e.fontName];o.vertical&&(r+=Math.PI/2);let a=c(this,md)&&o.fontSubstitution||o.fontFamily;a=et.fontFamilyMap.get(a)||a;const l=Math.hypot(s[2],s[3]),u=l*C(A=et,Mn,RC).call(A,a,c(this,Ro));let h,p;r===0?(h=s[4],p=s[5]-u):(h=s[4]+u*Math.sin(r),p=s[5]-u*Math.cos(r));const g="calc(var(--scale-factor)*",m=t.style;c(this,nn)===c(this,Tl)?(m.left=`${(100*h/c(this,vd)).toFixed(2)}%`,m.top=`${(100*p/c(this,yd)).toFixed(2)}%`):(m.left=`${g}${h.toFixed(2)}px)`,m.top=`${g}${p.toFixed(2)}px)`),m.fontSize=`${g}${(c(et,hr)*l).toFixed(2)}px)`,m.fontFamily=a,i.fontSize=l,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,c(this,md)&&(t.dataset.fontName=o.fontSubstitutionLoadedName||e.fontName),r!==0&&(i.angle=r*(180/Math.PI));let y=!1;if(e.str.length>1)y=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const T=Math.abs(e.transform[0]),v=Math.abs(e.transform[3]);T!==v&&Math.max(T,v)/Math.min(T,v)>1.5&&(y=!0)}if(y&&(i.canvasWidth=o.vertical?e.height:e.width),c(this,Ad).set(t,i),c(this,hs).div=t,c(this,hs).properties=i,C(this,Gs,ry).call(this,c(this,hs)),i.hasText&&c(this,nn).append(t),i.hasEOL){const T=document.createElement("br");T.setAttribute("role","presentation"),c(this,nn).append(T)}},ry=function(e){var a;const{div:t,properties:i,ctx:s}=e,{style:r}=t;let o="";if(c(et,hr)>1&&(o=`scale(${1/c(et,hr)})`),i.canvasWidth!==0&&i.hasText){const{fontFamily:l}=r,{canvasWidth:u,fontSize:h}=i;C(a=et,Mn,oy).call(a,s,h*c(this,dr),l);const{width:p}=s.measureText(t.textContent);p>0&&(o=`scaleX(${u*c(this,dr)/p}) ${o}`)}i.angle!==0&&(o=`rotate(${i.angle}deg) ${o}`),o.length>0&&(r.transform=o)},Mn=new WeakSet,sf=function(e=null){let t=c(this,No).get(e||(e=""));if(!t){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=e,document.body.append(i),t=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),c(this,No).set(e,t),c(this,Sd).set(t,{size:0,family:""})}return t},oy=function(e,t,i){const s=c(this,Sd).get(e);t===s.size&&i===s.family||(e.font=`${t}px ${i}`,s.size=t,s.family=i)},PC=function(){if(c(this,hr)!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),_(this,hr,e.getBoundingClientRect().height),e.remove()},RC=function(e,t){const i=c(this,bo).get(e);if(i)return i;const s=C(this,Mn,sf).call(this,t);s.canvas.width=s.canvas.height=Zt,C(this,Mn,oy).call(this,s,Zt,e);const r=s.measureText("");let o=r.fontBoundingBoxAscent,a=Math.abs(r.fontBoundingBoxDescent);if(o){const h=o/(o+a);return c(this,bo).set(e,h),s.canvas.width=s.canvas.height=0,h}s.strokeStyle="red",s.clearRect(0,0,Zt,Zt),s.strokeText("g",0,0);let l=s.getImageData(0,0,Zt,Zt).data;a=0;for(let h=l.length-1-3;h>=0;h-=4)if(l[h]>0){a=Math.ceil(h/4/Zt);break}s.clearRect(0,0,Zt,Zt),s.strokeText("A",0,Zt),l=s.getImageData(0,0,Zt,Zt).data,o=0;for(let h=0,p=l.length;h<p;h+=4)if(l[h]>0){o=Zt-Math.floor(h/4/Zt);break}s.canvas.width=s.canvas.height=0;const u=o?o/(o+a):zR;return c(this,bo).set(e,u),u},S(et,Mn),S(et,bo,new Map),S(et,No,new Map),S(et,Sd,new WeakMap),S(et,hr,null),S(et,Rl,new Set);let bc=et;class Nc{static textContent(e){const t=[],i={items:t,styles:Object.create(null)};function s(r){var l;if(!r)return;let o=null;const a=r.name;if(a==="#text")o=r.value;else if(Nc.shouldBuildText(a))(l=r==null?void 0:r.attributes)!=null&&l.textContent?o=r.attributes.textContent:r.value&&(o=r.value);else return;if(o!==null&&t.push({str:o}),!!r.children)for(const u of r.children)s(u)}return s(e),i}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}const qR=65536,$R=100,WR=5e3,YR=Dt?aR:sR,KR=Dt?lR:pC,JR=Dt?oR:rR,XR=Dt?uR:vC;function QR(n={}){typeof n=="string"||n instanceof URL?n={url:n}:(n instanceof ArrayBuffer||ArrayBuffer.isView(n))&&(n={data:n});const e=new ay,{docId:t}=e,i=n.url?ZR(n.url):null,s=n.data?jR(n.data):null,r=n.httpHeaders||null,o=n.withCredentials===!0,a=n.password??null,l=n.range instanceof MC?n.range:null,u=Number.isInteger(n.rangeChunkSize)&&n.rangeChunkSize>0?n.rangeChunkSize:qR;let h=n.worker instanceof tl?n.worker:null;const p=n.verbosity,g=typeof n.docBaseUrl=="string"&&!Yp(n.docBaseUrl)?n.docBaseUrl:null,m=typeof n.cMapUrl=="string"?n.cMapUrl:null,y=n.cMapPacked!==!1,A=n.CMapReaderFactory||KR,T=typeof n.standardFontDataUrl=="string"?n.standardFontDataUrl:null,v=n.StandardFontDataFactory||XR,E=n.stopAtErrors!==!0,w=Number.isInteger(n.maxImageSize)&&n.maxImageSize>-1?n.maxImageSize:-1,x=n.isEvalSupported!==!1,I=typeof n.isOffscreenCanvasSupported=="boolean"?n.isOffscreenCanvasSupported:!Dt,P=typeof n.isImageDecoderSupported=="boolean"?n.isImageDecoderSupported:!Dt&&(Wt.platform.isFirefox||!globalThis.chrome),R=Number.isInteger(n.canvasMaxAreaInBytes)?n.canvasMaxAreaInBytes:-1,k=typeof n.disableFontFace=="boolean"?n.disableFontFace:Dt,b=n.fontExtraProperties===!0,N=n.enableXfa===!0,D=n.ownerDocument||globalThis.document,Y=n.disableRange===!0,ie=n.disableStream===!0,ae=n.disableAutoFetch===!0,Ye=n.pdfBug===!0,F=n.CanvasFactory||YR,$=n.FilterFactory||JR,U=n.enableHWA===!0,K=l?l.length:n.length??NaN,Q=typeof n.useSystemFonts=="boolean"?n.useSystemFonts:!Dt&&!k,ce=typeof n.useWorkerFetch=="boolean"?n.useWorkerFetch:A===pC&&v===vC&&m&&T&&Gu(m,document.baseURI)&&Gu(T,document.baseURI),le=null;FP(p);const Re={canvasFactory:new F({ownerDocument:D,enableHWA:U}),filterFactory:new $({docId:t,ownerDocument:D}),cMapReaderFactory:ce?null:new A({baseUrl:m,isCompressed:y}),standardFontDataFactory:ce?null:new v({baseUrl:T})};if(!h){const Ge={verbosity:p,port:Ps.workerPort};h=Ge.port?tl.fromPort(Ge):new tl(Ge),e._worker=h}const Qt={docId:t,apiVersion:"4.10.38",data:s,password:a,disableAutoFetch:ae,rangeChunkSize:u,length:K,docBaseUrl:g,enableXfa:N,evaluatorOptions:{maxImageSize:w,disableFontFace:k,ignoreErrors:E,isEvalSupported:x,isOffscreenCanvasSupported:I,isImageDecoderSupported:P,canvasMaxAreaInBytes:R,fontExtraProperties:b,useSystemFonts:Q,cMapUrl:ce?m:null,standardFontDataUrl:ce?T:null}},Ji={disableFontFace:k,fontExtraProperties:b,ownerDocument:D,pdfBug:Ye,styleElement:le,loadingParams:{disableAutoFetch:ae,enableXfa:N}};return h.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const Ge=h.messageHandler.sendWithPromise("GetDocRequest",Qt,s?[s.buffer]:null);let me;if(l)me=new xR(l,{disableRange:Y,disableStream:ie});else if(!s){if(!i)throw new Error("getDocument - no `url` parameter provided.");let Ca;if(Dt)if(Gu(i)){if(typeof fetch>"u"||typeof Response>"u"||!("body"in Response.prototype))throw new Error("getDocument - the Fetch API was disabled in Node.js, see `--no-experimental-fetch`.");Ca=O_}else Ca=VR;else Ca=Gu(i)?O_:LR;me=new Ca({url:i,length:K,httpHeaders:r,withCredentials:o,rangeChunkSize:u,disableRange:Y,disableStream:ie})}return Ge.then(Ca=>{if(e.destroyed)throw new Error("Loading aborted");if(h.destroyed)throw new Error("Worker was destroyed");const g0=new qu(t,Ca,h.port),tx=new iM(g0,e,me,Ji,Re);e._transport=tx,g0.send("Ready",null)})}).catch(e._capability.reject),e}function ZR(n){if(n instanceof URL)return n.href;try{return new URL(n,window.location).href}catch{if(Dt&&typeof n=="string")return n}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function jR(n){if(Dt&&typeof Buffer<"u"&&n instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(n instanceof Uint8Array&&n.byteLength===n.buffer.byteLength)return n;if(typeof n=="string")return $p(n);if(n instanceof ArrayBuffer||ArrayBuffer.isView(n)||typeof n=="object"&&!isNaN(n==null?void 0:n.length))return new Uint8Array(n);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function B_(n){return typeof n=="object"&&Number.isInteger(n==null?void 0:n.num)&&n.num>=0&&Number.isInteger(n==null?void 0:n.gen)&&n.gen>=0}var gp;const mp=class mp{constructor(){this._capability=Promise.withResolvers(),this._transport=null,this._worker=null,this.docId=`d${Ht(mp,gp)._++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){var e,t,i,s;this.destroyed=!0;try{(e=this._worker)!=null&&e.port&&(this._worker._pendingDestroy=!0),await((t=this._transport)==null?void 0:t.destroy())}catch(r){throw(i=this._worker)!=null&&i.port&&delete this._worker._pendingDestroy,r}this._transport=null,(s=this._worker)==null||s.destroy(),this._worker=null}};gp=new WeakMap,S(mp,gp,0);let ay=mp;class MC{constructor(e,t,i=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=i,this.contentDispositionFilename=s,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=Promise.withResolvers()}addRangeListener(e){this._rangeListeners.push(e)}addProgressListener(e){this._progressListeners.push(e)}addProgressiveReadListener(e){this._progressiveReadListeners.push(e)}addProgressiveDoneListener(e){this._progressiveDoneListeners.push(e)}onDataRange(e,t){for(const i of this._rangeListeners)i(e,t)}onDataProgress(e,t){this._readyCapability.promise.then(()=>{for(const i of this._progressListeners)i(e,t)})}onDataProgressiveRead(e){this._readyCapability.promise.then(()=>{for(const t of this._progressiveReadListeners)t(e)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const e of this._progressiveDoneListeners)e()})}transportReady(){this._readyCapability.resolve()}requestDataRange(e,t){Se("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class eM{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return re(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}var fr,fs,qn,Ma,rf;class tM{constructor(e,t,i,s=!1){S(this,qn);S(this,fr,null);S(this,fs,!1);this._pageIndex=e,this._pageInfo=t,this._transport=i,this._stats=s?new P_:null,this._pdfBug=s,this.commonObjs=i.commonObjs,this.objs=new kC,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:i=0,offsetY:s=0,dontFlip:r=!1}={}){return new ch({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:i,offsetY:s,dontFlip:r})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return re(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){var e;return((e=this._transport._htmlForXfa)==null?void 0:e.children[this._pageIndex])||null}render({canvasContext:e,viewport:t,intent:i="display",annotationMode:s=Xs.ENABLE,transform:r=null,background:o=null,optionalContentConfigPromise:a=null,annotationCanvasMap:l=null,pageColors:u=null,printAnnotationStorage:h=null,isEditing:p=!1}){var x,I;(x=this._stats)==null||x.time("Overall");const g=this._transport.getRenderingIntent(i,s,h,p),{renderingIntent:m,cacheKey:y}=g;_(this,fs,!1),C(this,qn,rf).call(this),a||(a=this._transport.getOptionalContentConfig(m));let A=this._intentStates.get(y);A||(A=Object.create(null),this._intentStates.set(y,A)),A.streamReaderCancelTimeout&&(clearTimeout(A.streamReaderCancelTimeout),A.streamReaderCancelTimeout=null);const T=!!(m&Cn.PRINT);A.displayReadyCapability||(A.displayReadyCapability=Promise.withResolvers(),A.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(I=this._stats)==null||I.time("Page Request"),this._pumpOperatorList(g));const v=P=>{var R;A.renderTasks.delete(E),(this._maybeCleanupAfterRender||T)&&_(this,fs,!0),C(this,qn,Ma).call(this,!T),P?(E.capability.reject(P),this._abortOperatorList({intentState:A,reason:P instanceof Error?P:new Error(P)})):E.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),(R=globalThis.Stats)!=null&&R.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},E=new uy({callback:v,params:{canvasContext:e,viewport:t,transform:r,background:o},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:l,operatorList:A.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:u});(A.renderTasks||(A.renderTasks=new Set)).add(E);const w=E.task;return Promise.all([A.displayReadyCapability.promise,a]).then(([P,R])=>{var k;if(this.destroyed){v();return}if((k=this._stats)==null||k.time("Rendering"),!(R.renderingIntent&m))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");E.initializeGraphics({transparency:P,optionalContentConfig:R}),E.operatorListChanged()}).catch(v),w}getOperatorList({intent:e="display",annotationMode:t=Xs.ENABLE,printAnnotationStorage:i=null,isEditing:s=!1}={}){var u;function r(){a.operatorList.lastChunk&&(a.opListReadCapability.resolve(a.operatorList),a.renderTasks.delete(l))}const o=this._transport.getRenderingIntent(e,t,i,s,!0);let a=this._intentStates.get(o.cacheKey);a||(a=Object.create(null),this._intentStates.set(o.cacheKey,a));let l;return a.opListReadCapability||(l=Object.create(null),l.operatorListChanged=r,a.opListReadCapability=Promise.withResolvers(),(a.renderTasks||(a.renderTasks=new Set)).add(l),a.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},(u=this._stats)==null||u.time("Page Request"),this._pumpOperatorList(o)),a.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Nc.textContent(i));const t=this.streamTextContent(e);return new Promise(function(i,s){function r(){o.read().then(function({value:l,done:u}){if(u){i(a);return}a.lang??(a.lang=l.lang),Object.assign(a.styles,l.styles),a.items.push(...l.items),r()},s)}const o=t.getReader(),a={items:[],styles:Object.create(null),lang:null};r()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const i of t.renderTasks)e.push(i.completed),i.cancel();return this.objs.clear(),_(this,fs,!1),C(this,qn,rf).call(this),Promise.all(e)}cleanup(e=!1){_(this,fs,!0);const t=C(this,qn,Ma).call(this,!1);return e&&t&&this._stats&&(this._stats=new P_),t}_startRenderPage(e,t){var s,r;const i=this._intentStates.get(t);i&&((s=this._stats)==null||s.timeEnd("Page Request"),(r=i.displayReadyCapability)==null||r.resolve(e))}_renderPageChunk(e,t){for(let i=0,s=e.length;i<s;i++)t.operatorList.fnArray.push(e.fnArray[i]),t.operatorList.argsArray.push(e.argsArray[i]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const i of t.renderTasks)i.operatorListChanged();e.lastChunk&&C(this,qn,Ma).call(this,!0)}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:i,modifiedIds:s}){const{map:r,transfer:o}=i,l=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:r,modifiedIds:s},o).getReader(),u=this._intentStates.get(t);u.streamReader=l;const h=()=>{l.read().then(({value:p,done:g})=>{if(g){u.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(p,u),h())},p=>{if(u.streamReader=null,!this._transport.destroyed){if(u.operatorList){u.operatorList.lastChunk=!0;for(const g of u.renderTasks)g.operatorListChanged();C(this,qn,Ma).call(this,!0)}if(u.displayReadyCapability)u.displayReadyCapability.reject(p);else if(u.opListReadCapability)u.opListReadCapability.reject(p);else throw p}})};h()}_abortOperatorList({intentState:e,reason:t,force:i=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!i){if(e.renderTasks.size>0)return;if(t instanceof Yv){let s=$R;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new Gr(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,r]of this._intentStates)if(r===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}fr=new WeakMap,fs=new WeakMap,qn=new WeakSet,Ma=function(e=!1){if(C(this,qn,rf).call(this),!c(this,fs)||this.destroyed)return!1;if(e)return _(this,fr,setTimeout(()=>{_(this,fr,null),C(this,qn,Ma).call(this,!1)},WR)),!1;for(const{renderTasks:t,operatorList:i}of this._intentStates.values())if(t.size>0||!i.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),_(this,fs,!1),!0},rf=function(){c(this,fr)&&(clearTimeout(c(this,fr)),_(this,fr,null))};var ps,yp;class nM{constructor(){S(this,ps,new Map);S(this,yp,Promise.resolve())}postMessage(e,t){const i={data:structuredClone(e,t?{transfer:t}:null)};c(this,yp).then(()=>{for(const[s]of c(this,ps))s.call(this,i)})}addEventListener(e,t,i=null){let s=null;if((i==null?void 0:i.signal)instanceof AbortSignal){const{signal:r}=i;if(r.aborted){te("LoopbackPort - cannot use an `aborted` signal.");return}const o=()=>this.removeEventListener(e,t);s=()=>r.removeEventListener("abort",o),r.addEventListener("abort",o)}c(this,ps).set(t,s)}removeEventListener(e,t){const i=c(this,ps).get(t);i==null||i(),c(this,ps).delete(t)}terminate(){for(const[,e]of c(this,ps))e==null||e();c(this,ps).clear()}}ps=new WeakMap,yp=new WeakMap;var vp,Lo,Do,Ml,of,kl,af;const Me=class Me{constructor({name:e=null,port:t=null,verbosity:i=UP()}={}){S(this,Ml);var s;if(this.name=e,this.destroyed=!1,this.verbosity=i,this._readyCapability=Promise.withResolvers(),this._port=null,this._webWorker=null,this._messageHandler=null,t){if((s=c(Me,Do))!=null&&s.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(c(Me,Do)||_(Me,Do,new WeakMap)).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new qu("main","worker",e),this._messageHandler.on("ready",function(){}),C(this,Ml,of).call(this)}_initialize(){if(c(Me,Lo)||c(Me,kl,af)){this._setupFakeWorker();return}let{workerSrc:e}=Me;try{Me._isSameOrigin(window.location.href,e)||(e=Me._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),i=new qu("main","worker",t),s=()=>{r.abort(),i.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},r=new AbortController;t.addEventListener("error",()=>{this._webWorker||s()},{signal:r.signal}),i.on("test",a=>{if(r.abort(),this.destroyed||!a){s();return}this._messageHandler=i,this._port=t,this._webWorker=t,C(this,Ml,of).call(this)}),i.on("ready",a=>{if(r.abort(),this.destroyed){s();return}try{o()}catch{this._setupFakeWorker()}});const o=()=>{const a=new Uint8Array;i.send("test",a,[a.buffer])};o();return}catch{qp("The worker has been disabled.")}this._setupFakeWorker()}_setupFakeWorker(){c(Me,Lo)||(te("Setting up fake worker."),_(Me,Lo,!0)),Me._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new nM;this._port=t;const i=`fake${Ht(Me,vp)._++}`,s=new qu(i+"_worker",i,t);e.setup(s,t),this._messageHandler=new qu(i,i+"_worker",t),C(this,Ml,of).call(this)}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){var e,t,i;this.destroyed=!0,(e=this._webWorker)==null||e.terminate(),this._webWorker=null,(t=c(Me,Do))==null||t.delete(this._port),this._port=null,(i=this._messageHandler)==null||i.destroy(),this._messageHandler=null}static fromPort(e){var i;if(!(e!=null&&e.port))throw new Error("PDFWorker.fromPort - invalid method signature.");const t=(i=c(this,Do))==null?void 0:i.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new Me(e)}static get workerSrc(){if(Ps.workerSrc)return Ps.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return re(this,"_setupFakeWorkerGlobal",(async()=>c(this,kl,af)?c(this,kl,af):(await import(this.workerSrc)).WorkerMessageHandler)())}};vp=new WeakMap,Lo=new WeakMap,Do=new WeakMap,Ml=new WeakSet,of=function(){this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})},kl=new WeakSet,af=function(){var e;try{return((e=globalThis.pdfjsWorker)==null?void 0:e.WorkerMessageHandler)||null}catch{return null}},S(Me,kl),S(Me,vp,0),S(Me,Lo,!1),S(Me,Do),Dt&&(_(Me,Lo,!0),Ps.workerSrc||(Ps.workerSrc="./pdf.worker.mjs")),Me._isSameOrigin=(e,t)=>{let i;try{if(i=new URL(e),!i.origin||i.origin==="null")return!1}catch{return!1}const s=new URL(t,i);return i.origin===s.origin},Me._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))};let tl=Me;var gs,Ui,bl,Nl,ms,Fo,Ju;class iM{constructor(e,t,i,s,r){S(this,Fo);S(this,gs,new Map);S(this,Ui,new Map);S(this,bl,new Map);S(this,Nl,new Map);S(this,ms,null);this.messageHandler=e,this.loadingTask=t,this.commonObjs=new kC,this.fontLoader=new nR({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=r.canvasFactory,this.filterFactory=r.filterFactory,this.cMapReaderFactory=r.cMapReaderFactory,this.standardFontDataFactory=r.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=i,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.setupMessageHandler()}get annotationStorage(){return re(this,"annotationStorage",new Qv)}getRenderingIntent(e,t=Xs.ENABLE,i=null,s=!1,r=!1){let o=Cn.DISPLAY,a=Xm;switch(e){case"any":o=Cn.ANY;break;case"display":break;case"print":o=Cn.PRINT;break;default:te(`getRenderingIntent - invalid intent: ${e}`)}const l=o&Cn.PRINT&&i instanceof lC?i:this.annotationStorage;switch(t){case Xs.DISABLE:o+=Cn.ANNOTATIONS_DISABLE;break;case Xs.ENABLE:break;case Xs.ENABLE_FORMS:o+=Cn.ANNOTATIONS_FORMS;break;case Xs.ENABLE_STORAGE:o+=Cn.ANNOTATIONS_STORAGE,a=l.serializable;break;default:te(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(o+=Cn.IS_EDITING),r&&(o+=Cn.OPLIST);const{ids:u,hash:h}=l.modifiedIds,p=[o,a.hash,h];return{renderingIntent:o,cacheKey:p.join("_"),annotationStorageSerializable:a,modifiedIds:u}}destroy(){var i;if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),(i=c(this,ms))==null||i.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const s of c(this,Ui).values())e.push(s._destroy());c(this,Ui).clear(),c(this,bl).clear(),c(this,Nl).clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{var s,r;this.commonObjs.clear(),this.fontLoader.clear(),c(this,gs).clear(),this.filterFactory.destroy(),bc.cleanup(),(s=this._networkStream)==null||s.cancelAllRequests(new Gr("Worker was terminated.")),(r=this.messageHandler)==null||r.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(i,s)=>{Qe(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=r=>{this._lastProgress={loaded:r.loaded,total:r.total}},s.onPull=()=>{this._fullReader.read().then(function({value:r,done:o}){if(o){s.close();return}Qe(r instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(r),1,[r])}).catch(r=>{s.error(r)})},s.onCancel=r=>{this._fullReader.cancel(r),s.ready.catch(o=>{if(!this.destroyed)throw o})}}),e.on("ReaderHeadersReady",async i=>{var a;await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:r,contentLength:o}=this._fullReader;return(!s||!r)&&(this._lastProgress&&((a=t.onProgress)==null||a.call(t,this._lastProgress)),this._fullReader.onProgress=l=>{var u;(u=t.onProgress)==null||u.call(t,{loaded:l.loaded,total:l.total})}),{isStreamingSupported:s,isRangeSupported:r,contentLength:o}}),e.on("GetRangeReader",(i,s)=>{Qe(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const r=this._networkStream.getRangeReader(i.begin,i.end);if(!r){s.close();return}s.onPull=()=>{r.read().then(function({value:o,done:a}){if(a){s.close();return}Qe(o instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{r.cancel(o),s.ready.catch(a=>{if(!this.destroyed)throw a})}}),e.on("GetDoc",({pdfInfo:i})=>{this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,t._capability.resolve(new eM(i,this))}),e.on("DocException",i=>{t._capability.reject(jt(i))}),e.on("PasswordRequest",i=>{_(this,ms,Promise.withResolvers());try{if(!t.onPassword)throw jt(i);const s=r=>{r instanceof Error?c(this,ms).reject(r):c(this,ms).resolve({password:r})};t.onPassword(s,i.code)}catch(s){c(this,ms).reject(s)}return c(this,ms).promise}),e.on("DataLoaded",i=>{var s;(s=t.onProgress)==null||s.call(t,{loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),e.on("StartRenderPage",i=>{if(this.destroyed)return;c(this,Ui).get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),e.on("commonobj",([i,s,r])=>{var o;if(this.destroyed||this.commonObjs.has(i))return null;switch(s){case"Font":const{disableFontFace:a,fontExtraProperties:l,pdfBug:u}=this._params;if("error"in r){const m=r.error;te(`Error during font loading: ${m}`),this.commonObjs.resolve(i,m);break}const h=u&&((o=globalThis.FontInspector)!=null&&o.enabled)?(m,y)=>globalThis.FontInspector.fontAdded(m,y):null,p=new iR(r,{disableFontFace:a,fontExtraProperties:l,inspectFont:h});this.fontLoader.bind(p).catch(()=>e.sendWithPromise("FontFallback",{id:i})).finally(()=>{!l&&p.data&&(p.data=null),this.commonObjs.resolve(i,p)});break;case"CopyLocalImage":const{imageRef:g}=r;Qe(g,"The imageRef must be defined.");for(const m of c(this,Ui).values())for(const[,y]of m.objs)if((y==null?void 0:y.ref)===g)return y.dataLen?(this.commonObjs.resolve(i,structuredClone(y)),y.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(i,r);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([i,s,r,o])=>{var l;if(this.destroyed)return;const a=c(this,Ui).get(s);if(!a.objs.has(i)){if(a._intentStates.size===0){(l=o==null?void 0:o.bitmap)==null||l.close();return}switch(r){case"Image":a.objs.resolve(i,o),(o==null?void 0:o.dataLen)>bP&&(a._maybeCleanupAfterRender=!0);break;case"Pattern":a.objs.resolve(i,o);break;default:throw new Error(`Got unknown object type ${r}`)}}}),e.on("DocProgress",i=>{var s;this.destroyed||(s=t.onProgress)==null||s.call(t,{loaded:i.loaded,total:i.total})}),e.on("FetchBuiltInCMap",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.cMapReaderFactory)throw new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter.");return this.cMapReaderFactory.fetch(i)}),e.on("FetchStandardFontData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");if(!this.standardFontDataFactory)throw new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.");return this.standardFontDataFactory.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){var i;this.annotationStorage.size<=0&&te("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:((i=this._fullReader)==null?void 0:i.filename)??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,i=c(this,bl).get(t);if(i)return i;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(r=>{if(this.destroyed)throw new Error("Transport destroyed");r.refStr&&c(this,Nl).set(r.refStr,e);const o=new tM(t,r,this,this._params.pdfBug);return c(this,Ui).set(t,o),o});return c(this,bl).set(t,s),s}getPageIndex(e){return B_(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return C(this,Fo,Ju).call(this,"GetFieldObjects")}hasJSActions(){return C(this,Fo,Ju).call(this,"HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return C(this,Fo,Ju).call(this,"GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return C(this,Fo,Ju).call(this,"GetOptionalContentConfig").then(t=>new TR(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=c(this,gs).get(e);if(t)return t;const i=this.messageHandler.sendWithPromise(e,null).then(s=>{var r,o;return{info:s[0],metadata:s[1]?new wR(s[1]):null,contentDispositionFilename:((r=this._fullReader)==null?void 0:r.filename)??null,contentLength:((o=this._fullReader)==null?void 0:o.contentLength)??null}});return c(this,gs).set(e,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of c(this,Ui).values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),c(this,gs).clear(),this.filterFactory.destroy(!0),bc.cleanup()}}cachedPageNumber(e){if(!B_(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return c(this,Nl).get(t)??null}}gs=new WeakMap,Ui=new WeakMap,bl=new WeakMap,Nl=new WeakMap,ms=new WeakMap,Fo=new WeakSet,Ju=function(e,t=null){const i=c(this,gs).get(e);if(i)return i;const s=this.messageHandler.sendWithPromise(e,t);return c(this,gs).set(e,s),s};const Nu=Symbol("INITIAL_DATA");var pn,wd,ly;class kC{constructor(){S(this,wd);S(this,pn,Object.create(null))}get(e,t=null){if(t){const s=C(this,wd,ly).call(this,e);return s.promise.then(()=>t(s.data)),null}const i=c(this,pn)[e];if(!i||i.data===Nu)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return i.data}has(e){const t=c(this,pn)[e];return!!t&&t.data!==Nu}delete(e){const t=c(this,pn)[e];return!t||t.data===Nu?!1:(delete c(this,pn)[e],!0)}resolve(e,t=null){const i=C(this,wd,ly).call(this,e);i.data=t,i.resolve()}clear(){var e;for(const t in c(this,pn)){const{data:i}=c(this,pn)[t];(e=i==null?void 0:i.bitmap)==null||e.close()}_(this,pn,Object.create(null))}*[Symbol.iterator](){for(const e in c(this,pn)){const{data:t}=c(this,pn)[e];t!==Nu&&(yield[e,t])}}}pn=new WeakMap,wd=new WeakSet,ly=function(e){var t;return(t=c(this,pn))[e]||(t[e]={...Promise.withResolvers(),data:Nu})};var pr;class sM{constructor(e){S(this,pr,null);_(this,pr,e),this.onContinue=null}get promise(){return c(this,pr).capability.promise}cancel(e=0){c(this,pr).cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=c(this,pr).operatorList;if(!e)return!1;const{annotationCanvasMap:t}=c(this,pr);return e.form||e.canvas&&(t==null?void 0:t.size)>0}}pr=new WeakMap;var gr,Uo;const eo=class eo{constructor({callback:e,params:t,objs:i,commonObjs:s,annotationCanvasMap:r,operatorList:o,pageIndex:a,canvasFactory:l,filterFactory:u,useRequestAnimationFrame:h=!1,pdfBug:p=!1,pageColors:g=null}){S(this,gr,null);this.callback=e,this.params=t,this.objs=i,this.commonObjs=s,this.annotationCanvasMap=r,this.operatorListIdx=null,this.operatorList=o,this._pageIndex=a,this.canvasFactory=l,this.filterFactory=u,this._pdfBug=p,this.pageColors=g,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=h===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new sM(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){var a,l;if(this.cancelled)return;if(this._canvas){if(c(eo,Uo).has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");c(eo,Uo).add(this._canvas)}this._pdfBug&&((a=globalThis.StepperManager)!=null&&a.enabled)&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:i,viewport:s,transform:r,background:o}=this.params;this.gfx=new el(i,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:r,viewport:s,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,(l=this.graphicsReadyCallback)==null||l.call(this)}cancel(e=null,t=0){var i;this.running=!1,this.cancelled=!0,(i=this.gfx)==null||i.endDrawing(),c(this,gr)&&(window.cancelAnimationFrame(c(this,gr)),_(this,gr,null)),c(eo,Uo).delete(this._canvas),this.callback(e||new Yv(`Rendering cancelled, page ${this._pageIndex+1}`,t))}operatorListChanged(){var e;if(!this.graphicsReady){this.graphicsReadyCallback||(this.graphicsReadyCallback=this._continueBound);return}(e=this.stepper)==null||e.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?_(this,gr,window.requestAnimationFrame(()=>{_(this,gr,null),this._nextBound().catch(this._cancelBound)})):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),c(eo,Uo).delete(this._canvas),this.callback())))}};gr=new WeakMap,Uo=new WeakMap,S(eo,Uo,new WeakSet);let uy=eo;const rM="4.10.38",oM="f9bea397f";function z_(n){return Math.floor(Math.max(0,Math.min(1,n))*255).toString(16).padStart(2,"0")}function Lu(n){return Math.max(0,Math.min(255,255*n))}class q_{static CMYK_G([e,t,i,s]){return["G",1-Math.min(1,.3*e+.59*i+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=Lu(e),[e,e,e]}static G_HTML([e]){const t=z_(e);return`#${t}${t}${t}`}static RGB_G([e,t,i]){return["G",.3*e+.59*t+.11*i]}static RGB_rgb(e){return e.map(Lu)}static RGB_HTML(e){return`#${e.map(z_).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,i,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,i+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,i,s]){return[Lu(1-Math.min(1,e+s)),Lu(1-Math.min(1,i+s)),Lu(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,i]){const s=1-e,r=1-t,o=1-i,a=Math.min(s,r,o);return["CMYK",s,r,o,a]}}class aM{create(e,t,i=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),i||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Se("Abstract method `_createSVG` called.")}}class jv extends aM{_createSVG(e){return document.createElementNS(Xi,e)}}class bC{static setupStorage(e,t,i,s,r){const o=s.getValue(t,{value:null});switch(i.name){case"textarea":if(o.value!==null&&(e.textContent=o.value),r==="print")break;e.addEventListener("input",a=>{s.setValue(t,{value:a.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(o.value===i.attributes.xfaOn?e.setAttribute("checked",!0):o.value===i.attributes.xfaOff&&e.removeAttribute("checked"),r==="print")break;e.addEventListener("change",a=>{s.setValue(t,{value:a.target.checked?a.target.getAttribute("xfaOn"):a.target.getAttribute("xfaOff")})})}else{if(o.value!==null&&e.setAttribute("value",o.value),r==="print")break;e.addEventListener("input",a=>{s.setValue(t,{value:a.target.value})})}break;case"select":if(o.value!==null){e.setAttribute("value",o.value);for(const a of i.children)a.attributes.value===o.value?a.attributes.selected=!0:a.attributes.hasOwnProperty("selected")&&delete a.attributes.selected}e.addEventListener("input",a=>{const l=a.target.options,u=l.selectedIndex===-1?"":l[l.selectedIndex].value;s.setValue(t,{value:u})});break}}static setAttributes({html:e,element:t,storage:i=null,intent:s,linkService:r}){const{attributes:o}=t,a=e instanceof HTMLAnchorElement;o.type==="radio"&&(o.name=`${o.name}-${s}`);for(const[l,u]of Object.entries(o))if(u!=null)switch(l){case"class":u.length&&e.setAttribute(l,u.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",u);break;case"style":Object.assign(e.style,u);break;case"textContent":e.textContent=u;break;default:(!a||l!=="href"&&l!=="newWindow")&&e.setAttribute(l,u)}a&&r.addLinkAttributes(e,o.href,o.newWindow),i&&o.dataId&&this.setupStorage(e,o.dataId,t,i)}static render(e){var p,g;const t=e.annotationStorage,i=e.linkService,s=e.xfaHtml,r=e.intent||"display",o=document.createElement(s.name);s.attributes&&this.setAttributes({html:o,element:s,intent:r,linkService:i});const a=r!=="richText",l=e.div;if(l.append(o),e.viewport){const m=`matrix(${e.viewport.transform.join(",")})`;l.style.transform=m}a&&l.setAttribute("class","xfaLayer xfaFont");const u=[];if(s.children.length===0){if(s.value){const m=document.createTextNode(s.value);o.append(m),a&&Nc.shouldBuildText(s.name)&&u.push(m)}return{textDivs:u}}const h=[[s,-1,o]];for(;h.length>0;){const[m,y,A]=h.at(-1);if(y+1===m.children.length){h.pop();continue}const T=m.children[++h.at(-1)[1]];if(T===null)continue;const{name:v}=T;if(v==="#text"){const w=document.createTextNode(T.value);u.push(w),A.append(w);continue}const E=(p=T==null?void 0:T.attributes)!=null&&p.xmlns?document.createElementNS(T.attributes.xmlns,v):document.createElement(v);if(A.append(E),T.attributes&&this.setAttributes({html:E,element:T,storage:t,intent:r,linkService:i}),((g=T.children)==null?void 0:g.length)>0)h.push([T,-1,E]);else if(T.value){const w=document.createTextNode(T.value);a&&Nc.shouldBuildText(v)&&u.push(w),E.append(w)}}for(const m of l.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))m.setAttribute("readOnly",!0);return{textDivs:u}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const hh=1e3,lM=9,va=new WeakSet;function Ur(n){return{width:n[2]-n[0],height:n[3]-n[1]}}class uM{static create(e){switch(e.data.annotationType){case je.LINK:return new NC(e);case je.TEXT:return new cM(e);case je.WIDGET:switch(e.data.fieldType){case"Tx":return new dM(e);case"Btn":return e.data.radioButton?new FC(e):e.data.checkBox?new fM(e):new pM(e);case"Ch":return new gM(e);case"Sig":return new hM(e)}return new Sa(e);case je.POPUP:return new dy(e);case je.FREETEXT:return new OC(e);case je.LINE:return new yM(e);case je.SQUARE:return new vM(e);case je.CIRCLE:return new _M(e);case je.POLYLINE:return new BC(e);case je.CARET:return new EM(e);case je.INK:return new e0(e);case je.POLYGON:return new AM(e);case je.HIGHLIGHT:return new zC(e);case je.UNDERLINE:return new SM(e);case je.SQUIGGLY:return new wM(e);case je.STRIKEOUT:return new CM(e);case je.STAMP:return new qC(e);case je.FILEATTACHMENT:return new TM(e);default:return new We(e)}}}var Ho,Ll,Dl,Cd,cy;const h0=class h0{constructor(e,{isRenderable:t=!1,ignoreBorder:i=!1,createQuadrilaterals:s=!1}={}){S(this,Cd);S(this,Ho,null);S(this,Ll,!1);S(this,Dl,null);this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(i)),s&&this._createQuadrilaterals()}static _hasPopupData({titleObj:e,contentsObj:t,richText:i}){return!!(e!=null&&e.str||t!=null&&t.str||i!=null&&i.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return h0._hasPopupData(this.data)}updateEdited(e){var i;if(!this.container)return;c(this,Ho)||_(this,Ho,{rect:this.data.rect.slice(0)});const{rect:t}=e;t&&C(this,Cd,cy).call(this,t),(i=c(this,Dl))==null||i.popup.updateEdited(e)}resetEdited(){var e;c(this,Ho)&&(C(this,Cd,cy).call(this,c(this,Ho).rect),(e=c(this,Dl))==null||e.popup.resetEdited(),_(this,Ho,null))}_createContainer(e){const{data:t,parent:{page:i,viewport:s}}=this,r=document.createElement("section");r.setAttribute("data-annotation-id",t.id),this instanceof Sa||(r.tabIndex=hh);const{style:o}=r;if(o.zIndex=this.parent.zIndex++,t.alternativeText&&(r.title=t.alternativeText),t.noRotate&&r.classList.add("norotate"),!t.rect||this instanceof dy){const{rotation:A}=t;return!t.hasOwnCanvas&&A!==0&&this.setRotation(A,r),r}const{width:a,height:l}=Ur(t.rect);if(!e&&t.borderStyle.width>0){o.borderWidth=`${t.borderStyle.width}px`;const A=t.borderStyle.horizontalCornerRadius,T=t.borderStyle.verticalCornerRadius;if(A>0||T>0){const E=`calc(${A}px * var(--scale-factor)) / calc(${T}px * var(--scale-factor))`;o.borderRadius=E}else if(this instanceof FC){const E=`calc(${a}px * var(--scale-factor)) / calc(${l}px * var(--scale-factor))`;o.borderRadius=E}switch(t.borderStyle.style){case ku.SOLID:o.borderStyle="solid";break;case ku.DASHED:o.borderStyle="dashed";break;case ku.BEVELED:te("Unimplemented border style: beveled");break;case ku.INSET:te("Unimplemented border style: inset");break;case ku.UNDERLINE:o.borderBottomStyle="solid";break}const v=t.borderColor||null;v?(_(this,Ll,!0),o.borderColor=W.makeHexColor(v[0]|0,v[1]|0,v[2]|0)):o.borderWidth=0}const u=W.normalizeRect([t.rect[0],i.view[3]-t.rect[1]+i.view[1],t.rect[2],i.view[3]-t.rect[3]+i.view[1]]),{pageWidth:h,pageHeight:p,pageX:g,pageY:m}=s.rawDims;o.left=`${100*(u[0]-g)/h}%`,o.top=`${100*(u[1]-m)/p}%`;const{rotation:y}=t;return t.hasOwnCanvas||y===0?(o.width=`${100*a/h}%`,o.height=`${100*l/p}%`):this.setRotation(y,r),r}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:s}=this.parent.viewport.rawDims,{width:r,height:o}=Ur(this.data.rect);let a,l;e%180===0?(a=100*r/i,l=100*o/s):(a=100*o/i,l=100*r/s),t.style.width=`${a}%`,t.style.height=`${l}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,i,s)=>{const r=s.detail[t],o=r[0],a=r.slice(1);s.target.style[i]=q_[`${o}_HTML`](a),this.annotationStorage.setValue(this.data.id,{[i]:q_[`${o}_rgb`](a)})};return re(this,"_commonActions",{display:t=>{const{display:i}=t.detail,s=i%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:i===1||i===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:i}=t.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const i=t.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(e,t){const i=this._commonActions;for(const s of Object.keys(t.detail)){const r=e[s]||i[s];r==null||r(t)}}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const i=this._commonActions;for(const[s,r]of Object.entries(t)){const o=i[s];if(o){const a={detail:{[s]:r},target:e};o(a),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,i,s,r]=this.data.rect.map(A=>Math.fround(A));if(e.length===8){const[A,T,v,E]=e.subarray(2,6);if(s===A&&r===T&&t===v&&i===E)return}const{style:o}=this.container;let a;if(c(this,Ll)){const{borderColor:A,borderWidth:T}=o;o.borderWidth=0,a=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${A}" stroke-width="${T}">`],this.container.classList.add("hasBorder")}const l=s-t,u=r-i,{svgFactory:h}=this,p=h.createElement("svg");p.classList.add("quadrilateralsContainer"),p.setAttribute("width",0),p.setAttribute("height",0);const g=h.createElement("defs");p.append(g);const m=h.createElement("clipPath"),y=`clippath_${this.data.id}`;m.setAttribute("id",y),m.setAttribute("clipPathUnits","objectBoundingBox"),g.append(m);for(let A=2,T=e.length;A<T;A+=8){const v=e[A],E=e[A+1],w=e[A+2],x=e[A+3],I=h.createElement("rect"),P=(w-t)/l,R=(r-E)/u,k=(v-w)/l,b=(E-x)/u;I.setAttribute("x",P),I.setAttribute("y",R),I.setAttribute("width",k),I.setAttribute("height",b),m.append(I),a==null||a.push(`<rect vector-effect="non-scaling-stroke" x="${P}" y="${R}" width="${k}" height="${b}"/>`)}c(this,Ll)&&(a.push("</g></svg>')"),o.backgroundImage=a.join("")),this.container.append(p),this.container.style.clipPath=`url(#${y})`}_createPopup(){const{data:e}=this,t=_(this,Dl,new dy({data:{color:e.color,titleObj:e.titleObj,modificationDate:e.modificationDate,contentsObj:e.contentsObj,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation},parent:this.parent,elements:[this]}));this.parent.div.append(t.render())}render(){Se("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const i=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:r,id:o,exportValues:a}of s){if(r===-1||o===t)continue;const l=typeof a=="string"?a:null,u=document.querySelector(`[data-element-id="${o}"]`);if(u&&!va.has(u)){te(`_getElementsByName - element not allowed: ${o}`);continue}i.push({id:o,exportValue:l,domElement:u})}return i}for(const s of document.getElementsByName(e)){const{exportValue:r}=s,o=s.getAttribute("data-element-id");o!==t&&va.has(s)&&i.push({id:o,exportValue:r,domElement:s})}return i}show(){var e;this.container&&(this.container.hidden=!1),(e=this.popup)==null||e.maybeShow()}hide(){var e;this.container&&(this.container.hidden=!0),(e=this.popup)==null||e.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{var i;(i=this.linkService.eventBus)==null||i.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t})})}};Ho=new WeakMap,Ll=new WeakMap,Dl=new WeakMap,Cd=new WeakSet,cy=function(e){const{container:{style:t},data:{rect:i,rotation:s},parent:{viewport:{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:l}}}}=this;i==null||i.splice(0,4,...e);const{width:u,height:h}=Ur(e);t.left=`${100*(e[0]-a)/r}%`,t.top=`${100*(o-e[3]+l)/o}%`,s===0?(t.width=`${100*u/r}%`,t.height=`${100*h/o}%`):this.setRotation(s)};let We=h0;var xn,Xr,LC,DC;class NC extends We{constructor(t,i=null){super(t,{isRenderable:!0,ignoreBorder:!!(i!=null&&i.ignoreBorder),createQuadrilaterals:!0});S(this,xn);this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:i}=this,s=document.createElement("a");s.setAttribute("data-element-id",t.id);let r=!1;return t.url?(i.addLinkAttributes(s,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(s,t.action),r=!0):t.attachment?(C(this,xn,LC).call(this,s,t.attachment,t.attachmentDest),r=!0):t.setOCGState?(C(this,xn,DC).call(this,s,t.setOCGState),r=!0):t.dest?(this._bindLink(s,t.dest),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(s,t),r=!0),t.resetForm?(this._bindResetFormAction(s,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(s,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&this.container.append(s),this.container}_bindLink(t,i){t.href=this.linkService.getDestinationHash(i),t.onclick=()=>(i&&this.linkService.goToDestination(i),!1),(i||i==="")&&C(this,xn,Xr).call(this)}_bindNamedAction(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(i),!1),C(this,xn,Xr).call(this)}_bindJSAction(t,i){t.href=this.linkService.getAnchorUrl("");const s=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(i.actions)){const o=s.get(r);o&&(t[o]=()=>{var a;return(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:i.id,name:r}}),!1})}t.onclick||(t.onclick=()=>!1),C(this,xn,Xr).call(this)}_bindResetFormAction(t,i){const s=t.onclick;if(s||(t.href=this.linkService.getAnchorUrl("")),C(this,xn,Xr).call(this),!this._fieldObjects){te('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),s||(t.onclick=()=>!1);return}t.onclick=()=>{var p;s==null||s();const{fields:r,refs:o,include:a}=i,l=[];if(r.length!==0||o.length!==0){const g=new Set(o);for(const m of r){const y=this._fieldObjects[m]||[];for(const{id:A}of y)g.add(A)}for(const m of Object.values(this._fieldObjects))for(const y of m)g.has(y.id)===a&&l.push(y)}else for(const g of Object.values(this._fieldObjects))l.push(...g);const u=this.annotationStorage,h=[];for(const g of l){const{id:m}=g;switch(h.push(m),g.type){case"text":{const A=g.defaultValue||"";u.setValue(m,{value:A});break}case"checkbox":case"radiobutton":{const A=g.defaultValue===g.exportValues;u.setValue(m,{value:A});break}case"combobox":case"listbox":{const A=g.defaultValue||"";u.setValue(m,{value:A});break}default:continue}const y=document.querySelector(`[data-element-id="${m}"]`);if(y){if(!va.has(y)){te(`_bindResetFormAction - element not allowed: ${m}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&((p=this.linkService.eventBus)==null||p.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:h,name:"ResetForm"}})),!1}}}xn=new WeakSet,Xr=function(){this.container.setAttribute("data-internal-link","")},LC=function(t,i,s=null){t.href=this.linkService.getAnchorUrl(""),i.description&&(t.title=i.description),t.onclick=()=>{var r;return(r=this.downloadManager)==null||r.openOrDownloadData(i.content,i.filename,s),!1},C(this,xn,Xr).call(this)},DC=function(t,i){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(i),!1),C(this,xn,Xr).call(this)};class cM extends We{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class Sa extends We{render(){return this.container}showElementAndHideCanvas(e){var t;this.data.hasOwnCanvas&&(((t=e.previousSibling)==null?void 0:t.nodeName)==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return Wt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,i,s,r){i.includes("mouse")?e.addEventListener(i,o=>{var a;(a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(o),shift:o.shiftKey,modifier:this._getKeyModifier(o)}})}):e.addEventListener(i,o=>{var a;if(i==="blur"){if(!t.focused||!o.relatedTarget)return;t.focused=!1}else if(i==="focus"){if(t.focused)return;t.focused=!0}r&&((a=this.linkService.eventBus)==null||a.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:r(o)}}))})}_setEventListeners(e,t,i,s){var r,o,a;for(const[l,u]of i)(u==="Action"||(r=this.data.actions)!=null&&r[u])&&((u==="Focus"||u==="Blur")&&(t||(t={focused:!1})),this._setEventListener(e,t,l,u,s),u==="Focus"&&!((o=this.data.actions)!=null&&o.Blur)?this._setEventListener(e,t,"blur","Blur",null):u==="Blur"&&!((a=this.data.actions)!=null&&a.Focus)&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":W.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||lM,r=e.style;let o;const a=2,l=u=>Math.round(10*u)/10;if(this.data.multiLine){const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a),h=Math.round(u/(Ig*s))||1,p=u/h;o=Math.min(s,l(p/Ig))}else{const u=Math.abs(this.data.rect[3]-this.data.rect[1]-a);o=Math.min(s,l(u/Ig))}r.fontSize=`calc(${o}px * var(--scale-factor))`,r.color=W.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(r.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class dM extends Sa{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,i,s){const r=this.annotationStorage;for(const o of this._getElementsByName(e.name,e.id))o.domElement&&(o.domElement[t]=i),r.setValue(o.id,{[s]:i})}render(){var s,r;const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const o=e.getValue(t,{value:this.data.fieldValue});let a=o.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&a.length>l&&(a=a.slice(0,l));let u=o.formattedValue||((s=this.data.textContent)==null?void 0:s.join(`
`))||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const h={userValue:a,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=u??a,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type="text",i.setAttribute("value",u??a),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),va.add(i),i.setAttribute("data-element-id",t),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=hh,this._setRequired(i,this.data.required),l&&(i.maxLength=l),i.addEventListener("input",g=>{e.setValue(t,{value:g.target.value}),this.setPropertyOnSiblings(i,"value",g.target.value,"value"),h.formattedValue=null}),i.addEventListener("resetform",g=>{const m=this.data.defaultFieldValue??"";i.value=h.userValue=m,h.formattedValue=null});let p=g=>{const{formattedValue:m}=h;m!=null&&(g.target.value=m),g.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",m=>{var A;if(h.focused)return;const{target:y}=m;h.userValue&&(y.value=h.userValue),h.lastCommittedValue=y.value,h.commitKey=1,(A=this.data.actions)!=null&&A.Focus||(h.focused=!0)}),i.addEventListener("updatefromsandbox",m=>{this.showElementAndHideCanvas(m.target);const y={value(A){h.userValue=A.detail.value??"",e.setValue(t,{value:h.userValue.toString()}),A.target.value=h.userValue},formattedValue(A){const{formattedValue:T}=A.detail;h.formattedValue=T,T!=null&&A.target!==document.activeElement&&(A.target.value=T),e.setValue(t,{formattedValue:T})},selRange(A){A.target.setSelectionRange(...A.detail.selRange)},charLimit:A=>{var w;const{charLimit:T}=A.detail,{target:v}=A;if(T===0){v.removeAttribute("maxLength");return}v.setAttribute("maxLength",T);let E=h.userValue;!E||E.length<=T||(E=E.slice(0,T),v.value=h.userValue=E,e.setValue(t,{value:E}),(w=this.linkService.eventBus)==null||w.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:1,selStart:v.selectionStart,selEnd:v.selectionEnd}}))}};this._dispatchEventFromSandbox(y,m)}),i.addEventListener("keydown",m=>{var T;h.commitKey=1;let y=-1;if(m.key==="Escape"?y=0:m.key==="Enter"&&!this.data.multiLine?y=2:m.key==="Tab"&&(h.commitKey=3),y===-1)return;const{value:A}=m.target;h.lastCommittedValue!==A&&(h.lastCommittedValue=A,h.userValue=A,(T=this.linkService.eventBus)==null||T.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:A,willCommit:!0,commitKey:y,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}}))});const g=p;p=null,i.addEventListener("blur",m=>{var A,T;if(!h.focused||!m.relatedTarget)return;(A=this.data.actions)!=null&&A.Blur||(h.focused=!1);const{value:y}=m.target;h.userValue=y,h.lastCommittedValue!==y&&((T=this.linkService.eventBus)==null||T.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:y,willCommit:!0,commitKey:h.commitKey,selStart:m.target.selectionStart,selEnd:m.target.selectionEnd}})),g(m)}),(r=this.data.actions)!=null&&r.Keystroke&&i.addEventListener("beforeinput",m=>{var I;h.lastCommittedValue=null;const{data:y,target:A}=m,{value:T,selectionStart:v,selectionEnd:E}=A;let w=v,x=E;switch(m.inputType){case"deleteWordBackward":{const P=T.substring(0,v).match(/\w*[^\w]*$/);P&&(w-=P[0].length);break}case"deleteWordForward":{const P=T.substring(v).match(/^[^\w]*\w*/);P&&(x+=P[0].length);break}case"deleteContentBackward":v===E&&(w-=1);break;case"deleteContentForward":v===E&&(x+=1);break}m.preventDefault(),(I=this.linkService.eventBus)==null||I.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:T,change:y||"",willCommit:!1,selStart:w,selEnd:x}})}),this._setEventListeners(i,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],m=>m.target.value)}if(p&&i.addEventListener("blur",p),this.data.comb){const m=(this.data.rect[2]-this.data.rect[0])/l;i.classList.add("comb"),i.style.letterSpacing=`calc(${m}px * var(--scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class hM extends Sa{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class fM extends Sa{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(i,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const r=document.createElement("input");return va.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="checkbox",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.setAttribute("exportValue",t.exportValue),r.tabIndex=hh,r.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const u of this._getElementsByName(a,i)){const h=l&&u.exportValue===t.exportValue;u.domElement&&(u.domElement.checked=h),e.setValue(u.id,{value:h})}e.setValue(i,{value:l})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue||"Off";o.target.checked=a===t.exportValue}),this.enableScripting&&this.hasJSActions&&(r.addEventListener("updatefromsandbox",o=>{const a={value(l){l.target.checked=l.detail.value!=="Off",e.setValue(i,{value:l.target.checked})}};this._dispatchEventFromSandbox(a,o)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],o=>o.target.checked)),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class FC extends Sa{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,i=t.id;let s=e.getValue(i,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(i,{value:s})),s)for(const o of this._getElementsByName(t.fieldName,i))e.setValue(o.id,{value:!1});const r=document.createElement("input");if(va.add(r),r.setAttribute("data-element-id",i),r.disabled=t.readOnly,this._setRequired(r,this.data.required),r.type="radio",r.name=t.fieldName,s&&r.setAttribute("checked",!0),r.tabIndex=hh,r.addEventListener("change",o=>{const{name:a,checked:l}=o.target;for(const u of this._getElementsByName(a,i))e.setValue(u.id,{value:!1});e.setValue(i,{value:l})}),r.addEventListener("resetform",o=>{const a=t.defaultFieldValue;o.target.checked=a!=null&&a===t.buttonValue}),this.enableScripting&&this.hasJSActions){const o=t.buttonValue;r.addEventListener("updatefromsandbox",a=>{const l={value:u=>{const h=o===u.detail.value;for(const p of this._getElementsByName(u.target.name)){const g=h&&p.id===i;p.domElement&&(p.domElement.checked=g),e.setValue(p.id,{value:g})}}};this._dispatchEventFromSandbox(l,a)}),this._setEventListeners(r,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],a=>a.target.checked)}return this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class pM extends NC{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),e}}class gM extends Sa{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,i=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");va.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=hh;let r=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",h=>{const p=this.data.defaultFieldValue;for(const g of s.options)g.selected=g.value===p});for(const h of this.data.options){const p=document.createElement("option");p.textContent=h.displayValue,p.value=h.exportValue,i.value.includes(h.exportValue)&&(p.setAttribute("selected",!0),r=!1),s.append(p)}let o=null;if(r){const h=document.createElement("option");h.value=" ",h.setAttribute("hidden",!0),h.setAttribute("selected",!0),s.prepend(h),o=()=>{h.remove(),s.removeEventListener("input",o),o=null},s.addEventListener("input",o)}const a=h=>{const p=h?"value":"textContent",{options:g,multiple:m}=s;return m?Array.prototype.filter.call(g,y=>y.selected).map(y=>y[p]):g.selectedIndex===-1?null:g[g.selectedIndex][p]};let l=a(!1);const u=h=>{const p=h.target.options;return Array.prototype.map.call(p,g=>({displayValue:g.textContent,exportValue:g.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",h=>{const p={value(g){o==null||o();const m=g.detail.value,y=new Set(Array.isArray(m)?m:[m]);for(const A of s.options)A.selected=y.has(A.value);e.setValue(t,{value:a(!0)}),l=a(!1)},multipleSelection(g){s.multiple=!0},remove(g){const m=s.options,y=g.detail.remove;m[y].selected=!1,s.remove(y),m.length>0&&Array.prototype.findIndex.call(m,T=>T.selected)===-1&&(m[0].selected=!0),e.setValue(t,{value:a(!0),items:u(g)}),l=a(!1)},clear(g){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),l=a(!1)},insert(g){const{index:m,displayValue:y,exportValue:A}=g.detail.insert,T=s.children[m],v=document.createElement("option");v.textContent=y,v.value=A,T?T.before(v):s.append(v),e.setValue(t,{value:a(!0),items:u(g)}),l=a(!1)},items(g){const{items:m}=g.detail;for(;s.length!==0;)s.remove(0);for(const y of m){const{displayValue:A,exportValue:T}=y,v=document.createElement("option");v.textContent=A,v.value=T,s.append(v)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:a(!0),items:u(g)}),l=a(!1)},indices(g){const m=new Set(g.detail.indices);for(const y of g.target.options)y.selected=m.has(y.index);e.setValue(t,{value:a(!0)}),l=a(!1)},editable(g){g.target.disabled=!g.detail.editable}};this._dispatchEventFromSandbox(p,h)}),s.addEventListener("input",h=>{var m;const p=a(!0),g=a(!1);e.setValue(t,{value:p}),h.preventDefault(),(m=this.linkService.eventBus)==null||m.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:l,change:g,changeEx:p,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],h=>h.target.value)):s.addEventListener("input",function(h){e.setValue(t,{value:a(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class dy extends We{constructor(e){const{data:t,elements:i}=e;super(e,{isRenderable:We._hasPopupData(t)}),this.elements=i,this.popup=null}render(){this.container.classList.add("popupAnnotation");const e=this.popup=new mM({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),t=[];for(const i of this.elements)i.popup=e,i.container.ariaHasPopup="dialog",t.push(i.data.id),i.addHighlightArea();return this.container.setAttribute("aria-controls",t.map(i=>`${Wv}${i}`).join(",")),this.container}}var Fl,_p,Ap,Ul,Vo,Oe,ys,Hl,Td,xd,Vl,vs,oi,_s,Id,As,Pd,Go,Oo,Ee,lf,hy,UC,HC,VC,GC,uf,cf,fy;class mM{constructor({container:e,color:t,elements:i,titleObj:s,modificationDate:r,contentsObj:o,richText:a,parent:l,rect:u,parentRect:h,open:p}){S(this,Ee);S(this,Fl,C(this,Ee,VC).bind(this));S(this,_p,C(this,Ee,fy).bind(this));S(this,Ap,C(this,Ee,cf).bind(this));S(this,Ul,C(this,Ee,uf).bind(this));S(this,Vo,null);S(this,Oe,null);S(this,ys,null);S(this,Hl,null);S(this,Td,null);S(this,xd,null);S(this,Vl,null);S(this,vs,!1);S(this,oi,null);S(this,_s,null);S(this,Id,null);S(this,As,null);S(this,Pd,null);S(this,Go,null);S(this,Oo,!1);var g;_(this,Oe,e),_(this,Pd,s),_(this,ys,o),_(this,As,a),_(this,xd,l),_(this,Vo,t),_(this,Id,u),_(this,Vl,h),_(this,Td,i),_(this,Hl,Jv.toDateObject(r)),this.trigger=i.flatMap(m=>m.getElementsToTriggerPopup());for(const m of this.trigger)m.addEventListener("click",c(this,Ul)),m.addEventListener("mouseenter",c(this,Ap)),m.addEventListener("mouseleave",c(this,_p)),m.classList.add("popupTriggerArea");for(const m of i)(g=m.container)==null||g.addEventListener("keydown",c(this,Fl));c(this,Oe).hidden=!0,p&&C(this,Ee,uf).call(this)}render(){if(c(this,oi))return;const e=_(this,oi,document.createElement("div"));if(e.className="popup",c(this,Vo)){const r=e.style.outlineColor=W.makeHexColor(...c(this,Vo));CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?e.style.backgroundColor=`color-mix(in srgb, ${r} 30%, white)`:e.style.backgroundColor=W.makeHexColor(...c(this,Vo).map(a=>Math.floor(.7*(255-a)+a)))}const t=document.createElement("span");t.className="header";const i=document.createElement("h1");if(t.append(i),{dir:i.dir,str:i.textContent}=c(this,Pd),e.append(t),c(this,Hl)){const r=document.createElement("span");r.classList.add("popupDate"),r.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),r.setAttribute("data-l10n-args",JSON.stringify({dateObj:c(this,Hl).valueOf()})),t.append(r)}const s=c(this,Ee,lf);if(s)bC.render({xfaHtml:s,intent:"richText",div:e}),e.lastChild.classList.add("richText","popupContent");else{const r=this._formatContents(c(this,ys));e.append(r)}c(this,Oe).append(e)}_formatContents({str:e,dir:t}){const i=document.createElement("p");i.classList.add("popupContent"),i.dir=t;const s=e.split(/(?:\r\n?|\n)/);for(let r=0,o=s.length;r<o;++r){const a=s[r];i.append(document.createTextNode(a)),r<o-1&&i.append(document.createElement("br"))}return i}updateEdited({rect:e,popupContent:t}){var i;c(this,Go)||_(this,Go,{contentsObj:c(this,ys),richText:c(this,As)}),e&&_(this,_s,null),t&&(_(this,As,C(this,Ee,HC).call(this,t)),_(this,ys,null)),(i=c(this,oi))==null||i.remove(),_(this,oi,null)}resetEdited(){var e;c(this,Go)&&({contentsObj:Ht(this,ys)._,richText:Ht(this,As)._}=c(this,Go),_(this,Go,null),(e=c(this,oi))==null||e.remove(),_(this,oi,null),_(this,_s,null))}forceHide(){_(this,Oo,this.isVisible),c(this,Oo)&&(c(this,Oe).hidden=!0)}maybeShow(){c(this,Oo)&&(c(this,oi)||C(this,Ee,cf).call(this),_(this,Oo,!1),c(this,Oe).hidden=!1)}get isVisible(){return c(this,Oe).hidden===!1}}Fl=new WeakMap,_p=new WeakMap,Ap=new WeakMap,Ul=new WeakMap,Vo=new WeakMap,Oe=new WeakMap,ys=new WeakMap,Hl=new WeakMap,Td=new WeakMap,xd=new WeakMap,Vl=new WeakMap,vs=new WeakMap,oi=new WeakMap,_s=new WeakMap,Id=new WeakMap,As=new WeakMap,Pd=new WeakMap,Go=new WeakMap,Oo=new WeakMap,Ee=new WeakSet,lf=function(){const e=c(this,As),t=c(this,ys);return e!=null&&e.str&&(!(t!=null&&t.str)||t.str===e.str)&&c(this,As).html||null},hy=function(){var e,t,i;return((i=(t=(e=c(this,Ee,lf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.fontSize)||0},UC=function(){var e,t,i;return((i=(t=(e=c(this,Ee,lf))==null?void 0:e.attributes)==null?void 0:t.style)==null?void 0:i.color)||null},HC=function(e){const t=[],i={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:c(this,Ee,UC),fontSize:c(this,Ee,hy)?`calc(${c(this,Ee,hy)}px * var(--scale-factor))`:""}};for(const r of e.split(`
`))t.push({name:"span",value:r,attributes:s});return i},VC=function(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&c(this,vs))&&C(this,Ee,uf).call(this)},GC=function(){if(c(this,_s)!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:i,pageX:s,pageY:r}}}=c(this,xd);let o=!!c(this,Vl),a=o?c(this,Vl):c(this,Id);for(const y of c(this,Td))if(!a||W.intersect(y.data.rect,a)!==null){a=y.data.rect,o=!0;break}const l=W.normalizeRect([a[0],e[3]-a[1]+e[1],a[2],e[3]-a[3]+e[1]]),h=o?a[2]-a[0]+5:0,p=l[0]+h,g=l[1];_(this,_s,[100*(p-s)/t,100*(g-r)/i]);const{style:m}=c(this,Oe);m.left=`${c(this,_s)[0]}%`,m.top=`${c(this,_s)[1]}%`},uf=function(){_(this,vs,!c(this,vs)),c(this,vs)?(C(this,Ee,cf).call(this),c(this,Oe).addEventListener("click",c(this,Ul)),c(this,Oe).addEventListener("keydown",c(this,Fl))):(C(this,Ee,fy).call(this),c(this,Oe).removeEventListener("click",c(this,Ul)),c(this,Oe).removeEventListener("keydown",c(this,Fl)))},cf=function(){c(this,oi)||this.render(),this.isVisible?c(this,vs)&&c(this,Oe).classList.add("focused"):(C(this,Ee,GC).call(this),c(this,Oe).hidden=!1,c(this,Oe).style.zIndex=parseInt(c(this,Oe).style.zIndex)+1e3)},fy=function(){c(this,Oe).classList.remove("focused"),!(c(this,vs)||!this.isVisible)&&(c(this,Oe).hidden=!0,c(this,Oe).style.zIndex=parseInt(c(this,Oe).style.zIndex)-1e3)};class OC extends We{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=ee.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const i=document.createElement("span");i.textContent=t,e.append(i)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Rd;class yM extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Rd,null)}render(){this.container.classList.add("lineAnnotation");const t=this.data,{width:i,height:s}=Ur(t.rect),r=this.svgFactory.create(i,s,!0),o=_(this,Rd,this.svgFactory.createElement("svg:line"));return o.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),o.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),o.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),o.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),o.setAttribute("stroke-width",t.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),r.append(o),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Rd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Rd=new WeakMap;var Md;class vM extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Md,null)}render(){this.container.classList.add("squareAnnotation");const t=this.data,{width:i,height:s}=Ur(t.rect),r=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,a=_(this,Md,this.svgFactory.createElement("svg:rect"));return a.setAttribute("x",o/2),a.setAttribute("y",o/2),a.setAttribute("width",i-o),a.setAttribute("height",s-o),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,Md)}addHighlightArea(){this.container.classList.add("highlightArea")}}Md=new WeakMap;var kd;class _M extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,kd,null)}render(){this.container.classList.add("circleAnnotation");const t=this.data,{width:i,height:s}=Ur(t.rect),r=this.svgFactory.create(i,s,!0),o=t.borderStyle.width,a=_(this,kd,this.svgFactory.createElement("svg:ellipse"));return a.setAttribute("cx",i/2),a.setAttribute("cy",s/2),a.setAttribute("rx",i/2-o/2),a.setAttribute("ry",s/2-o/2),a.setAttribute("stroke-width",o||1),a.setAttribute("stroke","transparent"),a.setAttribute("fill","transparent"),r.append(a),this.container.append(r),!t.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,kd)}addHighlightArea(){this.container.classList.add("highlightArea")}}kd=new WeakMap;var bd;class BC extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,bd,null);this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:i,borderStyle:s,popupRef:r}}=this;if(!i)return this.container;const{width:o,height:a}=Ur(t),l=this.svgFactory.create(o,a,!0);let u=[];for(let p=0,g=i.length;p<g;p+=2){const m=i[p]-t[0],y=t[3]-i[p+1];u.push(`${m},${y}`)}u=u.join(" ");const h=_(this,bd,this.svgFactory.createElement(this.svgElementName));return h.setAttribute("points",u),h.setAttribute("stroke-width",s.width||1),h.setAttribute("stroke","transparent"),h.setAttribute("fill","transparent"),l.append(h),this.container.append(l),!r&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return c(this,bd)}addHighlightArea(){this.container.classList.add("highlightArea")}}bd=new WeakMap;class AM extends BC{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class EM extends We{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}var Nd,Bo,Ld,py;class e0 extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0});S(this,Ld);S(this,Nd,null);S(this,Bo,[]);this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ee.HIGHLIGHT:ee.INK}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:i,inkLists:s,borderStyle:r,popupRef:o}}=this,{transform:a,width:l,height:u}=C(this,Ld,py).call(this,i,t),h=this.svgFactory.create(l,u,!0),p=_(this,Nd,this.svgFactory.createElement("svg:g"));h.append(p),p.setAttribute("stroke-width",r.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",a);for(let g=0,m=s.length;g<m;g++){const y=this.svgFactory.createElement(this.svgElementName);c(this,Bo).push(y),y.setAttribute("points",s[g].join(",")),p.append(y)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(h),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:i,points:s,rect:r}=t,o=c(this,Nd);if(i>=0&&o.setAttribute("stroke-width",i||1),s)for(let a=0,l=c(this,Bo).length;a<l;a++)c(this,Bo)[a].setAttribute("points",s[a].join(","));if(r){const{transform:a,width:l,height:u}=C(this,Ld,py).call(this,this.data.rotation,r);o.parentElement.setAttribute("viewBox",`0 0 ${l} ${u}`),o.setAttribute("transform",a)}}getElementsToTriggerPopup(){return c(this,Bo)}addHighlightArea(){this.container.classList.add("highlightArea")}}Nd=new WeakMap,Bo=new WeakMap,Ld=new WeakSet,py=function(t,i){switch(t){case 90:return{transform:`rotate(90) translate(${-i[0]},${i[1]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};case 180:return{transform:`rotate(180) translate(${-i[2]},${i[1]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]};case 270:return{transform:`rotate(270) translate(${-i[2]},${i[3]}) scale(1,-1)`,width:i[3]-i[1],height:i[2]-i[0]};default:return{transform:`translate(${-i[0]},${i[3]}) scale(1,-1)`,width:i[2]-i[0],height:i[3]-i[1]}}};class zC extends We{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ee.HIGHLIGHT}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),this.container}}class SM extends We{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class wM extends We{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class CM extends We{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class qC extends We{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ee.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}var Dd,Fd,gy;class TM extends We{constructor(t){var s;super(t,{isRenderable:!0});S(this,Fd);S(this,Dd,null);const{file:i}=this.data;this.filename=i.filename,this.content=i.content,(s=this.linkService.eventBus)==null||s.dispatch("fileattachmentannotation",{source:this,...i})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:i}=this;let s;i.hasAppearance||i.fillAlpha===0?s=document.createElement("div"):(s=document.createElement("img"),s.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(i.name)?"paperclip":"pushpin"}.svg`,i.fillAlpha&&i.fillAlpha<1&&(s.style=`filter: opacity(${Math.round(i.fillAlpha*100)}%);`)),s.addEventListener("dblclick",C(this,Fd,gy).bind(this)),_(this,Dd,s);const{isMac:r}=Wt.platform;return t.addEventListener("keydown",o=>{o.key==="Enter"&&(r?o.metaKey:o.ctrlKey)&&C(this,Fd,gy).call(this)}),!i.popupRef&&this.hasPopupData?this._createPopup():s.classList.add("popupTriggerArea"),t.append(s),t}getElementsToTriggerPopup(){return c(this,Dd)}addHighlightArea(){this.container.classList.add("highlightArea")}}Dd=new WeakMap,Fd=new WeakSet,gy=function(){var t;(t=this.downloadManager)==null||t.openOrDownloadData(this.content,this.filename)};var Ud,zo,qo,Hd,_a,$C,my;class xM{constructor({div:e,accessibilityManager:t,annotationCanvasMap:i,annotationEditorUIManager:s,page:r,viewport:o,structTreeLayer:a}){S(this,_a);S(this,Ud,null);S(this,zo,null);S(this,qo,new Map);S(this,Hd,null);this.div=e,_(this,Ud,t),_(this,zo,i),_(this,Hd,a||null),this.page=r,this.viewport=o,this.zIndex=0,this._annotationEditorUIManager=s}hasEditableAnnotations(){return c(this,qo).size>0}async render(e){var o;const{annotations:t}=e,i=this.div;ma(i,this.viewport);const s=new Map,r={data:null,layer:i,linkService:e.linkService,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new jv,annotationStorage:e.annotationStorage||new Qv,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const a of t){if(a.noHTML)continue;const l=a.annotationType===je.POPUP;if(l){const p=s.get(a.id);if(!p)continue;r.elements=p}else{const{width:p,height:g}=Ur(a.rect);if(p<=0||g<=0)continue}r.data=a;const u=uM.create(r);if(!u.isRenderable)continue;if(!l&&a.popupRef){const p=s.get(a.popupRef);p?p.push(u):s.set(a.popupRef,[u])}const h=u.render();a.hidden&&(h.style.visibility="hidden"),await C(this,_a,$C).call(this,h,a.id),u._isEditable&&(c(this,qo).set(u.data.id,u),(o=this._annotationEditorUIManager)==null||o.renderAnnotationElement(u))}C(this,_a,my).call(this)}update({viewport:e}){const t=this.div;this.viewport=e,ma(t,{rotation:e.rotation}),C(this,_a,my).call(this),t.hidden=!1}getEditableAnnotations(){return Array.from(c(this,qo).values())}getEditableAnnotation(e){return c(this,qo).get(e)}}Ud=new WeakMap,zo=new WeakMap,qo=new WeakMap,Hd=new WeakMap,_a=new WeakSet,$C=async function(e,t){var o,a;const i=e.firstChild||e,s=i.id=`${Wv}${t}`,r=await((o=c(this,Hd))==null?void 0:o.getAriaAttributes(s));if(r)for(const[l,u]of r)i.setAttribute(l,u);this.div.append(e),(a=c(this,Ud))==null||a.moveElementInDOM(this.div,e,i,!1)},my=function(){if(!c(this,zo))return;const e=this.div;for(const[t,i]of c(this,zo)){const s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;i.className="annotationContent";const{firstChild:r}=s;r?r.nodeName==="CANVAS"?r.replaceWith(i):r.classList.contains("annotationContent")?r.after(i):r.before(i):s.append(i)}c(this,zo).clear()};const Nh=/\r\n?|\n/g;var ai,gn,Vd,$o,mn,Ze,WC,YC,KC,df,Ns,hf,ff,JC,vy,XC;const we=class we extends Ue{constructor(t){super({...t,name:"freeTextEditor"});S(this,Ze);S(this,ai);S(this,gn,"");S(this,Vd,`${this.id}-editor`);S(this,$o,null);S(this,mn);_(this,ai,t.color||we._defaultColor||Ue._defaultLineColor),_(this,mn,t.fontSize||we._defaultFontSize)}static get _keyboardManager(){const t=we.prototype,i=o=>o.isEmpty(),s=ya.TRANSLATE_SMALL,r=ya.TRANSLATE_BIG;return re(this,"_keyboardManager",new dh([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-s,0],checker:i}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:i}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[s,0],checker:i}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:i}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-s],checker:i}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:i}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,s],checker:i}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:i}]]))}static initialize(t,i){Ue.initialize(t,i);const s=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(s.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,i){switch(t){case ue.FREETEXT_SIZE:we._defaultFontSize=i;break;case ue.FREETEXT_COLOR:we._defaultColor=i;break}}updateParams(t,i){switch(t){case ue.FREETEXT_SIZE:C(this,Ze,WC).call(this,i);break;case ue.FREETEXT_COLOR:C(this,Ze,YC).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[ue.FREETEXT_SIZE,we._defaultFontSize],[ue.FREETEXT_COLOR,we._defaultColor||Ue._defaultLineColor]]}get propertiesToUpdate(){return[[ue.FREETEXT_SIZE,c(this,mn)],[ue.FREETEXT_COLOR,c(this,ai)]]}_translateEmpty(t,i){this._uiManager.translateSelectedEditors(t,i,!0)}getInitialTranslation(){const t=this.parentScale;return[-we._internalPadding*t,-(we._internalPadding+c(this,mn))*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(this.isInEditMode())return;this.parent.setEditingState(!1),this.parent.updateToolbar(ee.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),_(this,$o,new AbortController);const t=this._uiManager.combinedSignal(c(this,$o));this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t})}disableEditMode(){var t;this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",c(this,Vd)),this._isDraggable=!0,(t=c(this,$o))==null||t.abort(),_(this,$o,null),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"))}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){var i;this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),(i=this._initialOptions)!=null&&i.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=c(this,gn),i=_(this,gn,C(this,Ze,KC).call(this).trimEnd());if(t===i)return;const s=r=>{if(_(this,gn,r),!r){this.remove();return}C(this,Ze,ff).call(this),this._uiManager.rebuild(this),C(this,Ze,df).call(this)};this.addCommands({cmd:()=>{s(i)},undo:()=>{s(t)},mustExec:!1}),C(this,Ze,df).call(this)}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(t){this.enterInEditMode()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){we._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let t,i;this.width&&(t=this.x,i=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",c(this,Vd)),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:s}=this.editorDiv;if(s.fontSize=`calc(${c(this,mn)}px * var(--scale-factor))`,s.color=c(this,ai),this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),Xf(this,this.div,["dblclick","keydown"]),this.width){const[r,o]=this.parentDimensions;if(this.annotationElementId){const{position:a}=this._initialData;let[l,u]=this.getInitialTranslation();[l,u]=this.pageTranslationToScreen(l,u);const[h,p]=this.pageDimensions,[g,m]=this.pageTranslation;let y,A;switch(this.rotation){case 0:y=t+(a[0]-g)/h,A=i+this.height-(a[1]-m)/p;break;case 90:y=t+(a[0]-g)/h,A=i-(a[1]-m)/p,[l,u]=[u,-l];break;case 180:y=t-this.width+(a[0]-g)/h,A=i-(a[1]-m)/p,[l,u]=[-l,-u];break;case 270:y=t+(a[0]-g-this.height*p)/h,A=i+(a[1]-m-this.width*h)/p,[l,u]=[-u,l];break}this.setAt(y*r,A*o,l,u)}else this.setAt(t*r,i*o,this.width*r,this.height*o);C(this,Ze,ff).call(this),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}editorDivPaste(t){var y,A,T;const i=t.clipboardData||window.clipboardData,{types:s}=i;if(s.length===1&&s[0]==="text/plain")return;t.preventDefault();const r=C(y=we,Ns,vy).call(y,i.getData("text")||"").replaceAll(Nh,`
`);if(!r)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const a=o.getRangeAt(0);if(!r.includes(`
`)){a.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:l,startOffset:u}=a,h=[],p=[];if(l.nodeType===Node.TEXT_NODE){const v=l.parentElement;if(p.push(l.nodeValue.slice(u).replaceAll(Nh,"")),v!==this.editorDiv){let E=h;for(const w of this.editorDiv.childNodes){if(w===v){E=p;continue}E.push(C(A=we,Ns,hf).call(A,w))}}h.push(l.nodeValue.slice(0,u).replaceAll(Nh,""))}else if(l===this.editorDiv){let v=h,E=0;for(const w of this.editorDiv.childNodes)E++===u&&(v=p),v.push(C(T=we,Ns,hf).call(T,w))}_(this,gn,`${h.join(`
`)}${r}${p.join(`
`)}`),C(this,Ze,ff).call(this);const g=new Range;let m=h.reduce((v,E)=>v+E.length,0);for(const{firstChild:v}of this.editorDiv.childNodes)if(v.nodeType===Node.TEXT_NODE){const E=v.nodeValue.length;if(m<=E){g.setStart(v,m),g.setEnd(v,m);break}m-=E}o.removeAllRanges(),o.addRange(g)}get contentDiv(){return this.editorDiv}static async deserialize(t,i,s){var a;let r=null;if(t instanceof OC){const{data:{defaultAppearanceData:{fontSize:l,fontColor:u},rect:h,rotation:p,id:g,popupRef:m},textContent:y,textPosition:A,parent:{page:{pageNumber:T}}}=t;if(!y||y.length===0)return null;r=t={annotationType:ee.FREETEXT,color:Array.from(u),fontSize:l,value:y.join(`
`),position:A,pageIndex:T-1,rect:h.slice(0),rotation:p,id:g,deleted:!1,popupRef:m}}const o=await super.deserialize(t,i,s);return _(o,mn,t.fontSize),_(o,ai,W.makeHexColor(...t.color)),_(o,gn,C(a=we,Ns,vy).call(a,t.value)),o.annotationElementId=t.id||null,o._initialData=r,o}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=we._internalPadding*this.parentScale,s=this.getRect(i,i),r=Ue._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:c(this,ai)),o={annotationType:ee.FREETEXT,color:r,fontSize:c(this,mn),value:C(this,Ze,JC).call(this),pageIndex:this.pageIndex,rect:s,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?o:this.annotationElementId&&!C(this,Ze,XC).call(this,o)?null:(o.id=this.annotationElementId,o)}renderAnnotationElement(t){const i=super.renderAnnotationElement(t);if(this.deleted)return i;const{style:s}=i;s.fontSize=`calc(${c(this,mn)}px * var(--scale-factor))`,s.color=c(this,ai),i.replaceChildren();for(const o of c(this,gn).split(`
`)){const a=document.createElement("div");a.append(o?document.createTextNode(o):document.createElement("br")),i.append(a)}const r=we._internalPadding*this.parentScale;return t.updateEdited({rect:this.getRect(r,r),popupContent:c(this,gn)}),i}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}};ai=new WeakMap,gn=new WeakMap,Vd=new WeakMap,$o=new WeakMap,mn=new WeakMap,Ze=new WeakSet,WC=function(t){const i=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--scale-factor))`,this.translate(0,-(r-c(this,mn))*this.parentScale),_(this,mn,r),C(this,Ze,df).call(this)},s=c(this,mn);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ue.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})},YC=function(t){const i=r=>{_(this,ai,this.editorDiv.style.color=r)},s=c(this,ai);this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ue.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})},KC=function(){var s;const t=[];this.editorDiv.normalize();let i=null;for(const r of this.editorDiv.childNodes)(i==null?void 0:i.nodeType)===Node.TEXT_NODE&&r.nodeName==="BR"||(t.push(C(s=we,Ns,hf).call(s,r)),i=r);return t.join(`
`)},df=function(){const[t,i]=this.parentDimensions;let s;if(this.isAttachedToDOM)s=this.div.getBoundingClientRect();else{const{currentLayer:r,div:o}=this,a=o.style.display,l=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",r.div.append(this.div),s=o.getBoundingClientRect(),o.remove(),o.style.display=a,o.classList.toggle("hidden",l)}this.rotation%180===this.parentRotation%180?(this.width=s.width/t,this.height=s.height/i):(this.width=s.height/t,this.height=s.width/i),this.fixAndSetPosition()},Ns=new WeakSet,hf=function(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Nh,"")},ff=function(){if(this.editorDiv.replaceChildren(),!!c(this,gn))for(const t of c(this,gn).split(`
`)){const i=document.createElement("div");i.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(i)}},JC=function(){return c(this,gn).replaceAll(""," ")},vy=function(t){return t.replaceAll(" ","")},XC=function(t){const{value:i,fontSize:s,color:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||t.value!==i||t.fontSize!==s||t.color.some((a,l)=>a!==r[l])||t.pageIndex!==o},S(we,Ns),J(we,"_freeTextDefaultContent",""),J(we,"_internalPadding",0),J(we,"_defaultColor",null),J(we,"_defaultFontSize",10),J(we,"_type","freetext"),J(we,"_editorType",ee.FREETEXT);let yy=we;class O{toSVGPath(){Se("Abstract method `toSVGPath` must be implemented.")}get box(){Se("Abstract getter `box` must be implemented.")}serialize(e,t){Se("Abstract method `serialize` must be implemented.")}static _rescale(e,t,i,s,r,o){o||(o=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a]*s,o[a+1]=i+e[a+1]*r;return o}static _rescaleAndSwap(e,t,i,s,r,o){o||(o=new Float32Array(e.length));for(let a=0,l=e.length;a<l;a+=2)o[a]=t+e[a+1]*s,o[a+1]=i+e[a]*r;return o}static _translate(e,t,i,s){s||(s=new Float32Array(e.length));for(let r=0,o=e.length;r<o;r+=2)s[r]=t+e[r],s[r+1]=i+e[r+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,i,s,r){switch(r){case 90:return[1-t/i,e/s];case 180:return[1-e/i,1-t/s];case 270:return[t/i,1-e/s];default:return[e/i,t/s]}}static _normalizePagePoint(e,t,i){switch(i){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,i,s,r,o){return[(e+5*i)/6,(t+5*s)/6,(5*i+r)/6,(5*s+o)/6,(i+r)/2,(s+o)/2]}}J(O,"PRECISION",1e-4);var yn,li,Gl,Ol,Hi,se,Wo,Yo,Gd,Od,Bl,zl,mr,Bd,Ep,Sp,rt,Xu,QC,ZC,jC,eT,tT,nT;const ts=class ts{constructor({x:e,y:t},i,s,r,o,a=0){S(this,rt);S(this,yn);S(this,li,[]);S(this,Gl);S(this,Ol);S(this,Hi,[]);S(this,se,new Float32Array(18));S(this,Wo);S(this,Yo);S(this,Gd);S(this,Od);S(this,Bl);S(this,zl);S(this,mr,[]);_(this,yn,i),_(this,zl,r*s),_(this,Ol,o),c(this,se).set([NaN,NaN,NaN,NaN,e,t],6),_(this,Gl,a),_(this,Od,c(ts,Bd)*s),_(this,Gd,c(ts,Sp)*s),_(this,Bl,s),c(this,mr).push(e,t)}isEmpty(){return isNaN(c(this,se)[8])}add({x:e,y:t}){var b;_(this,Wo,e),_(this,Yo,t);const[i,s,r,o]=c(this,yn);let[a,l,u,h]=c(this,se).subarray(8,12);const p=e-u,g=t-h,m=Math.hypot(p,g);if(m<c(this,Gd))return!1;const y=m-c(this,Od),A=y/m,T=A*p,v=A*g;let E=a,w=l;a=u,l=h,u+=T,h+=v,(b=c(this,mr))==null||b.push(e,t);const x=-v/y,I=T/y,P=x*c(this,zl),R=I*c(this,zl);return c(this,se).set(c(this,se).subarray(2,8),0),c(this,se).set([u+P,h+R],4),c(this,se).set(c(this,se).subarray(14,18),12),c(this,se).set([u-P,h-R],16),isNaN(c(this,se)[6])?(c(this,Hi).length===0&&(c(this,se).set([a+P,l+R],2),c(this,Hi).push(NaN,NaN,NaN,NaN,(a+P-i)/r,(l+R-s)/o),c(this,se).set([a-P,l-R],14),c(this,li).push(NaN,NaN,NaN,NaN,(a-P-i)/r,(l-R-s)/o)),c(this,se).set([E,w,a,l,u,h],6),!this.isEmpty()):(c(this,se).set([E,w,a,l,u,h],6),Math.abs(Math.atan2(w-l,E-a)-Math.atan2(v,T))<Math.PI/2?([a,l,u,h]=c(this,se).subarray(2,6),c(this,Hi).push(NaN,NaN,NaN,NaN,((a+u)/2-i)/r,((l+h)/2-s)/o),[a,l,E,w]=c(this,se).subarray(14,18),c(this,li).push(NaN,NaN,NaN,NaN,((E+a)/2-i)/r,((w+l)/2-s)/o),!0):([E,w,a,l,u,h]=c(this,se).subarray(0,6),c(this,Hi).push(((E+5*a)/6-i)/r,((w+5*l)/6-s)/o,((5*a+u)/6-i)/r,((5*l+h)/6-s)/o,((a+u)/2-i)/r,((l+h)/2-s)/o),[u,h,a,l,E,w]=c(this,se).subarray(12,18),c(this,li).push(((E+5*a)/6-i)/r,((w+5*l)/6-s)/o,((5*a+u)/6-i)/r,((5*l+h)/6-s)/o,((a+u)/2-i)/r,((l+h)/2-s)/o),!0))}toSVGPath(){if(this.isEmpty())return"";const e=c(this,Hi),t=c(this,li);if(isNaN(c(this,se)[6])&&!this.isEmpty())return C(this,rt,QC).call(this);const i=[];i.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?i.push(`L${e[s+4]} ${e[s+5]}`):i.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);C(this,rt,jC).call(this,i);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?i.push(`L${t[s+4]} ${t[s+5]}`):i.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return C(this,rt,ZC).call(this,i),i.join(" ")}newFreeDrawOutline(e,t,i,s,r,o){return new iT(e,t,i,s,r,o)}getOutlines(){var p;const e=c(this,Hi),t=c(this,li),i=c(this,se),[s,r,o,a]=c(this,yn),l=new Float32Array((((p=c(this,mr))==null?void 0:p.length)??0)+2);for(let g=0,m=l.length-2;g<m;g+=2)l[g]=(c(this,mr)[g]-s)/o,l[g+1]=(c(this,mr)[g+1]-r)/a;if(l[l.length-2]=(c(this,Wo)-s)/o,l[l.length-1]=(c(this,Yo)-r)/a,isNaN(i[6])&&!this.isEmpty())return C(this,rt,eT).call(this,l);const u=new Float32Array(c(this,Hi).length+24+c(this,li).length);let h=e.length;for(let g=0;g<h;g+=2){if(isNaN(e[g])){u[g]=u[g+1]=NaN;continue}u[g]=e[g],u[g+1]=e[g+1]}h=C(this,rt,nT).call(this,u,h);for(let g=t.length-6;g>=6;g-=6)for(let m=0;m<6;m+=2){if(isNaN(t[g+m])){u[h]=u[h+1]=NaN,h+=2;continue}u[h]=t[g+m],u[h+1]=t[g+m+1],h+=2}return C(this,rt,tT).call(this,u,h),this.newFreeDrawOutline(u,l,c(this,yn),c(this,Bl),c(this,Gl),c(this,Ol))}};yn=new WeakMap,li=new WeakMap,Gl=new WeakMap,Ol=new WeakMap,Hi=new WeakMap,se=new WeakMap,Wo=new WeakMap,Yo=new WeakMap,Gd=new WeakMap,Od=new WeakMap,Bl=new WeakMap,zl=new WeakMap,mr=new WeakMap,Bd=new WeakMap,Ep=new WeakMap,Sp=new WeakMap,rt=new WeakSet,Xu=function(){const e=c(this,se).subarray(4,6),t=c(this,se).subarray(16,18),[i,s,r,o]=c(this,yn);return[(c(this,Wo)+(e[0]-t[0])/2-i)/r,(c(this,Yo)+(e[1]-t[1])/2-s)/o,(c(this,Wo)+(t[0]-e[0])/2-i)/r,(c(this,Yo)+(t[1]-e[1])/2-s)/o]},QC=function(){const[e,t,i,s]=c(this,yn),[r,o,a,l]=C(this,rt,Xu).call(this);return`M${(c(this,se)[2]-e)/i} ${(c(this,se)[3]-t)/s} L${(c(this,se)[4]-e)/i} ${(c(this,se)[5]-t)/s} L${r} ${o} L${a} ${l} L${(c(this,se)[16]-e)/i} ${(c(this,se)[17]-t)/s} L${(c(this,se)[14]-e)/i} ${(c(this,se)[15]-t)/s} Z`},ZC=function(e){const t=c(this,li);e.push(`L${t[4]} ${t[5]} Z`)},jC=function(e){const[t,i,s,r]=c(this,yn),o=c(this,se).subarray(4,6),a=c(this,se).subarray(16,18),[l,u,h,p]=C(this,rt,Xu).call(this);e.push(`L${(o[0]-t)/s} ${(o[1]-i)/r} L${l} ${u} L${h} ${p} L${(a[0]-t)/s} ${(a[1]-i)/r}`)},eT=function(e){const t=c(this,se),[i,s,r,o]=c(this,yn),[a,l,u,h]=C(this,rt,Xu).call(this),p=new Float32Array(36);return p.set([NaN,NaN,NaN,NaN,(t[2]-i)/r,(t[3]-s)/o,NaN,NaN,NaN,NaN,(t[4]-i)/r,(t[5]-s)/o,NaN,NaN,NaN,NaN,a,l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,(t[16]-i)/r,(t[17]-s)/o,NaN,NaN,NaN,NaN,(t[14]-i)/r,(t[15]-s)/o],0),this.newFreeDrawOutline(p,e,c(this,yn),c(this,Bl),c(this,Gl),c(this,Ol))},tT=function(e,t){const i=c(this,li);return e.set([NaN,NaN,NaN,NaN,i[4],i[5]],t),t+=6},nT=function(e,t){const i=c(this,se).subarray(4,6),s=c(this,se).subarray(16,18),[r,o,a,l]=c(this,yn),[u,h,p,g]=C(this,rt,Xu).call(this);return e.set([NaN,NaN,NaN,NaN,(i[0]-r)/a,(i[1]-o)/l,NaN,NaN,NaN,NaN,u,h,NaN,NaN,NaN,NaN,p,g,NaN,NaN,NaN,NaN,(s[0]-r)/a,(s[1]-o)/l],t),t+=24},S(ts,Bd,8),S(ts,Ep,2),S(ts,Sp,c(ts,Bd)+c(ts,Ep));let jf=ts;var ql,Ko,Es,zd,vn,qd,qe,wp,sT;class iT extends O{constructor(t,i,s,r,o,a){super();S(this,wp);S(this,ql);S(this,Ko,new Float32Array(4));S(this,Es);S(this,zd);S(this,vn);S(this,qd);S(this,qe);_(this,qe,t),_(this,vn,i),_(this,ql,s),_(this,qd,r),_(this,Es,o),_(this,zd,a),this.lastPoint=[NaN,NaN],C(this,wp,sT).call(this,a);const[l,u,h,p]=c(this,Ko);for(let g=0,m=t.length;g<m;g+=2)t[g]=(t[g]-l)/h,t[g+1]=(t[g+1]-u)/p;for(let g=0,m=i.length;g<m;g+=2)i[g]=(i[g]-l)/h,i[g+1]=(i[g+1]-u)/p}toSVGPath(){const t=[`M${c(this,qe)[4]} ${c(this,qe)[5]}`];for(let i=6,s=c(this,qe).length;i<s;i+=6){if(isNaN(c(this,qe)[i])){t.push(`L${c(this,qe)[i+4]} ${c(this,qe)[i+5]}`);continue}t.push(`C${c(this,qe)[i]} ${c(this,qe)[i+1]} ${c(this,qe)[i+2]} ${c(this,qe)[i+3]} ${c(this,qe)[i+4]} ${c(this,qe)[i+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,i,s,r],o){const a=s-t,l=r-i;let u,h;switch(o){case 0:u=O._rescale(c(this,qe),t,r,a,-l),h=O._rescale(c(this,vn),t,r,a,-l);break;case 90:u=O._rescaleAndSwap(c(this,qe),t,i,a,l),h=O._rescaleAndSwap(c(this,vn),t,i,a,l);break;case 180:u=O._rescale(c(this,qe),s,i,-a,l),h=O._rescale(c(this,vn),s,i,-a,l);break;case 270:u=O._rescaleAndSwap(c(this,qe),s,r,-a,-l),h=O._rescaleAndSwap(c(this,vn),s,r,-a,-l);break}return{outline:Array.from(u),points:[Array.from(h)]}}get box(){return c(this,Ko)}newOutliner(t,i,s,r,o,a=0){return new jf(t,i,s,r,o,a)}getNewOutline(t,i){const[s,r,o,a]=c(this,Ko),[l,u,h,p]=c(this,ql),g=o*h,m=a*p,y=s*h+l,A=r*p+u,T=this.newOutliner({x:c(this,vn)[0]*g+y,y:c(this,vn)[1]*m+A},c(this,ql),c(this,qd),t,c(this,zd),i??c(this,Es));for(let v=2;v<c(this,vn).length;v+=2)T.add({x:c(this,vn)[v]*g+y,y:c(this,vn)[v+1]*m+A});return T.getOutlines()}}ql=new WeakMap,Ko=new WeakMap,Es=new WeakMap,zd=new WeakMap,vn=new WeakMap,qd=new WeakMap,qe=new WeakMap,wp=new WeakSet,sT=function(t){const i=c(this,qe);let s=i[4],r=i[5],o=s,a=r,l=s,u=r,h=s,p=r;const g=t?Math.max:Math.min;for(let y=6,A=i.length;y<A;y+=6){if(isNaN(i[y]))o=Math.min(o,i[y+4]),a=Math.min(a,i[y+5]),l=Math.max(l,i[y+4]),u=Math.max(u,i[y+5]),p<i[y+5]?(h=i[y+4],p=i[y+5]):p===i[y+5]&&(h=g(h,i[y+4]));else{const T=W.bezierBoundingBox(s,r,...i.slice(y,y+6));o=Math.min(o,T[0]),a=Math.min(a,T[1]),l=Math.max(l,T[2]),u=Math.max(u,T[3]),p<T[3]?(h=T[2],p=T[3]):p===T[3]&&(h=g(h,T[2]))}s=i[y+4],r=i[y+5]}const m=c(this,Ko);m[0]=o-c(this,Es),m[1]=a-c(this,Es),m[2]=l-o+2*c(this,Es),m[3]=u-a+2*c(this,Es),this.lastPoint=[h,p]};var $d,Wd,yr,ui,Kt,rT,pf,oT,aT,Ay;class _y{constructor(e,t=0,i=0,s=!0){S(this,Kt);S(this,$d);S(this,Wd);S(this,yr,[]);S(this,ui,[]);let r=1/0,o=-1/0,a=1/0,l=-1/0;const u=10**-4;for(const{x:T,y:v,width:E,height:w}of e){const x=Math.floor((T-t)/u)*u,I=Math.ceil((T+E+t)/u)*u,P=Math.floor((v-t)/u)*u,R=Math.ceil((v+w+t)/u)*u,k=[x,P,R,!0],b=[I,P,R,!1];c(this,yr).push(k,b),r=Math.min(r,x),o=Math.max(o,I),a=Math.min(a,P),l=Math.max(l,R)}const h=o-r+2*i,p=l-a+2*i,g=r-i,m=a-i,y=c(this,yr).at(s?-1:-2),A=[y[0],y[2]];for(const T of c(this,yr)){const[v,E,w]=T;T[0]=(v-g)/h,T[1]=(E-m)/p,T[2]=(w-m)/p}_(this,$d,new Float32Array([g,m,h,p])),_(this,Wd,A)}getOutlines(){c(this,yr).sort((t,i)=>t[0]-i[0]||t[1]-i[1]||t[2]-i[2]);const e=[];for(const t of c(this,yr))t[3]?(e.push(...C(this,Kt,Ay).call(this,t)),C(this,Kt,oT).call(this,t)):(C(this,Kt,aT).call(this,t),e.push(...C(this,Kt,Ay).call(this,t)));return C(this,Kt,rT).call(this,e)}}$d=new WeakMap,Wd=new WeakMap,yr=new WeakMap,ui=new WeakMap,Kt=new WeakSet,rT=function(e){const t=[],i=new Set;for(const o of e){const[a,l,u]=o;t.push([a,l,o],[a,u,o])}t.sort((o,a)=>o[1]-a[1]||o[0]-a[0]);for(let o=0,a=t.length;o<a;o+=2){const l=t[o][2],u=t[o+1][2];l.push(u),u.push(l),i.add(l),i.add(u)}const s=[];let r;for(;i.size>0;){const o=i.values().next().value;let[a,l,u,h,p]=o;i.delete(o);let g=a,m=l;for(r=[a,u],s.push(r);;){let y;if(i.has(h))y=h;else if(i.has(p))y=p;else break;i.delete(y),[a,l,u,h,p]=y,g!==a&&(r.push(g,m,a,m===l?l:u),g=a),m=m===l?u:l}r.push(g,m)}return new IM(s,c(this,$d),c(this,Wd))},pf=function(e){const t=c(this,ui);let i=0,s=t.length-1;for(;i<=s;){const r=i+s>>1,o=t[r][0];if(o===e)return r;o<e?i=r+1:s=r-1}return s+1},oT=function([,e,t]){const i=C(this,Kt,pf).call(this,e);c(this,ui).splice(i,0,[e,t])},aT=function([,e,t]){const i=C(this,Kt,pf).call(this,e);for(let s=i;s<c(this,ui).length;s++){const[r,o]=c(this,ui)[s];if(r!==e)break;if(r===e&&o===t){c(this,ui).splice(s,1);return}}for(let s=i-1;s>=0;s--){const[r,o]=c(this,ui)[s];if(r!==e)break;if(r===e&&o===t){c(this,ui).splice(s,1);return}}},Ay=function(e){const[t,i,s]=e,r=[[t,i,s]],o=C(this,Kt,pf).call(this,s);for(let a=0;a<o;a++){const[l,u]=c(this,ui)[a];for(let h=0,p=r.length;h<p;h++){const[,g,m]=r[h];if(!(u<=g||m<=l)){if(g>=l){if(m>u)r[h][1]=u;else{if(p===1)return[];r.splice(h,1),h--,p--}continue}r[h][2]=l,m>u&&r.push([t,u,m])}}}return r};var Yd,$l;class IM extends O{constructor(t,i,s){super();S(this,Yd);S(this,$l);_(this,$l,t),_(this,Yd,i),this.lastPoint=s}toSVGPath(){const t=[];for(const i of c(this,$l)){let[s,r]=i;t.push(`M${s} ${r}`);for(let o=2;o<i.length;o+=2){const a=i[o],l=i[o+1];a===s?(t.push(`V${l}`),r=l):l===r&&(t.push(`H${a}`),s=a)}t.push("Z")}return t.join(" ")}serialize([t,i,s,r],o){const a=[],l=s-t,u=r-i;for(const h of c(this,$l)){const p=new Array(h.length);for(let g=0;g<h.length;g+=2)p[g]=t+h[g]*l,p[g+1]=r-h[g+1]*u;a.push(p)}return a}get box(){return c(this,Yd)}get classNamesForOutlining(){return["highlightOutline"]}}Yd=new WeakMap,$l=new WeakMap;class Ey extends jf{newFreeDrawOutline(e,t,i,s,r,o){return new PM(e,t,i,s,r,o)}}class PM extends iT{newOutliner(e,t,i,s,r,o=0){return new Ey(e,t,i,s,r,o)}}var ci,Jo,Wl,nt,Kd,Yl,Jd,Xd,vr,di,Kl,Qd,Ae,Sy,wy,Cy,Qr,lT,$s;const en=class en{constructor({editor:e=null,uiManager:t=null}){S(this,Ae);S(this,ci,null);S(this,Jo,null);S(this,Wl);S(this,nt,null);S(this,Kd,!1);S(this,Yl,!1);S(this,Jd,null);S(this,Xd);S(this,vr,null);S(this,di,null);S(this,Kl);var i;e?(_(this,Yl,!1),_(this,Kl,ue.HIGHLIGHT_COLOR),_(this,Jd,e)):(_(this,Yl,!0),_(this,Kl,ue.HIGHLIGHT_DEFAULT_COLOR)),_(this,di,(e==null?void 0:e._uiManager)||t),_(this,Xd,c(this,di)._eventBus),_(this,Wl,(e==null?void 0:e.color)||((i=c(this,di))==null?void 0:i.highlightColors.values().next().value)||"#FFFF98"),c(en,Qd)||_(en,Qd,Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"}))}static get _keyboardManager(){return re(this,"_keyboardManager",new dh([[["Escape","mac+Escape"],en.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],en.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],en.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],en.prototype._moveToPrevious],[["Home","mac+Home"],en.prototype._moveToBeginning],[["End","mac+End"],en.prototype._moveToEnd]]))}renderButton(){const e=_(this,ci,document.createElement("button"));e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.setAttribute("aria-haspopup",!0);const t=c(this,di)._signal;e.addEventListener("click",C(this,Ae,Qr).bind(this),{signal:t}),e.addEventListener("keydown",C(this,Ae,Cy).bind(this),{signal:t});const i=_(this,Jo,document.createElement("span"));return i.className="swatch",i.setAttribute("aria-hidden",!0),i.style.backgroundColor=c(this,Wl),e.append(i),e}renderMainDropdown(){const e=_(this,nt,C(this,Ae,Sy).call(this));return e.setAttribute("aria-orientation","horizontal"),e.setAttribute("aria-labelledby","highlightColorPickerLabel"),e}_colorSelectFromKeyboard(e){if(e.target===c(this,ci)){C(this,Ae,Qr).call(this,e);return}const t=e.target.getAttribute("data-color");t&&C(this,Ae,wy).call(this,t,e)}_moveToNext(e){var t,i;if(!c(this,Ae,$s)){C(this,Ae,Qr).call(this,e);return}if(e.target===c(this,ci)){(t=c(this,nt).firstChild)==null||t.focus();return}(i=e.target.nextSibling)==null||i.focus()}_moveToPrevious(e){var t,i;if(e.target===((t=c(this,nt))==null?void 0:t.firstChild)||e.target===c(this,ci)){c(this,Ae,$s)&&this._hideDropdownFromKeyboard();return}c(this,Ae,$s)||C(this,Ae,Qr).call(this,e),(i=e.target.previousSibling)==null||i.focus()}_moveToBeginning(e){var t;if(!c(this,Ae,$s)){C(this,Ae,Qr).call(this,e);return}(t=c(this,nt).firstChild)==null||t.focus()}_moveToEnd(e){var t;if(!c(this,Ae,$s)){C(this,Ae,Qr).call(this,e);return}(t=c(this,nt).lastChild)==null||t.focus()}hideDropdown(){var e,t;(e=c(this,nt))==null||e.classList.add("hidden"),(t=c(this,vr))==null||t.abort(),_(this,vr,null)}_hideDropdownFromKeyboard(){var e;if(!c(this,Yl)){if(!c(this,Ae,$s)){(e=c(this,Jd))==null||e.unselect();return}this.hideDropdown(),c(this,ci).focus({preventScroll:!0,focusVisible:c(this,Kd)})}}updateColor(e){if(c(this,Jo)&&(c(this,Jo).style.backgroundColor=e),!c(this,nt))return;const t=c(this,di).highlightColors.values();for(const i of c(this,nt).children)i.setAttribute("aria-selected",t.next().value===e)}destroy(){var e,t;(e=c(this,ci))==null||e.remove(),_(this,ci,null),_(this,Jo,null),(t=c(this,nt))==null||t.remove(),_(this,nt,null)}};ci=new WeakMap,Jo=new WeakMap,Wl=new WeakMap,nt=new WeakMap,Kd=new WeakMap,Yl=new WeakMap,Jd=new WeakMap,Xd=new WeakMap,vr=new WeakMap,di=new WeakMap,Kl=new WeakMap,Qd=new WeakMap,Ae=new WeakSet,Sy=function(){const e=document.createElement("div"),t=c(this,di)._signal;e.addEventListener("contextmenu",Ai,{signal:t}),e.className="dropdown",e.role="listbox",e.setAttribute("aria-multiselectable",!1),e.setAttribute("aria-orientation","vertical"),e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown");for(const[i,s]of c(this,di).highlightColors){const r=document.createElement("button");r.tabIndex="0",r.role="option",r.setAttribute("data-color",s),r.title=i,r.setAttribute("data-l10n-id",c(en,Qd)[i]);const o=document.createElement("span");r.append(o),o.className="swatch",o.style.backgroundColor=s,r.setAttribute("aria-selected",s===c(this,Wl)),r.addEventListener("click",C(this,Ae,wy).bind(this,s),{signal:t}),e.append(r)}return e.addEventListener("keydown",C(this,Ae,Cy).bind(this),{signal:t}),e},wy=function(e,t){t.stopPropagation(),c(this,Xd).dispatch("switchannotationeditorparams",{source:this,type:c(this,Kl),value:e})},Cy=function(e){en._keyboardManager.exec(this,e)},Qr=function(e){if(c(this,Ae,$s)){this.hideDropdown();return}if(_(this,Kd,e.detail===0),c(this,vr)||(_(this,vr,new AbortController),window.addEventListener("pointerdown",C(this,Ae,lT).bind(this),{signal:c(this,di).combinedSignal(c(this,vr))})),c(this,nt)){c(this,nt).classList.remove("hidden");return}const t=_(this,nt,C(this,Ae,Sy).call(this));c(this,ci).append(t)},lT=function(e){var t;(t=c(this,nt))!=null&&t.contains(e.target)||this.hideDropdown()},$s=function(){return c(this,nt)&&!c(this,nt).classList.contains("hidden")},S(en,Qd,null);let ep=en;var Jl,Zd,Ss,Xo,Xl,sn,jd,eh,Qo,Hn,_n,mt,Ql,ws,kt,Zl,Vn,th,j,Ty,gf,uT,cT,dT,xy,Zr,$n,ka,hT,mf,Qu,fT,pT,gT,mT,yT;const ge=class ge extends Ue{constructor(t){super({...t,name:"highlightEditor"});S(this,j);S(this,Jl,null);S(this,Zd,0);S(this,Ss);S(this,Xo,null);S(this,Xl,null);S(this,sn,null);S(this,jd,null);S(this,eh,0);S(this,Qo,null);S(this,Hn,null);S(this,_n,null);S(this,mt,!1);S(this,Ql,null);S(this,ws);S(this,kt,null);S(this,Zl,"");S(this,Vn);S(this,th,"");this.color=t.color||ge._defaultColor,_(this,Vn,t.thickness||ge._defaultThickness),_(this,ws,t.opacity||ge._defaultOpacity),_(this,Ss,t.boxes||null),_(this,th,t.methodOfCreation||""),_(this,Zl,t.text||""),this._isDraggable=!1,t.highlightId>-1?(_(this,mt,!0),C(this,j,gf).call(this,t),C(this,j,Zr).call(this)):c(this,Ss)&&(_(this,Jl,t.anchorNode),_(this,Zd,t.anchorOffset),_(this,jd,t.focusNode),_(this,eh,t.focusOffset),C(this,j,Ty).call(this),C(this,j,Zr).call(this),this.rotate(this.rotation))}static get _keyboardManager(){const t=ge.prototype;return re(this,"_keyboardManager",new dh([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}get telemetryInitialData(){return{action:"added",type:c(this,mt)?"free_highlight":"highlight",color:this._uiManager.highlightColorNames.get(this.color),thickness:c(this,Vn),methodOfCreation:c(this,th)}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.highlightColorNames.get(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}static initialize(t,i){var s;Ue.initialize(t,i),ge._defaultColor||(ge._defaultColor=((s=i.highlightColors)==null?void 0:s.values().next().value)||"#fff066")}static updateDefaultParams(t,i){switch(t){case ue.HIGHLIGHT_DEFAULT_COLOR:ge._defaultColor=i;break;case ue.HIGHLIGHT_THICKNESS:ge._defaultThickness=i;break}}translateInPage(t,i){}get toolbarPosition(){return c(this,Ql)}updateParams(t,i){switch(t){case ue.HIGHLIGHT_COLOR:C(this,j,uT).call(this,i);break;case ue.HIGHLIGHT_THICKNESS:C(this,j,cT).call(this,i);break}}static get defaultPropertiesToUpdate(){return[[ue.HIGHLIGHT_DEFAULT_COLOR,ge._defaultColor],[ue.HIGHLIGHT_THICKNESS,ge._defaultThickness]]}get propertiesToUpdate(){return[[ue.HIGHLIGHT_COLOR,this.color||ge._defaultColor],[ue.HIGHLIGHT_THICKNESS,c(this,Vn)||ge._defaultThickness],[ue.HIGHLIGHT_FREE,c(this,mt)]]}async addEditToolbar(){const t=await super.addEditToolbar();return t?(this._uiManager.highlightColors&&(_(this,Xl,new ep({editor:this})),t.addColorPicker(c(this,Xl))),t):null}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(C(this,j,Qu).call(this))}getBaseTranslation(){return[0,0]}getRect(t,i){return super.getRect(t,i,C(this,j,Qu).call(this))}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){C(this,j,xy).call(this),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(C(this,j,Zr).call(this),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?C(this,j,xy).call(this):t&&(C(this,j,Zr).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),this.show(this._isVisible),i&&this.select()}rotate(t){var r,o,a;const{drawLayer:i}=this.parent;let s;c(this,mt)?(t=(t-this.rotation+360)%360,s=C(r=ge,$n,ka).call(r,c(this,Hn).box,t)):s=C(o=ge,$n,ka).call(o,[this.x,this.y,this.width,this.height],t),i.updateProperties(c(this,_n),{bbox:s,root:{"data-main-rotation":t}}),i.updateProperties(c(this,kt),{bbox:C(a=ge,$n,ka).call(a,c(this,sn).box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();c(this,Zl)&&(t.setAttribute("aria-label",c(this,Zl)),t.setAttribute("role","mark")),c(this,mt)?t.classList.add("free"):this.div.addEventListener("keydown",C(this,j,hT).bind(this),{signal:this._uiManager._signal});const i=_(this,Qo,document.createElement("div"));t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal",i.style.clipPath=c(this,Xo);const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),Xf(this,c(this,Qo),["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,kt),{rootClass:{hovered:!0}})}pointerleave(){var t;this.isSelected||(t=this.parent)==null||t.drawLayer.updateProperties(c(this,kt),{rootClass:{hovered:!1}})}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:C(this,j,mf).call(this,!0);break;case 1:case 3:C(this,j,mf).call(this,!1);break}}select(){var t;super.select(),c(this,kt)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,kt),{rootClass:{hovered:!1,selected:!0}}))}unselect(){var t;super.unselect(),c(this,kt)&&((t=this.parent)==null||t.drawLayer.updateProperties(c(this,kt),{rootClass:{selected:!1}}),c(this,mt)||C(this,j,mf).call(this,!1))}get _mustFixPosition(){return!c(this,mt)}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(c(this,_n),{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(c(this,kt),{rootClass:{hidden:!t}}))}static startHighlighting(t,i,{target:s,x:r,y:o}){const{x:a,y:l,width:u,height:h}=s.getBoundingClientRect(),p=new AbortController,g=t.combinedSignal(p),m=y=>{p.abort(),C(this,$n,mT).call(this,t,y)};window.addEventListener("blur",m,{signal:g}),window.addEventListener("pointerup",m,{signal:g}),window.addEventListener("pointerdown",In,{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",Ai,{signal:g}),s.addEventListener("pointermove",C(this,$n,gT).bind(this,t),{signal:g}),this._freeHighlight=new Ey({x:r,y:o},[a,l,u,h],t.scale,this._defaultThickness/2,i,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static async deserialize(t,i,s){var A,T,v,E;let r=null;if(t instanceof zC){const{data:{quadPoints:w,rect:x,rotation:I,id:P,color:R,opacity:k,popupRef:b},parent:{page:{pageNumber:N}}}=t;r=t={annotationType:ee.HIGHLIGHT,color:Array.from(R),opacity:k,quadPoints:w,boxes:null,pageIndex:N-1,rect:x.slice(0),rotation:I,id:P,deleted:!1,popupRef:b}}else if(t instanceof e0){const{data:{inkLists:w,rect:x,rotation:I,id:P,color:R,borderStyle:{rawWidth:k},popupRef:b},parent:{page:{pageNumber:N}}}=t;r=t={annotationType:ee.HIGHLIGHT,color:Array.from(R),thickness:k,inkLists:w,boxes:null,pageIndex:N-1,rect:x.slice(0),rotation:I,id:P,deleted:!1,popupRef:b}}const{color:o,quadPoints:a,inkLists:l,opacity:u}=t,h=await super.deserialize(t,i,s);h.color=W.makeHexColor(...o),_(h,ws,u||1),l&&_(h,Vn,t.thickness),h.annotationElementId=t.id||null,h._initialData=r;const[p,g]=h.pageDimensions,[m,y]=h.pageTranslation;if(a){const w=_(h,Ss,[]);for(let x=0;x<a.length;x+=8)w.push({x:(a[x]-m)/p,y:1-(a[x+1]-y)/g,width:(a[x+2]-a[x])/p,height:(a[x+1]-a[x+5])/g});C(A=h,j,Ty).call(A),C(T=h,j,Zr).call(T),h.rotate(h.rotation)}else if(l){_(h,mt,!0);const w=l[0],x={x:w[0]-m,y:g-(w[1]-y)},I=new Ey(x,[0,0,p,g],1,c(h,Vn)/2,!0,.001);for(let k=0,b=w.length;k<b;k+=2)x.x=w[k]-m,x.y=g-(w[k+1]-y),I.add(x);const{id:P,clipPathId:R}=i.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:h.color,"fill-opacity":h._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:I.toSVGPath()}},!0,!0);C(v=h,j,gf).call(v,{highlightOutlines:I.getOutlines(),highlightId:P,clipPathId:R}),C(E=h,j,Zr).call(E)}return h}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const i=this.getRect(0,0),s=Ue._colorManager.convert(this.color),r={annotationType:ee.HIGHLIGHT,color:s,opacity:c(this,ws),thickness:c(this,Vn),quadPoints:C(this,j,fT).call(this),outlines:C(this,j,pT).call(this,i),pageIndex:this.pageIndex,rect:i,rotation:C(this,j,Qu).call(this),structTreeParentId:this._structTreeParentId};return this.annotationElementId&&!C(this,j,yT).call(this,r)?null:(r.id=this.annotationElementId,r)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};Jl=new WeakMap,Zd=new WeakMap,Ss=new WeakMap,Xo=new WeakMap,Xl=new WeakMap,sn=new WeakMap,jd=new WeakMap,eh=new WeakMap,Qo=new WeakMap,Hn=new WeakMap,_n=new WeakMap,mt=new WeakMap,Ql=new WeakMap,ws=new WeakMap,kt=new WeakMap,Zl=new WeakMap,Vn=new WeakMap,th=new WeakMap,j=new WeakSet,Ty=function(){const t=new _y(c(this,Ss),.001);_(this,Hn,t.getOutlines()),[this.x,this.y,this.width,this.height]=c(this,Hn).box;const i=new _y(c(this,Ss),.0025,.001,this._uiManager.direction==="ltr");_(this,sn,i.getOutlines());const{lastPoint:s}=c(this,sn);_(this,Ql,[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height])},gf=function({highlightOutlines:t,highlightId:i,clipPathId:s}){var p,g;if(_(this,Hn,t),_(this,sn,t.getNewOutline(c(this,Vn)/2+1.5,.0025)),i>=0)_(this,_n,i),_(this,Xo,s),this.parent.drawLayer.finalizeDraw(i,{bbox:t.box,path:{d:t.toSVGPath()}}),_(this,kt,this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:c(this,sn).box,path:{d:c(this,sn).toSVGPath()}},!0));else if(this.parent){const m=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(c(this,_n),{bbox:C(p=ge,$n,ka).call(p,c(this,Hn).box,(m-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(c(this,kt),{bbox:C(g=ge,$n,ka).call(g,c(this,sn).box,m),path:{d:c(this,sn).toSVGPath()}})}const[o,a,l,u]=t.box;switch(this.rotation){case 0:this.x=o,this.y=a,this.width=l,this.height=u;break;case 90:{const[m,y]=this.parentDimensions;this.x=a,this.y=1-o,this.width=l*y/m,this.height=u*m/y;break}case 180:this.x=1-o,this.y=1-a,this.width=l,this.height=u;break;case 270:{const[m,y]=this.parentDimensions;this.x=1-a,this.y=o,this.width=l*y/m,this.height=u*m/y;break}}const{lastPoint:h}=c(this,sn);_(this,Ql,[(h[0]-o)/l,(h[1]-a)/u])},uT=function(t){const i=(o,a)=>{var l,u;this.color=o,_(this,ws,a),(l=this.parent)==null||l.drawLayer.updateProperties(c(this,_n),{root:{fill:o,"fill-opacity":a}}),(u=c(this,Xl))==null||u.updateColor(o)},s=this.color,r=c(this,ws);this.addCommands({cmd:i.bind(this,t,ge._defaultOpacity),undo:i.bind(this,s,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ue.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.highlightColorNames.get(t)},!0)},cT=function(t){const i=c(this,Vn),s=r=>{_(this,Vn,r),C(this,j,dT).call(this,r)};this.addCommands({cmd:s.bind(this,t),undo:s.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ue.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)},dT=function(t){if(!c(this,mt))return;C(this,j,gf).call(this,{highlightOutlines:c(this,Hn).getNewOutline(t/2)}),this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)},xy=function(){c(this,_n)===null||!this.parent||(this.parent.drawLayer.remove(c(this,_n)),_(this,_n,null),this.parent.drawLayer.remove(c(this,kt)),_(this,kt,null))},Zr=function(t=this.parent){c(this,_n)===null&&({id:Ht(this,_n)._,clipPathId:Ht(this,Xo)._}=t.drawLayer.draw({bbox:c(this,Hn).box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":c(this,ws)},rootClass:{highlight:!0,free:c(this,mt)},path:{d:c(this,Hn).toSVGPath()}},!1,!0),_(this,kt,t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:c(this,mt)},bbox:c(this,sn).box,path:{d:c(this,sn).toSVGPath()}},c(this,mt))),c(this,Qo)&&(c(this,Qo).style.clipPath=c(this,Xo)))},$n=new WeakSet,ka=function([t,i,s,r],o){switch(o){case 90:return[1-i-r,t,r,s];case 180:return[1-t-s,1-i-r,s,r];case 270:return[i,1-t-s,r,s]}return[t,i,s,r]},hT=function(t){ge._keyboardManager.exec(this,t)},mf=function(t){if(!c(this,Jl))return;const i=window.getSelection();t?i.setPosition(c(this,Jl),c(this,Zd)):i.setPosition(c(this,jd),c(this,eh))},Qu=function(){return c(this,mt)?this.rotation:0},fT=function(){if(c(this,mt))return null;const[t,i]=this.pageDimensions,[s,r]=this.pageTranslation,o=c(this,Ss),a=new Float32Array(o.length*8);let l=0;for(const{x:u,y:h,width:p,height:g}of o){const m=u*t+s,y=(1-h)*i+r;a[l]=a[l+4]=m,a[l+1]=a[l+3]=y,a[l+2]=a[l+6]=m+p*t,a[l+5]=a[l+7]=y-g*i,l+=8}return a},pT=function(t){return c(this,Hn).serialize(t,C(this,j,Qu).call(this))},gT=function(t,i){this._freeHighlight.add(i)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})},mT=function(t,i){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(i,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""},yT=function(t){const{color:i}=this._initialData;return t.color.some((s,r)=>s!==i[r])},S(ge,$n),J(ge,"_defaultColor",null),J(ge,"_defaultOpacity",1),J(ge,"_defaultThickness",12),J(ge,"_type","highlight"),J(ge,"_editorType",ee.HIGHLIGHT),J(ge,"_freeHighlightId",-1),J(ge,"_freeHighlight",null),J(ge,"_freeHighlightClipId","");let tp=ge;var Zo;class RM{constructor(){S(this,Zo,Object.create(null))}updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,i]of Object.entries(e))this.updateProperty(t,i)}updateSVGProperty(e,t){c(this,Zo)[e]=t}toSVGProperties(){const e=c(this,Zo);return _(this,Zo,Object.create(null)),{root:e}}reset(){_(this,Zo,Object.create(null))}updateAll(e=this){this.updateProperties(e)}clone(){Se("Not implemented")}}Zo=new WeakMap;var An,jl,ut,jo,ea,_r,Ar,Er,ta,he,Py,Ry,My,Zu,vT,yf,ju,ba;const z=class z extends Ue{constructor(t){super(t);S(this,he);S(this,An,null);S(this,jl);J(this,"_drawId",null);_(this,jl,t.mustBeCommitted||!1),t.drawOutlines&&(C(this,he,Py).call(this,t),C(this,he,Zu).call(this))}static _mergeSVGProperties(t,i){const s=new Set(Object.keys(t));for(const[r,o]of Object.entries(i))s.has(r)?Object.assign(t[r],o):t[r]=o;return t}static getDefaultDrawingOptions(t){Se("Not implemented")}static get typesMap(){Se("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,i){const s=this.typesMap.get(t);s&&this._defaultDrawingOptions.updateProperty(s,i),this._currentParent&&(c(z,ut).updateProperty(s,i),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,i){const s=this.constructor.typesMap.get(t);s&&this._updateProperty(t,s,i)}static get defaultPropertiesToUpdate(){const t=[],i=this._defaultDrawingOptions;for(const[s,r]of this.typesMap)t.push([s,i[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:i}=this;for(const[s,r]of this.constructor.typesMap)t.push([s,i[r]]);return t}_updateProperty(t,i,s){const r=this._drawingOptions,o=r[i],a=l=>{var h;r.updateProperty(i,l);const u=c(this,An).updateProperty(i,l);u&&C(this,he,ju).call(this,u),(h=this.parent)==null||h.drawLayer.updateProperties(this._drawId,r.toSVGProperties())};this.addCommands({cmd:a.bind(this,s),undo:a.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,z._mergeSVGProperties(c(this,An).getPathResizingSVGProperties(C(this,he,yf).call(this)),{bbox:C(this,he,ba).call(this)}))}_onResized(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,z._mergeSVGProperties(c(this,An).getPathResizedSVGProperties(C(this,he,yf).call(this)),{bbox:C(this,he,ba).call(this)}))}_onTranslating(t,i){var s;(s=this.parent)==null||s.drawLayer.updateProperties(this._drawId,{bbox:C(this,he,ba).call(this,t,i)})}_onTranslated(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,z._mergeSVGProperties(c(this,An).getPathTranslatedSVGProperties(C(this,he,yf).call(this),this.parentDimensions),{bbox:C(this,he,ba).call(this)}))}_onStartDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){var t;(t=this.parent)==null||t.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,c(this,jl)&&(_(this,jl,!1),this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){C(this,he,My).call(this),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(C(this,he,Zu).call(this),C(this,he,ju).call(this,c(this,An).box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){var s;let i=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),C(this,he,My).call(this)):t&&(this._uiManager.addShouldRescale(this),C(this,he,Zu).call(this,t),i=!this.parent&&((s=this.div)==null?void 0:s.classList.contains("selectedEditor"))),super.setParent(t),i&&this.select()}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,z._mergeSVGProperties({bbox:C(this,he,ba).call(this)},c(this,An).updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&C(this,he,ju).call(this,c(this,An).updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;const t=super.render();t.classList.add("draw");const i=document.createElement("div");t.append(i),i.setAttribute("aria-hidden","true"),i.className="internal";const[s,r]=this.parentDimensions;return this.setDims(this.width*s,this.height*r),this._uiManager.addShouldRescale(this),this.disableEditing(),t}static createDrawerInstance(t,i,s,r,o){Se("Not implemented")}static startDrawing(t,i,s,r){var T;const{target:o,offsetX:a,offsetY:l,pointerId:u,pointerType:h}=r;if(c(z,Ar)&&c(z,Ar)!==h)return;const{viewport:{rotation:p}}=t,{width:g,height:m}=o.getBoundingClientRect(),y=_(z,jo,new AbortController),A=t.combinedSignal(y);if(c(z,_r)||_(z,_r,u),c(z,Ar)??_(z,Ar,h),window.addEventListener("pointerup",v=>{var E;c(z,_r)===v.pointerId?this._endDraw(v):(E=c(z,Er))==null||E.delete(v.pointerId)},{signal:A}),window.addEventListener("pointercancel",v=>{var E;c(z,_r)===v.pointerId?this._currentParent.endDrawingSession():(E=c(z,Er))==null||E.delete(v.pointerId)},{signal:A}),window.addEventListener("pointerdown",v=>{c(z,Ar)===v.pointerType&&((c(z,Er)||_(z,Er,new Set)).add(v.pointerId),c(z,ut).isCancellable()&&(c(z,ut).removeLastElement(),c(z,ut).isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:A}),window.addEventListener("contextmenu",Ai,{signal:A}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:A}),o.addEventListener("touchmove",v=>{v.timeStamp===c(z,ta)&&In(v)},{signal:A}),t.toggleDrawing(),(T=i._editorUndoBar)==null||T.hide(),c(z,ut)){t.drawLayer.updateProperties(this._currentDrawId,c(z,ut).startNew(a,l,g,m,p));return}i.updateUIForDefaultProperties(this),_(z,ut,this.createDrawerInstance(a,l,g,m,p)),_(z,ea,this.getDefaultDrawingOptions()),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(c(z,ea).toSVGProperties(),c(z,ut).defaultSVGProperties),!0,!1)}static _drawMove(t){var o;if(_(z,ta,-1),!c(z,ut))return;const{offsetX:i,offsetY:s,pointerId:r}=t;if(c(z,_r)===r){if(((o=c(z,Er))==null?void 0:o.size)>=1){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,c(z,ut).add(i,s)),_(z,ta,t.timeStamp),In(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,_(z,ut,null),_(z,ea,null),_(z,Ar,null),_(z,ta,NaN)),c(z,jo)&&(c(z,jo).abort(),_(z,jo,null),_(z,_r,NaN),_(z,Er,null))}static _endDraw(t){const i=this._currentParent;if(i){if(i.toggleDrawing(!0),this._cleanup(!1),t&&i.drawLayer.updateProperties(this._currentDrawId,c(z,ut).end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const s=c(z,ut),r=this._currentDrawId,o=s.getLastElement();i.addCommands({cmd:()=>{i.drawLayer.updateProperties(r,s.setLastElement(o))},undo:()=>{i.drawLayer.updateProperties(r,s.removeLastElement())},mustExec:!1,type:ue.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const i=this._currentParent;if(!i)return null;if(i.toggleDrawing(!0),i.cleanUndoStack(ue.DRAW_STEP),!c(z,ut).isEmpty()){const{pageDimensions:[s,r],scale:o}=i,a=i.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:c(z,ut).getOutlines(s*o,r*o,o,this._INNER_MARGIN),drawingOptions:c(z,ea),mustBeCommitted:!t});return this._cleanup(!0),a}return i.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,i,s,r,o,a){Se("Not implemented")}static async deserialize(t,i,s){var p,g;const{rawDims:{pageWidth:r,pageHeight:o,pageX:a,pageY:l}}=i.viewport,u=this.deserializeDraw(a,l,r,o,this._INNER_MARGIN,t),h=await super.deserialize(t,i,s);return h.createDrawingOptions(t),C(p=h,he,Py).call(p,{drawOutlines:u}),C(g=h,he,Zu).call(g),h.onScaleChanging(),h.rotate(),h}serializeDraw(t){const[i,s]=this.pageTranslation,[r,o]=this.pageDimensions;return c(this,An).serialize([i,s,r,o],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}static canCreateNewEmptyEditor(){return!1}};An=new WeakMap,jl=new WeakMap,ut=new WeakMap,jo=new WeakMap,ea=new WeakMap,_r=new WeakMap,Ar=new WeakMap,Er=new WeakMap,ta=new WeakMap,he=new WeakSet,Py=function({drawOutlines:t,drawId:i,drawingOptions:s}){_(this,An,t),this._drawingOptions||(this._drawingOptions=s),i>=0?(this._drawId=i,this.parent.drawLayer.finalizeDraw(i,t.defaultProperties)):this._drawId=C(this,he,Ry).call(this,t,this.parent),C(this,he,ju).call(this,t.box)},Ry=function(t,i){const{id:s}=i.drawLayer.draw(z._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return s},My=function(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())},Zu=function(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=C(this,he,Ry).call(this,c(this,An),t)}},vT=function([t,i,s,r]){const{parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[i,1-t,s*(a/o),r*(o/a)];case 180:return[1-t,1-i,s,r];case 270:return[1-i,t,s*(a/o),r*(o/a)];default:return[t,i,s,r]}},yf=function(){const{x:t,y:i,width:s,height:r,parentDimensions:[o,a],rotation:l}=this;switch(l){case 90:return[1-i,t,s*(o/a),r*(a/o)];case 180:return[1-t,1-i,s,r];case 270:return[i,1-t,s*(o/a),r*(a/o)];default:return[t,i,s,r]}},ju=function(t){if([this.x,this.y,this.width,this.height]=C(this,he,vT).call(this,t),this.div){this.fixAndSetPosition();const[i,s]=this.parentDimensions;this.setDims(this.width*i,this.height*s)}this._onResized()},ba=function(){const{x:t,y:i,width:s,height:r,rotation:o,parentRotation:a,parentDimensions:[l,u]}=this;switch((o*4+a)/90){case 1:return[1-i-r,t,r,s];case 2:return[1-t-s,1-i-r,s,r];case 3:return[i,1-t-s,r,s];case 4:return[t,i-s*(l/u),r*(u/l),s*(l/u)];case 5:return[1-i,t,s*(l/u),r*(u/l)];case 6:return[1-t-r*(u/l),1-i,r*(u/l),s*(l/u)];case 7:return[i-s*(l/u),1-t-r*(u/l),s*(l/u),r*(u/l)];case 8:return[t-s,i-r,s,r];case 9:return[1-i,t-s,r,s];case 10:return[1-t,1-i,s,r];case 11:return[i-r,1-t,r,s];case 12:return[t-r*(u/l),i,r*(u/l),s*(l/u)];case 13:return[1-i-s*(l/u),t-r*(u/l),s*(l/u),r*(u/l)];case 14:return[1-t,1-i-s*(l/u),r*(u/l),s*(l/u)];case 15:return[i,1-t,s*(l/u),r*(u/l)];default:return[t,i,s,r]}},J(z,"_currentDrawId",-1),J(z,"_currentParent",null),S(z,ut,null),S(z,jo,null),S(z,ea,null),S(z,_r,NaN),S(z,Ar,null),S(z,Er,null),S(z,ta,NaN),J(z,"_INNER_MARGIN",3);let Iy=z;var Vi,ct,dt,na,eu,Ot,yt,Gn,ia,sa,ra,tu,vf;class MM{constructor(e,t,i,s,r,o){S(this,tu);S(this,Vi,new Float64Array(6));S(this,ct);S(this,dt);S(this,na);S(this,eu);S(this,Ot);S(this,yt,"");S(this,Gn,0);S(this,ia,new np);S(this,sa);S(this,ra);_(this,sa,i),_(this,ra,s),_(this,na,r),_(this,eu,o),[e,t]=C(this,tu,vf).call(this,e,t);const a=_(this,ct,[NaN,NaN,NaN,NaN,e,t]);_(this,Ot,[e,t]),_(this,dt,[{line:a,points:c(this,Ot)}]),c(this,Vi).set(a,0)}updateProperty(e,t){e==="stroke-width"&&_(this,eu,t)}isEmpty(){return!c(this,dt)||c(this,dt).length===0}isCancellable(){return c(this,Ot).length<=10}add(e,t){[e,t]=C(this,tu,vf).call(this,e,t);const[i,s,r,o]=c(this,Vi).subarray(2,6),a=e-r,l=t-o;return Math.hypot(c(this,sa)*a,c(this,ra)*l)<=2?null:(c(this,Ot).push(e,t),isNaN(i)?(c(this,Vi).set([r,o,e,t],2),c(this,ct).push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(c(this,Vi)[0])&&c(this,ct).splice(6,6),c(this,Vi).set([i,s,r,o,e,t],0),c(this,ct).push(...O.createBezierPoints(i,s,r,o,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const i=this.add(e,t);return i||(c(this,Ot).length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,i,s,r){_(this,sa,i),_(this,ra,s),_(this,na,r),[e,t]=C(this,tu,vf).call(this,e,t);const o=_(this,ct,[NaN,NaN,NaN,NaN,e,t]);_(this,Ot,[e,t]);const a=c(this,dt).at(-1);return a&&(a.line=new Float32Array(a.line),a.points=new Float32Array(a.points)),c(this,dt).push({line:o,points:c(this,Ot)}),c(this,Vi).set(o,0),_(this,Gn,0),this.toSVGPath(),null}getLastElement(){return c(this,dt).at(-1)}setLastElement(e){return c(this,dt)?(c(this,dt).push(e),_(this,ct,e.line),_(this,Ot,e.points),_(this,Gn,0),{path:{d:this.toSVGPath()}}):c(this,ia).setLastElement(e)}removeLastElement(){if(!c(this,dt))return c(this,ia).removeLastElement();c(this,dt).pop(),_(this,yt,"");for(let e=0,t=c(this,dt).length;e<t;e++){const{line:i,points:s}=c(this,dt)[e];_(this,ct,i),_(this,Ot,s),_(this,Gn,0),this.toSVGPath()}return{path:{d:c(this,yt)}}}toSVGPath(){const e=O.svgRound(c(this,ct)[4]),t=O.svgRound(c(this,ct)[5]);if(c(this,Ot).length===2)return _(this,yt,`${c(this,yt)} M ${e} ${t} Z`),c(this,yt);if(c(this,Ot).length<=6){const s=c(this,yt).lastIndexOf("M");_(this,yt,`${c(this,yt).slice(0,s)} M ${e} ${t}`),_(this,Gn,6)}if(c(this,Ot).length===4){const s=O.svgRound(c(this,ct)[10]),r=O.svgRound(c(this,ct)[11]);return _(this,yt,`${c(this,yt)} L ${s} ${r}`),_(this,Gn,12),c(this,yt)}const i=[];c(this,Gn)===0&&(i.push(`M ${e} ${t}`),_(this,Gn,6));for(let s=c(this,Gn),r=c(this,ct).length;s<r;s+=6){const[o,a,l,u,h,p]=c(this,ct).slice(s,s+6).map(O.svgRound);i.push(`C${o} ${a} ${l} ${u} ${h} ${p}`)}return _(this,yt,c(this,yt)+i.join(" ")),_(this,Gn,c(this,ct).length),c(this,yt)}getOutlines(e,t,i,s){const r=c(this,dt).at(-1);return r.line=new Float32Array(r.line),r.points=new Float32Array(r.points),c(this,ia).build(c(this,dt),e,t,i,c(this,na),c(this,eu),s),_(this,Vi,null),_(this,ct,null),_(this,dt,null),_(this,yt,null),c(this,ia)}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}Vi=new WeakMap,ct=new WeakMap,dt=new WeakMap,na=new WeakMap,eu=new WeakMap,Ot=new WeakMap,yt=new WeakMap,Gn=new WeakMap,ia=new WeakMap,sa=new WeakMap,ra=new WeakMap,tu=new WeakSet,vf=function(e,t){return O._normalizePoint(e,t,c(this,sa),c(this,ra),c(this,na))};var Bt,nh,ih,En,Gi,Oi,nu,iu,su,Et,Zi,_T,AT,ET;const f0=class f0 extends O{constructor(){super(...arguments);S(this,Et);S(this,Bt);S(this,nh,0);S(this,ih);S(this,En);S(this,Gi);S(this,Oi);S(this,nu);S(this,iu);S(this,su)}build(t,i,s,r,o,a,l){_(this,Gi,i),_(this,Oi,s),_(this,nu,r),_(this,iu,o),_(this,su,a),_(this,ih,l??0),_(this,En,t),C(this,Et,AT).call(this)}setLastElement(t){return c(this,En).push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return c(this,En).pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:i}of c(this,En)){if(t.push(`M${O.svgRound(i[4])} ${O.svgRound(i[5])}`),i.length===6){t.push("Z");continue}if(i.length===12){t.push(`L${O.svgRound(i[10])} ${O.svgRound(i[11])}`);continue}for(let s=6,r=i.length;s<r;s+=6){const[o,a,l,u,h,p]=i.subarray(s,s+6).map(O.svgRound);t.push(`C${o} ${a} ${l} ${u} ${h} ${p}`)}}return t.join("")}serialize([t,i,s,r],o){const a=[],l=[],[u,h,p,g]=C(this,Et,_T).call(this);let m,y,A,T,v,E,w,x,I;switch(c(this,iu)){case 0:I=O._rescale,m=t,y=i+r,A=s,T=-r,v=t+u*s,E=i+(1-h-g)*r,w=t+(u+p)*s,x=i+(1-h)*r;break;case 90:I=O._rescaleAndSwap,m=t,y=i,A=s,T=r,v=t+h*s,E=i+u*r,w=t+(h+g)*s,x=i+(u+p)*r;break;case 180:I=O._rescale,m=t+s,y=i,A=-s,T=r,v=t+(1-u-p)*s,E=i+h*r,w=t+(1-u)*s,x=i+(h+g)*r;break;case 270:I=O._rescaleAndSwap,m=t+s,y=i+r,A=-s,T=-r,v=t+(1-h-g)*s,E=i+(1-u-p)*r,w=t+(1-h)*s,x=i+(1-u)*r;break}for(const{line:P,points:R}of c(this,En))a.push(I(P,m,y,A,T,o?new Array(P.length):null)),l.push(I(R,m,y,A,T,o?new Array(R.length):null));return{lines:a,points:l,rect:[v,E,w,x]}}static deserialize(t,i,s,r,o,{paths:{lines:a,points:l},rotation:u,thickness:h}){const p=[];let g,m,y,A,T;switch(u){case 0:T=O._rescale,g=-t/s,m=i/r+1,y=1/s,A=-1/r;break;case 90:T=O._rescaleAndSwap,g=-i/r,m=-t/s,y=1/r,A=1/s;break;case 180:T=O._rescale,g=t/s+1,m=-i/r,y=-1/s,A=1/r;break;case 270:T=O._rescaleAndSwap,g=i/r+1,m=t/s+1,y=-1/r,A=-1/s;break}if(!a){a=[];for(const E of l){const w=E.length;if(w===2){a.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(w===4){a.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const x=new Float32Array(3*(w-2));a.push(x);let[I,P,R,k]=E.subarray(0,4);x.set([NaN,NaN,NaN,NaN,I,P],0);for(let b=4;b<w;b+=2){const N=E[b],D=E[b+1];x.set(O.createBezierPoints(I,P,R,k,N,D),(b-2)*3),[I,P,R,k]=[R,k,N,D]}}}for(let E=0,w=a.length;E<w;E++)p.push({line:T(a[E].map(x=>x??NaN),g,m,y,A),points:T(l[E].map(x=>x??NaN),g,m,y,A)});const v=new f0;return v.build(p,s,r,1,u,h,o),v}get box(){return c(this,Bt)}updateProperty(t,i){return t==="stroke-width"?C(this,Et,ET).call(this,i):null}updateParentDimensions([t,i],s){const[r,o]=C(this,Et,Zi).call(this);_(this,Gi,t),_(this,Oi,i),_(this,nu,s);const[a,l]=C(this,Et,Zi).call(this),u=a-r,h=l-o,p=c(this,Bt);return p[0]-=u,p[1]-=h,p[2]+=2*u,p[3]+=2*h,p}updateRotation(t){return _(this,nh,t),{path:{transform:this.rotationTransform}}}get viewBox(){return c(this,Bt).map(O.svgRound).join(" ")}get defaultProperties(){const[t,i]=c(this,Bt);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${O.svgRound(t)} ${O.svgRound(i)}`}}}get rotationTransform(){const[,,t,i]=c(this,Bt);let s=0,r=0,o=0,a=0,l=0,u=0;switch(c(this,nh)){case 90:r=i/t,o=-t/i,l=t;break;case 180:s=-1,a=-1,l=t,u=i;break;case 270:r=-i/t,o=t/i,u=i;break;default:return""}return`matrix(${s} ${r} ${o} ${a} ${O.svgRound(l)} ${O.svgRound(u)})`}getPathResizingSVGProperties([t,i,s,r]){const[o,a]=C(this,Et,Zi).call(this),[l,u,h,p]=c(this,Bt);if(Math.abs(h-o)<=O.PRECISION||Math.abs(p-a)<=O.PRECISION){const T=t+s/2-(l+h/2),v=i+r/2-(u+p/2);return{path:{"transform-origin":`${O.svgRound(t)} ${O.svgRound(i)}`,transform:`${this.rotationTransform} translate(${T} ${v})`}}}const g=(s-2*o)/(h-2*o),m=(r-2*a)/(p-2*a),y=h/s,A=p/r;return{path:{"transform-origin":`${O.svgRound(l)} ${O.svgRound(u)}`,transform:`${this.rotationTransform} scale(${y} ${A}) translate(${O.svgRound(o)} ${O.svgRound(a)}) scale(${g} ${m}) translate(${O.svgRound(-o)} ${O.svgRound(-a)})`}}}getPathResizedSVGProperties([t,i,s,r]){const[o,a]=C(this,Et,Zi).call(this),l=c(this,Bt),[u,h,p,g]=l;if(l[0]=t,l[1]=i,l[2]=s,l[3]=r,Math.abs(p-o)<=O.PRECISION||Math.abs(g-a)<=O.PRECISION){const v=t+s/2-(u+p/2),E=i+r/2-(h+g/2);for(const{line:w,points:x}of c(this,En))O._translate(w,v,E,w),O._translate(x,v,E,x);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${O.svgRound(t)} ${O.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const m=(s-2*o)/(p-2*o),y=(r-2*a)/(g-2*a),A=-m*(u+o)+t+o,T=-y*(h+a)+i+a;if(m!==1||y!==1||A!==0||T!==0)for(const{line:v,points:E}of c(this,En))O._rescale(v,A,T,m,y,v),O._rescale(E,A,T,m,y,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${O.svgRound(t)} ${O.svgRound(i)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,i],s){const[r,o]=s,a=c(this,Bt),l=t-a[0],u=i-a[1];if(c(this,Gi)===r&&c(this,Oi)===o)for(const{line:h,points:p}of c(this,En))O._translate(h,l,u,h),O._translate(p,l,u,p);else{const h=c(this,Gi)/r,p=c(this,Oi)/o;_(this,Gi,r),_(this,Oi,o);for(const{line:g,points:m}of c(this,En))O._rescale(g,l,u,h,p,g),O._rescale(m,l,u,h,p,m);a[2]*=h,a[3]*=p}return a[0]=t,a[1]=i,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${O.svgRound(t)} ${O.svgRound(i)}`}}}get defaultSVGProperties(){const t=c(this,Bt);return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${O.svgRound(t[0])} ${O.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}};Bt=new WeakMap,nh=new WeakMap,ih=new WeakMap,En=new WeakMap,Gi=new WeakMap,Oi=new WeakMap,nu=new WeakMap,iu=new WeakMap,su=new WeakMap,Et=new WeakSet,Zi=function(t=c(this,su)){const i=c(this,ih)+t/2*c(this,nu);return c(this,iu)%180===0?[i/c(this,Gi),i/c(this,Oi)]:[i/c(this,Oi),i/c(this,Gi)]},_T=function(){const[t,i,s,r]=c(this,Bt),[o,a]=C(this,Et,Zi).call(this,0);return[t+o,i+a,s-2*o,r-2*a]},AT=function(){const t=_(this,Bt,new Float32Array([1/0,1/0,-1/0,-1/0]));for(const{line:r}of c(this,En)){if(r.length<=12){for(let l=4,u=r.length;l<u;l+=6){const[h,p]=r.subarray(l,l+2);t[0]=Math.min(t[0],h),t[1]=Math.min(t[1],p),t[2]=Math.max(t[2],h),t[3]=Math.max(t[3],p)}continue}let o=r[4],a=r[5];for(let l=6,u=r.length;l<u;l+=6){const[h,p,g,m,y,A]=r.subarray(l,l+6);W.bezierBoundingBox(o,a,h,p,g,m,y,A,t),o=y,a=A}}const[i,s]=C(this,Et,Zi).call(this);t[0]=Math.min(1,Math.max(0,t[0]-i)),t[1]=Math.min(1,Math.max(0,t[1]-s)),t[2]=Math.min(1,Math.max(0,t[2]+i)),t[3]=Math.min(1,Math.max(0,t[3]+s)),t[2]-=t[0],t[3]-=t[1]},ET=function(t){const[i,s]=C(this,Et,Zi).call(this);_(this,su,t);const[r,o]=C(this,Et,Zi).call(this),[a,l]=[r-i,o-s],u=c(this,Bt);return u[0]-=a,u[1]-=l,u[2]+=2*a,u[3]+=2*l,u};let np=f0;var ru;const p0=class p0 extends RM{constructor(t){super();S(this,ru);_(this,ru,t),super.updateProperties({fill:"none",stroke:Ue._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,i){t==="stroke-width"&&(i??(i=this["stroke-width"]),i*=c(this,ru).realScale),super.updateSVGProperty(t,i)}clone(){const t=new p0(c(this,ru));return t.updateAll(this),t}};ru=new WeakMap;let ky=p0;var Cp,ST;const Ya=class Ya extends Iy{constructor(t){super({...t,name:"inkEditor"});S(this,Cp);this._willKeepAspectRatio=!0}static initialize(t,i){Ue.initialize(t,i),this._defaultDrawingOptions=new ky(i.viewParameters)}static getDefaultDrawingOptions(t){const i=this._defaultDrawingOptions.clone();return i.updateProperties(t),i}static get supportMultipleDrawings(){return!0}static get typesMap(){return re(this,"typesMap",new Map([[ue.INK_THICKNESS,"stroke-width"],[ue.INK_COLOR,"stroke"],[ue.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,i,s,r,o){return new MM(t,i,s,r,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,i,s,r,o,a){return np.deserialize(t,i,s,r,o,a)}static async deserialize(t,i,s){let r=null;if(t instanceof e0){const{data:{inkLists:a,rect:l,rotation:u,id:h,color:p,opacity:g,borderStyle:{rawWidth:m},popupRef:y},parent:{page:{pageNumber:A}}}=t;r=t={annotationType:ee.INK,color:Array.from(p),thickness:m,opacity:g,paths:{points:a},boxes:null,pageIndex:A-1,rect:l.slice(0),rotation:u,id:h,deleted:!1,popupRef:y}}const o=await super.deserialize(t,i,s);return o.annotationElementId=t.id||null,o._initialData=r,o}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:i,parent:s}=this;i.updateSVGProperty("stroke-width"),s.drawLayer.updateProperties(t,i.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:i,opacity:s}){this._drawingOptions=Ya.getDefaultDrawingOptions({stroke:W.makeHexColor(...t),"stroke-width":i,"stroke-opacity":s})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:i,points:s,rect:r}=this.serializeDraw(t),{_drawingOptions:{stroke:o,"stroke-opacity":a,"stroke-width":l}}=this,u={annotationType:ee.INK,color:Ue._colorManager.convert(o),opacity:a,thickness:l,paths:{lines:i,points:s},pageIndex:this.pageIndex,rect:r,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return t?u:this.annotationElementId&&!C(this,Cp,ST).call(this,u)?null:(u.id=this.annotationElementId,u)}renderAnnotationElement(t){const{points:i,rect:s}=this.serializeDraw(!1);return t.updateEdited({rect:s,thickness:this._drawingOptions["stroke-width"],points:i}),null}};Cp=new WeakSet,ST=function(t){const{color:i,thickness:s,opacity:r,pageIndex:o}=this._initialData;return this._hasBeenMoved||this._hasBeenResized||t.color.some((a,l)=>a!==i[l])||t.thickness!==s||t.opacity!==r||t.pageIndex!==o},J(Ya,"_type","ink"),J(Ya,"_editorType",ee.INK),J(Ya,"_defaultDrawingOptions",null);let by=Ya;var De,vt,Sr,Cs,wr,ou,Bi,zi,Sn,au,fe,ec,tc,_f,Ly,Af,Dy,Ef,wT;const fc=class fc extends Ue{constructor(t){super({...t,name:"stampEditor"});S(this,fe);S(this,De,null);S(this,vt,null);S(this,Sr,null);S(this,Cs,null);S(this,wr,null);S(this,ou,"");S(this,Bi,null);S(this,zi,null);S(this,Sn,!1);S(this,au,!1);_(this,Cs,t.bitmapUrl),_(this,wr,t.bitmapFile)}static initialize(t,i){Ue.initialize(t,i)}static get supportedTypes(){return re(this,"supportedTypes",["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"].map(i=>`image/${i}`))}static get supportedTypesStr(){return re(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(t){return this.supportedTypes.includes(t)}static paste(t,i){i.pasteEditor(ee.STAMP,{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){var t;return{type:"stamp",hasAltText:!!((t=this.altTextData)!=null&&t.altText)}}static computeTelemetryFinalData(t){const i=t.get("hasAltText");return{hasAltText:i.get(!0)??0,hasNoAltText:i.get(!1)??0}}async mlGuessAltText(t=null,i=!0){if(this.hasAltTextData())return null;const{mlManager:s}=this._uiManager;if(!s)throw new Error("No ML.");if(!await s.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:o,height:a}=t||this.copyCanvas(null,null,!0).imageData,l=await s.guess({name:"altText",request:{data:r,width:o,height:a,channels:r.length/(o*a)}});if(!l)throw new Error("No response from the AI service.");if(l.error)throw new Error("Error from the AI service.");if(l.cancel)return null;if(!l.output)throw new Error("No valid response from the AI service.");const u=l.output;return await this.setGuessedAltText(u),i&&!this.hasAltTextData()&&(this.altTextData={alt:u,decorative:!1}),u}remove(){var t;c(this,vt)&&(_(this,De,null),this._uiManager.imageManager.deleteId(c(this,vt)),(t=c(this,Bi))==null||t.remove(),_(this,Bi,null),c(this,zi)&&(clearTimeout(c(this,zi)),_(this,zi,null))),super.remove()}rebuild(){if(!this.parent){c(this,vt)&&C(this,fe,_f).call(this);return}super.rebuild(),this.div!==null&&(c(this,vt)&&c(this,Bi)===null&&C(this,fe,_f).call(this),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(c(this,Sr)||c(this,De)||c(this,Cs)||c(this,wr)||c(this,vt))}get isResizable(){return!0}render(){if(this.div)return this.div;let t,i;if(this.width&&(t=this.x,i=this.y),super.render(),this.div.hidden=!0,this.div.setAttribute("role","figure"),this.addAltTextButton(),c(this,De)?C(this,fe,Ly).call(this):C(this,fe,_f).call(this),this.width&&!this.annotationElementId){const[s,r]=this.parentDimensions;this.setAt(t*s,i*r,this.width*s,this.height*r)}return this._uiManager.addShouldRescale(this),this.div}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;c(this,zi)!==null&&clearTimeout(c(this,zi)),_(this,zi,setTimeout(()=>{_(this,zi,null),C(this,fe,Dy).call(this)},200))}copyCanvas(t,i,s=!1){var m;t||(t=224);const{width:r,height:o}=c(this,De),a=new km;let l=c(this,De),u=r,h=o,p=null;if(i){if(r>i||o>i){const k=Math.min(i/r,i/o);u=Math.floor(r*k),h=Math.floor(o*k)}p=document.createElement("canvas");const y=p.width=Math.ceil(u*a.sx),A=p.height=Math.ceil(h*a.sy);c(this,Sn)||(l=C(this,fe,Af).call(this,y,A));const T=p.getContext("2d");T.filter=this._uiManager.hcmFilter;let v="white",E="#cfcfd8";this._uiManager.hcmFilter!=="none"?E="black":(m=window.matchMedia)!=null&&m.call(window,"(prefers-color-scheme: dark)").matches&&(v="#8f8f9d",E="#42414d");const w=15,x=w*a.sx,I=w*a.sy,P=new OffscreenCanvas(x*2,I*2),R=P.getContext("2d");R.fillStyle=v,R.fillRect(0,0,x*2,I*2),R.fillStyle=E,R.fillRect(0,0,x,I),R.fillRect(x,I,x,I),T.fillStyle=T.createPattern(P,"repeat"),T.fillRect(0,0,y,A),T.drawImage(l,0,0,l.width,l.height,0,0,y,A)}let g=null;if(s){let y,A;if(a.symmetric&&l.width<t&&l.height<t)y=l.width,A=l.height;else if(l=c(this,De),r>t||o>t){const E=Math.min(t/r,t/o);y=Math.floor(r*E),A=Math.floor(o*E),c(this,Sn)||(l=C(this,fe,Af).call(this,y,A))}const v=new OffscreenCanvas(y,A).getContext("2d",{willReadFrequently:!0});v.drawImage(l,0,0,l.width,l.height,0,0,y,A),g={width:y,height:A,data:v.getImageData(0,0,y,A).data}}return{canvas:p,width:u,height:h,imageData:g}}getImageForAltText(){return c(this,Bi)}static async deserialize(t,i,s){var A;let r=null;if(t instanceof qC){const{data:{rect:T,rotation:v,id:E,structParent:w,popupRef:x},container:I,parent:{page:{pageNumber:P}}}=t,R=I.querySelector("canvas"),k=s.imageManager.getFromCanvas(I.id,R);R.remove();const b=((A=await i._structTree.getAriaAttributes(`${Wv}${E}`))==null?void 0:A.get("aria-label"))||"";r=t={annotationType:ee.STAMP,bitmapId:k.id,bitmap:k.bitmap,pageIndex:P-1,rect:T.slice(0),rotation:v,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:b},isSvg:!1,structParent:w,popupRef:x}}const o=await super.deserialize(t,i,s),{rect:a,bitmap:l,bitmapUrl:u,bitmapId:h,isSvg:p,accessibilityData:g}=t;h&&s.imageManager.isValidId(h)?(_(o,vt,h),l&&_(o,De,l)):_(o,Cs,u),_(o,Sn,p);const[m,y]=o.pageDimensions;return o.width=(a[2]-a[0])/m,o.height=(a[3]-a[1])/y,o.annotationElementId=t.id||null,g&&(o.altTextData=g),o._initialData=r,_(o,au,!!r),o}serialize(t=!1,i=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const s={annotationType:ee.STAMP,bitmapId:c(this,vt),pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:c(this,Sn),structTreeParentId:this._structTreeParentId};if(t)return s.bitmapUrl=C(this,fe,Ef).call(this,!0),s.accessibilityData=this.serializeAltText(!0),s;const{decorative:r,altText:o}=this.serializeAltText(!1);if(!r&&o&&(s.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const l=C(this,fe,wT).call(this,s);if(l.isSame)return null;l.isSameAltText?delete s.accessibilityData:s.accessibilityData.structParent=this._initialData.structParent??-1}if(s.id=this.annotationElementId,i===null)return s;i.stamps||(i.stamps=new Map);const a=c(this,Sn)?(s.rect[2]-s.rect[0])*(s.rect[3]-s.rect[1]):null;if(!i.stamps.has(c(this,vt)))i.stamps.set(c(this,vt),{area:a,serialized:s}),s.bitmap=C(this,fe,Ef).call(this,!1);else if(c(this,Sn)){const l=i.stamps.get(c(this,vt));a>l.area&&(l.area=a,l.serialized.bitmap.close(),l.serialized.bitmap=C(this,fe,Ef).call(this,!1))}return s}renderAnnotationElement(t){return t.updateEdited({rect:this.getRect(0,0)}),null}};De=new WeakMap,vt=new WeakMap,Sr=new WeakMap,Cs=new WeakMap,wr=new WeakMap,ou=new WeakMap,Bi=new WeakMap,zi=new WeakMap,Sn=new WeakMap,au=new WeakMap,fe=new WeakSet,ec=function(t,i=!1){if(!t){this.remove();return}_(this,De,t.bitmap),i||(_(this,vt,t.id),_(this,Sn,t.isSvg)),t.file&&_(this,ou,t.file.name),C(this,fe,Ly).call(this)},tc=function(){if(_(this,Sr,null),this._uiManager.enableWaiting(!1),!!c(this,Bi)){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,De)){this._editToolbar.hide(),this._uiManager.editAltText(this,!0);return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&c(this,De)){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}},_f=function(){if(c(this,vt)){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(c(this,vt)).then(s=>C(this,fe,ec).call(this,s,!0)).finally(()=>C(this,fe,tc).call(this));return}if(c(this,Cs)){const s=c(this,Cs);_(this,Cs,null),this._uiManager.enableWaiting(!0),_(this,Sr,this._uiManager.imageManager.getFromUrl(s).then(r=>C(this,fe,ec).call(this,r)).finally(()=>C(this,fe,tc).call(this)));return}if(c(this,wr)){const s=c(this,wr);_(this,wr,null),this._uiManager.enableWaiting(!0),_(this,Sr,this._uiManager.imageManager.getFromFile(s).then(r=>C(this,fe,ec).call(this,r)).finally(()=>C(this,fe,tc).call(this)));return}const t=document.createElement("input");t.type="file",t.accept=fc.supportedTypesStr;const i=this._uiManager._signal;_(this,Sr,new Promise(s=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),C(this,fe,ec).call(this,r)}s()},{signal:i}),t.addEventListener("cancel",()=>{this.remove(),s()},{signal:i})}).finally(()=>C(this,fe,tc).call(this))),t.click()},Ly=function(){var p;const{div:t}=this;let{width:i,height:s}=c(this,De);const[r,o]=this.pageDimensions,a=.75;if(this.width)i=this.width*r,s=this.height*o;else if(i>a*r||s>a*o){const g=Math.min(a*r/i,a*o/s);i*=g,s*=g}const[l,u]=this.parentDimensions;this.setDims(i*l/r,s*u/o),this._uiManager.enableWaiting(!1);const h=_(this,Bi,document.createElement("canvas"));h.setAttribute("role","img"),this.addContainer(h),this.width=i/r,this.height=s/o,(p=this._initialOptions)!=null&&p.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),C(this,fe,Dy).call(this),c(this,au)||(this.parent.addUndoableEditor(this),_(this,au,!0)),this._reportTelemetry({action:"inserted_image"}),c(this,ou)&&h.setAttribute("aria-label",c(this,ou))},Af=function(t,i){const{width:s,height:r}=c(this,De);let o=s,a=r,l=c(this,De);for(;o>2*t||a>2*i;){const u=o,h=a;o>2*t&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),a>2*i&&(a=a>=16384?Math.floor(a/2)-1:Math.ceil(a/2));const p=new OffscreenCanvas(o,a);p.getContext("2d").drawImage(l,0,0,u,h,0,0,o,a),l=p.transferToImageBitmap()}return l},Dy=function(){const[t,i]=this.parentDimensions,{width:s,height:r}=this,o=new km,a=Math.ceil(s*t*o.sx),l=Math.ceil(r*i*o.sy),u=c(this,Bi);if(!u||u.width===a&&u.height===l)return;u.width=a,u.height=l;const h=c(this,Sn)?c(this,De):C(this,fe,Af).call(this,a,l),p=u.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(h,0,0,h.width,h.height,0,0,a,l)},Ef=function(t){if(t){if(c(this,Sn)){const r=this._uiManager.imageManager.getSvgUrl(c(this,vt));if(r)return r}const i=document.createElement("canvas");return{width:i.width,height:i.height}=c(this,De),i.getContext("2d").drawImage(c(this,De),0,0),i.toDataURL()}if(c(this,Sn)){const[i,s]=this.pageDimensions,r=Math.round(this.width*i*Or.PDF_TO_CSS_UNITS),o=Math.round(this.height*s*Or.PDF_TO_CSS_UNITS),a=new OffscreenCanvas(r,o);return a.getContext("2d").drawImage(c(this,De),0,0,c(this,De).width,c(this,De).height,0,0,r,o),a.transferToImageBitmap()}return structuredClone(c(this,De))},wT=function(t){var a;const{pageIndex:i,accessibilityData:{altText:s}}=this._initialData,r=t.pageIndex===i,o=(((a=t.accessibilityData)==null?void 0:a.alt)||"")===s;return{isSame:!this._hasBeenMoved&&!this._hasBeenResized&&r&&o,isSameAltText:o}},J(fc,"_type","stamp"),J(fc,"_editorType",ee.STAMP);let Ny=fc;var oa,lu,qi,Cr,Ts,On,Tr,uu,aa,hi,xs,bt,Is,q,xr,be,CT,xi,Uy,Hy,Sf;const jn=class jn{constructor({uiManager:e,pageIndex:t,div:i,structTreeLayer:s,accessibilityManager:r,annotationLayer:o,drawLayer:a,textLayer:l,viewport:u,l10n:h}){S(this,be);S(this,oa);S(this,lu,!1);S(this,qi,null);S(this,Cr,null);S(this,Ts,null);S(this,On,new Map);S(this,Tr,!1);S(this,uu,!1);S(this,aa,!1);S(this,hi,null);S(this,xs,null);S(this,bt,null);S(this,Is,null);S(this,q);const p=[...c(jn,xr).values()];if(!jn._initialized){jn._initialized=!0;for(const g of p)g.initialize(h,e)}e.registerEditorTypes(p),_(this,q,e),this.pageIndex=t,this.div=i,_(this,oa,r),_(this,qi,o),this.viewport=u,_(this,bt,l),this.drawLayer=a,this._structTree=s,c(this,q).addLayer(this)}get isEmpty(){return c(this,On).size===0}get isInvisible(){return this.isEmpty&&c(this,q).getMode()===ee.NONE}updateToolbar(e){c(this,q).updateToolbar(e)}updateMode(e=c(this,q).getMode()){switch(C(this,be,Sf).call(this),e){case ee.NONE:this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ee.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ee.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;for(const i of c(jn,xr).values())t.toggle(`${i._type}Editing`,e===i._editorType);this.div.hidden=!1}hasTextLayer(e){var t;return e===((t=c(this,bt))==null?void 0:t.div)}setEditingState(e){c(this,q).setEditingState(e)}addCommands(e){c(this,q).addCommands(e)}cleanUndoStack(e){c(this,q).cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){var t;(t=c(this,qi))==null||t.div.classList.toggle("disabled",!e)}async enable(){_(this,aa,!0),this.div.tabIndex=0,this.togglePointerEvents(!0);const e=new Set;for(const i of c(this,On).values())i.enableEditing(),i.show(!0),i.annotationElementId&&(c(this,q).removeChangedExistingAnnotation(i),e.add(i.annotationElementId));if(!c(this,qi)){_(this,aa,!1);return}const t=c(this,qi).getEditableAnnotations();for(const i of t){if(i.hide(),c(this,q).isDeletedAnnotationElement(i.data.id)||e.has(i.data.id))continue;const s=await this.deserialize(i);s&&(this.addOrRebuild(s),s.enableEditing())}_(this,aa,!1)}disable(){var s;_(this,uu,!0),this.div.tabIndex=-1,this.togglePointerEvents(!1);const e=new Map,t=new Map;for(const r of c(this,On).values())if(r.disableEditing(),!!r.annotationElementId){if(r.serialize()!==null){e.set(r.annotationElementId,r);continue}else t.set(r.annotationElementId,r);(s=this.getEditableAnnotation(r.annotationElementId))==null||s.show(),r.remove()}if(c(this,qi)){const r=c(this,qi).getEditableAnnotations();for(const o of r){const{id:a}=o.data;if(c(this,q).isDeletedAnnotationElement(a))continue;let l=t.get(a);if(l){l.resetAnnotationElement(o),l.show(!1),o.show();continue}l=e.get(a),l&&(c(this,q).addChangedExistingAnnotation(l),l.renderAnnotationElement(o)&&l.show(!1)),o.show()}}C(this,be,Sf).call(this),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of c(jn,xr).values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),_(this,uu,!1)}getEditableAnnotation(e){var t;return((t=c(this,qi))==null?void 0:t.getEditableAnnotation(e))||null}setActiveEditor(e){c(this,q).getActive()!==e&&c(this,q).setActiveEditor(e)}enableTextSelection(){var e;if(this.div.tabIndex=-1,(e=c(this,bt))!=null&&e.div&&!c(this,Is)){_(this,Is,new AbortController);const t=c(this,q).combinedSignal(c(this,Is));c(this,bt).div.addEventListener("pointerdown",C(this,be,CT).bind(this),{signal:t}),c(this,bt).div.classList.add("highlighting")}}disableTextSelection(){var e;this.div.tabIndex=0,(e=c(this,bt))!=null&&e.div&&c(this,Is)&&(c(this,Is).abort(),_(this,Is,null),c(this,bt).div.classList.remove("highlighting"))}enableClick(){if(c(this,Cr))return;_(this,Cr,new AbortController);const e=c(this,q).combinedSignal(c(this,Cr));this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){var e;(e=c(this,Cr))==null||e.abort(),_(this,Cr,null)}attach(e){c(this,On).set(e.id,e);const{annotationElementId:t}=e;t&&c(this,q).isDeletedAnnotationElement(t)&&c(this,q).removeDeletedAnnotationElement(e)}detach(e){var t;c(this,On).delete(e.id),(t=c(this,oa))==null||t.removePointerInTextLayer(e.contentDiv),!c(this,uu)&&e.annotationElementId&&c(this,q).addDeletedAnnotationElement(e)}remove(e){this.detach(e),c(this,q).removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){var t;e.parent!==this&&(e.parent&&e.annotationElementId&&(c(this,q).addDeletedAnnotationElement(e.annotationElementId),Ue.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),(t=e.parent)==null||t.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),c(this,q).addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!c(this,aa)),c(this,q).addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){var i;if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!c(this,Ts)&&(e._focusEventsAllowed=!1,_(this,Ts,setTimeout(()=>{_(this,Ts,null),e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:c(this,q)._signal}),t.focus())},0))),e._structTreeParentId=(i=c(this,oa))==null?void 0:i.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||(e.parent=this),e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),i=()=>{e.remove()};this.addCommands({cmd:t,undo:i,mustExec:!1})}getNextId(){return c(this,q).getId()}combinedSignal(e){return c(this,q).combinedSignal(e)}canCreateNewEmptyEditor(){var e;return(e=c(this,be,xi))==null?void 0:e.canCreateNewEmptyEditor()}pasteEditor(e,t){c(this,q).updateToolbar(e),c(this,q).updateMode(e);const{offsetX:i,offsetY:s}=C(this,be,Hy).call(this),r=this.getNextId(),o=C(this,be,Uy).call(this,{parent:this,id:r,x:i,y:s,uiManager:c(this,q),isCentered:!0,...t});o&&this.add(o)}async deserialize(e){var t;return await((t=c(jn,xr).get(e.annotationType??e.annotationEditorType))==null?void 0:t.deserialize(e,this,c(this,q)))||null}createAndAddNewEditor(e,t,i={}){const s=this.getNextId(),r=C(this,be,Uy).call(this,{parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:c(this,q),isCentered:t,...i});return r&&this.add(r),r}addNewEditor(){this.createAndAddNewEditor(C(this,be,Hy).call(this),!0)}setSelected(e){c(this,q).setSelected(e)}toggleSelected(e){c(this,q).toggleSelected(e)}unselect(e){c(this,q).unselect(e)}pointerup(e){var i;const{isMac:t}=Wt.platform;if(!(e.button!==0||e.ctrlKey&&t)&&e.target===this.div&&c(this,Tr)&&(_(this,Tr,!1),!((i=c(this,be,xi))!=null&&i.isDrawer&&c(this,be,xi).supportMultipleDrawings))){if(!c(this,lu)){_(this,lu,!0);return}if(c(this,q).getMode()===ee.STAMP){c(this,q).unselectAll();return}this.createAndAddNewEditor(e,!1)}}pointerdown(e){var s;if(c(this,q).getMode()===ee.HIGHLIGHT&&this.enableTextSelection(),c(this,Tr)){_(this,Tr,!1);return}const{isMac:t}=Wt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(_(this,Tr,!0),(s=c(this,be,xi))!=null&&s.isDrawer){this.startDrawingSession(e);return}const i=c(this,q).getActive();_(this,lu,!i||i.isEmpty())}startDrawingSession(e){if(this.div.focus(),c(this,hi)){c(this,be,xi).startDrawing(this,c(this,q),!1,e);return}c(this,q).setCurrentDrawingSession(this),_(this,hi,new AbortController);const t=c(this,q).combinedSignal(c(this,hi));this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(_(this,xs,null),this.commitOrRemove())},{signal:t}),c(this,be,xi).startDrawing(this,c(this,q),!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&_(this,xs,t);return}c(this,xs)&&setTimeout(()=>{var t;(t=c(this,xs))==null||t.focus(),_(this,xs,null)},0)}endDrawingSession(e=!1){return c(this,hi)?(c(this,q).setCurrentDrawingSession(null),c(this,hi).abort(),_(this,hi,null),_(this,xs,null),c(this,be,xi).endDrawing(e)):null}findNewParent(e,t,i){const s=c(this,q).findParent(t,i);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return c(this,hi)?(this.endDrawingSession(),!0):!1}onScaleChanging(){c(this,hi)&&c(this,be,xi).onScaleChangingWhenDrawing(this)}destroy(){var e,t;this.commitOrRemove(),((e=c(this,q).getActive())==null?void 0:e.parent)===this&&(c(this,q).commitOrRemove(),c(this,q).setActiveEditor(null)),c(this,Ts)&&(clearTimeout(c(this,Ts)),_(this,Ts,null));for(const i of c(this,On).values())(t=c(this,oa))==null||t.removePointerInTextLayer(i.contentDiv),i.setParent(null),i.isAttachedToDOM=!1,i.div.remove();this.div=null,c(this,On).clear(),c(this,q).removeLayer(this)}render({viewport:e}){this.viewport=e,ma(this.div,e);for(const t of c(this,q).getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){c(this,q).commitOrRemove(),C(this,be,Sf).call(this);const t=this.viewport.rotation,i=e.rotation;if(this.viewport=e,ma(this.div,{rotation:i}),t!==i)for(const s of c(this,On).values())s.rotate(i)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return c(this,q).viewParameters.realScale}};oa=new WeakMap,lu=new WeakMap,qi=new WeakMap,Cr=new WeakMap,Ts=new WeakMap,On=new WeakMap,Tr=new WeakMap,uu=new WeakMap,aa=new WeakMap,hi=new WeakMap,xs=new WeakMap,bt=new WeakMap,Is=new WeakMap,q=new WeakMap,xr=new WeakMap,be=new WeakSet,CT=function(e){c(this,q).unselectAll();const{target:t}=e;if(t===c(this,bt).div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&c(this,bt).div.contains(t)){const{isMac:i}=Wt.platform;if(e.button!==0||e.ctrlKey&&i)return;c(this,q).showAllEditors("highlight",!0,!0),c(this,bt).div.classList.add("free"),this.toggleDrawing(),tp.startHighlighting(this,c(this,q).direction==="ltr",{target:c(this,bt).div,x:e.x,y:e.y}),c(this,bt).div.addEventListener("pointerup",()=>{c(this,bt).div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:c(this,q)._signal}),e.preventDefault()}},xi=function(){return c(jn,xr).get(c(this,q).getMode())},Uy=function(e){const t=c(this,be,xi);return t?new t.prototype.constructor(e):null},Hy=function(){const{x:e,y:t,width:i,height:s}=this.div.getBoundingClientRect(),r=Math.max(0,e),o=Math.max(0,t),a=Math.min(window.innerWidth,e+i),l=Math.min(window.innerHeight,t+s),u=(r+a)/2-e,h=(o+l)/2-t,[p,g]=this.viewport.rotation%180===0?[u,h]:[h,u];return{offsetX:p,offsetY:g}},Sf=function(){for(const e of c(this,On).values())e.isEmpty()&&e.remove()},J(jn,"_initialized",!1),S(jn,xr,new Map([yy,by,Ny,tp].map(e=>[e._editorType,e])));let Fy=jn;var fi,sh,zt,la,Tp,TT,Ki,Gy,xT,Oy;const Pt=class Pt{constructor({pageIndex:e}){S(this,Ki);S(this,fi,null);S(this,sh,0);S(this,zt,new Map);S(this,la,new Map);this.pageIndex=e}setParent(e){if(!c(this,fi)){_(this,fi,e);return}if(c(this,fi)!==e){if(c(this,zt).size>0)for(const t of c(this,zt).values())t.remove(),e.append(t);_(this,fi,e)}}static get _svgFactory(){return re(this,"_svgFactory",new jv)}draw(e,t=!1,i=!1){const s=Ht(this,sh)._++,r=C(this,Ki,Gy).call(this),o=Pt._svgFactory.createElement("defs");r.append(o);const a=Pt._svgFactory.createElement("path");o.append(a);const l=`path_p${this.pageIndex}_${s}`;a.setAttribute("id",l),a.setAttribute("vector-effect","non-scaling-stroke"),t&&c(this,la).set(s,a);const u=i?C(this,Ki,xT).call(this,o,l):null,h=Pt._svgFactory.createElement("use");return r.append(h),h.setAttribute("href",`#${l}`),this.updateProperties(r,e),c(this,zt).set(s,r),{id:s,clipPathId:`url(#${u})`}}drawOutline(e,t){const i=Ht(this,sh)._++,s=C(this,Ki,Gy).call(this),r=Pt._svgFactory.createElement("defs");s.append(r);const o=Pt._svgFactory.createElement("path");r.append(o);const a=`path_p${this.pageIndex}_${i}`;o.setAttribute("id",a),o.setAttribute("vector-effect","non-scaling-stroke");let l;if(t){const p=Pt._svgFactory.createElement("mask");r.append(p),l=`mask_p${this.pageIndex}_${i}`,p.setAttribute("id",l),p.setAttribute("maskUnits","objectBoundingBox");const g=Pt._svgFactory.createElement("rect");p.append(g),g.setAttribute("width","1"),g.setAttribute("height","1"),g.setAttribute("fill","white");const m=Pt._svgFactory.createElement("use");p.append(m),m.setAttribute("href",`#${a}`),m.setAttribute("stroke","none"),m.setAttribute("fill","black"),m.setAttribute("fill-rule","nonzero"),m.classList.add("mask")}const u=Pt._svgFactory.createElement("use");s.append(u),u.setAttribute("href",`#${a}`),l&&u.setAttribute("mask",`url(#${l})`);const h=u.cloneNode();return s.append(h),u.classList.add("mainOutline"),h.classList.add("secondaryOutline"),this.updateProperties(s,e),c(this,zt).set(i,s),i}finalizeDraw(e,t){c(this,la).delete(e),this.updateProperties(e,t)}updateProperties(e,t){var l;if(!t)return;const{root:i,bbox:s,rootClass:r,path:o}=t,a=typeof e=="number"?c(this,zt).get(e):e;if(a){if(i&&C(this,Ki,Oy).call(this,a,i),s&&C(l=Pt,Tp,TT).call(l,a,s),r){const{classList:u}=a;for(const[h,p]of Object.entries(r))u.toggle(h,p)}if(o){const h=a.firstChild.firstChild;C(this,Ki,Oy).call(this,h,o)}}}updateParent(e,t){if(t===this)return;const i=c(this,zt).get(e);i&&(c(t,fi).append(i),c(this,zt).delete(e),c(t,zt).set(e,i))}remove(e){c(this,la).delete(e),c(this,fi)!==null&&(c(this,zt).get(e).remove(),c(this,zt).delete(e))}destroy(){_(this,fi,null);for(const e of c(this,zt).values())e.remove();c(this,zt).clear(),c(this,la).clear()}};fi=new WeakMap,sh=new WeakMap,zt=new WeakMap,la=new WeakMap,Tp=new WeakSet,TT=function(e,[t,i,s,r]){const{style:o}=e;o.top=`${100*i}%`,o.left=`${100*t}%`,o.width=`${100*s}%`,o.height=`${100*r}%`},Ki=new WeakSet,Gy=function(){const e=Pt._svgFactory.create(1,1,!0);return c(this,fi).append(e),e.setAttribute("aria-hidden",!0),e},xT=function(e,t){const i=Pt._svgFactory.createElement("clipPath");e.append(i);const s=`clip_${t}`;i.setAttribute("id",s),i.setAttribute("clipPathUnits","objectBoundingBox");const r=Pt._svgFactory.createElement("use");return i.append(r),r.setAttribute("href",`#${t}`),r.classList.add("clip"),s},Oy=function(e,t){for(const[i,s]of Object.entries(t))s===null?e.removeAttribute(i):e.setAttribute(i,s)},S(Pt,Tp);let Vy=Pt;globalThis.pdfjsTestingUtils={HighlightOutliner:_y};Z.AbortException;Z.AnnotationEditorLayer;Z.AnnotationEditorParamsType;Z.AnnotationEditorType;Z.AnnotationEditorUIManager;Z.AnnotationLayer;Z.AnnotationMode;Z.ColorPicker;Z.DOMSVGFactory;Z.DrawLayer;Z.FeatureTest;var kM=Z.GlobalWorkerOptions;Z.ImageKind;Z.InvalidPDFException;Z.MissingPDFException;Z.OPS;Z.OutputScale;Z.PDFDataRangeTransport;Z.PDFDateString;Z.PDFWorker;Z.PasswordResponses;Z.PermissionFlag;Z.PixelsPerInch;Z.RenderingCancelledException;Z.TextLayer;Z.TouchManager;Z.UnexpectedResponseException;Z.Util;Z.VerbosityLevel;Z.XfaLayer;Z.build;Z.createValidAbsoluteUrl;Z.fetchData;var bM=Z.getDocument;Z.getFilenameFromUrl;Z.getPdfFilenameFromUrl;Z.getXfaPageViewport;Z.isDataScheme;Z.isPdfFile;Z.noContextMenu;Z.normalizeUnicode;Z.setLayerDimensions;Z.shadow;Z.stopEvent;Z.version;kM.workerSrc="https://cdn.jsdelivr.net/npm/pdfjs-dist@4.0.379/build/pdf.worker.min.mjs";const NM=({onStart:n,isLoading:e})=>{const[t,i]=Je.useState(""),[s,r]=Je.useState(""),[o,a]=Je.useState(!1),[l,u]=Je.useState(5),[h,p]=Je.useState(Im.Intermediate),[g,m]=Je.useState({tf:!0,mc:!0,basic:!0}),y=async v=>{try{const E=await v.arrayBuffer(),w=await bM({data:E}).promise;let x="";for(let I=1;I<=w.numPages;I++){const k=(await(await w.getPage(I)).getTextContent()).items.map(b=>b.str).join(" ");x+=k+`
`}return x}catch(E){throw console.error("Errore PDF",E),new Error("Impossibile leggere il PDF.")}},A=Je.useCallback(async v=>{var I;const E=(I=v.target.files)==null?void 0:I[0];if(!E)return;const w=E.type==="application/pdf"||E.name.toLowerCase().endsWith(".pdf"),x=E.name.toLowerCase().endsWith(".md")||E.type==="text/markdown";if(!w&&!x){alert("Formato non supportato. Carica solo PDF o MD.");return}r(E.name),a(!0),i("");try{if(w){const P=await y(E);i(P)}else{const P=new FileReader;P.onload=R=>{var b;const k=(b=R.target)==null?void 0:b.result;i(k),a(!1)},P.readAsText(E);return}}catch(P){console.error("Errore lettura file:",P),alert("Impossibile leggere il file."),r("")}finally{w&&a(!1)}},[]),T=v=>{if(v.preventDefault(),!t.trim()){alert("Per favore carica un documento valido (PDF o MD).");return}if(!g.tf&&!g.mc&&!g.basic){alert("Seleziona almeno un tipo di carta.");return}n({cardCount:l,difficulty:h,includeTrueFalse:g.tf,includeMultipleChoice:g.mc,includeBasic:g.basic},{text:t,fileName:s})};return M.jsxs("div",{className:"w-full max-w-3xl mx-auto backdrop-blur-xl bg-slate-900/80 border border-slate-700/50 rounded-3xl shadow-2xl overflow-hidden animate-slide-up relative",children:[M.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500"}),M.jsxs("div",{className:"p-8 md:p-10 space-y-8",children:[M.jsxs("div",{className:"text-center space-y-2",children:[M.jsx("h2",{className:"text-3xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-indigo-400 to-cyan-400",children:"Setup Sessione"}),M.jsx("p",{className:"text-slate-400",children:"Carica i tuoi appunti e personalizza l'esperienza"})]}),M.jsxs("form",{onSubmit:T,className:"space-y-8",children:[M.jsxs("div",{className:"space-y-3",children:[M.jsx("label",{className:"block text-sm font-bold text-slate-300 uppercase tracking-wider",children:"1. Documento (PDF / MD)"}),M.jsx("div",{className:"group relative",children:M.jsxs("label",{className:`flex flex-col items-center justify-center w-full h-40 border-2 border-dashed rounded-2xl cursor-pointer transition-all duration-300 ${o?"border-slate-600 bg-slate-800/50 cursor-wait":s?"border-emerald-500/50 bg-emerald-950/20":"border-slate-600 bg-slate-800/30 hover:bg-slate-800 hover:border-indigo-500 hover:shadow-lg hover:shadow-indigo-500/20"}`,children:[M.jsx("div",{className:"flex flex-col items-center justify-center pt-5 pb-6",children:o?M.jsx("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-indigo-500 mb-3"}):s?M.jsxs(M.Fragment,{children:[M.jsx("div",{className:"w-12 h-12 mb-3 rounded-full bg-emerald-500/20 flex items-center justify-center text-emerald-400",children:M.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})})}),M.jsx("p",{className:"mb-1 text-sm text-emerald-400 font-semibold",children:s}),M.jsx("p",{className:"text-xs text-slate-500",children:"Pronto per l'analisi"})]}):M.jsxs(M.Fragment,{children:[M.jsx("div",{className:"w-12 h-12 mb-3 rounded-full bg-slate-700/50 flex items-center justify-center text-slate-400 group-hover:text-indigo-400 group-hover:bg-indigo-500/10 transition-colors",children:M.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})})}),M.jsx("p",{className:"mb-2 text-sm text-slate-400",children:M.jsx("span",{className:"font-semibold text-indigo-400",children:"Clicca per caricare"})}),M.jsx("p",{className:"text-xs text-slate-500",children:"PDF o Markdown"})]})}),M.jsx("input",{type:"file",className:"hidden",accept:".pdf,.md",onChange:A,disabled:o})]})})]}),M.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[M.jsxs("div",{className:"space-y-4",children:[M.jsx("label",{className:"block text-sm font-bold text-slate-300 uppercase tracking-wider",children:"2. Livello"}),M.jsx("div",{className:"flex bg-slate-800 p-1 rounded-xl",children:Object.values(Im).map(v=>M.jsx("button",{type:"button",onClick:()=>p(v),className:`flex-1 py-2.5 text-sm rounded-lg transition-all font-medium ${h===v?"bg-gradient-to-br from-indigo-600 to-purple-600 text-white shadow-lg":"text-slate-400 hover:text-white hover:bg-slate-700/50"}`,children:v},v))})]}),M.jsxs("div",{className:"space-y-4",children:[M.jsxs("div",{className:"flex justify-between items-center",children:[M.jsx("label",{className:"block text-sm font-bold text-slate-300 uppercase tracking-wider",children:"3. Quantit"}),M.jsxs("span",{className:"px-3 py-1 bg-indigo-500/20 text-indigo-300 rounded-lg text-sm font-bold",children:[l," Card"]})]}),M.jsx("input",{type:"range",min:"3",max:"20",value:l,onChange:v=>u(parseInt(v.target.value)),className:"w-full h-2 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-indigo-500"})]})]}),M.jsxs("div",{className:"space-y-3",children:[M.jsx("label",{className:"block text-sm font-bold text-slate-300 uppercase tracking-wider mb-2",children:"4. Tipologie"}),M.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[{id:"tf",label:"Vero/Falso",val:g.tf},{id:"mc",label:"Multipla",val:g.mc},{id:"basic",label:"Aperta",val:g.basic}].map(v=>M.jsxs("label",{className:`flex items-center justify-center p-4 rounded-xl cursor-pointer border transition-all ${v.val?"bg-indigo-600/20 border-indigo-500/50 text-white shadow-lg shadow-indigo-900/20":"bg-slate-800 border-transparent text-slate-500 hover:border-slate-600"}`,children:[M.jsx("input",{type:"checkbox",checked:v.val,onChange:()=>m(E=>({...E,[v.id]:!E[v.id]})),className:"hidden"}),M.jsx("span",{className:"font-semibold",children:v.label})]},v.id))})]}),M.jsxs("button",{type:"submit",disabled:e||o||!t,className:"w-full py-5 relative group overflow-hidden rounded-xl font-bold text-lg text-white shadow-2xl disabled:opacity-50 disabled:cursor-not-allowed",children:[M.jsx("div",{className:"absolute inset-0 w-full h-full bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 transition-all duration-300 group-hover:scale-105"}),M.jsx("div",{className:"absolute inset-0 w-full h-full bg-white/20 opacity-0 group-hover:opacity-100 transition-opacity"}),M.jsx("span",{className:"relative flex items-center justify-center",children:e?M.jsxs(M.Fragment,{children:[M.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[M.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),M.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Elaborazione con IA..."]}):"GENERA FLASHCARD"})]})]})]})]})},LM=({card:n,onAnswer:e,currentIndex:t,totalCards:i})=>{const[s,r]=Je.useState(!1),[o,a]=Je.useState(null),[l,u]=Je.useState(!1),h=T=>{l||(a(T),u(!0),setTimeout(()=>{r(!0)},800))},p=()=>{r(!0)},g=T=>{u(!0),e(T)},m=()=>{if(n.type===wn.MultipleChoice||n.type===wn.TrueFalse){const T=o===n.correctAnswer;e(T)}},y=T=>l?T===n.correctAnswer?"bg-emerald-900/50 border-emerald-500 text-emerald-200 font-bold shadow-[0_0_15px_rgba(16,185,129,0.4)]":T===o&&T!==n.correctAnswer?"bg-red-900/50 border-red-500 text-red-200":"bg-slate-800/50 border-slate-800 text-slate-600 opacity-50":"bg-slate-800 hover:bg-slate-700 border-slate-700 text-slate-200 hover:border-indigo-500",A=t/i*100;return M.jsxs("div",{className:"w-full max-w-4xl mx-auto my-6 px-4 animate-slide-up",children:[M.jsxs("div",{className:"flex flex-col mb-8",children:[M.jsxs("div",{className:"flex justify-between items-end mb-2",children:[M.jsxs("span",{className:"text-2xl font-bold text-white",children:["Domanda ",t+1," ",M.jsxs("span",{className:"text-slate-500 text-lg",children:["/ ",i]})]}),M.jsx("span",{className:"px-3 py-1 rounded-full bg-slate-800 border border-slate-700 text-xs font-medium uppercase tracking-wider text-indigo-400",children:n.type==="basic"?"Aperta":n.type==="true_false"?"Vero/Falso":"Multipla"})]}),M.jsx("div",{className:"w-full bg-slate-800 rounded-full h-2 overflow-hidden",children:M.jsx("div",{className:"h-full bg-gradient-to-r from-indigo-500 to-purple-500 shadow-[0_0_10px_rgba(168,85,247,0.5)] transition-all duration-700 ease-out",style:{width:`${A}%`}})})]}),M.jsx("div",{className:"perspective-1000 w-full",children:M.jsxs("div",{className:`relative w-full transition-transform duration-700 transform-style-3d card-grid ${s?"rotate-y-180":""}`,children:[M.jsxs("div",{className:"card-face backface-hidden bg-slate-900 rounded-3xl p-8 md:p-12 border border-slate-700 shadow-2xl flex flex-col justify-between min-h-[450px]",children:[M.jsx("div",{className:"flex-grow flex items-center justify-center py-6",children:M.jsx("h2",{className:"text-2xl md:text-4xl font-bold text-white leading-tight text-center",children:n.question})}),M.jsxs("div",{className:"mt-8 space-y-4 w-full",children:[n.type===wn.MultipleChoice&&n.options&&M.jsx("div",{className:"grid grid-cols-1 gap-3",children:n.options.map((T,v)=>M.jsx("button",{onClick:()=>h(T),disabled:l,className:`p-5 w-full rounded-2xl border-2 text-left transition-all duration-200 text-lg ${y(T)}`,children:T},v))}),n.type===wn.TrueFalse&&M.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[M.jsx("button",{onClick:()=>h("Vero"),disabled:l,className:`py-6 rounded-2xl border-2 font-bold text-xl transition-all ${y("Vero")}`,children:"Vero"}),M.jsx("button",{onClick:()=>h("Falso"),disabled:l,className:`py-6 rounded-2xl border-2 font-bold text-xl transition-all ${y("Falso")}`,children:"Falso"})]}),n.type===wn.Basic&&M.jsx("div",{className:"flex justify-center pb-4",children:M.jsxs("button",{onClick:p,className:"group relative px-8 py-4 bg-indigo-600 rounded-full font-bold text-white shadow-lg overflow-hidden transition-all hover:scale-105 active:scale-95",children:[M.jsx("div",{className:"absolute inset-0 bg-white/20 group-hover:translate-x-full transition-transform duration-500 -skew-x-12"}),"Rivela Risposta"]})}),n.type!==wn.Basic&&l&&!s&&M.jsx("p",{className:"text-center text-slate-500 text-sm animate-pulse",children:"Girando la carta..."})]})]}),M.jsxs("div",{className:"card-face backface-hidden rotate-y-180 bg-slate-900 rounded-3xl p-8 md:p-12 border border-indigo-500/30 shadow-[0_0_40px_rgba(79,70,229,0.15)] flex flex-col justify-between min-h-[450px]",children:[M.jsxs("div",{className:"space-y-6",children:[M.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[M.jsx("div",{className:`w-3 h-3 rounded-full ${o===n.correctAnswer||n.type===wn.Basic?"bg-emerald-500":"bg-red-500"}`}),M.jsx("span",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest",children:"Soluzione"})]}),M.jsx("h3",{className:`text-2xl md:text-3xl font-bold leading-snug ${n.type===wn.Basic?"text-indigo-400":o===n.correctAnswer?"text-emerald-400":"text-red-400"}`,children:n.correctAnswer}),M.jsxs("div",{className:"bg-slate-800/50 p-6 rounded-2xl border border-slate-700/50 backdrop-blur-sm",children:[M.jsxs("h4",{className:"font-semibold text-indigo-300 mb-2 flex items-center",children:[M.jsx("svg",{className:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),"Spiegazione"]}),M.jsx("p",{className:"text-slate-300 leading-relaxed text-lg",children:n.userExplanation||"Nessuna spiegazione dettagliata disponibile."})]})]}),M.jsx("div",{className:"mt-8 pt-6 border-t border-slate-800",children:n.type===wn.Basic?M.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[M.jsx("button",{onClick:()=>g(!1),className:"py-4 rounded-xl border border-red-900/50 bg-red-950/30 text-red-400 font-bold hover:bg-red-900/50 hover:border-red-500 transition-all",children:"Non lo sapevo"}),M.jsx("button",{onClick:()=>g(!0),className:"py-4 rounded-xl border border-emerald-900/50 bg-emerald-950/30 text-emerald-400 font-bold hover:bg-emerald-900/50 hover:border-emerald-500 transition-all",children:"Lo sapevo"})]}):M.jsx("button",{onClick:m,className:"w-full py-4 bg-white text-slate-900 rounded-xl font-extrabold text-lg hover:bg-indigo-50 hover:scale-[1.02] transition-all shadow-[0_0_20px_rgba(255,255,255,0.3)]",children:"Prossima Domanda"})})]})]})})]})},DM=({state:n,onRestart:e})=>{const[t,i]=Je.useState(0),[s,r]=Je.useState(!1),o=n.answers.length,a=n.answers.filter(v=>v).length,l=o>0?a/o*100:0,h=(v=>v>=98?{grade:"10",message:"Leggendario!",color:"from-fuchsia-400 to-purple-600",glow:"shadow-fuchsia-500/50",stroke:"#d946ef"}:v>=95?{grade:"9 ",message:"Eccellente",color:"from-violet-400 to-indigo-600",glow:"shadow-violet-500/50",stroke:"#8b5cf6"}:v>=90?{grade:"9",message:"Ottimo",color:"from-indigo-400 to-blue-600",glow:"shadow-indigo-500/50",stroke:"#6366f1"}:v>=85?{grade:"8 ",message:"Molto Buono",color:"from-cyan-400 to-blue-500",glow:"shadow-cyan-500/50",stroke:"#06b6d4"}:v>=80?{grade:"8",message:"Buono",color:"from-teal-400 to-emerald-600",glow:"shadow-teal-500/50",stroke:"#14b8a6"}:v>=75?{grade:"7 ",message:"Discreto",color:"from-emerald-400 to-green-600",glow:"shadow-emerald-500/50",stroke:"#10b981"}:v>=70?{grade:"7",message:"Pi che sufficiente",color:"from-green-400 to-emerald-600",glow:"shadow-green-500/50",stroke:"#22c55e"}:v>=65?{grade:"6 ",message:"Sufficiente +",color:"from-lime-400 to-green-600",glow:"shadow-lime-500/50",stroke:"#84cc16"}:v>=60?{grade:"6",message:"Sufficiente",color:"from-yellow-400 to-orange-500",glow:"shadow-yellow-500/50",stroke:"#eab308"}:v>=55?{grade:"5 ",message:"Quasi sufficiente",color:"from-orange-400 to-red-500",glow:"shadow-orange-500/50",stroke:"#f97316"}:v>=45?{grade:"5",message:"Insufficiente",color:"from-orange-500 to-red-600",glow:"shadow-orange-500/50",stroke:"#f97316"}:v>=35?{grade:"4 ",message:"Gravemente insufficiente",color:"from-red-500 to-rose-700",glow:"shadow-red-500/50",stroke:"#ef4444"}:v>=25?{grade:"4",message:"Gravemente insufficiente",color:"from-red-600 to-rose-800",glow:"shadow-red-600/50",stroke:"#dc2626"}:{grade:"2",message:"Disastroso",color:"from-red-700 to-rose-950",glow:"shadow-red-900/50",stroke:"#991b1b"})(l);Je.useEffect(()=>{setTimeout(()=>{let v=0;const E=1500,w=20,x=E/w,I=l/x,P=setInterval(()=>{v+=I,v>=l?(i(l),clearInterval(P),r(!0)):i(v)},w);return()=>clearInterval(P)},300)},[l]);const p=280,g=12,m=p/2,y=(p-g)/2-10,A=2*Math.PI*y,T=A-t/100*A;return M.jsxs("div",{className:"w-full flex flex-col items-center justify-center animate-fade-in py-8",children:[M.jsxs("div",{className:"relative w-[320px] h-[320px] flex items-center justify-center mb-8",children:[M.jsx("div",{className:`absolute inset-0 rounded-full bg-gradient-to-tr ${h.color} opacity-20 blur-3xl animate-pulse`}),M.jsx("div",{className:"absolute inset-0 border-[2px] border-slate-700/30 rounded-full border-dashed animate-[spin_10s_linear_infinite]"}),M.jsx("div",{className:"absolute inset-4 border-[1px] border-slate-600/20 rounded-full animate-[spin_15s_linear_infinite_reverse]"}),M.jsxs("svg",{width:p,height:p,className:"transform -rotate-90 relative z-10 drop-shadow-2xl",children:[M.jsx("circle",{cx:m,cy:m,r:y,stroke:"#1e293b",strokeWidth:g,fill:"transparent",strokeLinecap:"round"}),M.jsx("circle",{cx:m,cy:m,r:y,stroke:h.stroke,strokeWidth:g,fill:"transparent",strokeDasharray:A,strokeDashoffset:T,strokeLinecap:"round",className:"transition-all duration-100 ease-linear",style:{filter:`drop-shadow(0 0 6px ${h.stroke})`}})]}),M.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center z-20",children:[M.jsx("span",{className:"text-slate-400 text-xs font-bold uppercase tracking-[0.2em] mb-2",children:"Voto"}),M.jsx("div",{className:`text-7xl font-black text-transparent bg-clip-text bg-gradient-to-b ${h.color} drop-shadow-sm`,children:s?h.grade:Math.round(t/10*10)/10}),M.jsxs("div",{className:`mt-4 px-4 py-1 rounded-full bg-slate-800/80 backdrop-blur border border-slate-700 text-sm font-medium ${s?"opacity-100 translate-y-0":"opacity-0 translate-y-4"} transition-all duration-500`,children:[Math.round(t),"% Accuratezza"]})]})]}),M.jsxs("div",{className:`text-center space-y-2 mb-10 transition-all duration-700 ${s?"opacity-100 scale-100":"opacity-0 scale-95"}`,children:[M.jsx("h2",{className:`text-4xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r ${h.color}`,children:h.message}),M.jsx("p",{className:"text-slate-400 text-lg",children:"Hai completato la sessione."})]}),M.jsxs("div",{className:`grid grid-cols-2 gap-4 w-full max-w-lg mb-12 transition-all duration-1000 delay-200 ${s?"opacity-100 translate-y-0":"opacity-0 translate-y-10"}`,children:[M.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-2xl border border-emerald-500/20 flex flex-col items-center shadow-lg relative overflow-hidden group",children:[M.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-emerald-500"}),M.jsx("span",{className:"text-3xl font-bold text-white mb-1 group-hover:scale-110 transition-transform",children:a}),M.jsx("span",{className:"text-xs text-emerald-400 uppercase font-bold tracking-wider",children:"Corrette"})]}),M.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-2xl border border-red-500/20 flex flex-col items-center shadow-lg relative overflow-hidden group",children:[M.jsx("div",{className:"absolute top-0 left-0 w-1 h-full bg-red-500"}),M.jsx("span",{className:"text-3xl font-bold text-white mb-1 group-hover:scale-110 transition-transform",children:o-a}),M.jsx("span",{className:"text-xs text-red-400 uppercase font-bold tracking-wider",children:"Errate"})]})]}),M.jsxs("button",{onClick:e,className:"group relative px-10 py-4 bg-slate-900 rounded-xl font-bold text-lg text-white overflow-hidden border border-indigo-500/50 shadow-[0_0_20px_rgba(99,102,241,0.3)] transition-all hover:shadow-[0_0_30px_rgba(99,102,241,0.6)] hover:-translate-y-1 active:scale-95",children:[M.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-indigo-600 via-purple-600 to-indigo-600 opacity-0 group-hover:opacity-20 transition-opacity duration-300"}),M.jsxs("span",{className:"relative flex items-center space-x-2",children:[M.jsx("svg",{className:"w-5 h-5 transition-transform group-hover:rotate-180",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),M.jsx("span",{children:"Nuova Sessione"})]})]})]})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let FM,UM;function HM(){return{geminiUrl:FM,vertexUrl:UM}}function VM(n,e,t,i){var s,r;if(!(n!=null&&n.baseUrl)){const o=HM();return e?(s=o.vertexUrl)!==null&&s!==void 0?s:t:(r=o.geminiUrl)!==null&&r!==void 0?r:i}return n.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Bs{}function V(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(i,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const r=e[s];return r!=null?String(r):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function f(n,e,t){for(let r=0;r<e.length-1;r++){const o=e[r];if(o.endsWith("[]")){const a=o.slice(0,-2);if(!(a in n))if(Array.isArray(t))n[a]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(n[a])){const l=n[a];if(Array.isArray(t))for(let u=0;u<l.length;u++){const h=l[u];f(h,e.slice(r+1),t[u])}else for(const u of l)f(u,e.slice(r+1),t)}return}else if(o.endsWith("[0]")){const a=o.slice(0,-3);a in n||(n[a]=[{}]);const l=n[a];f(l[0],e.slice(r+1),t);return}(!n[o]||typeof n[o]!="object")&&(n[o]={}),n=n[o]}const i=e[e.length-1],s=n[i];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${i}`)}else i==="_self"&&typeof t=="object"&&t!==null&&!Array.isArray(t)?Object.assign(n,t):n[i]=t}function d(n,e,t=void 0){try{if(e.length===1&&e[0]==="_self")return n;for(let i=0;i<e.length;i++){if(typeof n!="object"||n===null)return t;const s=e[i];if(s.endsWith("[]")){const r=s.slice(0,-2);if(r in n){const o=n[r];return Array.isArray(o)?o.map(a=>d(a,e.slice(i+1),t)):t}else return t}else n=n[s]}return n}catch(i){if(i instanceof TypeError)return t;throw i}}function GM(n,e){for(const[t,i]of Object.entries(e)){const s=t.split("."),r=i.split("."),o=new Set;let a=-1;for(let l=0;l<s.length;l++)if(s[l]==="*"){a=l;break}if(a!==-1&&r.length>a)for(let l=a;l<r.length;l++){const u=r[l];u!=="*"&&!u.endsWith("[]")&&!u.endsWith("[0]")&&o.add(u)}By(n,s,r,0,o)}}function By(n,e,t,i,s){if(i>=e.length||typeof n!="object"||n===null)return;const r=e[i];if(r.endsWith("[]")){const o=r.slice(0,-2),a=n;if(o in a&&Array.isArray(a[o]))for(const l of a[o])By(l,e,t,i+1,s)}else if(r==="*"){if(typeof n=="object"&&n!==null&&!Array.isArray(n)){const o=n,a=Object.keys(o).filter(u=>!u.startsWith("_")&&!s.has(u)),l={};for(const u of a)l[u]=o[u];for(const[u,h]of Object.entries(l)){const p=[];for(const g of t.slice(i))g==="*"?p.push(u):p.push(g);f(o,p,h)}for(const u of a)delete o[u]}}else{const o=n;r in o&&By(o[r],e,t,i+1,s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function t0(n){if(typeof n!="string")throw new Error("fromImageBytes must be a string");return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function OM(n){const e={},t=d(n,["operationName"]);t!=null&&f(e,["operationName"],t);const i=d(n,["resourceName"]);return i!=null&&f(e,["_url","resourceName"],i),e}function BM(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata"]);i!=null&&f(e,["metadata"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["response","generateVideoResponse"]);return o!=null&&f(e,["response"],qM(o)),e}function zM(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata"]);i!=null&&f(e,["metadata"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["response"]);return o!=null&&f(e,["response"],$M(o)),e}function qM(n){const e={},t=d(n,["generatedSamples"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>WM(o))),f(e,["generatedVideos"],r)}const i=d(n,["raiMediaFilteredCount"]);i!=null&&f(e,["raiMediaFilteredCount"],i);const s=d(n,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function $M(n){const e={},t=d(n,["videos"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>YM(o))),f(e,["generatedVideos"],r)}const i=d(n,["raiMediaFilteredCount"]);i!=null&&f(e,["raiMediaFilteredCount"],i);const s=d(n,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function WM(n){const e={},t=d(n,["video"]);return t!=null&&f(e,["video"],jM(t)),e}function YM(n){const e={},t=d(n,["_self"]);return t!=null&&f(e,["video"],ek(t)),e}function KM(n){const e={},t=d(n,["operationName"]);return t!=null&&f(e,["_url","operationName"],t),e}function JM(n){const e={},t=d(n,["operationName"]);return t!=null&&f(e,["_url","operationName"],t),e}function XM(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata"]);i!=null&&f(e,["metadata"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["response"]);return o!=null&&f(e,["response"],QM(o)),e}function QM(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["parent"]);i!=null&&f(e,["parent"],i);const s=d(n,["documentName"]);return s!=null&&f(e,["documentName"],s),e}function IT(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata"]);i!=null&&f(e,["metadata"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["response"]);return o!=null&&f(e,["response"],ZM(o)),e}function ZM(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["parent"]);i!=null&&f(e,["parent"],i);const s=d(n,["documentName"]);return s!=null&&f(e,["documentName"],s),e}function jM(n){const e={},t=d(n,["uri"]);t!=null&&f(e,["uri"],t);const i=d(n,["encodedVideo"]);i!=null&&f(e,["videoBytes"],t0(i));const s=d(n,["encoding"]);return s!=null&&f(e,["mimeType"],s),e}function ek(n){const e={},t=d(n,["gcsUri"]);t!=null&&f(e,["uri"],t);const i=d(n,["bytesBase64Encoded"]);i!=null&&f(e,["videoBytes"],t0(i));const s=d(n,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var $_;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})($_||($_={}));var W_;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(W_||(W_={}));var Y_;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(Y_||(Y_={}));var At;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT",n.NULL="NULL"})(At||(At={}));var K_;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(K_||(K_={}));var J_;(function(n){n.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",n.SIMPLE_SEARCH="SIMPLE_SEARCH",n.ELASTIC_SEARCH="ELASTIC_SEARCH"})(J_||(J_={}));var X_;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(X_||(X_={}));var Q_;(function(n){n.HTTP_IN_UNSPECIFIED="HTTP_IN_UNSPECIFIED",n.HTTP_IN_QUERY="HTTP_IN_QUERY",n.HTTP_IN_HEADER="HTTP_IN_HEADER",n.HTTP_IN_PATH="HTTP_IN_PATH",n.HTTP_IN_BODY="HTTP_IN_BODY",n.HTTP_IN_COOKIE="HTTP_IN_COOKIE"})(Q_||(Q_={}));var Z_;(function(n){n.PHISH_BLOCK_THRESHOLD_UNSPECIFIED="PHISH_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_HIGH_AND_ABOVE="BLOCK_HIGH_AND_ABOVE",n.BLOCK_HIGHER_AND_ABOVE="BLOCK_HIGHER_AND_ABOVE",n.BLOCK_VERY_HIGH_AND_ABOVE="BLOCK_VERY_HIGH_AND_ABOVE",n.BLOCK_ONLY_EXTREMELY_HIGH="BLOCK_ONLY_EXTREMELY_HIGH"})(Z_||(Z_={}));var j_;(function(n){n.THINKING_LEVEL_UNSPECIFIED="THINKING_LEVEL_UNSPECIFIED",n.LOW="LOW",n.HIGH="HIGH"})(j_||(j_={}));var eA;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",n.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",n.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",n.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",n.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_JAILBREAK="HARM_CATEGORY_JAILBREAK"})(eA||(eA={}));var tA;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(tA||(tA={}));var nA;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(nA||(nA={}));var iA;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY",n.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL",n.IMAGE_PROHIBITED_CONTENT="IMAGE_PROHIBITED_CONTENT",n.NO_IMAGE="NO_IMAGE"})(iA||(iA={}));var sA;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(sA||(sA={}));var rA;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(rA||(rA={}));var oA;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR",n.URL_RETRIEVAL_STATUS_PAYWALL="URL_RETRIEVAL_STATUS_PAYWALL",n.URL_RETRIEVAL_STATUS_UNSAFE="URL_RETRIEVAL_STATUS_UNSAFE"})(oA||(oA={}));var aA;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.IMAGE_SAFETY="IMAGE_SAFETY",n.MODEL_ARMOR="MODEL_ARMOR",n.JAILBREAK="JAILBREAK"})(aA||(aA={}));var lA;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(lA||(lA={}));var ip;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(ip||(ip={}));var uA;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(uA||(uA={}));var cA;(function(n){n.TUNING_MODE_UNSPECIFIED="TUNING_MODE_UNSPECIFIED",n.TUNING_MODE_FULL="TUNING_MODE_FULL",n.TUNING_MODE_PEFT_ADAPTER="TUNING_MODE_PEFT_ADAPTER"})(cA||(cA={}));var dA;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(dA||(dA={}));var zy;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(zy||(zy={}));var hA;(function(n){n.TUNING_TASK_UNSPECIFIED="TUNING_TASK_UNSPECIFIED",n.TUNING_TASK_I2V="TUNING_TASK_I2V",n.TUNING_TASK_T2V="TUNING_TASK_T2V",n.TUNING_TASK_R2V="TUNING_TASK_R2V"})(hA||(hA={}));var fA;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(fA||(fA={}));var pA;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(pA||(pA={}));var gA;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(gA||(gA={}));var mA;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(mA||(mA={}));var yA;(function(n){n.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",n.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(yA||(yA={}));var vA;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE",n.VALIDATED="VALIDATED"})(vA||(vA={}));var _A;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(_A||(_A={}));var AA;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(AA||(AA={}));var EA;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi",n.zh="zh",n.pt="pt",n.es="es"})(EA||(EA={}));var SA;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(SA||(SA={}));var wA;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(wA||(wA={}));var CA;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(CA||(CA={}));var TA;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(TA||(TA={}));var xA;(function(n){n.FOREGROUND="FOREGROUND",n.BACKGROUND="BACKGROUND",n.PROMPT="PROMPT",n.SEMANTIC="SEMANTIC",n.INTERACTIVE="INTERACTIVE"})(xA||(xA={}));var IA;(function(n){n.ASSET="ASSET",n.STYLE="STYLE"})(IA||(IA={}));var PA;(function(n){n.INSERT="INSERT",n.REMOVE="REMOVE",n.REMOVE_STATIC="REMOVE_STATIC",n.OUTPAINT="OUTPAINT"})(PA||(PA={}));var RA;(function(n){n.OPTIMIZED="OPTIMIZED",n.LOSSLESS="LOSSLESS"})(RA||(RA={}));var MA;(function(n){n.SUPERVISED_FINE_TUNING="SUPERVISED_FINE_TUNING",n.PREFERENCE_TUNING="PREFERENCE_TUNING"})(MA||(MA={}));var kA;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.STATE_PENDING="STATE_PENDING",n.STATE_ACTIVE="STATE_ACTIVE",n.STATE_FAILED="STATE_FAILED"})(kA||(kA={}));var bA;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(bA||(bA={}));var NA;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(NA||(NA={}));var LA;(function(n){n.TURN_COMPLETE_REASON_UNSPECIFIED="TURN_COMPLETE_REASON_UNSPECIFIED",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.RESPONSE_REJECTED="RESPONSE_REJECTED",n.NEED_MORE_INPUT="NEED_MORE_INPUT"})(LA||(LA={}));var DA;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(DA||(DA={}));var FA;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(FA||(FA={}));var UA;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(UA||(UA={}));var HA;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(HA||(HA={}));var VA;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(VA||(VA={}));var GA;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(GA||(GA={}));var OA;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY",n.VOCALIZATION="VOCALIZATION"})(OA||(OA={}));var $a;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})($a||($a={}));class qy{constructor(e){const t={};for(const i of e.headers.entries())t[i[0]]=i[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class Du{get text(){var e,t,i,s,r,o,a,l;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",h=!1;const p=[];for(const g of(l=(a=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[m,y]of Object.entries(g))m!=="text"&&m!=="thought"&&m!=="thoughtSignature"&&(y!==null||y!==void 0)&&p.push(m);if(typeof g.text=="string"){if(typeof g.thought=="boolean"&&g.thought)continue;h=!0,u+=g.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?u:void 0}get data(){var e,t,i,s,r,o,a,l;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const h=[];for(const p of(l=(a=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)!==null&&l!==void 0?l:[]){for(const[g,m]of Object.entries(p))g!=="inlineData"&&(m!==null||m!==void 0)&&h.push(g);p.inlineData&&typeof p.inlineData.data=="string"&&(u+=atob(p.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,t,i,s,r,o,a,l;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(a=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,t,i,s,r,o,a,l,u;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(l=(a=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return(u=h==null?void 0:h[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,t,i,s,r,o,a,l,u;if(((s=(i=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||i===void 0?void 0:i.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(l=(a=(o=(r=this.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content)===null||a===void 0?void 0:a.parts)===null||l===void 0?void 0:l.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if((h==null?void 0:h.length)!==0)return(u=h==null?void 0:h[0])===null||u===void 0?void 0:u.output}}class BA{}class zA{}class tk{}class nk{}class ik{}class sk{}class qA{}class $A{}class WA{}class rk{}class sp{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new sp;let s;const r=e;return t?s=zM(r):s=BM(r),Object.assign(i,s),i}}class YA{}class KA{}class JA{}class ok{}class ak{}class lk{}class n0{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new n0,r=XM(e);return Object.assign(i,r),i}}class uk{}class ck{}class dk{}class XA{}class hk{get text(){var e,t,i;let s="",r=!1;const o=[];for(const a of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[l,u]of Object.entries(a))l!=="text"&&l!=="thought"&&u!==null&&o.push(l);if(typeof a.text=="string"){if(typeof a.thought=="boolean"&&a.thought)continue;r=!0,s+=a.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),r?s:void 0}get data(){var e,t,i;let s="";const r=[];for(const o of(i=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&i!==void 0?i:[]){for(const[a,l]of Object.entries(o))a!=="inlineData"&&l!==null&&r.push(a);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return r.length>0&&console.warn(`there are non-data parts ${r} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class fk{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}class i0{_fromAPIResponse({apiResponse:e,_isVertexAI:t}){const i=new i0,r=IT(e);return Object.assign(i,r),i}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pe(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(e.includes("..")||e.includes("?")||e.includes("&"))throw new Error("invalid model parameter");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function PT(n,e){const t=pe(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function RT(n){return Array.isArray(n)?n.map(e=>rp(e)):[rp(n)]}function rp(n){if(typeof n=="object"&&n!==null)return n;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof n}`)}function MT(n){const e=rp(n);if(e.mimeType&&e.mimeType.startsWith("image/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function kT(n){const e=rp(n);if(e.mimeType&&e.mimeType.startsWith("audio/"))return e;throw new Error(`Unsupported mime type: ${e.mimeType}`)}function QA(n){if(n==null)throw new Error("PartUnion is required");if(typeof n=="object")return n;if(typeof n=="string")return{text:n};throw new Error(`Unsupported part type: ${typeof n}`)}function bT(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("PartListUnion is required");return Array.isArray(n)?n.map(e=>QA(e)):[QA(n)]}function $y(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function ZA(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function jA(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Ft(n){if(n==null)throw new Error("ContentUnion is required");return $y(n)?n:{role:"user",parts:bT(n)}}function s0(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const i=Ft(t);return i.parts&&i.parts.length>0&&i.parts[0].text!==void 0?[i.parts[0].text]:[]});if(n.isVertexAI()){const t=Ft(e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Ft(t)):[Ft(e)]}function Kn(n){if(n==null||Array.isArray(n)&&n.length===0)throw new Error("contents are required");if(!Array.isArray(n)){if(ZA(n)||jA(n))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Ft(n)]}const e=[],t=[],i=$y(n[0]);for(const s of n){const r=$y(s);if(r!=i)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(r)e.push(s);else{if(ZA(s)||jA(s))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");t.push(s)}}return i||e.push({role:"user",parts:bT(t)}),e}function pk(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(i=>i!=="null");if(t.length===1)e.type=Object.values(At).includes(t[0].toUpperCase())?t[0].toUpperCase():At.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const i of t)e.anyOf.push({type:Object.values(At).includes(i.toUpperCase())?i.toUpperCase():At.TYPE_UNSPECIFIED})}}function nl(n){const e={},t=["items"],i=["anyOf"],s=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const r=n.anyOf;r!=null&&r.length==2&&(r[0].type==="null"?(e.nullable=!0,n=r[1]):r[1].type==="null"&&(e.nullable=!0,n=r[0])),n.type instanceof Array&&pk(n.type,e);for(const[o,a]of Object.entries(n))if(a!=null)if(o=="type"){if(a==="null")throw new Error("type: null can not be the only possible type for the field.");if(a instanceof Array)continue;e.type=Object.values(At).includes(a.toUpperCase())?a.toUpperCase():At.TYPE_UNSPECIFIED}else if(t.includes(o))e[o]=nl(a);else if(i.includes(o)){const l=[];for(const u of a){if(u.type=="null"){e.nullable=!0;continue}l.push(nl(u))}e[o]=l}else if(s.includes(o)){const l={};for(const[u,h]of Object.entries(a))l[u]=nl(h);e[o]=l}else{if(o==="additionalProperties")continue;e[o]=a}return e}function r0(n){return nl(n)}function o0(n){if(typeof n=="object")return n;if(typeof n=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:n}}};throw new Error(`Unsupported speechConfig type: ${typeof n}`)}function a0(n){if("multiSpeakerVoiceConfig"in n)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return n}function Au(n){if(n.functionDeclarations)for(const e of n.functionDeclarations)e.parameters&&(Object.keys(e.parameters).includes("$schema")?e.parametersJsonSchema||(e.parametersJsonSchema=e.parameters,delete e.parameters):e.parameters=nl(e.parameters)),e.response&&(Object.keys(e.response).includes("$schema")?e.responseJsonSchema||(e.responseJsonSchema=e.response,delete e.response):e.response=nl(e.response));return n}function Eu(n){if(n==null)throw new Error("tools is required");if(!Array.isArray(n))throw new Error("tools is required and must be an array of Tools");const e=[];for(const t of n)e.push(t);return e}function gk(n,e,t,i=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===i;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:s?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function zs(n,e){if(typeof e!="string")throw new Error("name must be a string");return gk(n,e,"cachedContents")}function NT(n){switch(n){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return n}}function Yr(n){return t0(n)}function mk(n){return n!=null&&typeof n=="object"&&"name"in n}function yk(n){return n!=null&&typeof n=="object"&&"video"in n}function vk(n){return n!=null&&typeof n=="object"&&"uri"in n}function LT(n){var e;let t;if(mk(n)&&(t=n.name),!(vk(n)&&(t=n.uri,t===void 0))&&!(yk(n)&&(t=(e=n.video)===null||e===void 0?void 0:e.uri,t===void 0))){if(typeof n=="string"&&(t=n),t===void 0)throw new Error("Could not extract file name from the provided input.");if(t.startsWith("https://")){const s=t.split("files/")[1].match(/[a-z0-9]+/);if(s===null)throw new Error(`Could not extract file name from URI ${t}`);t=s[0]}else t.startsWith("files/")&&(t=t.split("files/")[1]);return t}}function DT(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function FT(n){for(const e of["models","tunedModels","publisherModels"])if(_k(n,e))return n[e];return[]}function _k(n,e){return n!==null&&typeof n=="object"&&e in n}function Ak(n,e={}){const t=n,i={name:t.name,description:t.description,parametersJsonSchema:t.inputSchema};return t.outputSchema&&(i.responseJsonSchema=t.outputSchema),e.behavior&&(i.behavior=e.behavior),{functionDeclarations:[i]}}function Ek(n,e={}){const t=[],i=new Set;for(const s of n){const r=s.name;if(i.has(r))throw new Error(`Duplicate function name ${r} found in MCP tools. Please ensure function names are unique.`);i.add(r);const o=Ak(s,e);o.functionDeclarations&&t.push(...o.functionDeclarations)}return{functionDeclarations:t}}function UT(n,e){let t;if(typeof e=="string")if(n.isVertexAI())if(e.startsWith("gs://"))t={format:"jsonl",gcsUri:[e]};else if(e.startsWith("bq://"))t={format:"bigquery",bigqueryUri:e};else throw new Error(`Unsupported string source for Vertex AI: ${e}`);else if(e.startsWith("files/"))t={fileName:e};else throw new Error(`Unsupported string source for Gemini API: ${e}`);else if(Array.isArray(e)){if(n.isVertexAI())throw new Error("InlinedRequest[] is not supported in Vertex AI.");t={inlinedRequests:e}}else t=e;const i=[t.gcsUri,t.bigqueryUri].filter(Boolean).length,s=[t.inlinedRequests,t.fileName].filter(Boolean).length;if(n.isVertexAI()){if(s>0||i!==1)throw new Error("Exactly one of `gcsUri` or `bigqueryUri` must be set for Vertex AI.")}else if(i>0||s!==1)throw new Error("Exactly one of `inlinedRequests`, `fileName`, must be set for Gemini API.");return t}function Sk(n){if(typeof n!="string")return n;const e=n;if(e.startsWith("gs://"))return{format:"jsonl",gcsUri:e};if(e.startsWith("bq://"))return{format:"bigquery",bigqueryUri:e};throw new Error(`Unsupported destination: ${e}`)}function HT(n){if(typeof n!="object"||n===null)return{};const e=n,t=e.inlinedResponses;if(typeof t!="object"||t===null)return n;const s=t.inlinedResponses;if(!Array.isArray(s)||s.length===0)return n;let r=!1;for(const o of s){if(typeof o!="object"||o===null)continue;const l=o.response;if(typeof l!="object"||l===null)continue;if(l.embedding!==void 0){r=!0;break}}return r&&(e.inlinedEmbedContentResponses=e.inlinedResponses,delete e.inlinedResponses),n}function Su(n,e){const t=e;if(!n.isVertexAI()){if(/batches\/[^/]+$/.test(t))return t.split("/").pop();throw new Error(`Invalid batch job name: ${t}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(t))return t.split("/").pop();if(/^\d+$/.test(t))return t;throw new Error(`Invalid batch job name: ${t}.`)}function VT(n){const e=n;return e==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":e==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":e==="BATCH_STATE_RUNNING"?"JOB_STATE_RUNNING":e==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":e==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":e==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":e==="BATCH_STATE_EXPIRED"?"JOB_STATE_EXPIRED":e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wk(n){const e={},t=d(n,["responsesFile"]);t!=null&&f(e,["fileName"],t);const i=d(n,["inlinedResponses","inlinedResponses"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>i1(o))),f(e,["inlinedResponses"],r)}const s=d(n,["inlinedEmbedContentResponses","inlinedResponses"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["inlinedEmbedContentResponses"],r)}return e}function Ck(n){const e={},t=d(n,["predictionsFormat"]);t!=null&&f(e,["format"],t);const i=d(n,["gcsDestination","outputUriPrefix"]);i!=null&&f(e,["gcsUri"],i);const s=d(n,["bigqueryDestination","outputUri"]);return s!=null&&f(e,["bigqueryUri"],s),e}function Tk(n){const e={},t=d(n,["format"]);t!=null&&f(e,["predictionsFormat"],t);const i=d(n,["gcsUri"]);i!=null&&f(e,["gcsDestination","outputUriPrefix"],i);const s=d(n,["bigqueryUri"]);if(s!=null&&f(e,["bigqueryDestination","outputUri"],s),d(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(n,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");if(d(n,["inlinedEmbedContentResponses"])!==void 0)throw new Error("inlinedEmbedContentResponses parameter is not supported in Vertex AI.");return e}function wf(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata","displayName"]);i!=null&&f(e,["displayName"],i);const s=d(n,["metadata","state"]);s!=null&&f(e,["state"],VT(s));const r=d(n,["metadata","createTime"]);r!=null&&f(e,["createTime"],r);const o=d(n,["metadata","endTime"]);o!=null&&f(e,["endTime"],o);const a=d(n,["metadata","updateTime"]);a!=null&&f(e,["updateTime"],a);const l=d(n,["metadata","model"]);l!=null&&f(e,["model"],l);const u=d(n,["metadata","output"]);return u!=null&&f(e,["dest"],wk(HT(u))),e}function Wy(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["displayName"]);i!=null&&f(e,["displayName"],i);const s=d(n,["state"]);s!=null&&f(e,["state"],VT(s));const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["createTime"]);o!=null&&f(e,["createTime"],o);const a=d(n,["startTime"]);a!=null&&f(e,["startTime"],a);const l=d(n,["endTime"]);l!=null&&f(e,["endTime"],l);const u=d(n,["updateTime"]);u!=null&&f(e,["updateTime"],u);const h=d(n,["model"]);h!=null&&f(e,["model"],h);const p=d(n,["inputConfig"]);p!=null&&f(e,["src"],xk(p));const g=d(n,["outputConfig"]);g!=null&&f(e,["dest"],Ck(HT(g)));const m=d(n,["completionStats"]);return m!=null&&f(e,["completionStats"],m),e}function xk(n){const e={},t=d(n,["instancesFormat"]);t!=null&&f(e,["format"],t);const i=d(n,["gcsSource","uris"]);i!=null&&f(e,["gcsUri"],i);const s=d(n,["bigquerySource","inputUri"]);return s!=null&&f(e,["bigqueryUri"],s),e}function Ik(n,e){const t={};if(d(e,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(d(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(e,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const i=d(e,["fileName"]);i!=null&&f(t,["fileName"],i);const s=d(e,["inlinedRequests"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>n1(n,o))),f(t,["requests","requests"],r)}return t}function Pk(n){const e={},t=d(n,["format"]);t!=null&&f(e,["instancesFormat"],t);const i=d(n,["gcsUri"]);i!=null&&f(e,["gcsSource","uris"],i);const s=d(n,["bigqueryUri"]);if(s!=null&&f(e,["bigquerySource","inputUri"],s),d(n,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(d(n,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return e}function Rk(n){const e={},t=d(n,["data"]);if(t!=null&&f(e,["data"],t),d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function Mk(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Su(n,i)),t}function kk(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Su(n,i)),t}function bk(n){const e={},t=d(n,["content"]);t!=null&&f(e,["content"],t);const i=d(n,["citationMetadata"]);i!=null&&f(e,["citationMetadata"],Nk(i));const s=d(n,["tokenCount"]);s!=null&&f(e,["tokenCount"],s);const r=d(n,["finishReason"]);r!=null&&f(e,["finishReason"],r);const o=d(n,["avgLogprobs"]);o!=null&&f(e,["avgLogprobs"],o);const a=d(n,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const l=d(n,["index"]);l!=null&&f(e,["index"],l);const u=d(n,["logprobsResult"]);u!=null&&f(e,["logprobsResult"],u);const h=d(n,["safetyRatings"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(m=>m)),f(e,["safetyRatings"],g)}const p=d(n,["urlContextMetadata"]);return p!=null&&f(e,["urlContextMetadata"],p),e}function Nk(n){const e={},t=d(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),f(e,["citations"],i)}return e}function GT(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>c1(r))),f(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&f(e,["role"],i),e}function Lk(n,e){const t={},i=d(n,["displayName"]);if(e!==void 0&&i!=null&&f(e,["batch","displayName"],i),d(n,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return t}function Dk(n,e){const t={},i=d(n,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const s=d(n,["dest"]);return e!==void 0&&s!=null&&f(e,["outputConfig"],Tk(Sk(s))),t}function eE(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["src"]);s!=null&&f(t,["batch","inputConfig"],Ik(n,UT(n,s)));const r=d(e,["config"]);return r!=null&&Lk(r,t),t}function Fk(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["model"],pe(n,i));const s=d(e,["src"]);s!=null&&f(t,["inputConfig"],Pk(UT(n,s)));const r=d(e,["config"]);return r!=null&&Dk(r,t),t}function Uk(n,e){const t={},i=d(n,["displayName"]);return e!==void 0&&i!=null&&f(e,["batch","displayName"],i),t}function Hk(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["src"]);s!=null&&f(t,["batch","inputConfig"],$k(n,s));const r=d(e,["config"]);return r!=null&&Uk(r,t),t}function Vk(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Su(n,i)),t}function Gk(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Su(n,i)),t}function Ok(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["name"]);i!=null&&f(e,["name"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);return r!=null&&f(e,["error"],r),e}function Bk(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["name"]);i!=null&&f(e,["name"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);return r!=null&&f(e,["error"],r),e}function zk(n,e){const t={},i=d(e,["contents"]);if(i!=null){let r=s0(n,i);Array.isArray(r)&&(r=r.map(o=>o)),f(t,["requests[]","request","content"],r)}const s=d(e,["config"]);return s!=null&&(f(t,["_self"],qk(s,t)),GM(t,{"requests[].*":"requests[].request.*"})),t}function qk(n,e){const t={},i=d(n,["taskType"]);e!==void 0&&i!=null&&f(e,["requests[]","taskType"],i);const s=d(n,["title"]);e!==void 0&&s!=null&&f(e,["requests[]","title"],s);const r=d(n,["outputDimensionality"]);if(e!==void 0&&r!=null&&f(e,["requests[]","outputDimensionality"],r),d(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function $k(n,e){const t={},i=d(e,["fileName"]);i!=null&&f(t,["file_name"],i);const s=d(e,["inlinedRequests"]);return s!=null&&f(t,["requests"],zk(n,s)),t}function Wk(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function Yk(n){const e={},t=d(n,["id"]);t!=null&&f(e,["id"],t);const i=d(n,["args"]);i!=null&&f(e,["args"],i);const s=d(n,["name"]);if(s!=null&&f(e,["name"],s),d(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function Kk(n){const e={},t=d(n,["mode"]);t!=null&&f(e,["mode"],t);const i=d(n,["allowedFunctionNames"]);if(i!=null&&f(e,["allowedFunctionNames"],i),d(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function Jk(n,e,t){const i={},s=d(e,["systemInstruction"]);t!==void 0&&s!=null&&f(t,["systemInstruction"],GT(Ft(s)));const r=d(e,["temperature"]);r!=null&&f(i,["temperature"],r);const o=d(e,["topP"]);o!=null&&f(i,["topP"],o);const a=d(e,["topK"]);a!=null&&f(i,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&f(i,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&f(i,["maxOutputTokens"],u);const h=d(e,["stopSequences"]);h!=null&&f(i,["stopSequences"],h);const p=d(e,["responseLogprobs"]);p!=null&&f(i,["responseLogprobs"],p);const g=d(e,["logprobs"]);g!=null&&f(i,["logprobs"],g);const m=d(e,["presencePenalty"]);m!=null&&f(i,["presencePenalty"],m);const y=d(e,["frequencyPenalty"]);y!=null&&f(i,["frequencyPenalty"],y);const A=d(e,["seed"]);A!=null&&f(i,["seed"],A);const T=d(e,["responseMimeType"]);T!=null&&f(i,["responseMimeType"],T);const v=d(e,["responseSchema"]);v!=null&&f(i,["responseSchema"],r0(v));const E=d(e,["responseJsonSchema"]);if(E!=null&&f(i,["responseJsonSchema"],E),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const w=d(e,["safetySettings"]);if(t!==void 0&&w!=null){let Y=w;Array.isArray(Y)&&(Y=Y.map(ie=>d1(ie))),f(t,["safetySettings"],Y)}const x=d(e,["tools"]);if(t!==void 0&&x!=null){let Y=Eu(x);Array.isArray(Y)&&(Y=Y.map(ie=>f1(Au(ie)))),f(t,["tools"],Y)}const I=d(e,["toolConfig"]);if(t!==void 0&&I!=null&&f(t,["toolConfig"],h1(I)),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const P=d(e,["cachedContent"]);t!==void 0&&P!=null&&f(t,["cachedContent"],zs(n,P));const R=d(e,["responseModalities"]);R!=null&&f(i,["responseModalities"],R);const k=d(e,["mediaResolution"]);k!=null&&f(i,["mediaResolution"],k);const b=d(e,["speechConfig"]);if(b!=null&&f(i,["speechConfig"],o0(b)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=d(e,["thinkingConfig"]);N!=null&&f(i,["thinkingConfig"],N);const D=d(e,["imageConfig"]);return D!=null&&f(i,["imageConfig"],t1(D)),i}function Xk(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["candidates"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>bk(u))),f(e,["candidates"],l)}const s=d(n,["modelVersion"]);s!=null&&f(e,["modelVersion"],s);const r=d(n,["promptFeedback"]);r!=null&&f(e,["promptFeedback"],r);const o=d(n,["responseId"]);o!=null&&f(e,["responseId"],o);const a=d(n,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function Qk(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Su(n,i)),t}function Zk(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],Su(n,i)),t}function jk(n){const e={};if(d(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=d(n,["enableWidget"]);return t!=null&&f(e,["enableWidget"],t),e}function e1(n){const e={};if(d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=d(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],t),e}function t1(n){const e={},t=d(n,["aspectRatio"]);t!=null&&f(e,["aspectRatio"],t);const i=d(n,["imageSize"]);if(i!=null&&f(e,["imageSize"],i),d(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(d(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function n1(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["request","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let a=Kn(s);Array.isArray(a)&&(a=a.map(l=>GT(l))),f(t,["request","contents"],a)}const r=d(e,["metadata"]);r!=null&&f(t,["metadata"],r);const o=d(e,["config"]);return o!=null&&f(t,["request","generationConfig"],Jk(n,o,d(t,["request"],{}))),t}function i1(n){const e={},t=d(n,["response"]);t!=null&&f(e,["response"],Xk(t));const i=d(n,["error"]);return i!=null&&f(e,["error"],i),e}function s1(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);if(e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),d(n,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return t}function r1(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);e!==void 0&&s!=null&&f(e,["_query","pageToken"],s);const r=d(n,["filter"]);return e!==void 0&&r!=null&&f(e,["_query","filter"],r),t}function o1(n){const e={},t=d(n,["config"]);return t!=null&&s1(t,e),e}function a1(n){const e={},t=d(n,["config"]);return t!=null&&r1(t,e),e}function l1(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["operations"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>wf(o))),f(e,["batchJobs"],r)}return e}function u1(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["batchPredictionJobs"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>Wy(o))),f(e,["batchJobs"],r)}return e}function c1(n){const e={},t=d(n,["mediaResolution"]);t!=null&&f(e,["mediaResolution"],t);const i=d(n,["codeExecutionResult"]);i!=null&&f(e,["codeExecutionResult"],i);const s=d(n,["executableCode"]);s!=null&&f(e,["executableCode"],s);const r=d(n,["fileData"]);r!=null&&f(e,["fileData"],Wk(r));const o=d(n,["functionCall"]);o!=null&&f(e,["functionCall"],Yk(o));const a=d(n,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(n,["inlineData"]);l!=null&&f(e,["inlineData"],Rk(l));const u=d(n,["text"]);u!=null&&f(e,["text"],u);const h=d(n,["thought"]);h!=null&&f(e,["thought"],h);const p=d(n,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const g=d(n,["videoMetadata"]);return g!=null&&f(e,["videoMetadata"],g),e}function d1(n){const e={},t=d(n,["category"]);if(t!=null&&f(e,["category"],t),d(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=d(n,["threshold"]);return i!=null&&f(e,["threshold"],i),e}function h1(n){const e={},t=d(n,["functionCallingConfig"]);t!=null&&f(e,["functionCallingConfig"],Kk(t));const i=d(n,["retrievalConfig"]);return i!=null&&f(e,["retrievalConfig"],i),e}function f1(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=d(n,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=d(n,["computerUse"]);s!=null&&f(e,["computerUse"],s);const r=d(n,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const o=d(n,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(n,["googleMaps"]);a!=null&&f(e,["googleMaps"],jk(a));const l=d(n,["googleSearch"]);l!=null&&f(e,["googleSearch"],e1(l));const u=d(n,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Hs;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents",n.PAGED_ITEM_FILE_SEARCH_STORES="fileSearchStores",n.PAGED_ITEM_DOCUMENTS="documents"})(Hs||(Hs={}));class wa{constructor(e,t,i,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,i,s)}init(e,t,i){var s,r;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.sdkHttpResponseInternal=t==null?void 0:t.sdkHttpResponse,this.idxInternal=0;let o={config:{}};!i||Object.keys(i).length===0?o={config:{}}:typeof i=="object"?o=Object.assign({},i):o=i,o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(r=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&r!==void 0?r:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class p1 extends Bs{constructor(e){super(),this.apiClient=e,this.create=async t=>(this.apiClient.isVertexAI()&&(t.config=this.formatDestination(t.src,t.config)),this.createInternal(t)),this.createEmbeddings=async t=>{if(console.warn("batches.createEmbeddings() is experimental and may change without notice."),this.apiClient.isVertexAI())throw new Error("Vertex AI does not support batches.createEmbeddings.");return this.createEmbeddingsInternal(t)},this.list=async(t={})=>new wa(Hs.PAGED_ITEM_BATCH_JOBS,i=>this.listInternal(i),await this.listInternal(t),t)}createInlinedGenerateContentRequest(e){const t=eE(this.apiClient,e),i=t._url,s=V("{model}:batchGenerateContent",i),a=t.batch.inputConfig.requests,l=a.requests,u=[];for(const h of l){const p=Object.assign({},h);if(p.systemInstruction){const g=p.systemInstruction;delete p.systemInstruction;const m=p.request;m.systemInstruction=g,p.request=m}u.push(p)}return a.requests=u,delete t.config,delete t._url,delete t._query,{path:s,body:t}}getGcsUri(e){if(typeof e=="string")return e.startsWith("gs://")?e:void 0;if(!Array.isArray(e)&&e.gcsUri&&e.gcsUri.length>0)return e.gcsUri[0]}getBigqueryUri(e){if(typeof e=="string")return e.startsWith("bq://")?e:void 0;if(!Array.isArray(e))return e.bigqueryUri}formatDestination(e,t){const i=t?Object.assign({},t):{},s=Date.now().toString();if(i.displayName||(i.displayName=`genaiBatchJob_${s}`),i.dest===void 0){const r=this.getGcsUri(e),o=this.getBigqueryUri(e);if(r)r.endsWith(".jsonl")?i.dest=`${r.slice(0,-6)}/dest`:i.dest=`${r}_dest_${s}`;else if(o)i.dest=`${o}_dest_${s}`;else throw new Error("Unsupported source for Vertex AI: No GCS or BigQuery URI found.")}return i}async createInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Fk(this.apiClient,e);return a=V("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>Wy(h))}else{const u=eE(this.apiClient,e);return a=V("{model}:batchGenerateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>wf(h))}}async createEmbeddingsInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Hk(this.apiClient,e);return r=V("{model}:asyncBatchEmbedContent",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>wf(l))}}async get(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Zk(this.apiClient,e);return a=V("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>Wy(h))}else{const u=Qk(this.apiClient,e);return a=V("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>wf(h))}}async cancel(e){var t,i,s,r;let o="",a={};if(this.apiClient.isVertexAI()){const l=kk(this.apiClient,e);o=V("batchPredictionJobs/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const l=Mk(this.apiClient,e);o=V("batches/{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async listInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=a1(e);return a=V("batchPredictionJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=u1(h),g=new XA;return Object.assign(g,p),g})}else{const u=o1(e);return a=V("batches",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=l1(h),g=new XA;return Object.assign(g,p),g})}}async delete(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Gk(this.apiClient,e);return a=V("batchPredictionJobs/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>Bk(h))}else{const u=Vk(this.apiClient,e);return a=V("batches/{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>Ok(h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function g1(n){const e={},t=d(n,["data"]);if(t!=null&&f(e,["data"],t),d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function tE(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>H1(r))),f(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&f(e,["role"],i),e}function m1(n,e){const t={},i=d(n,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const s=d(n,["expireTime"]);e!==void 0&&s!=null&&f(e,["expireTime"],s);const r=d(n,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const o=d(n,["contents"]);if(e!==void 0&&o!=null){let h=Kn(o);Array.isArray(h)&&(h=h.map(p=>tE(p))),f(e,["contents"],h)}const a=d(n,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],tE(Ft(a)));const l=d(n,["tools"]);if(e!==void 0&&l!=null){let h=l;Array.isArray(h)&&(h=h.map(p=>G1(p))),f(e,["tools"],h)}const u=d(n,["toolConfig"]);if(e!==void 0&&u!=null&&f(e,["toolConfig"],V1(u)),d(n,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return t}function y1(n,e){const t={},i=d(n,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const s=d(n,["expireTime"]);e!==void 0&&s!=null&&f(e,["expireTime"],s);const r=d(n,["displayName"]);e!==void 0&&r!=null&&f(e,["displayName"],r);const o=d(n,["contents"]);if(e!==void 0&&o!=null){let p=Kn(o);Array.isArray(p)&&(p=p.map(g=>g)),f(e,["contents"],p)}const a=d(n,["systemInstruction"]);e!==void 0&&a!=null&&f(e,["systemInstruction"],Ft(a));const l=d(n,["tools"]);if(e!==void 0&&l!=null){let p=l;Array.isArray(p)&&(p=p.map(g=>O1(g))),f(e,["tools"],p)}const u=d(n,["toolConfig"]);e!==void 0&&u!=null&&f(e,["toolConfig"],u);const h=d(n,["kmsKeyName"]);return e!==void 0&&h!=null&&f(e,["encryption_spec","kmsKeyName"],h),t}function v1(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["model"],PT(n,i));const s=d(e,["config"]);return s!=null&&m1(s,t),t}function _1(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["model"],PT(n,i));const s=d(e,["config"]);return s!=null&&y1(s,t),t}function A1(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],zs(n,i)),t}function E1(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],zs(n,i)),t}function S1(n){const e={},t=d(n,["sdkHttpResponse"]);return t!=null&&f(e,["sdkHttpResponse"],t),e}function w1(n){const e={},t=d(n,["sdkHttpResponse"]);return t!=null&&f(e,["sdkHttpResponse"],t),e}function C1(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function T1(n){const e={},t=d(n,["id"]);t!=null&&f(e,["id"],t);const i=d(n,["args"]);i!=null&&f(e,["args"],i);const s=d(n,["name"]);if(s!=null&&f(e,["name"],s),d(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function x1(n){const e={},t=d(n,["mode"]);t!=null&&f(e,["mode"],t);const i=d(n,["allowedFunctionNames"]);if(i!=null&&f(e,["allowedFunctionNames"],i),d(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function I1(n){const e={};if(d(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=d(n,["description"]);t!=null&&f(e,["description"],t);const i=d(n,["name"]);i!=null&&f(e,["name"],i);const s=d(n,["parameters"]);s!=null&&f(e,["parameters"],s);const r=d(n,["parametersJsonSchema"]);r!=null&&f(e,["parametersJsonSchema"],r);const o=d(n,["response"]);o!=null&&f(e,["response"],o);const a=d(n,["responseJsonSchema"]);return a!=null&&f(e,["responseJsonSchema"],a),e}function P1(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],zs(n,i)),t}function R1(n,e){const t={},i=d(e,["name"]);return i!=null&&f(t,["_url","name"],zs(n,i)),t}function M1(n){const e={};if(d(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=d(n,["enableWidget"]);return t!=null&&f(e,["enableWidget"],t),e}function k1(n){const e={};if(d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=d(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],t),e}function b1(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),t}function N1(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),t}function L1(n){const e={},t=d(n,["config"]);return t!=null&&b1(t,e),e}function D1(n){const e={},t=d(n,["config"]);return t!=null&&N1(t,e),e}function F1(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["cachedContents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["cachedContents"],r)}return e}function U1(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["cachedContents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["cachedContents"],r)}return e}function H1(n){const e={},t=d(n,["mediaResolution"]);t!=null&&f(e,["mediaResolution"],t);const i=d(n,["codeExecutionResult"]);i!=null&&f(e,["codeExecutionResult"],i);const s=d(n,["executableCode"]);s!=null&&f(e,["executableCode"],s);const r=d(n,["fileData"]);r!=null&&f(e,["fileData"],C1(r));const o=d(n,["functionCall"]);o!=null&&f(e,["functionCall"],T1(o));const a=d(n,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(n,["inlineData"]);l!=null&&f(e,["inlineData"],g1(l));const u=d(n,["text"]);u!=null&&f(e,["text"],u);const h=d(n,["thought"]);h!=null&&f(e,["thought"],h);const p=d(n,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const g=d(n,["videoMetadata"]);return g!=null&&f(e,["videoMetadata"],g),e}function V1(n){const e={},t=d(n,["functionCallingConfig"]);t!=null&&f(e,["functionCallingConfig"],x1(t));const i=d(n,["retrievalConfig"]);return i!=null&&f(e,["retrievalConfig"],i),e}function G1(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=d(n,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=d(n,["computerUse"]);s!=null&&f(e,["computerUse"],s);const r=d(n,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const o=d(n,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(n,["googleMaps"]);a!=null&&f(e,["googleMaps"],M1(a));const l=d(n,["googleSearch"]);l!=null&&f(e,["googleSearch"],k1(l));const u=d(n,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function O1(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let p=t;Array.isArray(p)&&(p=p.map(g=>I1(g))),f(e,["functionDeclarations"],p)}const i=d(n,["retrieval"]);i!=null&&f(e,["retrieval"],i);const s=d(n,["googleSearchRetrieval"]);s!=null&&f(e,["googleSearchRetrieval"],s);const r=d(n,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),d(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=d(n,["codeExecution"]);o!=null&&f(e,["codeExecution"],o);const a=d(n,["enterpriseWebSearch"]);a!=null&&f(e,["enterpriseWebSearch"],a);const l=d(n,["googleMaps"]);l!=null&&f(e,["googleMaps"],l);const u=d(n,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const h=d(n,["urlContext"]);return h!=null&&f(e,["urlContext"],h),e}function B1(n,e){const t={},i=d(n,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const s=d(n,["expireTime"]);return e!==void 0&&s!=null&&f(e,["expireTime"],s),t}function z1(n,e){const t={},i=d(n,["ttl"]);e!==void 0&&i!=null&&f(e,["ttl"],i);const s=d(n,["expireTime"]);return e!==void 0&&s!=null&&f(e,["expireTime"],s),t}function q1(n,e){const t={},i=d(e,["name"]);i!=null&&f(t,["_url","name"],zs(n,i));const s=d(e,["config"]);return s!=null&&B1(s,t),t}function $1(n,e){const t={},i=d(e,["name"]);i!=null&&f(t,["_url","name"],zs(n,i));const s=d(e,["config"]);return s!=null&&z1(s,t),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class W1 extends Bs{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new wa(Hs.PAGED_ITEM_CACHED_CONTENTS,i=>this.listInternal(i),await this.listInternal(t),t)}async create(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=_1(this.apiClient,e);return a=V("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>h)}else{const u=v1(this.apiClient,e);return a=V("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>h)}}async get(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=R1(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>h)}else{const u=P1(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>h)}}async delete(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=E1(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=w1(h),g=new KA;return Object.assign(g,p),g})}else{const u=A1(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=S1(h),g=new KA;return Object.assign(g,p),g})}}async update(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=$1(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>h)}else{const u=q1(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>h)}}async listInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=D1(e);return a=V("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=U1(h),g=new JA;return Object.assign(g,p),g})}else{const u=L1(e);return a=V("cachedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=F1(h),g=new JA;return Object.assign(g,p),g})}}}function nE(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],i=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&i>=n.length&&(n=void 0),{value:n&&n[i++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ie(n){return this instanceof Ie?(this.v=n,this):new Ie(n)}function il(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=t.apply(n,e||[]),s,r=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),a("next"),a("throw"),a("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(m){return function(y){return Promise.resolve(y).then(m,p)}}function a(m,y){i[m]&&(s[m]=function(A){return new Promise(function(T,v){r.push([m,A,T,v])>1||l(m,A)})},y&&(s[m]=y(s[m])))}function l(m,y){try{u(i[m](y))}catch(A){g(r[0][3],A)}}function u(m){m.value instanceof Ie?Promise.resolve(m.value.v).then(h,p):g(r[0][2],m)}function h(m){l("next",m)}function p(m){l("throw",m)}function g(m,y){m(y),r.shift(),r.length&&l(r[0][0],r[0][1])}}function hc(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof nE=="function"?nE(n):n[Symbol.iterator](),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(r){t[r]=n[r]&&function(o){return new Promise(function(a,l){o=n[r](o),s(a,l,o.done,o.value)})}}function s(r,o,a,l){Promise.resolve(l).then(function(u){r({value:u,done:a})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Y1(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:OT(t)}function OT(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0)return!1;return!0}function K1(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function iE(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let i=0;for(;i<t;)if(n[i].role==="user")e.push(n[i]),i++;else{const s=[];let r=!0;for(;i<t&&n[i].role==="model";)s.push(n[i]),r&&!OT(n[i])&&(r=!1),i++;r?e.push(...s):e.pop()}return e}class J1{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new X1(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class X1{constructor(e,t,i,s={},r=[]){this.apiClient=e,this.modelsModule=t,this.model=i,this.config=s,this.history=r,this.sendPromise=Promise.resolve(),K1(r)}async sendMessage(e){var t;await this.sendPromise;const i=Ft(e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var r,o,a;const l=await s,u=(o=(r=l.candidates)===null||r===void 0?void 0:r[0])===null||o===void 0?void 0:o.content,h=l.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let g=[];h!=null&&(g=(a=h.slice(p))!==null&&a!==void 0?a:[]);const m=u?[u]:[];this.recordHistory(i,m,g)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),s}async sendMessageStream(e){var t;await this.sendPromise;const i=Ft(e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(i),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const r=await s;return this.processStreamResponse(r,i)}getHistory(e=!1){const t=e?iE(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var i,s;return il(this,arguments,function*(){var o,a,l,u;const h=[];try{for(var p=!0,g=hc(e),m;m=yield Ie(g.next()),o=m.done,!o;p=!0){u=m.value,p=!1;const y=u;if(Y1(y)){const A=(s=(i=y.candidates)===null||i===void 0?void 0:i[0])===null||s===void 0?void 0:s.content;A!==void 0&&h.push(A)}yield yield Ie(y)}}catch(y){a={error:y}}finally{try{!p&&!o&&(l=g.return)&&(yield Ie(l.call(g)))}finally{if(a)throw a.error}}this.recordHistory(t,h)})}recordHistory(e,t,i){let s=[];t.length>0&&t.every(r=>r.role!==void 0)?s=t:s.push({role:"model",parts:[]}),i&&i.length>0?this.history.push(...iE(i)):this.history.push(e),this.history.push(...s)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Xp extends Error{constructor(e){super(e.message),this.name="ApiError",this.status=e.status,Object.setPrototypeOf(this,Xp.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Q1(n){const e={},t=d(n,["file"]);return t!=null&&f(e,["file"],t),e}function Z1(n){const e={},t=d(n,["sdkHttpResponse"]);return t!=null&&f(e,["sdkHttpResponse"],t),e}function j1(n){const e={},t=d(n,["name"]);return t!=null&&f(e,["_url","file"],LT(t)),e}function eb(n){const e={},t=d(n,["sdkHttpResponse"]);return t!=null&&f(e,["sdkHttpResponse"],t),e}function tb(n){const e={},t=d(n,["name"]);return t!=null&&f(e,["_url","file"],LT(t)),e}function nb(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),t}function ib(n){const e={},t=d(n,["config"]);return t!=null&&nb(t,e),e}function sb(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["files"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["files"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rb extends Bs{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new wa(Hs.PAGED_ITEM_FILES,i=>this.listInternal(i),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>t)}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=ib(e);return r=V("files",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),s.then(l=>{const u=sb(l),h=new uk;return Object.assign(h,u),h})}}async createInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=Q1(e);return r=V("upload/v1beta/files",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const u=Z1(l),h=new ck;return Object.assign(h,u),h})}}async get(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=tb(e);return r=V("files/{file}",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>l)}}async delete(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=j1(e);return r=V("files/{file}",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),s.then(l=>{const u=eb(l),h=new dk;return Object.assign(h,u),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Cf(n){const e={},t=d(n,["data"]);if(t!=null&&f(e,["data"],t),d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function ob(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>Sb(r))),f(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&f(e,["role"],i),e}function ab(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function lb(n){const e={},t=d(n,["id"]);t!=null&&f(e,["id"],t);const i=d(n,["args"]);i!=null&&f(e,["args"],i);const s=d(n,["name"]);if(s!=null&&f(e,["name"],s),d(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function ub(n){const e={};if(d(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=d(n,["description"]);t!=null&&f(e,["description"],t);const i=d(n,["name"]);i!=null&&f(e,["name"],i);const s=d(n,["parameters"]);s!=null&&f(e,["parameters"],s);const r=d(n,["parametersJsonSchema"]);r!=null&&f(e,["parametersJsonSchema"],r);const o=d(n,["response"]);o!=null&&f(e,["response"],o);const a=d(n,["responseJsonSchema"]);return a!=null&&f(e,["responseJsonSchema"],a),e}function cb(n){const e={},t=d(n,["modelSelectionConfig"]);t!=null&&f(e,["modelConfig"],t);const i=d(n,["responseJsonSchema"]);i!=null&&f(e,["responseJsonSchema"],i);const s=d(n,["audioTimestamp"]);s!=null&&f(e,["audioTimestamp"],s);const r=d(n,["candidateCount"]);r!=null&&f(e,["candidateCount"],r);const o=d(n,["enableAffectiveDialog"]);o!=null&&f(e,["enableAffectiveDialog"],o);const a=d(n,["frequencyPenalty"]);a!=null&&f(e,["frequencyPenalty"],a);const l=d(n,["logprobs"]);l!=null&&f(e,["logprobs"],l);const u=d(n,["maxOutputTokens"]);u!=null&&f(e,["maxOutputTokens"],u);const h=d(n,["mediaResolution"]);h!=null&&f(e,["mediaResolution"],h);const p=d(n,["presencePenalty"]);p!=null&&f(e,["presencePenalty"],p);const g=d(n,["responseLogprobs"]);g!=null&&f(e,["responseLogprobs"],g);const m=d(n,["responseMimeType"]);m!=null&&f(e,["responseMimeType"],m);const y=d(n,["responseModalities"]);y!=null&&f(e,["responseModalities"],y);const A=d(n,["responseSchema"]);A!=null&&f(e,["responseSchema"],A);const T=d(n,["routingConfig"]);T!=null&&f(e,["routingConfig"],T);const v=d(n,["seed"]);v!=null&&f(e,["seed"],v);const E=d(n,["speechConfig"]);E!=null&&f(e,["speechConfig"],BT(E));const w=d(n,["stopSequences"]);w!=null&&f(e,["stopSequences"],w);const x=d(n,["temperature"]);x!=null&&f(e,["temperature"],x);const I=d(n,["thinkingConfig"]);I!=null&&f(e,["thinkingConfig"],I);const P=d(n,["topK"]);P!=null&&f(e,["topK"],P);const R=d(n,["topP"]);if(R!=null&&f(e,["topP"],R),d(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function db(n){const e={};if(d(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=d(n,["enableWidget"]);return t!=null&&f(e,["enableWidget"],t),e}function hb(n){const e={};if(d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=d(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],t),e}function fb(n,e){const t={},i=d(n,["generationConfig"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig"],i);const s=d(n,["responseModalities"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","responseModalities"],s);const r=d(n,["temperature"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig","temperature"],r);const o=d(n,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=d(n,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=d(n,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(n,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const h=d(n,["seed"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","seed"],h);const p=d(n,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],a0(p));const g=d(n,["thinkingConfig"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","thinkingConfig"],g);const m=d(n,["enableAffectiveDialog"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],m);const y=d(n,["systemInstruction"]);e!==void 0&&y!=null&&f(e,["setup","systemInstruction"],ob(Ft(y)));const A=d(n,["tools"]);if(e!==void 0&&A!=null){let P=Eu(A);Array.isArray(P)&&(P=P.map(R=>Cb(Au(R)))),f(e,["setup","tools"],P)}const T=d(n,["sessionResumption"]);e!==void 0&&T!=null&&f(e,["setup","sessionResumption"],wb(T));const v=d(n,["inputAudioTranscription"]);e!==void 0&&v!=null&&f(e,["setup","inputAudioTranscription"],v);const E=d(n,["outputAudioTranscription"]);e!==void 0&&E!=null&&f(e,["setup","outputAudioTranscription"],E);const w=d(n,["realtimeInputConfig"]);e!==void 0&&w!=null&&f(e,["setup","realtimeInputConfig"],w);const x=d(n,["contextWindowCompression"]);e!==void 0&&x!=null&&f(e,["setup","contextWindowCompression"],x);const I=d(n,["proactivity"]);return e!==void 0&&I!=null&&f(e,["setup","proactivity"],I),t}function pb(n,e){const t={},i=d(n,["generationConfig"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig"],cb(i));const s=d(n,["responseModalities"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","responseModalities"],s);const r=d(n,["temperature"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig","temperature"],r);const o=d(n,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=d(n,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=d(n,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(n,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const h=d(n,["seed"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","seed"],h);const p=d(n,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],BT(a0(p)));const g=d(n,["thinkingConfig"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","thinkingConfig"],g);const m=d(n,["enableAffectiveDialog"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],m);const y=d(n,["systemInstruction"]);e!==void 0&&y!=null&&f(e,["setup","systemInstruction"],Ft(y));const A=d(n,["tools"]);if(e!==void 0&&A!=null){let P=Eu(A);Array.isArray(P)&&(P=P.map(R=>Tb(Au(R)))),f(e,["setup","tools"],P)}const T=d(n,["sessionResumption"]);e!==void 0&&T!=null&&f(e,["setup","sessionResumption"],T);const v=d(n,["inputAudioTranscription"]);e!==void 0&&v!=null&&f(e,["setup","inputAudioTranscription"],v);const E=d(n,["outputAudioTranscription"]);e!==void 0&&E!=null&&f(e,["setup","outputAudioTranscription"],E);const w=d(n,["realtimeInputConfig"]);e!==void 0&&w!=null&&f(e,["setup","realtimeInputConfig"],w);const x=d(n,["contextWindowCompression"]);e!==void 0&&x!=null&&f(e,["setup","contextWindowCompression"],x);const I=d(n,["proactivity"]);return e!==void 0&&I!=null&&f(e,["setup","proactivity"],I),t}function gb(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["setup","model"],pe(n,i));const s=d(e,["config"]);return s!=null&&f(t,["config"],fb(s,t)),t}function mb(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["setup","model"],pe(n,i));const s=d(e,["config"]);return s!=null&&f(t,["config"],pb(s,t)),t}function yb(n){const e={},t=d(n,["musicGenerationConfig"]);return t!=null&&f(e,["musicGenerationConfig"],t),e}function vb(n){const e={},t=d(n,["weightedPrompts"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),f(e,["weightedPrompts"],i)}return e}function _b(n){const e={},t=d(n,["media"]);if(t!=null){let u=RT(t);Array.isArray(u)&&(u=u.map(h=>Cf(h))),f(e,["mediaChunks"],u)}const i=d(n,["audio"]);i!=null&&f(e,["audio"],Cf(kT(i)));const s=d(n,["audioStreamEnd"]);s!=null&&f(e,["audioStreamEnd"],s);const r=d(n,["video"]);r!=null&&f(e,["video"],Cf(MT(r)));const o=d(n,["text"]);o!=null&&f(e,["text"],o);const a=d(n,["activityStart"]);a!=null&&f(e,["activityStart"],a);const l=d(n,["activityEnd"]);return l!=null&&f(e,["activityEnd"],l),e}function Ab(n){const e={},t=d(n,["media"]);if(t!=null){let u=RT(t);Array.isArray(u)&&(u=u.map(h=>h)),f(e,["mediaChunks"],u)}const i=d(n,["audio"]);i!=null&&f(e,["audio"],kT(i));const s=d(n,["audioStreamEnd"]);s!=null&&f(e,["audioStreamEnd"],s);const r=d(n,["video"]);r!=null&&f(e,["video"],MT(r));const o=d(n,["text"]);o!=null&&f(e,["text"],o);const a=d(n,["activityStart"]);a!=null&&f(e,["activityStart"],a);const l=d(n,["activityEnd"]);return l!=null&&f(e,["activityEnd"],l),e}function Eb(n){const e={},t=d(n,["setupComplete"]);t!=null&&f(e,["setupComplete"],t);const i=d(n,["serverContent"]);i!=null&&f(e,["serverContent"],i);const s=d(n,["toolCall"]);s!=null&&f(e,["toolCall"],s);const r=d(n,["toolCallCancellation"]);r!=null&&f(e,["toolCallCancellation"],r);const o=d(n,["usageMetadata"]);o!=null&&f(e,["usageMetadata"],xb(o));const a=d(n,["goAway"]);a!=null&&f(e,["goAway"],a);const l=d(n,["sessionResumptionUpdate"]);return l!=null&&f(e,["sessionResumptionUpdate"],l),e}function Sb(n){const e={},t=d(n,["mediaResolution"]);t!=null&&f(e,["mediaResolution"],t);const i=d(n,["codeExecutionResult"]);i!=null&&f(e,["codeExecutionResult"],i);const s=d(n,["executableCode"]);s!=null&&f(e,["executableCode"],s);const r=d(n,["fileData"]);r!=null&&f(e,["fileData"],ab(r));const o=d(n,["functionCall"]);o!=null&&f(e,["functionCall"],lb(o));const a=d(n,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(n,["inlineData"]);l!=null&&f(e,["inlineData"],Cf(l));const u=d(n,["text"]);u!=null&&f(e,["text"],u);const h=d(n,["thought"]);h!=null&&f(e,["thought"],h);const p=d(n,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const g=d(n,["videoMetadata"]);return g!=null&&f(e,["videoMetadata"],g),e}function wb(n){const e={},t=d(n,["handle"]);if(t!=null&&f(e,["handle"],t),d(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function BT(n){const e={},t=d(n,["languageCode"]);t!=null&&f(e,["languageCode"],t);const i=d(n,["voiceConfig"]);if(i!=null&&f(e,["voiceConfig"],i),d(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function Cb(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=d(n,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=d(n,["computerUse"]);s!=null&&f(e,["computerUse"],s);const r=d(n,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const o=d(n,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(n,["googleMaps"]);a!=null&&f(e,["googleMaps"],db(a));const l=d(n,["googleSearch"]);l!=null&&f(e,["googleSearch"],hb(l));const u=d(n,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function Tb(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let p=t;Array.isArray(p)&&(p=p.map(g=>ub(g))),f(e,["functionDeclarations"],p)}const i=d(n,["retrieval"]);i!=null&&f(e,["retrieval"],i);const s=d(n,["googleSearchRetrieval"]);s!=null&&f(e,["googleSearchRetrieval"],s);const r=d(n,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),d(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=d(n,["codeExecution"]);o!=null&&f(e,["codeExecution"],o);const a=d(n,["enterpriseWebSearch"]);a!=null&&f(e,["enterpriseWebSearch"],a);const l=d(n,["googleMaps"]);l!=null&&f(e,["googleMaps"],l);const u=d(n,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const h=d(n,["urlContext"]);return h!=null&&f(e,["urlContext"],h),e}function xb(n){const e={},t=d(n,["promptTokenCount"]);t!=null&&f(e,["promptTokenCount"],t);const i=d(n,["cachedContentTokenCount"]);i!=null&&f(e,["cachedContentTokenCount"],i);const s=d(n,["candidatesTokenCount"]);s!=null&&f(e,["responseTokenCount"],s);const r=d(n,["toolUsePromptTokenCount"]);r!=null&&f(e,["toolUsePromptTokenCount"],r);const o=d(n,["thoughtsTokenCount"]);o!=null&&f(e,["thoughtsTokenCount"],o);const a=d(n,["totalTokenCount"]);a!=null&&f(e,["totalTokenCount"],a);const l=d(n,["promptTokensDetails"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(y=>y)),f(e,["promptTokensDetails"],m)}const u=d(n,["cacheTokensDetails"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(y=>y)),f(e,["cacheTokensDetails"],m)}const h=d(n,["candidatesTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(y=>y)),f(e,["responseTokensDetails"],m)}const p=d(n,["toolUsePromptTokensDetails"]);if(p!=null){let m=p;Array.isArray(m)&&(m=m.map(y=>y)),f(e,["toolUsePromptTokensDetails"],m)}const g=d(n,["trafficType"]);return g!=null&&f(e,["trafficType"],g),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Ib(n){const e={},t=d(n,["data"]);if(t!=null&&f(e,["data"],t),d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function Pb(n){const e={},t=d(n,["content"]);t!=null&&f(e,["content"],t);const i=d(n,["citationMetadata"]);i!=null&&f(e,["citationMetadata"],Rb(i));const s=d(n,["tokenCount"]);s!=null&&f(e,["tokenCount"],s);const r=d(n,["finishReason"]);r!=null&&f(e,["finishReason"],r);const o=d(n,["avgLogprobs"]);o!=null&&f(e,["avgLogprobs"],o);const a=d(n,["groundingMetadata"]);a!=null&&f(e,["groundingMetadata"],a);const l=d(n,["index"]);l!=null&&f(e,["index"],l);const u=d(n,["logprobsResult"]);u!=null&&f(e,["logprobsResult"],u);const h=d(n,["safetyRatings"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(m=>m)),f(e,["safetyRatings"],g)}const p=d(n,["urlContextMetadata"]);return p!=null&&f(e,["urlContextMetadata"],p),e}function Rb(n){const e={},t=d(n,["citationSources"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>s)),f(e,["citations"],i)}return e}function Mb(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let r=Kn(s);Array.isArray(r)&&(r=r.map(o=>o)),f(t,["contents"],r)}return t}function kb(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["tokensInfo"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>r)),f(e,["tokensInfo"],s)}return e}function bb(n){const e={},t=d(n,["values"]);t!=null&&f(e,["values"],t);const i=d(n,["statistics"]);return i!=null&&f(e,["statistics"],Nb(i)),e}function Nb(n){const e={},t=d(n,["truncated"]);t!=null&&f(e,["truncated"],t);const i=d(n,["token_count"]);return i!=null&&f(e,["tokenCount"],i),e}function Qp(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>BN(r))),f(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&f(e,["role"],i),e}function Lb(n){const e={},t=d(n,["controlType"]);t!=null&&f(e,["controlType"],t);const i=d(n,["enableControlImageComputation"]);return i!=null&&f(e,["computeControl"],i),e}function Db(n){const e={};if(d(n,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(d(n,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(d(n,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return e}function Fb(n,e){const t={},i=d(n,["systemInstruction"]);e!==void 0&&i!=null&&f(e,["systemInstruction"],Ft(i));const s=d(n,["tools"]);if(e!==void 0&&s!=null){let o=s;Array.isArray(o)&&(o=o.map(a=>YT(a))),f(e,["tools"],o)}const r=d(n,["generationConfig"]);return e!==void 0&&r!=null&&f(e,["generationConfig"],IN(r)),t}function Ub(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let o=Kn(s);Array.isArray(o)&&(o=o.map(a=>Qp(a))),f(t,["contents"],o)}const r=d(e,["config"]);return r!=null&&Db(r),t}function Hb(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let o=Kn(s);Array.isArray(o)&&(o=o.map(a=>a)),f(t,["contents"],o)}const r=d(e,["config"]);return r!=null&&Fb(r,t),t}function Vb(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["totalTokens"]);i!=null&&f(e,["totalTokens"],i);const s=d(n,["cachedContentTokenCount"]);return s!=null&&f(e,["cachedContentTokenCount"],s),e}function Gb(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["totalTokens"]);return i!=null&&f(e,["totalTokens"],i),e}function Ob(n,e){const t={},i=d(e,["model"]);return i!=null&&f(t,["_url","name"],pe(n,i)),t}function Bb(n,e){const t={},i=d(e,["model"]);return i!=null&&f(t,["_url","name"],pe(n,i)),t}function zb(n){const e={},t=d(n,["sdkHttpResponse"]);return t!=null&&f(e,["sdkHttpResponse"],t),e}function qb(n){const e={},t=d(n,["sdkHttpResponse"]);return t!=null&&f(e,["sdkHttpResponse"],t),e}function $b(n,e){const t={},i=d(n,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const s=d(n,["negativePrompt"]);e!==void 0&&s!=null&&f(e,["parameters","negativePrompt"],s);const r=d(n,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const o=d(n,["aspectRatio"]);e!==void 0&&o!=null&&f(e,["parameters","aspectRatio"],o);const a=d(n,["guidanceScale"]);e!==void 0&&a!=null&&f(e,["parameters","guidanceScale"],a);const l=d(n,["seed"]);e!==void 0&&l!=null&&f(e,["parameters","seed"],l);const u=d(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const h=d(n,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const p=d(n,["includeSafetyAttributes"]);e!==void 0&&p!=null&&f(e,["parameters","includeSafetyAttributes"],p);const g=d(n,["includeRaiReason"]);e!==void 0&&g!=null&&f(e,["parameters","includeRaiReason"],g);const m=d(n,["language"]);e!==void 0&&m!=null&&f(e,["parameters","language"],m);const y=d(n,["outputMimeType"]);e!==void 0&&y!=null&&f(e,["parameters","outputOptions","mimeType"],y);const A=d(n,["outputCompressionQuality"]);e!==void 0&&A!=null&&f(e,["parameters","outputOptions","compressionQuality"],A);const T=d(n,["addWatermark"]);e!==void 0&&T!=null&&f(e,["parameters","addWatermark"],T);const v=d(n,["labels"]);e!==void 0&&v!=null&&f(e,["labels"],v);const E=d(n,["editMode"]);e!==void 0&&E!=null&&f(e,["parameters","editMode"],E);const w=d(n,["baseSteps"]);return e!==void 0&&w!=null&&f(e,["parameters","editConfig","baseSteps"],w),t}function Wb(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["prompt"]);s!=null&&f(t,["instances[0]","prompt"],s);const r=d(e,["referenceImages"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>KN(l))),f(t,["instances[0]","referenceImages"],a)}const o=d(e,["config"]);return o!=null&&$b(o,t),t}function Yb(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>Zp(r))),f(e,["generatedImages"],s)}return e}function Kb(n,e){const t={},i=d(n,["taskType"]);e!==void 0&&i!=null&&f(e,["requests[]","taskType"],i);const s=d(n,["title"]);e!==void 0&&s!=null&&f(e,["requests[]","title"],s);const r=d(n,["outputDimensionality"]);if(e!==void 0&&r!=null&&f(e,["requests[]","outputDimensionality"],r),d(n,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(d(n,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return t}function Jb(n,e){const t={},i=d(n,["taskType"]);e!==void 0&&i!=null&&f(e,["instances[]","task_type"],i);const s=d(n,["title"]);e!==void 0&&s!=null&&f(e,["instances[]","title"],s);const r=d(n,["outputDimensionality"]);e!==void 0&&r!=null&&f(e,["parameters","outputDimensionality"],r);const o=d(n,["mimeType"]);e!==void 0&&o!=null&&f(e,["instances[]","mimeType"],o);const a=d(n,["autoTruncate"]);return e!==void 0&&a!=null&&f(e,["parameters","autoTruncate"],a),t}function Xb(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let a=s0(n,s);Array.isArray(a)&&(a=a.map(l=>l)),f(t,["requests[]","content"],a)}const r=d(e,["config"]);r!=null&&Kb(r,t);const o=d(e,["model"]);return o!==void 0&&f(t,["requests[]","model"],pe(n,o)),t}function Qb(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let o=s0(n,s);Array.isArray(o)&&(o=o.map(a=>a)),f(t,["instances[]","content"],o)}const r=d(e,["config"]);return r!=null&&Jb(r,t),t}function Zb(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["embeddings"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["embeddings"],r)}const s=d(n,["metadata"]);return s!=null&&f(e,["metadata"],s),e}function jb(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["predictions[]","embeddings"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>bb(o))),f(e,["embeddings"],r)}const s=d(n,["metadata"]);return s!=null&&f(e,["metadata"],s),e}function eN(n){const e={},t=d(n,["endpoint"]);t!=null&&f(e,["name"],t);const i=d(n,["deployedModelId"]);return i!=null&&f(e,["deployedModelId"],i),e}function tN(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function nN(n){const e={},t=d(n,["id"]);t!=null&&f(e,["id"],t);const i=d(n,["args"]);i!=null&&f(e,["args"],i);const s=d(n,["name"]);if(s!=null&&f(e,["name"],s),d(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function iN(n){const e={},t=d(n,["mode"]);t!=null&&f(e,["mode"],t);const i=d(n,["allowedFunctionNames"]);if(i!=null&&f(e,["allowedFunctionNames"],i),d(n,["streamFunctionCallArguments"])!==void 0)throw new Error("streamFunctionCallArguments parameter is not supported in Gemini API.");return e}function sN(n){const e={};if(d(n,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const t=d(n,["description"]);t!=null&&f(e,["description"],t);const i=d(n,["name"]);i!=null&&f(e,["name"],i);const s=d(n,["parameters"]);s!=null&&f(e,["parameters"],s);const r=d(n,["parametersJsonSchema"]);r!=null&&f(e,["parametersJsonSchema"],r);const o=d(n,["response"]);o!=null&&f(e,["response"],o);const a=d(n,["responseJsonSchema"]);return a!=null&&f(e,["responseJsonSchema"],a),e}function rN(n,e,t){const i={},s=d(e,["systemInstruction"]);t!==void 0&&s!=null&&f(t,["systemInstruction"],Qp(Ft(s)));const r=d(e,["temperature"]);r!=null&&f(i,["temperature"],r);const o=d(e,["topP"]);o!=null&&f(i,["topP"],o);const a=d(e,["topK"]);a!=null&&f(i,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&f(i,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&f(i,["maxOutputTokens"],u);const h=d(e,["stopSequences"]);h!=null&&f(i,["stopSequences"],h);const p=d(e,["responseLogprobs"]);p!=null&&f(i,["responseLogprobs"],p);const g=d(e,["logprobs"]);g!=null&&f(i,["logprobs"],g);const m=d(e,["presencePenalty"]);m!=null&&f(i,["presencePenalty"],m);const y=d(e,["frequencyPenalty"]);y!=null&&f(i,["frequencyPenalty"],y);const A=d(e,["seed"]);A!=null&&f(i,["seed"],A);const T=d(e,["responseMimeType"]);T!=null&&f(i,["responseMimeType"],T);const v=d(e,["responseSchema"]);v!=null&&f(i,["responseSchema"],r0(v));const E=d(e,["responseJsonSchema"]);if(E!=null&&f(i,["responseJsonSchema"],E),d(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(d(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const w=d(e,["safetySettings"]);if(t!==void 0&&w!=null){let Y=w;Array.isArray(Y)&&(Y=Y.map(ie=>JN(ie))),f(t,["safetySettings"],Y)}const x=d(e,["tools"]);if(t!==void 0&&x!=null){let Y=Eu(x);Array.isArray(Y)&&(Y=Y.map(ie=>nL(Au(ie)))),f(t,["tools"],Y)}const I=d(e,["toolConfig"]);if(t!==void 0&&I!=null&&f(t,["toolConfig"],tL(I)),d(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const P=d(e,["cachedContent"]);t!==void 0&&P!=null&&f(t,["cachedContent"],zs(n,P));const R=d(e,["responseModalities"]);R!=null&&f(i,["responseModalities"],R);const k=d(e,["mediaResolution"]);k!=null&&f(i,["mediaResolution"],k);const b=d(e,["speechConfig"]);if(b!=null&&f(i,["speechConfig"],o0(b)),d(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=d(e,["thinkingConfig"]);N!=null&&f(i,["thinkingConfig"],N);const D=d(e,["imageConfig"]);return D!=null&&f(i,["imageConfig"],bN(D)),i}function oN(n,e,t){const i={},s=d(e,["systemInstruction"]);t!==void 0&&s!=null&&f(t,["systemInstruction"],Ft(s));const r=d(e,["temperature"]);r!=null&&f(i,["temperature"],r);const o=d(e,["topP"]);o!=null&&f(i,["topP"],o);const a=d(e,["topK"]);a!=null&&f(i,["topK"],a);const l=d(e,["candidateCount"]);l!=null&&f(i,["candidateCount"],l);const u=d(e,["maxOutputTokens"]);u!=null&&f(i,["maxOutputTokens"],u);const h=d(e,["stopSequences"]);h!=null&&f(i,["stopSequences"],h);const p=d(e,["responseLogprobs"]);p!=null&&f(i,["responseLogprobs"],p);const g=d(e,["logprobs"]);g!=null&&f(i,["logprobs"],g);const m=d(e,["presencePenalty"]);m!=null&&f(i,["presencePenalty"],m);const y=d(e,["frequencyPenalty"]);y!=null&&f(i,["frequencyPenalty"],y);const A=d(e,["seed"]);A!=null&&f(i,["seed"],A);const T=d(e,["responseMimeType"]);T!=null&&f(i,["responseMimeType"],T);const v=d(e,["responseSchema"]);v!=null&&f(i,["responseSchema"],r0(v));const E=d(e,["responseJsonSchema"]);E!=null&&f(i,["responseJsonSchema"],E);const w=d(e,["routingConfig"]);w!=null&&f(i,["routingConfig"],w);const x=d(e,["modelSelectionConfig"]);x!=null&&f(i,["modelConfig"],x);const I=d(e,["safetySettings"]);if(t!==void 0&&I!=null){let F=I;Array.isArray(F)&&(F=F.map($=>$)),f(t,["safetySettings"],F)}const P=d(e,["tools"]);if(t!==void 0&&P!=null){let F=Eu(P);Array.isArray(F)&&(F=F.map($=>YT(Au($)))),f(t,["tools"],F)}const R=d(e,["toolConfig"]);t!==void 0&&R!=null&&f(t,["toolConfig"],R);const k=d(e,["labels"]);t!==void 0&&k!=null&&f(t,["labels"],k);const b=d(e,["cachedContent"]);t!==void 0&&b!=null&&f(t,["cachedContent"],zs(n,b));const N=d(e,["responseModalities"]);N!=null&&f(i,["responseModalities"],N);const D=d(e,["mediaResolution"]);D!=null&&f(i,["mediaResolution"],D);const Y=d(e,["speechConfig"]);Y!=null&&f(i,["speechConfig"],WT(o0(Y)));const ie=d(e,["audioTimestamp"]);ie!=null&&f(i,["audioTimestamp"],ie);const ae=d(e,["thinkingConfig"]);ae!=null&&f(i,["thinkingConfig"],ae);const Ye=d(e,["imageConfig"]);return Ye!=null&&f(i,["imageConfig"],NN(Ye)),i}function sE(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let o=Kn(s);Array.isArray(o)&&(o=o.map(a=>Qp(a))),f(t,["contents"],o)}const r=d(e,["config"]);return r!=null&&f(t,["generationConfig"],rN(n,r,t)),t}function rE(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["contents"]);if(s!=null){let o=Kn(s);Array.isArray(o)&&(o=o.map(a=>a)),f(t,["contents"],o)}const r=d(e,["config"]);return r!=null&&f(t,["generationConfig"],oN(n,r,t)),t}function oE(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["candidates"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(u=>Pb(u))),f(e,["candidates"],l)}const s=d(n,["modelVersion"]);s!=null&&f(e,["modelVersion"],s);const r=d(n,["promptFeedback"]);r!=null&&f(e,["promptFeedback"],r);const o=d(n,["responseId"]);o!=null&&f(e,["responseId"],o);const a=d(n,["usageMetadata"]);return a!=null&&f(e,["usageMetadata"],a),e}function aE(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["candidates"]);if(i!=null){let u=i;Array.isArray(u)&&(u=u.map(h=>h)),f(e,["candidates"],u)}const s=d(n,["createTime"]);s!=null&&f(e,["createTime"],s);const r=d(n,["modelVersion"]);r!=null&&f(e,["modelVersion"],r);const o=d(n,["promptFeedback"]);o!=null&&f(e,["promptFeedback"],o);const a=d(n,["responseId"]);a!=null&&f(e,["responseId"],a);const l=d(n,["usageMetadata"]);return l!=null&&f(e,["usageMetadata"],l),e}function aN(n,e){const t={};if(d(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(n,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const i=d(n,["numberOfImages"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const s=d(n,["aspectRatio"]);e!==void 0&&s!=null&&f(e,["parameters","aspectRatio"],s);const r=d(n,["guidanceScale"]);if(e!==void 0&&r!=null&&f(e,["parameters","guidanceScale"],r),d(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=d(n,["safetyFilterLevel"]);e!==void 0&&o!=null&&f(e,["parameters","safetySetting"],o);const a=d(n,["personGeneration"]);e!==void 0&&a!=null&&f(e,["parameters","personGeneration"],a);const l=d(n,["includeSafetyAttributes"]);e!==void 0&&l!=null&&f(e,["parameters","includeSafetyAttributes"],l);const u=d(n,["includeRaiReason"]);e!==void 0&&u!=null&&f(e,["parameters","includeRaiReason"],u);const h=d(n,["language"]);e!==void 0&&h!=null&&f(e,["parameters","language"],h);const p=d(n,["outputMimeType"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","mimeType"],p);const g=d(n,["outputCompressionQuality"]);if(e!==void 0&&g!=null&&f(e,["parameters","outputOptions","compressionQuality"],g),d(n,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(d(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const m=d(n,["imageSize"]);if(e!==void 0&&m!=null&&f(e,["parameters","sampleImageSize"],m),d(n,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return t}function lN(n,e){const t={},i=d(n,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const s=d(n,["negativePrompt"]);e!==void 0&&s!=null&&f(e,["parameters","negativePrompt"],s);const r=d(n,["numberOfImages"]);e!==void 0&&r!=null&&f(e,["parameters","sampleCount"],r);const o=d(n,["aspectRatio"]);e!==void 0&&o!=null&&f(e,["parameters","aspectRatio"],o);const a=d(n,["guidanceScale"]);e!==void 0&&a!=null&&f(e,["parameters","guidanceScale"],a);const l=d(n,["seed"]);e!==void 0&&l!=null&&f(e,["parameters","seed"],l);const u=d(n,["safetyFilterLevel"]);e!==void 0&&u!=null&&f(e,["parameters","safetySetting"],u);const h=d(n,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const p=d(n,["includeSafetyAttributes"]);e!==void 0&&p!=null&&f(e,["parameters","includeSafetyAttributes"],p);const g=d(n,["includeRaiReason"]);e!==void 0&&g!=null&&f(e,["parameters","includeRaiReason"],g);const m=d(n,["language"]);e!==void 0&&m!=null&&f(e,["parameters","language"],m);const y=d(n,["outputMimeType"]);e!==void 0&&y!=null&&f(e,["parameters","outputOptions","mimeType"],y);const A=d(n,["outputCompressionQuality"]);e!==void 0&&A!=null&&f(e,["parameters","outputOptions","compressionQuality"],A);const T=d(n,["addWatermark"]);e!==void 0&&T!=null&&f(e,["parameters","addWatermark"],T);const v=d(n,["labels"]);e!==void 0&&v!=null&&f(e,["labels"],v);const E=d(n,["imageSize"]);e!==void 0&&E!=null&&f(e,["parameters","sampleImageSize"],E);const w=d(n,["enhancePrompt"]);return e!==void 0&&w!=null&&f(e,["parameters","enhancePrompt"],w),t}function uN(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["prompt"]);s!=null&&f(t,["instances[0]","prompt"],s);const r=d(e,["config"]);return r!=null&&aN(r,t),t}function cN(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["prompt"]);s!=null&&f(t,["instances[0]","prompt"],s);const r=d(e,["config"]);return r!=null&&lN(r,t),t}function dN(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>wN(o))),f(e,["generatedImages"],r)}const s=d(n,["positivePromptSafetyAttributes"]);return s!=null&&f(e,["positivePromptSafetyAttributes"],qT(s)),e}function hN(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["predictions"]);if(i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>Zp(o))),f(e,["generatedImages"],r)}const s=d(n,["positivePromptSafetyAttributes"]);return s!=null&&f(e,["positivePromptSafetyAttributes"],$T(s)),e}function fN(n,e){const t={},i=d(n,["numberOfVideos"]);if(e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i),d(n,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(d(n,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const s=d(n,["durationSeconds"]);if(e!==void 0&&s!=null&&f(e,["parameters","durationSeconds"],s),d(n,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const r=d(n,["aspectRatio"]);e!==void 0&&r!=null&&f(e,["parameters","aspectRatio"],r);const o=d(n,["resolution"]);e!==void 0&&o!=null&&f(e,["parameters","resolution"],o);const a=d(n,["personGeneration"]);if(e!==void 0&&a!=null&&f(e,["parameters","personGeneration"],a),d(n,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const l=d(n,["negativePrompt"]);e!==void 0&&l!=null&&f(e,["parameters","negativePrompt"],l);const u=d(n,["enhancePrompt"]);if(e!==void 0&&u!=null&&f(e,["parameters","enhancePrompt"],u),d(n,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");const h=d(n,["lastFrame"]);e!==void 0&&h!=null&&f(e,["instances[0]","lastFrame"],jp(h));const p=d(n,["referenceImages"]);if(e!==void 0&&p!=null){let g=p;Array.isArray(g)&&(g=g.map(m=>gL(m))),f(e,["instances[0]","referenceImages"],g)}if(d(n,["mask"])!==void 0)throw new Error("mask parameter is not supported in Gemini API.");if(d(n,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return t}function pN(n,e){const t={},i=d(n,["numberOfVideos"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const s=d(n,["outputGcsUri"]);e!==void 0&&s!=null&&f(e,["parameters","storageUri"],s);const r=d(n,["fps"]);e!==void 0&&r!=null&&f(e,["parameters","fps"],r);const o=d(n,["durationSeconds"]);e!==void 0&&o!=null&&f(e,["parameters","durationSeconds"],o);const a=d(n,["seed"]);e!==void 0&&a!=null&&f(e,["parameters","seed"],a);const l=d(n,["aspectRatio"]);e!==void 0&&l!=null&&f(e,["parameters","aspectRatio"],l);const u=d(n,["resolution"]);e!==void 0&&u!=null&&f(e,["parameters","resolution"],u);const h=d(n,["personGeneration"]);e!==void 0&&h!=null&&f(e,["parameters","personGeneration"],h);const p=d(n,["pubsubTopic"]);e!==void 0&&p!=null&&f(e,["parameters","pubsubTopic"],p);const g=d(n,["negativePrompt"]);e!==void 0&&g!=null&&f(e,["parameters","negativePrompt"],g);const m=d(n,["enhancePrompt"]);e!==void 0&&m!=null&&f(e,["parameters","enhancePrompt"],m);const y=d(n,["generateAudio"]);e!==void 0&&y!=null&&f(e,["parameters","generateAudio"],y);const A=d(n,["lastFrame"]);e!==void 0&&A!=null&&f(e,["instances[0]","lastFrame"],Si(A));const T=d(n,["referenceImages"]);if(e!==void 0&&T!=null){let w=T;Array.isArray(w)&&(w=w.map(x=>mL(x))),f(e,["instances[0]","referenceImages"],w)}const v=d(n,["mask"]);e!==void 0&&v!=null&&f(e,["instances[0]","mask"],pL(v));const E=d(n,["compressionQuality"]);return e!==void 0&&E!=null&&f(e,["parameters","compressionQuality"],E),t}function gN(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata"]);i!=null&&f(e,["metadata"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["response","generateVideoResponse"]);return o!=null&&f(e,["response"],_N(o)),e}function mN(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata"]);i!=null&&f(e,["metadata"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["response"]);return o!=null&&f(e,["response"],AN(o)),e}function yN(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["prompt"]);s!=null&&f(t,["instances[0]","prompt"],s);const r=d(e,["image"]);r!=null&&f(t,["instances[0]","image"],jp(r));const o=d(e,["video"]);o!=null&&f(t,["instances[0]","video"],KT(o));const a=d(e,["source"]);a!=null&&EN(a,t);const l=d(e,["config"]);return l!=null&&fN(l,t),t}function vN(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["prompt"]);s!=null&&f(t,["instances[0]","prompt"],s);const r=d(e,["image"]);r!=null&&f(t,["instances[0]","image"],Si(r));const o=d(e,["video"]);o!=null&&f(t,["instances[0]","video"],JT(o));const a=d(e,["source"]);a!=null&&SN(a,t);const l=d(e,["config"]);return l!=null&&pN(l,t),t}function _N(n){const e={},t=d(n,["generatedSamples"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>TN(o))),f(e,["generatedVideos"],r)}const i=d(n,["raiMediaFilteredCount"]);i!=null&&f(e,["raiMediaFilteredCount"],i);const s=d(n,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function AN(n){const e={},t=d(n,["videos"]);if(t!=null){let r=t;Array.isArray(r)&&(r=r.map(o=>xN(o))),f(e,["generatedVideos"],r)}const i=d(n,["raiMediaFilteredCount"]);i!=null&&f(e,["raiMediaFilteredCount"],i);const s=d(n,["raiMediaFilteredReasons"]);return s!=null&&f(e,["raiMediaFilteredReasons"],s),e}function EN(n,e){const t={},i=d(n,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const s=d(n,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],jp(s));const r=d(n,["video"]);return e!==void 0&&r!=null&&f(e,["instances[0]","video"],KT(r)),t}function SN(n,e){const t={},i=d(n,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const s=d(n,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],Si(s));const r=d(n,["video"]);return e!==void 0&&r!=null&&f(e,["instances[0]","video"],JT(r)),t}function wN(n){const e={},t=d(n,["_self"]);t!=null&&f(e,["image"],LN(t));const i=d(n,["raiFilteredReason"]);i!=null&&f(e,["raiFilteredReason"],i);const s=d(n,["_self"]);return s!=null&&f(e,["safetyAttributes"],qT(s)),e}function Zp(n){const e={},t=d(n,["_self"]);t!=null&&f(e,["image"],zT(t));const i=d(n,["raiFilteredReason"]);i!=null&&f(e,["raiFilteredReason"],i);const s=d(n,["_self"]);s!=null&&f(e,["safetyAttributes"],$T(s));const r=d(n,["prompt"]);return r!=null&&f(e,["enhancedPrompt"],r),e}function CN(n){const e={},t=d(n,["_self"]);t!=null&&f(e,["mask"],zT(t));const i=d(n,["labels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>r)),f(e,["labels"],s)}return e}function TN(n){const e={},t=d(n,["video"]);return t!=null&&f(e,["video"],hL(t)),e}function xN(n){const e={},t=d(n,["_self"]);return t!=null&&f(e,["video"],fL(t)),e}function IN(n){const e={},t=d(n,["modelSelectionConfig"]);t!=null&&f(e,["modelConfig"],t);const i=d(n,["responseJsonSchema"]);i!=null&&f(e,["responseJsonSchema"],i);const s=d(n,["audioTimestamp"]);s!=null&&f(e,["audioTimestamp"],s);const r=d(n,["candidateCount"]);r!=null&&f(e,["candidateCount"],r);const o=d(n,["enableAffectiveDialog"]);o!=null&&f(e,["enableAffectiveDialog"],o);const a=d(n,["frequencyPenalty"]);a!=null&&f(e,["frequencyPenalty"],a);const l=d(n,["logprobs"]);l!=null&&f(e,["logprobs"],l);const u=d(n,["maxOutputTokens"]);u!=null&&f(e,["maxOutputTokens"],u);const h=d(n,["mediaResolution"]);h!=null&&f(e,["mediaResolution"],h);const p=d(n,["presencePenalty"]);p!=null&&f(e,["presencePenalty"],p);const g=d(n,["responseLogprobs"]);g!=null&&f(e,["responseLogprobs"],g);const m=d(n,["responseMimeType"]);m!=null&&f(e,["responseMimeType"],m);const y=d(n,["responseModalities"]);y!=null&&f(e,["responseModalities"],y);const A=d(n,["responseSchema"]);A!=null&&f(e,["responseSchema"],A);const T=d(n,["routingConfig"]);T!=null&&f(e,["routingConfig"],T);const v=d(n,["seed"]);v!=null&&f(e,["seed"],v);const E=d(n,["speechConfig"]);E!=null&&f(e,["speechConfig"],WT(E));const w=d(n,["stopSequences"]);w!=null&&f(e,["stopSequences"],w);const x=d(n,["temperature"]);x!=null&&f(e,["temperature"],x);const I=d(n,["thinkingConfig"]);I!=null&&f(e,["thinkingConfig"],I);const P=d(n,["topK"]);P!=null&&f(e,["topK"],P);const R=d(n,["topP"]);if(R!=null&&f(e,["topP"],R),d(n,["enableEnhancedCivicAnswers"])!==void 0)throw new Error("enableEnhancedCivicAnswers parameter is not supported in Vertex AI.");return e}function PN(n,e){const t={},i=d(e,["model"]);return i!=null&&f(t,["_url","name"],pe(n,i)),t}function RN(n,e){const t={},i=d(e,["model"]);return i!=null&&f(t,["_url","name"],pe(n,i)),t}function MN(n){const e={};if(d(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=d(n,["enableWidget"]);return t!=null&&f(e,["enableWidget"],t),e}function kN(n){const e={};if(d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=d(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],t),e}function bN(n){const e={},t=d(n,["aspectRatio"]);t!=null&&f(e,["aspectRatio"],t);const i=d(n,["imageSize"]);if(i!=null&&f(e,["imageSize"],i),d(n,["outputMimeType"])!==void 0)throw new Error("outputMimeType parameter is not supported in Gemini API.");if(d(n,["outputCompressionQuality"])!==void 0)throw new Error("outputCompressionQuality parameter is not supported in Gemini API.");return e}function NN(n){const e={},t=d(n,["aspectRatio"]);t!=null&&f(e,["aspectRatio"],t);const i=d(n,["imageSize"]);i!=null&&f(e,["imageSize"],i);const s=d(n,["outputMimeType"]);s!=null&&f(e,["imageOutputOptions","mimeType"],s);const r=d(n,["outputCompressionQuality"]);return r!=null&&f(e,["imageOutputOptions","compressionQuality"],r),e}function LN(n){const e={},t=d(n,["bytesBase64Encoded"]);t!=null&&f(e,["imageBytes"],Yr(t));const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function zT(n){const e={},t=d(n,["gcsUri"]);t!=null&&f(e,["gcsUri"],t);const i=d(n,["bytesBase64Encoded"]);i!=null&&f(e,["imageBytes"],Yr(i));const s=d(n,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}function jp(n){const e={};if(d(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const t=d(n,["imageBytes"]);t!=null&&f(e,["bytesBase64Encoded"],Yr(t));const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function Si(n){const e={},t=d(n,["gcsUri"]);t!=null&&f(e,["gcsUri"],t);const i=d(n,["imageBytes"]);i!=null&&f(e,["bytesBase64Encoded"],Yr(i));const s=d(n,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}function DN(n,e,t){const i={},s=d(e,["pageSize"]);t!==void 0&&s!=null&&f(t,["_query","pageSize"],s);const r=d(e,["pageToken"]);t!==void 0&&r!=null&&f(t,["_query","pageToken"],r);const o=d(e,["filter"]);t!==void 0&&o!=null&&f(t,["_query","filter"],o);const a=d(e,["queryBase"]);return t!==void 0&&a!=null&&f(t,["_url","models_url"],DT(n,a)),i}function FN(n,e,t){const i={},s=d(e,["pageSize"]);t!==void 0&&s!=null&&f(t,["_query","pageSize"],s);const r=d(e,["pageToken"]);t!==void 0&&r!=null&&f(t,["_query","pageToken"],r);const o=d(e,["filter"]);t!==void 0&&o!=null&&f(t,["_query","filter"],o);const a=d(e,["queryBase"]);return t!==void 0&&a!=null&&f(t,["_url","models_url"],DT(n,a)),i}function UN(n,e){const t={},i=d(e,["config"]);return i!=null&&DN(n,i,t),t}function HN(n,e){const t={},i=d(e,["config"]);return i!=null&&FN(n,i,t),t}function VN(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["_self"]);if(s!=null){let r=FT(s);Array.isArray(r)&&(r=r.map(o=>Yy(o))),f(e,["models"],r)}return e}function GN(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["_self"]);if(s!=null){let r=FT(s);Array.isArray(r)&&(r=r.map(o=>Ky(o))),f(e,["models"],r)}return e}function ON(n){const e={},t=d(n,["maskMode"]);t!=null&&f(e,["maskMode"],t);const i=d(n,["segmentationClasses"]);i!=null&&f(e,["maskClasses"],i);const s=d(n,["maskDilation"]);return s!=null&&f(e,["dilation"],s),e}function Yy(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["displayName"]);i!=null&&f(e,["displayName"],i);const s=d(n,["description"]);s!=null&&f(e,["description"],s);const r=d(n,["version"]);r!=null&&f(e,["version"],r);const o=d(n,["_self"]);o!=null&&f(e,["tunedModelInfo"],iL(o));const a=d(n,["inputTokenLimit"]);a!=null&&f(e,["inputTokenLimit"],a);const l=d(n,["outputTokenLimit"]);l!=null&&f(e,["outputTokenLimit"],l);const u=d(n,["supportedGenerationMethods"]);u!=null&&f(e,["supportedActions"],u);const h=d(n,["temperature"]);h!=null&&f(e,["temperature"],h);const p=d(n,["maxTemperature"]);p!=null&&f(e,["maxTemperature"],p);const g=d(n,["topP"]);g!=null&&f(e,["topP"],g);const m=d(n,["topK"]);m!=null&&f(e,["topK"],m);const y=d(n,["thinking"]);return y!=null&&f(e,["thinking"],y),e}function Ky(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["displayName"]);i!=null&&f(e,["displayName"],i);const s=d(n,["description"]);s!=null&&f(e,["description"],s);const r=d(n,["versionId"]);r!=null&&f(e,["version"],r);const o=d(n,["deployedModels"]);if(o!=null){let p=o;Array.isArray(p)&&(p=p.map(g=>eN(g))),f(e,["endpoints"],p)}const a=d(n,["labels"]);a!=null&&f(e,["labels"],a);const l=d(n,["_self"]);l!=null&&f(e,["tunedModelInfo"],sL(l));const u=d(n,["defaultCheckpointId"]);u!=null&&f(e,["defaultCheckpointId"],u);const h=d(n,["checkpoints"]);if(h!=null){let p=h;Array.isArray(p)&&(p=p.map(g=>g)),f(e,["checkpoints"],p)}return e}function BN(n){const e={},t=d(n,["mediaResolution"]);t!=null&&f(e,["mediaResolution"],t);const i=d(n,["codeExecutionResult"]);i!=null&&f(e,["codeExecutionResult"],i);const s=d(n,["executableCode"]);s!=null&&f(e,["executableCode"],s);const r=d(n,["fileData"]);r!=null&&f(e,["fileData"],tN(r));const o=d(n,["functionCall"]);o!=null&&f(e,["functionCall"],nN(o));const a=d(n,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(n,["inlineData"]);l!=null&&f(e,["inlineData"],Ib(l));const u=d(n,["text"]);u!=null&&f(e,["text"],u);const h=d(n,["thought"]);h!=null&&f(e,["thought"],h);const p=d(n,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const g=d(n,["videoMetadata"]);return g!=null&&f(e,["videoMetadata"],g),e}function zN(n){const e={},t=d(n,["productImage"]);return t!=null&&f(e,["image"],Si(t)),e}function qN(n,e){const t={},i=d(n,["numberOfImages"]);e!==void 0&&i!=null&&f(e,["parameters","sampleCount"],i);const s=d(n,["baseSteps"]);e!==void 0&&s!=null&&f(e,["parameters","baseSteps"],s);const r=d(n,["outputGcsUri"]);e!==void 0&&r!=null&&f(e,["parameters","storageUri"],r);const o=d(n,["seed"]);e!==void 0&&o!=null&&f(e,["parameters","seed"],o);const a=d(n,["safetyFilterLevel"]);e!==void 0&&a!=null&&f(e,["parameters","safetySetting"],a);const l=d(n,["personGeneration"]);e!==void 0&&l!=null&&f(e,["parameters","personGeneration"],l);const u=d(n,["addWatermark"]);e!==void 0&&u!=null&&f(e,["parameters","addWatermark"],u);const h=d(n,["outputMimeType"]);e!==void 0&&h!=null&&f(e,["parameters","outputOptions","mimeType"],h);const p=d(n,["outputCompressionQuality"]);e!==void 0&&p!=null&&f(e,["parameters","outputOptions","compressionQuality"],p);const g=d(n,["enhancePrompt"]);e!==void 0&&g!=null&&f(e,["parameters","enhancePrompt"],g);const m=d(n,["labels"]);return e!==void 0&&m!=null&&f(e,["labels"],m),t}function $N(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["source"]);s!=null&&YN(s,t);const r=d(e,["config"]);return r!=null&&qN(r,t),t}function WN(n){const e={},t=d(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>Zp(s))),f(e,["generatedImages"],i)}return e}function YN(n,e){const t={},i=d(n,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const s=d(n,["personImage"]);e!==void 0&&s!=null&&f(e,["instances[0]","personImage","image"],Si(s));const r=d(n,["productImages"]);if(e!==void 0&&r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>zN(a))),f(e,["instances[0]","productImages"],o)}return t}function KN(n){const e={},t=d(n,["referenceImage"]);t!=null&&f(e,["referenceImage"],Si(t));const i=d(n,["referenceId"]);i!=null&&f(e,["referenceId"],i);const s=d(n,["referenceType"]);s!=null&&f(e,["referenceType"],s);const r=d(n,["maskImageConfig"]);r!=null&&f(e,["maskImageConfig"],ON(r));const o=d(n,["controlImageConfig"]);o!=null&&f(e,["controlImageConfig"],Lb(o));const a=d(n,["styleImageConfig"]);a!=null&&f(e,["styleImageConfig"],a);const l=d(n,["subjectImageConfig"]);return l!=null&&f(e,["subjectImageConfig"],l),e}function qT(n){const e={},t=d(n,["safetyAttributes","categories"]);t!=null&&f(e,["categories"],t);const i=d(n,["safetyAttributes","scores"]);i!=null&&f(e,["scores"],i);const s=d(n,["contentType"]);return s!=null&&f(e,["contentType"],s),e}function $T(n){const e={},t=d(n,["safetyAttributes","categories"]);t!=null&&f(e,["categories"],t);const i=d(n,["safetyAttributes","scores"]);i!=null&&f(e,["scores"],i);const s=d(n,["contentType"]);return s!=null&&f(e,["contentType"],s),e}function JN(n){const e={},t=d(n,["category"]);if(t!=null&&f(e,["category"],t),d(n,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const i=d(n,["threshold"]);return i!=null&&f(e,["threshold"],i),e}function XN(n){const e={},t=d(n,["image"]);return t!=null&&f(e,["image"],Si(t)),e}function QN(n,e){const t={},i=d(n,["mode"]);e!==void 0&&i!=null&&f(e,["parameters","mode"],i);const s=d(n,["maxPredictions"]);e!==void 0&&s!=null&&f(e,["parameters","maxPredictions"],s);const r=d(n,["confidenceThreshold"]);e!==void 0&&r!=null&&f(e,["parameters","confidenceThreshold"],r);const o=d(n,["maskDilation"]);e!==void 0&&o!=null&&f(e,["parameters","maskDilation"],o);const a=d(n,["binaryColorThreshold"]);e!==void 0&&a!=null&&f(e,["parameters","binaryColorThreshold"],a);const l=d(n,["labels"]);return e!==void 0&&l!=null&&f(e,["labels"],l),t}function ZN(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["source"]);s!=null&&eL(s,t);const r=d(e,["config"]);return r!=null&&QN(r,t),t}function jN(n){const e={},t=d(n,["predictions"]);if(t!=null){let i=t;Array.isArray(i)&&(i=i.map(s=>CN(s))),f(e,["generatedMasks"],i)}return e}function eL(n,e){const t={},i=d(n,["prompt"]);e!==void 0&&i!=null&&f(e,["instances[0]","prompt"],i);const s=d(n,["image"]);e!==void 0&&s!=null&&f(e,["instances[0]","image"],Si(s));const r=d(n,["scribbleImage"]);return e!==void 0&&r!=null&&f(e,["instances[0]","scribble"],XN(r)),t}function WT(n){const e={},t=d(n,["languageCode"]);t!=null&&f(e,["languageCode"],t);const i=d(n,["voiceConfig"]);if(i!=null&&f(e,["voiceConfig"],i),d(n,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");return e}function tL(n){const e={},t=d(n,["functionCallingConfig"]);t!=null&&f(e,["functionCallingConfig"],iN(t));const i=d(n,["retrievalConfig"]);return i!=null&&f(e,["retrievalConfig"],i),e}function nL(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=d(n,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=d(n,["computerUse"]);s!=null&&f(e,["computerUse"],s);const r=d(n,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const o=d(n,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(n,["googleMaps"]);a!=null&&f(e,["googleMaps"],MN(a));const l=d(n,["googleSearch"]);l!=null&&f(e,["googleSearch"],kN(l));const u=d(n,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}function YT(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let p=t;Array.isArray(p)&&(p=p.map(g=>sN(g))),f(e,["functionDeclarations"],p)}const i=d(n,["retrieval"]);i!=null&&f(e,["retrieval"],i);const s=d(n,["googleSearchRetrieval"]);s!=null&&f(e,["googleSearchRetrieval"],s);const r=d(n,["computerUse"]);if(r!=null&&f(e,["computerUse"],r),d(n,["fileSearch"])!==void 0)throw new Error("fileSearch parameter is not supported in Vertex AI.");const o=d(n,["codeExecution"]);o!=null&&f(e,["codeExecution"],o);const a=d(n,["enterpriseWebSearch"]);a!=null&&f(e,["enterpriseWebSearch"],a);const l=d(n,["googleMaps"]);l!=null&&f(e,["googleMaps"],l);const u=d(n,["googleSearch"]);u!=null&&f(e,["googleSearch"],u);const h=d(n,["urlContext"]);return h!=null&&f(e,["urlContext"],h),e}function iL(n){const e={},t=d(n,["baseModel"]);t!=null&&f(e,["baseModel"],t);const i=d(n,["createTime"]);i!=null&&f(e,["createTime"],i);const s=d(n,["updateTime"]);return s!=null&&f(e,["updateTime"],s),e}function sL(n){const e={},t=d(n,["labels","google-vertex-llm-tuning-base-model-id"]);t!=null&&f(e,["baseModel"],t);const i=d(n,["createTime"]);i!=null&&f(e,["createTime"],i);const s=d(n,["updateTime"]);return s!=null&&f(e,["updateTime"],s),e}function rL(n,e){const t={},i=d(n,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const s=d(n,["description"]);e!==void 0&&s!=null&&f(e,["description"],s);const r=d(n,["defaultCheckpointId"]);return e!==void 0&&r!=null&&f(e,["defaultCheckpointId"],r),t}function oL(n,e){const t={},i=d(n,["displayName"]);e!==void 0&&i!=null&&f(e,["displayName"],i);const s=d(n,["description"]);e!==void 0&&s!=null&&f(e,["description"],s);const r=d(n,["defaultCheckpointId"]);return e!==void 0&&r!=null&&f(e,["defaultCheckpointId"],r),t}function aL(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","name"],pe(n,i));const s=d(e,["config"]);return s!=null&&rL(s,t),t}function lL(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["config"]);return s!=null&&oL(s,t),t}function uL(n,e){const t={},i=d(n,["outputGcsUri"]);e!==void 0&&i!=null&&f(e,["parameters","storageUri"],i);const s=d(n,["safetyFilterLevel"]);e!==void 0&&s!=null&&f(e,["parameters","safetySetting"],s);const r=d(n,["personGeneration"]);e!==void 0&&r!=null&&f(e,["parameters","personGeneration"],r);const o=d(n,["includeRaiReason"]);e!==void 0&&o!=null&&f(e,["parameters","includeRaiReason"],o);const a=d(n,["outputMimeType"]);e!==void 0&&a!=null&&f(e,["parameters","outputOptions","mimeType"],a);const l=d(n,["outputCompressionQuality"]);e!==void 0&&l!=null&&f(e,["parameters","outputOptions","compressionQuality"],l);const u=d(n,["enhanceInputImage"]);e!==void 0&&u!=null&&f(e,["parameters","upscaleConfig","enhanceInputImage"],u);const h=d(n,["imagePreservationFactor"]);e!==void 0&&h!=null&&f(e,["parameters","upscaleConfig","imagePreservationFactor"],h);const p=d(n,["labels"]);e!==void 0&&p!=null&&f(e,["labels"],p);const g=d(n,["numberOfImages"]);e!==void 0&&g!=null&&f(e,["parameters","sampleCount"],g);const m=d(n,["mode"]);return e!==void 0&&m!=null&&f(e,["parameters","mode"],m),t}function cL(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["_url","model"],pe(n,i));const s=d(e,["image"]);s!=null&&f(t,["instances[0]","image"],Si(s));const r=d(e,["upscaleFactor"]);r!=null&&f(t,["parameters","upscaleConfig","upscaleFactor"],r);const o=d(e,["config"]);return o!=null&&uL(o,t),t}function dL(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["predictions"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>Zp(r))),f(e,["generatedImages"],s)}return e}function hL(n){const e={},t=d(n,["uri"]);t!=null&&f(e,["uri"],t);const i=d(n,["encodedVideo"]);i!=null&&f(e,["videoBytes"],Yr(i));const s=d(n,["encoding"]);return s!=null&&f(e,["mimeType"],s),e}function fL(n){const e={},t=d(n,["gcsUri"]);t!=null&&f(e,["uri"],t);const i=d(n,["bytesBase64Encoded"]);i!=null&&f(e,["videoBytes"],Yr(i));const s=d(n,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}function pL(n){const e={},t=d(n,["image"]);t!=null&&f(e,["_self"],Si(t));const i=d(n,["maskMode"]);return i!=null&&f(e,["maskMode"],i),e}function gL(n){const e={},t=d(n,["image"]);t!=null&&f(e,["image"],jp(t));const i=d(n,["referenceType"]);return i!=null&&f(e,["referenceType"],i),e}function mL(n){const e={},t=d(n,["image"]);t!=null&&f(e,["image"],Si(t));const i=d(n,["referenceType"]);return i!=null&&f(e,["referenceType"],i),e}function KT(n){const e={},t=d(n,["uri"]);t!=null&&f(e,["uri"],t);const i=d(n,["videoBytes"]);i!=null&&f(e,["encodedVideo"],Yr(i));const s=d(n,["mimeType"]);return s!=null&&f(e,["encoding"],s),e}function JT(n){const e={},t=d(n,["uri"]);t!=null&&f(e,["gcsUri"],t);const i=d(n,["videoBytes"]);i!=null&&f(e,["bytesBase64Encoded"],Yr(i));const s=d(n,["mimeType"]);return s!=null&&f(e,["mimeType"],s),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const yL="Content-Type",vL="X-Server-Timeout",_L="User-Agent",Jy="x-goog-api-client",AL="1.30.0",EL=`google-genai-sdk/${AL}`,SL="v1beta1",wL="v1beta",lE=/^\s*data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class CL{constructor(e){var t,i;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:SL,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(i=this.clientOptions.apiVersion)!==null&&i!==void 0?i:wL,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const i=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&i.push(e.apiVersion),i.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,i){const s=[this.getRequestUrlInternal(t)];return i&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,i);if(e.queryParams)for(const[o,a]of Object.entries(e.queryParams))s.searchParams.append(o,String(a));let r={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else r.body=e.body;return r=await this.includeExtraHttpOptionsToRequestInit(r,t,s.toString(),e.abortSignal),this.unaryApiCall(s,r,e.httpMethod)}patchHttpOptions(e,t){const i=JSON.parse(JSON.stringify(e));for(const[s,r]of Object.entries(t))typeof r=="object"?i[s]=Object.assign(Object.assign({},i[s]),r):r!==void 0&&(i[s]=r);return i}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const i=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,i);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let r={};return r.body=e.body,r=await this.includeExtraHttpOptionsToRequestInit(r,t,s.toString(),e.abortSignal),this.streamApiCall(s,r,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,i,s){if(t&&t.timeout||s){const r=new AbortController,o=r.signal;if(t.timeout&&(t==null?void 0:t.timeout)>0){const a=setTimeout(()=>r.abort(),t.timeout);a&&typeof a.unref=="function"&&a.unref()}s&&s.addEventListener("abort",()=>{r.abort()}),e.signal=o}return t&&t.extraBody!==null&&TL(e,t.extraBody),e.headers=await this.getHeadersInternal(t,i),e}async unaryApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await uE(s),new qy(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,i){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:i})).then(async s=>(await uE(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var t;return il(this,arguments,function*(){const s=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),r=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";for(;;){const{done:a,value:l}=yield Ie(s.read());if(a){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=r.decode(l,{stream:!0});try{const p=JSON.parse(u);if("error"in p){const g=JSON.parse(JSON.stringify(p.error)),m=g.status,y=g.code,A=`got status: ${m}. ${JSON.stringify(p)}`;if(y>=400&&y<600)throw new Xp({message:A,status:y})}}catch(p){if(p.name==="ApiError")throw p}o+=u;let h=o.match(lE);for(;h;){const p=h[1];try{const g=new Response(p,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Ie(new qy(g)),o=o.slice(h[0].length),h=o.match(lE)}catch(g){throw new Error(`exception parsing stream chunk ${p}. ${g}`)}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(i=>{throw new Error(`exception ${i} sending request`)})}getDefaultHeaders(){const e={},t=EL+" "+this.clientOptions.userAgentExtra;return e[_L]=t,e[Jy]=t,e[yL]="application/json",e}async getHeadersInternal(e,t){const i=new Headers;if(e&&e.headers){for(const[s,r]of Object.entries(e.headers))i.append(s,r);e.timeout&&e.timeout>0&&i.append(vL,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(i,t),i}getFileName(e){var t;let i="";return typeof e=="string"&&(i=e.replace(/[/\\]+$/,""),i=(t=i.split(/[/\\]/).pop())!==null&&t!==void 0?t:""),i}async uploadFile(e,t){var i;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const r=this.clientOptions.uploader,o=await r.stat(e);s.sizeBytes=String(o.size);const a=(i=t==null?void 0:t.mimeType)!==null&&i!==void 0?i:o.type;if(a===void 0||a==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=a;const l={file:s},u=this.getFileName(e),h=V("upload/v1beta/files",l._url),p=await this.fetchUploadUrl(h,s.sizeBytes,s.mimeType,u,l,t==null?void 0:t.httpOptions);return r.upload(e,p,this)}async uploadFileToFileSearchStore(e,t,i){var s;const r=this.clientOptions.uploader,o=await r.stat(t),a=String(o.size),l=(s=i==null?void 0:i.mimeType)!==null&&s!==void 0?s:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");const u=`upload/v1beta/${e}:uploadToFileSearchStore`,h=this.getFileName(t),p={};i!=null&&i.customMetadata&&(p.customMetadata=i.customMetadata),i!=null&&i.chunkingConfig&&(p.chunkingConfig=i.chunkingConfig);const g=await this.fetchUploadUrl(u,a,l,h,p,i==null?void 0:i.httpOptions);return r.uploadToFileSearchStore(t,g,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t,i,s,r,o){var a;let l={};o?l=o:l={apiVersion:"",headers:Object.assign({"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t}`,"X-Goog-Upload-Header-Content-Type":`${i}`},s?{"X-Goog-Upload-File-Name":s}:{})};const u=await this.request({path:e,body:JSON.stringify(r),httpMethod:"POST",httpOptions:l});if(!u||!(u!=null&&u.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const h=(a=u==null?void 0:u.headers)===null||a===void 0?void 0:a["x-goog-upload-url"];if(h===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return h}}async function uE(n){var e;if(n===void 0)throw new Error("response is undefined");if(!n.ok){const t=n.status;let i;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?i=await n.json():i={error:{message:await n.text(),code:n.status,status:n.statusText}};const s=JSON.stringify(i);throw t>=400&&t<600?new Xp({message:s,status:t}):new Error(s)}}function TL(n,e){if(!e||Object.keys(e).length===0)return;if(n.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let t={};if(typeof n.body=="string"&&n.body.length>0)try{const r=JSON.parse(n.body);if(typeof r=="object"&&r!==null&&!Array.isArray(r))t=r;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function i(r,o){const a=Object.assign({},r);for(const l in o)if(Object.prototype.hasOwnProperty.call(o,l)){const u=o[l],h=a[l];u&&typeof u=="object"&&!Array.isArray(u)&&h&&typeof h=="object"&&!Array.isArray(h)?a[l]=i(h,u):(h&&u&&typeof h!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof h}, New type: ${typeof u}. Overwriting.`),a[l]=u)}return a}const s=i(t,e);n.body=JSON.stringify(s)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const xL="mcp_used/unknown";let IL=!1;function XT(n){for(const e of n)if(PL(e)||typeof e=="object"&&"inputSchema"in e)return!0;return IL}function QT(n){var e;const t=(e=n[Jy])!==null&&e!==void 0?e:"";n[Jy]=(t+` ${xL}`).trimStart()}function PL(n){return n!==null&&typeof n=="object"&&n instanceof l0}function RL(n,e=100){return il(this,arguments,function*(){let i,s=0;for(;s<e;){const r=yield Ie(n.listTools({cursor:i}));for(const o of r.tools)yield yield Ie(o),s++;if(!r.nextCursor)break;i=r.nextCursor}})}class l0{constructor(e=[],t){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=e,this.config=t}static create(e,t){return new l0(e,t)}async initialize(){var e,t,i,s;if(this.mcpTools.length>0)return;const r={},o=[];for(const h of this.mcpClients)try{for(var a=!0,l=(t=void 0,hc(RL(h))),u;u=await l.next(),e=u.done,!e;a=!0){s=u.value,a=!1;const p=s;o.push(p);const g=p.name;if(r[g])throw new Error(`Duplicate function name ${g} found in MCP tools. Please ensure function names are unique.`);r[g]=h}}catch(p){t={error:p}}finally{try{!a&&!e&&(i=l.return)&&await i.call(l)}finally{if(t)throw t.error}}this.mcpTools=o,this.functionNameToMcpClient=r}async tool(){return await this.initialize(),Ek(this.mcpTools,this.config)}async callTool(e){await this.initialize();const t=[];for(const i of e)if(i.name in this.functionNameToMcpClient){const s=this.functionNameToMcpClient[i.name];let r;this.config.timeout&&(r={timeout:this.config.timeout});const o=await s.callTool({name:i.name,arguments:i.args},void 0,r);t.push({functionResponse:{name:i.name,response:o.isError?{error:o}:o}})}return t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function ML(n,e,t){const i=new fk;let s;t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),Object.assign(i,s),e(i)}class kL{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i}async connect(e){var t,i;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),r=this.apiClient.getApiVersion(),o=LL(this.apiClient.getDefaultHeaders()),a=this.apiClient.getApiKey(),l=`${s}/ws/google.ai.generativelanguage.${r}.GenerativeService.BidiGenerateMusic?key=${a}`;let u=()=>{};const h=new Promise(w=>{u=w}),p=e.callbacks,g=function(){u({})},m=this.apiClient,y={onopen:g,onmessage:w=>{ML(m,p.onmessage,w)},onerror:(t=p==null?void 0:p.onerror)!==null&&t!==void 0?t:function(w){},onclose:(i=p==null?void 0:p.onclose)!==null&&i!==void 0?i:function(w){}},A=this.webSocketFactory.create(l,NL(o),y);A.connect(),await h;const E={setup:{model:pe(this.apiClient,e.model)}};return A.send(JSON.stringify(E)),new bL(A,this.apiClient)}}class bL{constructor(e,t){this.conn=e,this.apiClient=t}async setWeightedPrompts(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=vb(e);this.conn.send(JSON.stringify({clientContent:t}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=yb(e);this.conn.send(JSON.stringify(t))}sendPlaybackControl(e){const t={playbackControl:e};this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl($a.PLAY)}pause(){this.sendPlaybackControl($a.PAUSE)}stop(){this.sendPlaybackControl($a.STOP)}resetContext(){this.sendPlaybackControl($a.RESET_CONTEXT)}close(){this.conn.close()}}function NL(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function LL(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const DL="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function FL(n,e,t){const i=new hk;let s;t.data instanceof Blob?s=await t.data.text():t.data instanceof ArrayBuffer?s=new TextDecoder().decode(t.data):s=t.data;const r=JSON.parse(s);if(n.isVertexAI()){const o=Eb(r);Object.assign(i,o)}else Object.assign(i,r);e(i)}class UL{constructor(e,t,i){this.apiClient=e,this.auth=t,this.webSocketFactory=i,this.music=new kL(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,i,s,r,o,a;if(e.config&&e.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let h;const p=this.apiClient.getHeaders();e.config&&e.config.tools&&XT(e.config.tools)&&QT(p);const g=OL(p);if(this.apiClient.isVertexAI())h=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(g,h);else{const b=this.apiClient.getApiKey();let N="BidiGenerateContent",D="key";b!=null&&b.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),N="BidiGenerateContentConstrained",D="access_token"),h=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${N}?${D}=${b}`}let m=()=>{};const y=new Promise(b=>{m=b}),A=e.callbacks,T=function(){var b;(b=A==null?void 0:A.onopen)===null||b===void 0||b.call(A),m({})},v=this.apiClient,E={onopen:T,onmessage:b=>{FL(v,A.onmessage,b)},onerror:(t=A==null?void 0:A.onerror)!==null&&t!==void 0?t:function(b){},onclose:(i=A==null?void 0:A.onclose)!==null&&i!==void 0?i:function(b){}},w=this.webSocketFactory.create(h,GL(g),E);w.connect(),await y;let x=pe(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&x.startsWith("publishers/")){const b=this.apiClient.getProject(),N=this.apiClient.getLocation();x=`projects/${b}/locations/${N}/`+x}let I={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[ip.AUDIO]}:e.config.responseModalities=[ip.AUDIO]),!((r=e.config)===null||r===void 0)&&r.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const P=(a=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[],R=[];for(const b of P)if(this.isCallableTool(b)){const N=b;R.push(await N.tool())}else R.push(b);R.length>0&&(e.config.tools=R);const k={model:x,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?I=mb(this.apiClient,k):I=gb(this.apiClient,k),delete I.config,w.send(JSON.stringify(I)),new VL(w,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const HL={turnComplete:!0};class VL{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let i=[];try{i=Kn(t.turns),e.isVertexAI()||(i=i.map(s=>Qp(s)))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:i,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let i=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?i=t.functionResponses:i=[t.functionResponses],i.length===0)throw new Error("functionResponses is required.");for(const r of i){if(typeof r!="object"||r===null||!("name"in r)||!("response"in r))throw new Error(`Could not parse function response, type '${typeof r}'.`);if(!e.isVertexAI()&&!("id"in r))throw new Error(DL)}return{toolResponse:{functionResponses:i}}}sendClientContent(e){e=Object.assign(Object.assign({},HL),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:Ab(e)}:t={realtimeInput:_b(e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function GL(n){const e={};return n.forEach((t,i)=>{e[i]=t}),e}function OL(n){const e=new Headers;for(const[t,i]of Object.entries(n))e.append(t,i);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const cE=10;function dE(n){var e,t,i;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const o of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(sl(o)){s=!0;break}if(!s)return!0;const r=(i=n==null?void 0:n.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls;return r&&(r<0||!Number.isInteger(r))||r==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",r),!0):!1}function sl(n){return"callTool"in n&&typeof n.callTool=="function"}function BL(n){var e,t,i;return(i=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>sl(s)))!==null&&i!==void 0?i:!1}function hE(n){var e;const t=[];return!((e=n==null?void 0:n.config)===null||e===void 0)&&e.tools&&n.config.tools.forEach((i,s)=>{if(sl(i))return;const r=i;r.functionDeclarations&&r.functionDeclarations.length>0&&t.push(s)}),t}function fE(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class zL extends Bs{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var i,s,r,o,a;const l=await this.processParamsMaybeAddMcpUsage(t);if(this.maybeMoveToResponseJsonSchem(t),!BL(t)||dE(t.config))return await this.generateContentInternal(l);const u=hE(t);if(u.length>0){const A=u.map(T=>`tools[${T}]`).join(", ");throw new Error(`Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations is not yet supported. Incompatible tools found at ${A}.`)}let h,p;const g=Kn(l.contents),m=(r=(s=(i=l.config)===null||i===void 0?void 0:i.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&r!==void 0?r:cE;let y=0;for(;y<m&&(h=await this.generateContentInternal(l),!(!h.functionCalls||h.functionCalls.length===0));){const A=h.candidates[0].content,T=[];for(const v of(a=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&a!==void 0?a:[])if(sl(v)){const w=await v.callTool(h.functionCalls);T.push(...w)}y++,p={role:"user",parts:T},l.contents=Kn(l.contents),l.contents.push(A),l.contents.push(p),fE(l.config)&&(g.push(A),g.push(p))}return fE(l.config)&&(h.automaticFunctionCallingHistory=g),h},this.generateContentStream=async t=>{var i,s,r,o,a;if(this.maybeMoveToResponseJsonSchem(t),dE(t.config)){const p=await this.processParamsMaybeAddMcpUsage(t);return await this.generateContentStreamInternal(p)}const l=hE(t);if(l.length>0){const p=l.map(g=>`tools[${g}]`).join(", ");throw new Error(`Incompatible tools found at ${p}. Automatic function calling with CallableTools (or MCP objects) and basic FunctionDeclarations" is not yet supported.`)}const u=(r=(s=(i=t==null?void 0:t.config)===null||i===void 0?void 0:i.toolConfig)===null||s===void 0?void 0:s.functionCallingConfig)===null||r===void 0?void 0:r.streamFunctionCallArguments,h=(a=(o=t==null?void 0:t.config)===null||o===void 0?void 0:o.automaticFunctionCalling)===null||a===void 0?void 0:a.disable;if(u&&!h)throw new Error("Running in streaming mode with 'streamFunctionCallArguments' enabled, this feature is not compatible with automatic function calling (AFC). Please set 'config.automaticFunctionCalling.disable' to true to disable AFC or leave 'config.toolConfig.functionCallingConfig.streamFunctionCallArguments' to be undefined or set to false to disable streaming function call arguments feature.");return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(i=>{var s;let r;const o=[];if(i!=null&&i.generatedImages)for(const l of i.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((s=l==null?void 0:l.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?r=l==null?void 0:l.safetyAttributes:o.push(l);let a;return r?a={generatedImages:o,positivePromptSafetyAttributes:r,sdkHttpResponse:i.sdkHttpResponse}:a={generatedImages:o,sdkHttpResponse:i.sdkHttpResponse},a}),this.list=async t=>{var i;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((i=o.config)===null||i===void 0)&&i.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new wa(Hs.PAGED_ITEM_MODELS,a=>this.listInternal(a),await this.listInternal(o),o)},this.editImage=async t=>{const i={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(i.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(i)},this.upscaleImage=async t=>{let i={numberOfImages:1,mode:"upscale"};t.config&&(i=Object.assign(Object.assign({},i),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:i};return await this.upscaleImageInternal(s)},this.generateVideos=async t=>{var i,s,r,o,a,l;if((t.prompt||t.image||t.video)&&t.source)throw new Error("Source and prompt/image/video are mutually exclusive. Please only use source.");return this.apiClient.isVertexAI()||(!((i=t.video)===null||i===void 0)&&i.uri&&(!((s=t.video)===null||s===void 0)&&s.videoBytes)?t.video={uri:t.video.uri,mimeType:t.video.mimeType}:!((o=(r=t.source)===null||r===void 0?void 0:r.video)===null||o===void 0)&&o.uri&&(!((l=(a=t.source)===null||a===void 0?void 0:a.video)===null||l===void 0)&&l.videoBytes)&&(t.source.video={uri:t.source.video.uri,mimeType:t.source.video.mimeType})),await this.generateVideosInternal(t)}}maybeMoveToResponseJsonSchem(e){e.config&&e.config.responseSchema&&(e.config.responseJsonSchema||Object.keys(e.config.responseSchema).includes("$schema")&&(e.config.responseJsonSchema=e.config.responseSchema,delete e.config.responseSchema))}async processParamsMaybeAddMcpUsage(e){var t,i,s;const r=(t=e.config)===null||t===void 0?void 0:t.tools;if(!r)return e;const o=await Promise.all(r.map(async l=>sl(l)?await l.tool():l)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:o})};if(a.config.tools=o,e.config&&e.config.tools&&XT(e.config.tools)){const l=(s=(i=e.config.httpOptions)===null||i===void 0?void 0:i.headers)!==null&&s!==void 0?s:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),QT(u),a.config.httpOptions=Object.assign(Object.assign({},e.config.httpOptions),{headers:u})}return a}async initAfcToolsMap(e){var t,i,s;const r=new Map;for(const o of(i=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&i!==void 0?i:[])if(sl(o)){const a=o,l=await a.tool();for(const u of(s=l.functionDeclarations)!==null&&s!==void 0?s:[]){if(!u.name)throw new Error("Function declaration name is required.");if(r.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);r.set(u.name,a)}}return r}async processAfcStream(e){var t,i,s;const r=(s=(i=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:cE;let o=!1,a=0;const l=await this.initAfcToolsMap(e);return function(u,h,p){var g,m;return il(this,arguments,function*(){for(var y,A,T,v;a<r;){o&&(a++,o=!1);const I=yield Ie(u.processParamsMaybeAddMcpUsage(p)),P=yield Ie(u.generateContentStreamInternal(I)),R=[],k=[];try{for(var E=!0,w=(A=void 0,hc(P)),x;x=yield Ie(w.next()),y=x.done,!y;E=!0){v=x.value,E=!1;const b=v;if(yield yield Ie(b),b.candidates&&(!((g=b.candidates[0])===null||g===void 0)&&g.content)){k.push(b.candidates[0].content);for(const N of(m=b.candidates[0].content.parts)!==null&&m!==void 0?m:[])if(a<r&&N.functionCall){if(!N.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(N.functionCall.name)){const D=yield Ie(h.get(N.functionCall.name).callTool([N.functionCall]));R.push(...D)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${N.functionCall.name}`)}}}}catch(b){A={error:b}}finally{try{!E&&!y&&(T=w.return)&&(yield Ie(T.call(w)))}finally{if(A)throw A.error}}if(R.length>0){o=!0;const b=new Du;b.candidates=[{content:{role:"user",parts:R}}],yield yield Ie(b);const N=[];N.push(...k),N.push({role:"user",parts:R});const D=Kn(p.contents).concat(N);p.contents=D}else break}})}(this,l,e)}async generateContentInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=rE(this.apiClient,e);return a=V("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=aE(h),g=new Du;return Object.assign(g,p),g})}else{const u=sE(this.apiClient,e);return a=V("{model}:generateContent",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=oE(h),g=new Du;return Object.assign(g,p),g})}}async generateContentStreamInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=rE(this.apiClient,e);return a=V("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),o.then(function(p){return il(this,arguments,function*(){var g,m,y,A;try{for(var T=!0,v=hc(p),E;E=yield Ie(v.next()),g=E.done,!g;T=!0){A=E.value,T=!1;const w=A,x=aE(yield Ie(w.json()));x.sdkHttpResponse={headers:w.headers};const I=new Du;Object.assign(I,x),yield yield Ie(I)}}catch(w){m={error:w}}finally{try{!T&&!g&&(y=v.return)&&(yield Ie(y.call(v)))}finally{if(m)throw m.error}}})})}else{const u=sE(this.apiClient,e);return a=V("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.requestStream({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(p){return il(this,arguments,function*(){var g,m,y,A;try{for(var T=!0,v=hc(p),E;E=yield Ie(v.next()),g=E.done,!g;T=!0){A=E.value,T=!1;const w=A,x=oE(yield Ie(w.json()));x.sdkHttpResponse={headers:w.headers};const I=new Du;Object.assign(I,x),yield yield Ie(I)}}catch(w){m={error:w}}finally{try{!T&&!g&&(y=v.return)&&(yield Ie(y.call(v)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Qb(this.apiClient,e);return a=V("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=jb(h),g=new BA;return Object.assign(g,p),g})}else{const u=Xb(this.apiClient,e);return a=V("{model}:batchEmbedContents",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=Zb(h),g=new BA;return Object.assign(g,p),g})}}async generateImagesInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=cN(this.apiClient,e);return a=V("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=hN(h),g=new zA;return Object.assign(g,p),g})}else{const u=uN(this.apiClient,e);return a=V("{model}:predict",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=dN(h),g=new zA;return Object.assign(g,p),g})}}async editImageInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=Wb(this.apiClient,e);return r=V("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),s.then(l=>{const u=Yb(l),h=new tk;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=cL(this.apiClient,e);return r=V("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),s.then(l=>{const u=dL(l),h=new nk;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async recontextImage(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=$N(this.apiClient,e);return r=V("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const u=WN(l),h=new ik;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async segmentImage(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=ZN(this.apiClient,e);return r=V("{model}:predict",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const u=jN(l),h=new sk;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=RN(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>Ky(h))}else{const u=PN(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>Yy(h))}}async listInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=HN(this.apiClient,e);return a=V("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=GN(h),g=new qA;return Object.assign(g,p),g})}else{const u=UN(this.apiClient,e);return a=V("{models_url}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=VN(h),g=new qA;return Object.assign(g,p),g})}}async update(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=lL(this.apiClient,e);return a=V("{model}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>Ky(h))}else{const u=aL(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>Yy(h))}}async delete(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Bb(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=qb(h),g=new $A;return Object.assign(g,p),g})}else{const u=Ob(this.apiClient,e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=zb(h),g=new $A;return Object.assign(g,p),g})}}async countTokens(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=Hb(this.apiClient,e);return a=V("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=Gb(h),g=new WA;return Object.assign(g,p),g})}else{const u=Ub(this.apiClient,e);return a=V("{model}:countTokens",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=Vb(h),g=new WA;return Object.assign(g,p),g})}}async computeTokens(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=Mb(this.apiClient,e);return r=V("{model}:computeTokens",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),s.then(l=>{const u=kb(l),h=new rk;return Object.assign(h,u),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=vN(this.apiClient,e);return a=V("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>{const p=mN(h),g=new sp;return Object.assign(g,p),g})}else{const u=yN(this.apiClient,e);return a=V("{model}:predictLongRunning",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=gN(h),g=new sp;return Object.assign(g,p),g})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class qL extends Bs{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let r;i&&"httpOptions"in i&&(r=i.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:r}});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async get(e){const t=e.operation,i=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let r;i&&"httpOptions"in i&&(r=i.httpOptions);const o=await this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:r}});return t._fromAPIResponse({apiResponse:o,_isVertexAI:!0})}else{const s=await this.getVideosOperationInternal({operationName:t.name,config:i});return t._fromAPIResponse({apiResponse:s,_isVertexAI:!1})}}async getVideosOperationInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=JM(e);return a=V("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o}else{const u=KM(e);return a=V("{operationName}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o}}async fetchPredictVideosOperationInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=OM(e);return r=V("{resourceName}:fetchPredictOperation",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $L(n){const e={},t=d(n,["data"]);if(t!=null&&f(e,["data"],t),d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function WL(n){const e={},t=d(n,["parts"]);if(t!=null){let s=t;Array.isArray(s)&&(s=s.map(r=>tD(r))),f(e,["parts"],s)}const i=d(n,["role"]);return i!=null&&f(e,["role"],i),e}function YL(n,e,t){const i={},s=d(e,["expireTime"]);t!==void 0&&s!=null&&f(t,["expireTime"],s);const r=d(e,["newSessionExpireTime"]);t!==void 0&&r!=null&&f(t,["newSessionExpireTime"],r);const o=d(e,["uses"]);t!==void 0&&o!=null&&f(t,["uses"],o);const a=d(e,["liveConnectConstraints"]);t!==void 0&&a!=null&&f(t,["bidiGenerateContentSetup"],eD(n,a));const l=d(e,["lockAdditionalFields"]);return t!==void 0&&l!=null&&f(t,["fieldMask"],l),i}function KL(n,e){const t={},i=d(e,["config"]);return i!=null&&f(t,["config"],YL(n,i,t)),t}function JL(n){const e={};if(d(n,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const t=d(n,["fileUri"]);t!=null&&f(e,["fileUri"],t);const i=d(n,["mimeType"]);return i!=null&&f(e,["mimeType"],i),e}function XL(n){const e={},t=d(n,["id"]);t!=null&&f(e,["id"],t);const i=d(n,["args"]);i!=null&&f(e,["args"],i);const s=d(n,["name"]);if(s!=null&&f(e,["name"],s),d(n,["partialArgs"])!==void 0)throw new Error("partialArgs parameter is not supported in Gemini API.");if(d(n,["willContinue"])!==void 0)throw new Error("willContinue parameter is not supported in Gemini API.");return e}function QL(n){const e={};if(d(n,["authConfig"])!==void 0)throw new Error("authConfig parameter is not supported in Gemini API.");const t=d(n,["enableWidget"]);return t!=null&&f(e,["enableWidget"],t),e}function ZL(n){const e={};if(d(n,["excludeDomains"])!==void 0)throw new Error("excludeDomains parameter is not supported in Gemini API.");if(d(n,["blockingConfidence"])!==void 0)throw new Error("blockingConfidence parameter is not supported in Gemini API.");const t=d(n,["timeRangeFilter"]);return t!=null&&f(e,["timeRangeFilter"],t),e}function jL(n,e){const t={},i=d(n,["generationConfig"]);e!==void 0&&i!=null&&f(e,["setup","generationConfig"],i);const s=d(n,["responseModalities"]);e!==void 0&&s!=null&&f(e,["setup","generationConfig","responseModalities"],s);const r=d(n,["temperature"]);e!==void 0&&r!=null&&f(e,["setup","generationConfig","temperature"],r);const o=d(n,["topP"]);e!==void 0&&o!=null&&f(e,["setup","generationConfig","topP"],o);const a=d(n,["topK"]);e!==void 0&&a!=null&&f(e,["setup","generationConfig","topK"],a);const l=d(n,["maxOutputTokens"]);e!==void 0&&l!=null&&f(e,["setup","generationConfig","maxOutputTokens"],l);const u=d(n,["mediaResolution"]);e!==void 0&&u!=null&&f(e,["setup","generationConfig","mediaResolution"],u);const h=d(n,["seed"]);e!==void 0&&h!=null&&f(e,["setup","generationConfig","seed"],h);const p=d(n,["speechConfig"]);e!==void 0&&p!=null&&f(e,["setup","generationConfig","speechConfig"],a0(p));const g=d(n,["thinkingConfig"]);e!==void 0&&g!=null&&f(e,["setup","generationConfig","thinkingConfig"],g);const m=d(n,["enableAffectiveDialog"]);e!==void 0&&m!=null&&f(e,["setup","generationConfig","enableAffectiveDialog"],m);const y=d(n,["systemInstruction"]);e!==void 0&&y!=null&&f(e,["setup","systemInstruction"],WL(Ft(y)));const A=d(n,["tools"]);if(e!==void 0&&A!=null){let P=Eu(A);Array.isArray(P)&&(P=P.map(R=>iD(Au(R)))),f(e,["setup","tools"],P)}const T=d(n,["sessionResumption"]);e!==void 0&&T!=null&&f(e,["setup","sessionResumption"],nD(T));const v=d(n,["inputAudioTranscription"]);e!==void 0&&v!=null&&f(e,["setup","inputAudioTranscription"],v);const E=d(n,["outputAudioTranscription"]);e!==void 0&&E!=null&&f(e,["setup","outputAudioTranscription"],E);const w=d(n,["realtimeInputConfig"]);e!==void 0&&w!=null&&f(e,["setup","realtimeInputConfig"],w);const x=d(n,["contextWindowCompression"]);e!==void 0&&x!=null&&f(e,["setup","contextWindowCompression"],x);const I=d(n,["proactivity"]);return e!==void 0&&I!=null&&f(e,["setup","proactivity"],I),t}function eD(n,e){const t={},i=d(e,["model"]);i!=null&&f(t,["setup","model"],pe(n,i));const s=d(e,["config"]);return s!=null&&f(t,["config"],jL(s,t)),t}function tD(n){const e={},t=d(n,["mediaResolution"]);t!=null&&f(e,["mediaResolution"],t);const i=d(n,["codeExecutionResult"]);i!=null&&f(e,["codeExecutionResult"],i);const s=d(n,["executableCode"]);s!=null&&f(e,["executableCode"],s);const r=d(n,["fileData"]);r!=null&&f(e,["fileData"],JL(r));const o=d(n,["functionCall"]);o!=null&&f(e,["functionCall"],XL(o));const a=d(n,["functionResponse"]);a!=null&&f(e,["functionResponse"],a);const l=d(n,["inlineData"]);l!=null&&f(e,["inlineData"],$L(l));const u=d(n,["text"]);u!=null&&f(e,["text"],u);const h=d(n,["thought"]);h!=null&&f(e,["thought"],h);const p=d(n,["thoughtSignature"]);p!=null&&f(e,["thoughtSignature"],p);const g=d(n,["videoMetadata"]);return g!=null&&f(e,["videoMetadata"],g),e}function nD(n){const e={},t=d(n,["handle"]);if(t!=null&&f(e,["handle"],t),d(n,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return e}function iD(n){const e={},t=d(n,["functionDeclarations"]);if(t!=null){let h=t;Array.isArray(h)&&(h=h.map(p=>p)),f(e,["functionDeclarations"],h)}if(d(n,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const i=d(n,["googleSearchRetrieval"]);i!=null&&f(e,["googleSearchRetrieval"],i);const s=d(n,["computerUse"]);s!=null&&f(e,["computerUse"],s);const r=d(n,["fileSearch"]);r!=null&&f(e,["fileSearch"],r);const o=d(n,["codeExecution"]);if(o!=null&&f(e,["codeExecution"],o),d(n,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");const a=d(n,["googleMaps"]);a!=null&&f(e,["googleMaps"],QL(a));const l=d(n,["googleSearch"]);l!=null&&f(e,["googleSearch"],ZL(l));const u=d(n,["urlContext"]);return u!=null&&f(e,["urlContext"],u),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function sD(n){const e=[];for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const i=n[t];if(typeof i=="object"&&i!=null&&Object.keys(i).length>0){const s=Object.keys(i).map(r=>`${t}.${r}`);e.push(...s)}else e.push(t)}return e.join(",")}function rD(n,e){let t=null;const i=n.bidiGenerateContentSetup;if(typeof i=="object"&&i!==null&&"setup"in i){const r=i.setup;typeof r=="object"&&r!==null?(n.bidiGenerateContentSetup=r,t=r):delete n.bidiGenerateContentSetup}else i!==void 0&&delete n.bidiGenerateContentSetup;const s=n.fieldMask;if(t){const r=sD(t);if(Array.isArray(e==null?void 0:e.lockAdditionalFields)&&(e==null?void 0:e.lockAdditionalFields.length)===0)r?n.fieldMask=r:delete n.fieldMask;else if(e!=null&&e.lockAdditionalFields&&e.lockAdditionalFields.length>0&&s!==null&&Array.isArray(s)&&s.length>0){const o=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let a=[];s.length>0&&(a=s.map(u=>o.includes(u)?`generationConfig.${u}`:u));const l=[];r&&l.push(r),a.length>0&&l.push(...a),l.length>0?n.fieldMask=l.join(","):delete n.fieldMask}else delete n.fieldMask}else s!==null&&Array.isArray(s)&&s.length>0?n.fieldMask=s.join(","):delete n.fieldMask;return n}class oD extends Bs{constructor(e){super(),this.apiClient=e}async create(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const a=KL(this.apiClient,e);r=V("auth_tokens",a._url),o=a._query,delete a.config,delete a._url,delete a._query;const l=rD(a,e.config);return s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(u=>u.json()),s.then(u=>u)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function aD(n,e){const t={},i=d(n,["displayName"]);return e!==void 0&&i!=null&&f(e,["displayName"],i),t}function lD(n){const e={},t=d(n,["config"]);return t!=null&&aD(t,e),e}function uD(n,e){const t={},i=d(n,["force"]);return e!==void 0&&i!=null&&f(e,["_query","force"],i),t}function cD(n){const e={},t=d(n,["name"]);t!=null&&f(e,["_url","name"],t);const i=d(n,["config"]);return i!=null&&uD(i,e),e}function dD(n){const e={},t=d(n,["name"]);return t!=null&&f(e,["_url","name"],t),e}function hD(n,e){const t={},i=d(n,["customMetadata"]);if(e!==void 0&&i!=null){let r=i;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["customMetadata"],r)}const s=d(n,["chunkingConfig"]);return e!==void 0&&s!=null&&f(e,["chunkingConfig"],s),t}function fD(n){const e={},t=d(n,["name"]);t!=null&&f(e,["name"],t);const i=d(n,["metadata"]);i!=null&&f(e,["metadata"],i);const s=d(n,["done"]);s!=null&&f(e,["done"],s);const r=d(n,["error"]);r!=null&&f(e,["error"],r);const o=d(n,["response"]);return o!=null&&f(e,["response"],gD(o)),e}function pD(n){const e={},t=d(n,["fileSearchStoreName"]);t!=null&&f(e,["_url","file_search_store_name"],t);const i=d(n,["fileName"]);i!=null&&f(e,["fileName"],i);const s=d(n,["config"]);return s!=null&&hD(s,e),e}function gD(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["parent"]);i!=null&&f(e,["parent"],i);const s=d(n,["documentName"]);return s!=null&&f(e,["documentName"],s),e}function mD(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),t}function yD(n){const e={},t=d(n,["config"]);return t!=null&&mD(t,e),e}function vD(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["fileSearchStores"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["fileSearchStores"],r)}return e}function _D(n,e){const t={},i=d(n,["mimeType"]);e!==void 0&&i!=null&&f(e,["mimeType"],i);const s=d(n,["displayName"]);e!==void 0&&s!=null&&f(e,["displayName"],s);const r=d(n,["customMetadata"]);if(e!==void 0&&r!=null){let a=r;Array.isArray(a)&&(a=a.map(l=>l)),f(e,["customMetadata"],a)}const o=d(n,["chunkingConfig"]);return e!==void 0&&o!=null&&f(e,["chunkingConfig"],o),t}function AD(n){const e={},t=d(n,["fileSearchStoreName"]);t!=null&&f(e,["_url","file_search_store_name"],t);const i=d(n,["config"]);return i!=null&&_D(i,e),e}function ED(n){const e={},t=d(n,["sdkHttpResponse"]);return t!=null&&f(e,["sdkHttpResponse"],t),e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function SD(n,e){const t={},i=d(n,["force"]);return e!==void 0&&i!=null&&f(e,["_query","force"],i),t}function wD(n){const e={},t=d(n,["name"]);t!=null&&f(e,["_url","name"],t);const i=d(n,["config"]);return i!=null&&SD(i,e),e}function CD(n){const e={},t=d(n,["name"]);return t!=null&&f(e,["_url","name"],t),e}function TD(n,e){const t={},i=d(n,["pageSize"]);e!==void 0&&i!=null&&f(e,["_query","pageSize"],i);const s=d(n,["pageToken"]);return e!==void 0&&s!=null&&f(e,["_query","pageToken"],s),t}function xD(n){const e={},t=d(n,["parent"]);t!=null&&f(e,["_url","parent"],t);const i=d(n,["config"]);return i!=null&&TD(i,e),e}function ID(n){const e={},t=d(n,["sdkHttpResponse"]);t!=null&&f(e,["sdkHttpResponse"],t);const i=d(n,["nextPageToken"]);i!=null&&f(e,["nextPageToken"],i);const s=d(n,["documents"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(o=>o)),f(e,["documents"],r)}return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class PD extends Bs{constructor(e){super(),this.apiClient=e,this.list=async t=>new wa(Hs.PAGED_ITEM_DOCUMENTS,i=>this.listInternal({parent:t.parent,config:i.config}),await this.listInternal(t),t)}async get(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=CD(e);return r=V("{name}",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>l)}}async delete(e){var t,i;let s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=wD(e);s=V("{name}",o._url),r=o._query,delete o._url,delete o._query,await this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=xD(e);return r=V("{parent}/documents",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const u=ID(l),h=new ok;return Object.assign(h,u),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class RD extends Bs{constructor(e,t=new PD(e)){super(),this.apiClient=e,this.documents=t,this.list=async(i={})=>new wa(Hs.PAGED_ITEM_FILE_SEARCH_STORES,s=>this.listInternal(s),await this.listInternal(i),i)}async uploadToFileSearchStore(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files to a file search store.");return this.apiClient.uploadFileToFileSearchStore(e.fileSearchStoreName,e.file,e.config)}async create(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=lD(e);return r=V("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>l)}}async get(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=dD(e);return r=V("{name}",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>l)}}async delete(e){var t,i;let s="",r={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=cD(e);s=V("{name}",o._url),r=o._query,delete o._url,delete o._query,await this.apiClient.request({path:s,queryParams:r,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}}async listInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=yD(e);return r=V("fileSearchStores",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const u=vD(l),h=new ak;return Object.assign(h,u),h})}}async uploadToFileSearchStoreInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=AD(e);return r=V("upload/v1beta/{file_search_store_name}:uploadToFileSearchStore",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const u=ED(l),h=new lk;return Object.assign(h,u),h})}}async importFile(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=pD(e);return r=V("{file_search_store_name}:importFile",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json()),s.then(l=>{const u=fD(l),h=new n0;return Object.assign(h,u),h})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function MD(n,e){const t={},i=d(n,["name"]);return i!=null&&f(t,["_url","name"],i),t}function kD(n,e){const t={},i=d(n,["name"]);return i!=null&&f(t,["_url","name"],i),t}function bD(n,e,t){const i={};if(d(n,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=d(n,["tunedModelDisplayName"]);if(e!==void 0&&s!=null&&f(e,["displayName"],s),d(n,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const r=d(n,["epochCount"]);e!==void 0&&r!=null&&f(e,["tuningTask","hyperparameters","epochCount"],r);const o=d(n,["learningRateMultiplier"]);if(o!=null&&f(i,["tuningTask","hyperparameters","learningRateMultiplier"],o),d(n,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(d(n,["preTunedModelCheckpointId"])!==void 0)throw new Error("preTunedModelCheckpointId parameter is not supported in Gemini API.");if(d(n,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=d(n,["batchSize"]);e!==void 0&&a!=null&&f(e,["tuningTask","hyperparameters","batchSize"],a);const l=d(n,["learningRate"]);if(e!==void 0&&l!=null&&f(e,["tuningTask","hyperparameters","learningRate"],l),d(n,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");if(d(n,["beta"])!==void 0)throw new Error("beta parameter is not supported in Gemini API.");return i}function ND(n,e,t){const i={};let s=d(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const m=d(n,["validationDataset"]);e!==void 0&&m!=null&&f(e,["supervisedTuningSpec"],pE(m))}else if(s==="PREFERENCE_TUNING"){const m=d(n,["validationDataset"]);e!==void 0&&m!=null&&f(e,["preferenceOptimizationSpec"],pE(m))}const r=d(n,["tunedModelDisplayName"]);e!==void 0&&r!=null&&f(e,["tunedModelDisplayName"],r);const o=d(n,["description"]);e!==void 0&&o!=null&&f(e,["description"],o);let a=d(t,["config","method"]);if(a===void 0&&(a="SUPERVISED_FINE_TUNING"),a==="SUPERVISED_FINE_TUNING"){const m=d(n,["epochCount"]);e!==void 0&&m!=null&&f(e,["supervisedTuningSpec","hyperParameters","epochCount"],m)}else if(a==="PREFERENCE_TUNING"){const m=d(n,["epochCount"]);e!==void 0&&m!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","epochCount"],m)}let l=d(t,["config","method"]);if(l===void 0&&(l="SUPERVISED_FINE_TUNING"),l==="SUPERVISED_FINE_TUNING"){const m=d(n,["learningRateMultiplier"]);e!==void 0&&m!=null&&f(e,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],m)}else if(l==="PREFERENCE_TUNING"){const m=d(n,["learningRateMultiplier"]);e!==void 0&&m!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","learningRateMultiplier"],m)}let u=d(t,["config","method"]);if(u===void 0&&(u="SUPERVISED_FINE_TUNING"),u==="SUPERVISED_FINE_TUNING"){const m=d(n,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&f(e,["supervisedTuningSpec","exportLastCheckpointOnly"],m)}else if(u==="PREFERENCE_TUNING"){const m=d(n,["exportLastCheckpointOnly"]);e!==void 0&&m!=null&&f(e,["preferenceOptimizationSpec","exportLastCheckpointOnly"],m)}let h=d(t,["config","method"]);if(h===void 0&&(h="SUPERVISED_FINE_TUNING"),h==="SUPERVISED_FINE_TUNING"){const m=d(n,["adapterSize"]);e!==void 0&&m!=null&&f(e,["supervisedTuningSpec","hyperParameters","adapterSize"],m)}else if(h==="PREFERENCE_TUNING"){const m=d(n,["adapterSize"]);e!==void 0&&m!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","adapterSize"],m)}if(d(n,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(d(n,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");const p=d(n,["labels"]);e!==void 0&&p!=null&&f(e,["labels"],p);const g=d(n,["beta"]);return e!==void 0&&g!=null&&f(e,["preferenceOptimizationSpec","hyperParameters","beta"],g),i}function LD(n,e){const t={},i=d(n,["baseModel"]);i!=null&&f(t,["baseModel"],i);const s=d(n,["preTunedModel"]);s!=null&&f(t,["preTunedModel"],s);const r=d(n,["trainingDataset"]);r!=null&&$D(r);const o=d(n,["config"]);return o!=null&&bD(o,t),t}function DD(n,e){const t={},i=d(n,["baseModel"]);i!=null&&f(t,["baseModel"],i);const s=d(n,["preTunedModel"]);s!=null&&f(t,["preTunedModel"],s);const r=d(n,["trainingDataset"]);r!=null&&WD(r,t,e);const o=d(n,["config"]);return o!=null&&ND(o,t,e),t}function FD(n,e){const t={},i=d(n,["name"]);return i!=null&&f(t,["_url","name"],i),t}function UD(n,e){const t={},i=d(n,["name"]);return i!=null&&f(t,["_url","name"],i),t}function HD(n,e,t){const i={},s=d(n,["pageSize"]);e!==void 0&&s!=null&&f(e,["_query","pageSize"],s);const r=d(n,["pageToken"]);e!==void 0&&r!=null&&f(e,["_query","pageToken"],r);const o=d(n,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),i}function VD(n,e,t){const i={},s=d(n,["pageSize"]);e!==void 0&&s!=null&&f(e,["_query","pageSize"],s);const r=d(n,["pageToken"]);e!==void 0&&r!=null&&f(e,["_query","pageToken"],r);const o=d(n,["filter"]);return e!==void 0&&o!=null&&f(e,["_query","filter"],o),i}function GD(n,e){const t={},i=d(n,["config"]);return i!=null&&HD(i,t),t}function OD(n,e){const t={},i=d(n,["config"]);return i!=null&&VD(i,t),t}function BD(n,e){const t={},i=d(n,["sdkHttpResponse"]);i!=null&&f(t,["sdkHttpResponse"],i);const s=d(n,["nextPageToken"]);s!=null&&f(t,["nextPageToken"],s);const r=d(n,["tunedModels"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>ZT(a))),f(t,["tuningJobs"],o)}return t}function zD(n,e){const t={},i=d(n,["sdkHttpResponse"]);i!=null&&f(t,["sdkHttpResponse"],i);const s=d(n,["nextPageToken"]);s!=null&&f(t,["nextPageToken"],s);const r=d(n,["tuningJobs"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(a=>Xy(a))),f(t,["tuningJobs"],o)}return t}function qD(n,e){const t={},i=d(n,["name"]);i!=null&&f(t,["model"],i);const s=d(n,["name"]);return s!=null&&f(t,["endpoint"],s),t}function $D(n,e){const t={};if(d(n,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(d(n,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const i=d(n,["examples"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(r=>r)),f(t,["examples","examples"],s)}return t}function WD(n,e,t){const i={};let s=d(t,["config","method"]);if(s===void 0&&(s="SUPERVISED_FINE_TUNING"),s==="SUPERVISED_FINE_TUNING"){const o=d(n,["gcsUri"]);e!==void 0&&o!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(s==="PREFERENCE_TUNING"){const o=d(n,["gcsUri"]);e!==void 0&&o!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}let r=d(t,["config","method"]);if(r===void 0&&(r="SUPERVISED_FINE_TUNING"),r==="SUPERVISED_FINE_TUNING"){const o=d(n,["vertexDatasetResource"]);e!==void 0&&o!=null&&f(e,["supervisedTuningSpec","trainingDatasetUri"],o)}else if(r==="PREFERENCE_TUNING"){const o=d(n,["vertexDatasetResource"]);e!==void 0&&o!=null&&f(e,["preferenceOptimizationSpec","trainingDatasetUri"],o)}if(d(n,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return i}function ZT(n,e){const t={},i=d(n,["sdkHttpResponse"]);i!=null&&f(t,["sdkHttpResponse"],i);const s=d(n,["name"]);s!=null&&f(t,["name"],s);const r=d(n,["state"]);r!=null&&f(t,["state"],NT(r));const o=d(n,["createTime"]);o!=null&&f(t,["createTime"],o);const a=d(n,["tuningTask","startTime"]);a!=null&&f(t,["startTime"],a);const l=d(n,["tuningTask","completeTime"]);l!=null&&f(t,["endTime"],l);const u=d(n,["updateTime"]);u!=null&&f(t,["updateTime"],u);const h=d(n,["description"]);h!=null&&f(t,["description"],h);const p=d(n,["baseModel"]);p!=null&&f(t,["baseModel"],p);const g=d(n,["_self"]);return g!=null&&f(t,["tunedModel"],qD(g)),t}function Xy(n,e){const t={},i=d(n,["sdkHttpResponse"]);i!=null&&f(t,["sdkHttpResponse"],i);const s=d(n,["name"]);s!=null&&f(t,["name"],s);const r=d(n,["state"]);r!=null&&f(t,["state"],NT(r));const o=d(n,["createTime"]);o!=null&&f(t,["createTime"],o);const a=d(n,["startTime"]);a!=null&&f(t,["startTime"],a);const l=d(n,["endTime"]);l!=null&&f(t,["endTime"],l);const u=d(n,["updateTime"]);u!=null&&f(t,["updateTime"],u);const h=d(n,["error"]);h!=null&&f(t,["error"],h);const p=d(n,["description"]);p!=null&&f(t,["description"],p);const g=d(n,["baseModel"]);g!=null&&f(t,["baseModel"],g);const m=d(n,["tunedModel"]);m!=null&&f(t,["tunedModel"],m);const y=d(n,["preTunedModel"]);y!=null&&f(t,["preTunedModel"],y);const A=d(n,["supervisedTuningSpec"]);A!=null&&f(t,["supervisedTuningSpec"],A);const T=d(n,["preferenceOptimizationSpec"]);T!=null&&f(t,["preferenceOptimizationSpec"],T);const v=d(n,["tuningDataStats"]);v!=null&&f(t,["tuningDataStats"],v);const E=d(n,["encryptionSpec"]);E!=null&&f(t,["encryptionSpec"],E);const w=d(n,["partnerModelTuningSpec"]);w!=null&&f(t,["partnerModelTuningSpec"],w);const x=d(n,["customBaseModel"]);x!=null&&f(t,["customBaseModel"],x);const I=d(n,["experiment"]);I!=null&&f(t,["experiment"],I);const P=d(n,["labels"]);P!=null&&f(t,["labels"],P);const R=d(n,["outputUri"]);R!=null&&f(t,["outputUri"],R);const k=d(n,["pipelineJob"]);k!=null&&f(t,["pipelineJob"],k);const b=d(n,["serviceAccount"]);b!=null&&f(t,["serviceAccount"],b);const N=d(n,["tunedModelDisplayName"]);N!=null&&f(t,["tunedModelDisplayName"],N);const D=d(n,["veoTuningSpec"]);return D!=null&&f(t,["veoTuningSpec"],D),t}function YD(n,e){const t={},i=d(n,["sdkHttpResponse"]);i!=null&&f(t,["sdkHttpResponse"],i);const s=d(n,["name"]);s!=null&&f(t,["name"],s);const r=d(n,["metadata"]);r!=null&&f(t,["metadata"],r);const o=d(n,["done"]);o!=null&&f(t,["done"],o);const a=d(n,["error"]);return a!=null&&f(t,["error"],a),t}function pE(n,e){const t={},i=d(n,["gcsUri"]);i!=null&&f(t,["validationDatasetUri"],i);const s=d(n,["vertexDatasetResource"]);return s!=null&&f(t,["validationDatasetUri"],s),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class KD extends Bs{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new wa(Hs.PAGED_ITEM_TUNING_JOBS,i=>this.listInternal(i),await this.listInternal(t),t),this.tune=async t=>{var i;if(this.apiClient.isVertexAI())if(t.baseModel.startsWith("projects/")){const s={tunedModelName:t.baseModel};!((i=t.config)===null||i===void 0)&&i.preTunedModelCheckpointId&&(s.checkpointId=t.config.preTunedModelCheckpointId);const r=Object.assign(Object.assign({},t),{preTunedModel:s});return r.baseModel=void 0,await this.tuneInternal(r)}else{const s=Object.assign({},t);return await this.tuneInternal(s)}else{const s=Object.assign({},t),r=await this.tuneMldevInternal(s);let o="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?o=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(o=r.name.split("/operations/")[0]),{name:o,state:zy.JOB_STATE_QUEUED}}}}async getInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=UD(e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>Xy(h))}else{const u=FD(e);return a=V("{name}",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>ZT(h))}}async listInternal(e){var t,i,s,r;let o,a="",l={};if(this.apiClient.isVertexAI()){const u=OD(e);return a=V("tuningJobs",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=zD(h),g=new YA;return Object.assign(g,p),g})}else{const u=GD(e);return a=V("tunedModels",u._url),l=u._query,delete u._url,delete u._query,o=this.apiClient.request({path:a,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json().then(p=>{const g=p;return g.sdkHttpResponse={headers:h.headers},g})),o.then(h=>{const p=BD(h),g=new YA;return Object.assign(g,p),g})}}async cancel(e){var t,i,s,r;let o="",a={};if(this.apiClient.isVertexAI()){const l=kD(e);o=V("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal})}else{const l=MD(e);o=V("{name}:cancel",l._url),a=l._query,delete l._url,delete l._query,await this.apiClient.request({path:o,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal})}}async tuneInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI()){const a=DD(e,e);return r=V("tuningJobs",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),s.then(l=>Xy(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,i;let s,r="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const a=LD(e);return r=V("tunedModels",a._url),o=a._query,delete a._url,delete a._query,s=this.apiClient.request({path:r,queryParams:o,body:JSON.stringify(a),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(l=>l.json().then(u=>{const h=u;return h.sdkHttpResponse={headers:l.headers},h})),s.then(l=>YD(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class JD{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const XD=1024*1024*8,QD=3,ZD=1e3,jD=2,op="x-goog-upload-status";async function eF(n,e,t){var i;const s=await jT(n,e,t),r=await(s==null?void 0:s.json());if(((i=s==null?void 0:s.headers)===null||i===void 0?void 0:i[op])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return r.file}async function tF(n,e,t){var i;const s=await jT(n,e,t),r=await(s==null?void 0:s.json());if(((i=s==null?void 0:s.headers)===null||i===void 0?void 0:i[op])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");const o=IT(r),a=new i0;return Object.assign(a,o),a}async function jT(n,e,t){var i,s;let r=0,o=0,a=new qy(new Response),l="upload";for(r=n.size;o<r;){const u=Math.min(XD,r-o),h=n.slice(o,o+u);o+u>=r&&(l+=", finalize");let p=0,g=ZD;for(;p<QD&&(a=await t.request({path:"",body:h,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":l,"X-Goog-Upload-Offset":String(o),"Content-Length":String(u)}}}),!(!((i=a==null?void 0:a.headers)===null||i===void 0)&&i[op]));)p++,await iF(g),g=g*jD;if(o+=u,((s=a==null?void 0:a.headers)===null||s===void 0?void 0:s[op])!=="active")break;if(r<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}return a}async function nF(n){return{size:n.size,type:n.type}}function iF(n){return new Promise(e=>setTimeout(e,n))}class sF{async upload(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await eF(e,t,i)}async uploadToFileSearchStore(e,t,i){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await tF(e,t,i)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await nF(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class rF{create(e,t,i){return new oF(e,t,i)}}class oF{constructor(e,t,i){this.url=e,this.headers=t,this.callbacks=i}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gE="x-goog-api-key";class aF{constructor(e){this.apiKey=e}async addAuthHeaders(e,t){if(e.get(gE)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");e.append(gE,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lF="gl-node/";class uF{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const i=VM(e.httpOptions,e.vertexai,void 0,void 0);i&&(e.httpOptions?e.httpOptions.baseUrl=i:e.httpOptions={baseUrl:i}),this.apiVersion=e.apiVersion;const s=new aF(this.apiKey);this.apiClient=new CL({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:lF+"web",uploader:new sF,downloader:new JD}),this.models=new zL(this.apiClient),this.live=new UL(this.apiClient,s,new rF),this.batches=new p1(this.apiClient),this.chats=new J1(this.models,this.apiClient),this.caches=new W1(this.apiClient),this.files=new rb(this.apiClient),this.operations=new qL(this.apiClient),this.authTokens=new oD(this.apiClient),this.tunings=new KD(this.apiClient),this.fileSearchStores=new RD(this.apiClient)}}const cF=new uF({apiKey:"AIzaSyB002CdDAWdnwD6l_lYXHfNWKm8Kzgnn5A"}),dF=async(n,e)=>{const t=[];if(e.includeTrueFalse&&t.push("true_false (Vero o Falso)"),e.includeMultipleChoice&&t.push("multiple_choice (Risposta Multipla a 4 opzioni)"),e.includeBasic&&t.push("basic (Domanda aperta classica)"),t.length===0)throw new Error("Devi selezionare almeno un tipo di flash card.");const i=`
    Sei un professore esperto. Analizza il seguente testo e crea esattamente ${e.cardCount} flash card didattiche.
    
    Livello di difficolt: ${e.difficulty}.
    Tipi di domande permessi: ${t.join(", ")}.
    Lingua: Italiano.

    Regole:
    1. Per 'multiple_choice', fornisci 4 opzioni nell'array 'options'.
    2. Per 'true_false', la risposta deve essere "Vero" o "Falso".
    3. Per 'basic', la domanda deve richiedere una risposta breve ma precisa.
    4. Il campo 'correctAnswer' deve corrispondere esattamente a una delle opzioni (per MC), a "Vero"/"Falso" (per TF), o alla risposta corretta (per Basic).
    
    Testo da analizzare:
    "${n.substring(0,3e4)}" 
  `,s={type:At.ARRAY,items:{type:At.OBJECT,properties:{id:{type:At.INTEGER},type:{type:At.STRING,enum:[wn.TrueFalse,wn.MultipleChoice,wn.Basic]},question:{type:At.STRING},options:{type:At.ARRAY,items:{type:At.STRING}},correctAnswer:{type:At.STRING},userExplanation:{type:At.STRING,description:"Breve spiegazione del perch la risposta  corretta"}},required:["id","type","question","correctAnswer"]}};try{const o=(await cF.models.generateContent({model:"gemini-2.5-flash",contents:i,config:{responseMimeType:"application/json",responseSchema:s,temperature:.7}})).text;if(!o)throw new Error("Nessuna risposta dal modello.");return JSON.parse(o).map((l,u)=>({...l,id:u+1}))}catch(r){throw console.error("Errore durante la generazione delle flashcard:",r),new Error("Impossibile generare le flashcard. Riprova o controlla il testo.")}};function hF(){const[n,e]=Je.useState(!1),[t,i]=Je.useState(null),[s,r]=Je.useState([]),[o,a]=Je.useState({score:0,answers:[],currentCardIndex:0,isFinished:!1}),l=async(p,g)=>{e(!0),i(null);try{const m=await dF(g.text,p);r(m),a({score:0,answers:[],currentCardIndex:0,isFinished:!1})}catch(m){i(m.message||"Qualcosa  andato storto.")}finally{e(!1)}},u=p=>{const g=[...o.answers,p],m=o.currentCardIndex+1>=s.length;a(y=>({...y,score:p?y.score+1:y.score,answers:g,currentCardIndex:m?y.currentCardIndex:y.currentCardIndex+1,isFinished:m}))},h=()=>{r([]),a({score:0,answers:[],currentCardIndex:0,isFinished:!1}),i(null)};return M.jsxs("div",{className:"min-h-screen text-slate-200 overflow-x-hidden relative font-sans",children:[M.jsxs("div",{className:"fixed inset-0 z-[-1] bg-slate-950",children:[M.jsx("div",{className:"absolute top-[-10%] left-[-10%] w-[60%] h-[60%] bg-indigo-900/30 rounded-full mix-blend-screen filter blur-[100px] animate-blob"}),M.jsx("div",{className:"absolute bottom-[-10%] right-[-10%] w-[60%] h-[60%] bg-purple-900/20 rounded-full mix-blend-screen filter blur-[100px] animate-blob animation-delay-2000"}),M.jsx("div",{className:"absolute top-[40%] left-[40%] w-[40%] h-[40%] bg-pink-900/20 rounded-full mix-blend-screen filter blur-[100px] animate-blob animation-delay-4000"}),M.jsx("div",{className:"absolute inset-0 bg-[url('https://grainy-gradients.vercel.app/noise.svg')] opacity-20"})]}),M.jsxs("div",{className:"relative z-10 container mx-auto px-4 py-8 md:py-12 flex flex-col min-h-screen",children:[M.jsxs("header",{className:`text-center transition-all duration-500 ${s.length>0?"mb-4":"mb-12 mt-10"}`,children:[M.jsxs("div",{className:"inline-flex items-center justify-center space-x-3 mb-2",children:[M.jsx("div",{className:"p-2 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl shadow-lg shadow-indigo-500/30",children:M.jsx("span",{className:"text-2xl md:text-3xl text-white",children:""})}),M.jsx("h1",{className:"text-3xl md:text-5xl font-extrabold text-transparent bg-clip-text bg-gradient-to-r from-indigo-300 via-purple-300 to-pink-300 tracking-tight",children:"FlashMind AI"})]}),!s.length&&!n&&M.jsx("p",{className:"text-lg text-slate-400 max-w-xl mx-auto mt-4 animate-fade-in",children:"Carica PDF o MD. L'intelligenza artificiale creer il tuo percorso di studio personalizzato."})]}),M.jsxs("main",{className:"flex-grow flex flex-col items-center justify-center w-full",children:[t&&M.jsxs("div",{className:"w-full max-w-lg bg-red-950/50 border border-red-500/50 text-red-200 p-6 rounded-2xl shadow-xl mb-8 animate-slide-up backdrop-blur-sm",children:[M.jsxs("div",{className:"flex items-center mb-2",children:[M.jsx("svg",{className:"w-6 h-6 mr-2 text-red-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:M.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),M.jsx("h3",{className:"font-bold text-lg",children:"Si  verificato un errore"})]}),M.jsx("p",{className:"opacity-90",children:t}),M.jsx("button",{onClick:()=>i(null),className:"mt-4 px-4 py-2 bg-red-500/20 hover:bg-red-500/40 text-red-300 rounded-lg text-sm font-semibold transition-colors",children:"Riprova"})]}),s.length===0?M.jsx(NM,{onStart:l,isLoading:n}):o.isFinished?M.jsx(DM,{state:o,onRestart:h}):M.jsx(LM,{card:s[o.currentCardIndex],currentIndex:o.currentCardIndex,totalCards:s.length,onAnswer:u},s[o.currentCardIndex].id)]}),M.jsx("footer",{className:"mt-12 text-center text-slate-600 text-sm py-6",children:M.jsx("p",{className:"hover:text-slate-400 transition-colors cursor-default",children:"Powered by Google Gemini 2.5 Flash"})})]})]})}const ex=document.getElementById("root");if(!ex)throw new Error("Could not find root element to mount to");const fF=Lg.createRoot(ex);fF.render(M.jsx(Ax.StrictMode,{children:M.jsx(hF,{})}));
